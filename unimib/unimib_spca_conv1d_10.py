import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import numpy as np
import cPickle as pickle
from keras.models import Model, load_model
from keras.initializers import Constant, TruncatedNormal
from keras.layers import Input, Dense, Conv1D, Flatten, Dropout, Activation, BatchNormalization
from keras.layers.merge import concatenate
from keras.optimizers import Adam
from keras.callbacks import ModelCheckpoint
import keras.backend as K
from keras import losses
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix

# Load Sparse PCA data

X = pickle.load(open("data/X_unimib_spca.p", "rb"))
y = pickle.load(open("data/y_unimib_spca.p", "rb"))

n_classes = 17


# Below builds 1D CNN.

for i in range(30):
    test = y.loc[y[1] == i+1]
    # print y_sub
    test_index = test.index.values
    # print len(test_index)

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index], y_values[test_index]
    y_train = np.eye(n_classes)[y_train - 1]
    print X_train.shape # (11188, 151)

    # input layer
    input_signal = Input(shape=(151, 1))
    print K.int_shape(input_signal)

    # define initial parameters
    b_init = Constant(value=0.0)
    k_init = TruncatedNormal(mean=0.0, stddev=0.01, seed=2018)

    # first feature extractor
    conv11 = Conv1D(16, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn11 = BatchNormalization()(conv11)
    actv11 = Activation('relu')(bn11)
    conv12 = Conv1D(32, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv11)
    bn12 = BatchNormalization()(conv12)
    actv12 = Activation('relu')(bn12)
    flat1 = Flatten()(actv12)

    # second feature extractor
    conv21 = Conv1D(16, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn21 = BatchNormalization()(conv21)
    actv21 = Activation('relu')(bn21)
    conv22 = Conv1D(32, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv21)
    bn22 = BatchNormalization()(conv22)
    actv22 = Activation('relu')(bn22)
    flat2 = Flatten()(actv22)

    # third feature extractor
    conv31 = Conv1D(16, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn31 = BatchNormalization()(conv31)
    actv31 = Activation('relu')(bn31)
    conv32 = Conv1D(32, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv31)
    bn32 = BatchNormalization()(conv32)
    actv32 = Activation('relu')(bn32)
    flat3 = Flatten()(actv32)

    # merge feature extractors
    merge = concatenate([flat1, flat2, flat3])

    # dropout & fully-connected layer
    do = Dropout(0.9, seed=2018)(merge)
    output = Dense(n_classes, activation='softmax', bias_initializer=b_init, kernel_initializer=k_init)(do)

    # result
    model = Model(inputs=input_signal, outputs=output)

    # summarize layers
    print(model.summary())

    new_dir = 'model/unimib_spca_conv1d_10/' + str(i+1) + '/'
    if not os.path.exists(new_dir):
        os.makedirs(new_dir)

    fpath = new_dir + 'weights.{epoch:02d}-{val_acc:.2f}.hdf5'
    cp_cb = ModelCheckpoint(fpath, monitor='val_acc', verbose=1, save_best_only=True, mode='auto', period=1)

    adam = Adam(lr=0.001)
    model.compile(loss=losses.categorical_crossentropy, optimizer=adam, metrics=['accuracy'])
    model.fit(np.expand_dims(X_train, axis=2), y_train, batch_size=64, epochs=50, verbose=2, validation_split=0.10,
              callbacks=[cp_cb], shuffle=True)

    del model
    K.clear_session()


# Below calculates average test data accuracy (LOSO CV).

acc = []

for i in range(30):
    test = y.loc[y[1] == i+1]
    test_index = test.index.values

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index] - 1, y_values[test_index] - 1

    print "\n>>>>>>>>>>>>>>", str(i+1), "-fold <<<<<<<<<<<<<<<<"
    path_str = 'model/unimib_spca_conv1d_10/' + str(i+1) + '/'
    for path, dirs, files in os.walk(path_str):
        dirs.sort()
        files.sort()
        top_acc = []
        top_acc.append(files[-1])
        files = top_acc
        for file in files:
            print "========================================"
            print os.path.join(path, file)
            model = load_model(os.path.join(path, file))
            pred = model.predict(np.expand_dims(X_train, axis=2), batch_size=32)
            print "------ TRAIN ACCURACY: ", file, " ------"
            print accuracy_score(y_train, np.argmax(pred, axis=1))
            print confusion_matrix(y_train, np.argmax(pred, axis=1))
            pred = model.predict(np.expand_dims(X_test, axis=2), batch_size=32)
            print "------ TEST ACCURACY: ", file, " ------"
            print accuracy_score(y_test, np.argmax(pred, axis=1))
            print confusion_matrix(y_test, np.argmax(pred, axis=1))

            del model
            K.clear_session()

    acc.append(accuracy_score(y_test, np.argmax(pred, axis=1)))

print acc
print np.mean(acc)
print np.std(acc)

'''
-----
[0.671875, 0.7307032590051458, 0.819078947368421, 0.49517684887459806, 0.761744966442953, 0.8228155339805825, 0.7606060606060606, 0.818639798488665, 0.6642512077294686, 0.7156549520766773, 0.7321428571428571, 0.728, 0.7347480106100795, 0.8387096774193549, 0.7822784810126582, 0.6111111111111112, 0.8029978586723768, 0.7310344827586207, 0.7406015037593985, 0.7331887201735358, 0.6642857142857143, 0.6157024793388429, 0.7392638036809815, 0.7054009819967266, 0.7209876543209877, 0.7589285714285714, 0.7808988764044944, 0.8544303797468354, 0.6660194174757281, 0.7524509803921569]
0.731790937877
0.0741925397002
-----

/usr/bin/python2.7 /mnt/0cdd1a7e-3686-4cf7-9055-145eb5fe70f3/hcilab/OSS/electronicsletters2018/unimib/unimib_spca_conv1d_10.py
/home/hcilab/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.

>>>>>>>>>>>>>> 1 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/1/weights.35-0.50.hdf5
------ TRAIN ACCURACY:  weights.35-0.50.hdf5  ------
0.908404320717
[[ 142    4    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   3  186    1    0    2    0    0   14    0    0    0    0    0    0
     0    0    0]
 [   0    0 1630    0   11    1   39    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7 1884    0    1   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  864    0   25    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    5  713    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0    6    9 1259    0    0    0    0    0    0    0
     0    0    0]
 [   1    0    0    0    0    0    0  283    2    0    0    0    0    0
     1    1    0]
 [   0    1    0    0    0    0    1   16  179    0    0    0    0    0
     1    0    0]
 [   0    2    0    0    0    0    0    0    2  439    6    0    7   59
     0    3    0]
 [   0    1    0    0    1    0    0    2    1   17  420   10    1   18
     0   20    3]
 [   0    1    0    0    1    3    0    7    0    8   31  372    3   14
    43    5   23]
 [   0    3    0    0    0    0    0    5    0    4   13    9  590   12
     0    4    2]
 [   2    5    0    0    1    1    0    0    0   64    4    1    6  373
     0    7    6]
 [   1    1    0    0    2    0    0   20    4    1   19   45    2    6
   293    4   21]
 [   0    0    0    0    1    0    0    5    0   19   63   12    7   23
     8  316   39]
 [   0    2    0    0    0    1    0    4    0   11   20   28    4   24
     9   12  401]]
------ TEST ACCURACY:  weights.35-0.50.hdf5  ------
0.671875
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  1  0 27  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 28  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 25  0  1  0 16  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  2  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  9  1  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  1  0  1 10  1  0  1  0  1  1]
 [ 0  0  0  0  0  2  0  0  0  0  1  1  1  0  0  7  3]
 [ 0  0  0  0  0  0  0  0  0  0  5  0 14  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  3 10  0]
 [ 0  0  0  0  0  3  0  0  0  0  4  8  0  0  0  0  0]
 [ 0  0  0  0  0  4  0  0  0  2  0  0  0  4  4  3  3]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  2  3  0  0 10]]

>>>>>>>>>>>>>> 2 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/2/weights.43-0.52.hdf5
------ TRAIN ACCURACY:  weights.43-0.52.hdf5  ------
0.917411512335
[[ 140    4    2    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  187    8    0    1    0    0    7    0    0    0    0    0    0
     0    1    0]
 [   0    0 1595    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1893    0    0   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    0  851    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   42    1    3    7 1222    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    2    0    0    0    0  272    3    0    1    1    1    0
     4    0    2]
 [   0    0    1    0    0    0    0    9  185    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    0    0    0  435    6    6   13   36
     0    5    7]
 [   0    0    1    0    1    0    1    0    0    8  413   24    5   14
     0   19    2]
 [   0    0    1    0    1    1    1    0    0    2   13  458   10    3
     2    3    7]
 [   0    0    1    0    0    0    0    1    0    0   23   19  566    6
     0    4    1]
 [   0    0    0    0    1    0    0    0    0   49    8    6    5  355
     1   14   13]
 [   0    1    0    0    3    0    0    0    0    0   15  103    7    0
   253   11   16]
 [   0    0    0    0    0    0    0    0    0    6   60   13   12   14
     0  320   61]
 [   0    0    1    0    0    1    0    0    0    4   12   47    5   13
     0   22  402]]
------ TEST ACCURACY:  weights.43-0.52.hdf5  ------
0.730703259005
[[  6   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0]
 [  0   7   0   0   3   0   1   0   0   0   0   0   0   0   0   1   0]
 [  0   0 136   0   7   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  37   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  29   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  49   0   0   0   0   0   0   0   0   0   0]
 [  0   1   0   0   2   0   0   6   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   2   2   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  10   0   0   3   5   0   3   0]
 [  0   0   0   0   0   0   0   0   0   1   6   3  13   0   0   0   0]
 [  0   0   0   0   1   0   2   2   0   0   0  17   0   0   0   1   1]
 [  0   0   1   0   0   0   0   0   0   1   3   2  26   0   0   3   4]
 [  0   0   0   0   0   0   0   0   0   1   4   4   8  10   0   3   2]
 [  0   0   1   0   0   1   0   0   0   0   0   9   0   0   4   9   1]
 [  0   0   0   0   1   2   1   0   0   0   3   3   6   0   0   3   8]
 [  0   0   0   0   0   2   0   0   0   0   0  19   0   0   0   2   4]]

>>>>>>>>>>>>>> 3 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/3/weights.49-0.53.hdf5
------ TRAIN ACCURACY:  weights.49-0.53.hdf5  ------
0.932065928316
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  207    0    0    0    0    0    7    0    0    0    0    0    0
     0    0    0]
 [   1    0 1701    1    5    1    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1910    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   1    1    3    0  875    0    9    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    6    9    7 1258    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  282    3    0    0    0    0    0
     0    0    0]
 [   1    0    0    0    0    0    0    6  189    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    0    0    0    0  464    4    3    4   38
     0    2    0]
 [   0    0    1    0    0    0    0    2    0   28  417    1   12    7
     2   25    4]
 [   0    1    0    0    1    2    1    7    1   12   20  394   13   10
    28    8   18]
 [   0    1    0    0    0    0    1    2    0    2   15    6  603    9
     0    8    0]
 [   1    2    1    0    1    1    0    1    0   67    5    1    1  380
     2    7    1]
 [   2    0    0    0    5    1    0    8    0    3   14   37    6    0
   335    4   12]
 [   0    0    0    0    0    0    0    0    0   18   48    2   15   18
     1  368   33]
 [   0    0    0    0    0    1    0    2    0   12   12   21    4   20
     2   10  443]]
------ TEST ACCURACY:  weights.49-0.53.hdf5  ------
0.819078947368
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 73  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  2 36  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  0  0  0  3  0  0  0]
 [ 0  1  0  0  0  0  0  3  0  0  7  0  0  0  0  1  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  9  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 13  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0 10  0  0  2  0  0  1  0]
 [ 0  1  0  0  0  0  0  3  1  0  0  0  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  2  0  0  3  2  0  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  1  0  0  1  0]]

>>>>>>>>>>>>>> 4 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/4/weights.44-0.53.hdf5
------ TRAIN ACCURACY:  weights.44-0.53.hdf5  ------
0.925567190227
[[ 143    8    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   2  195    0    0    1    0    0   13    0    0    0    0    0    0
     0    1    0]
 [   0    1 1712    0    3    1    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1928    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    2    0  865    0   22    0    0    0    2    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    9    4    4   13 1266    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  273   13    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1  190    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    2    0    0    0    1  454    6    1    6   50
     0    2    0]
 [   0    0    0    0    1    0    1    2    0   19  416   10    1   14
     1   25    2]
 [   0    0    0    0    1    1    1    1    0   18   24  417    3    7
    11   11    8]
 [   0    1    0    0    0    0    0    2    0    4   13    9  602    8
     0    4    0]
 [   0    3    0    0    1    0    0    0    0   61    3    0    0  383
     6    9    1]
 [   1    1    0    0    3    0    0   10    2    2   17   76    2    7
   285    5   10]
 [   0    0    0    0    1    0    0    0    0   15   57    3    8   26
     1  358   28]
 [   0    0    0    0    0    1    0    1    0   10   19   19    3   18
     2   38  401]]
------ TEST ACCURACY:  weights.44-0.53.hdf5  ------
0.495176848875
[[ 2  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  1  0  9  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 50  0  0  4  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0 26  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 11  0  1  0  0  0  0  6  0  0  9  0]
 [ 0  1  0  1  0 21  0  0  0  0  0  0  4  0  0  0]
 [ 2  0  0  0  0  1  5  1  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  6  0  0  0  0  0  0  1  2  0]
 [ 0  0  0  0  0  0  0  0  6  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  1  4  0  0  0  0  9]
 [ 0  0  0  0  0  0  0  0  3 12  8  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  0  0 11  0  0  5  0]
 [ 0  0  0  0  0  0  0  0  1  1  5  0  7  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  1 10  0  0  0  1  1]
 [ 0  0  0  0  0  0  0  0  3  2  6  0  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  6  4  5  3  0  1  0]]

>>>>>>>>>>>>>> 5 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/5/weights.39-0.52.hdf5
------ TRAIN ACCURACY:  weights.39-0.52.hdf5  ------
0.90900374793
[[ 144    1    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   7  179    0    0    1    0    0   16    1    0    0    0    0    0
     0    0    0]
 [   0    1 1694    1   16    0    1    1    0    0    0    0    0    0
     0    1    1]
 [   0    0    1 1912    0    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   1    2    6    0  868    0   21    4    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    2  724    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   48   28   32   12 1169    1    0    0    0    0    0    0
     1    1    0]
 [   0    0    0    0    0    0    0  286    2    0    0    0    0    0
     1    1    0]
 [   1    0    0    0    0    0    0   16  180    0    0    0    0    1
     1    0    0]
 [   0    1    0    0    0    0    0    1    3  428   11    8    4   41
     1   13    2]
 [   0    0    0    0    0    0    0    9    0    8  422    5    7   12
     3   32    4]
 [   0    0    0    0    1    0    1    2    0    7   37  376    6    8
    23   23   21]
 [   0    3    0    0    0    0    0    1    0    0    7    7  608   14
     1    2    3]
 [   0    4    0    0    1    0    0    0    0   51    5    1    2  387
     5   11    7]
 [   1    1    0    0    3    0    0   19    0    5   15   38    8    0
   314    5   16]
 [   0    0    0    0    0    0    0    1    0    9   56    3   22   18
     5  333   51]
 [   0    1    0    0    0    0    0    2    1    9   19   13    4   15
    17   30  405]]
------ TEST ACCURACY:  weights.39-0.52.hdf5  ------
0.761744966443
[[ 7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 66  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 19  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  9  5  2  0]
 [ 0  0  0  0  0  0  0  1  2  0  2  0  0  0  0  3  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  8  0  0  7  0  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  1  0  0  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0  2  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  2  2  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  4  9  3]]

>>>>>>>>>>>>>> 6 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/6/weights.50-0.54.hdf5
------ TRAIN ACCURACY:  weights.50-0.54.hdf5  ------
0.918830883
[[ 134   16    0    0    0    0    0    0    0    0    0    0    1    0
     0    0    0]
 [   0  204    1    0    2    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1668    0   12    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   16 1837    1    2   70    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  865    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  715    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11    0   18    7 1238    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  275    6    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0   11  182    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    3  434    7    2    1   56
     0    3    2]
 [   0    0    0    0    4    0    0    1    1    6  417   10    8   16
     3   22    8]
 [   0    0    0    0    1    4    0    1    0    6    9  417   11   13
    11    6   28]
 [   0    2    1    0    0    0    0    1    0    2   10   12  590    8
     0    9    3]
 [   0    6    0    0    1    1    0    0    0   37    5    5    0  394
     1    4   10]
 [   0    2    2    0    6    0    0   10    2    2   10   69    9    0
   266   12   26]
 [   0    1    0    0    1    0    0    0    0    8   63    2   12   17
     2  342   45]
 [   0    0    1    0    0    1    0    0    0    1    7   15    1   18
     1   12  459]]
------ TEST ACCURACY:  weights.50-0.54.hdf5  ------
0.822815533981
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 44  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 29  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  2  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0  0  2 12  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0 16  1  0  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  8  6  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 15  0  0  3  1  0]
 [ 0  0  0  0  2  0  0  0  0  0  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  2  0  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 12  0  0  4  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  4 16]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1 17]]

>>>>>>>>>>>>>> 7 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/7/weights.21-0.50.hdf5
------ TRAIN ACCURACY:  weights.21-0.50.hdf5  ------
0.809806835067
[[ 140    8    1    0    0    0    0    0    0    0    0    3    1    0
     0    0    0]
 [  18  150    7    0    3    3    1   19    0    0    1    0    4    1
     1    2    1]
 [   0    0 1146    0    8    7  528    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1888    0    3   42    0    0    0    0    0    0    0
     0    0    0]
 [   1    0   22    1  709   45  105    0    0    0    1    0    1    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14    9    1   29 1238    0    0    0    0    0    0    0
     0    0    0]
 [   3    5    2    0    0    0    0  243    3    1    3    6    1    1
     9    2    9]
 [   0    0    1    0    0    0    0   14  163    0    5    2    0    1
     1    1    4]
 [   0    0    0    0    0    0    0    0    0  444    4    3   21   31
     0    3   10]
 [   0    0    0    0    1    4    1    0    0   26  365    6   41   13
     4   22   13]
 [   0    4    0    0    0   15    3    3    1   10   33  309   32    5
    28   29   36]
 [   0    0    0    0    1    0    0    3    0    7    2   11  611    3
     0    0    5]
 [   1    3    0    0    0   10    0    0    0  117    2    2   28  277
     3    7   12]
 [   2    3    0    0    3    6    0    2    0    9   38   75   12    3
   236   12   25]
 [   0    0    0    0    0    5    0    0    0   50   59    4   55   13
     7  242   65]
 [   0    2    0    0    0    3    0    1    0   18   31    6   27   23
     4   29  378]]
------ TEST ACCURACY:  weights.21-0.50.hdf5  ------
0.760606060606
[[ 4  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0 42  0  0  0  7  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 33  2  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  7  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  3  0  0  5  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 15  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  5  0  0  1  0  5]
 [ 0  1  0  0  0  0  0  0  0  0  0 13  0  0  2  2]
 [ 0  0  0  0  4  0  0  0  5  0  0  0 12  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  1 10]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  5  7]]

>>>>>>>>>>>>>> 8 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/8/weights.49-0.51.hdf5
------ TRAIN ACCURACY:  weights.49-0.51.hdf5  ------
0.920080886232
[[ 134   15    0    0    0    0    0    1    1    0    0    0    0    0
     0    0    0]
 [   1  209    0    0    0    0    0    5    1    0    0    0    0    0
     0    0    0]
 [   0    0 1652    0    7    0   12    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1907    0    0   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    4    0  874    0   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    3    3    4    7 1258    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  276    5    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    4  183    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    3    2  445    8    0    3   36
     0    1    5]
 [   0    1    0    0    3    0    0    3    2   20  416   11    1   12
     1   22    2]
 [   0    1    0    0    3    3    0    9    0    8   40  380    5   10
    23   10   17]
 [   0    3    0    0    2    0    1    3    0    1   17    9  579   14
     0    5    2]
 [   1    6    0    0    1    0    0    1    0   50    4    2    3  384
     2    8    3]
 [   0    2    0    0    3    0    0   18    0    0   26   49    0    1
   301    7   13]
 [   0    0    0    0    1    0    0    3    2   12   58    6    7   15
     4  354   41]
 [   0    0    0    0    0    2    0   10    0   12   22   15    4   20
     5   31  392]]
------ TEST ACCURACY:  weights.49-0.51.hdf5  ------
0.818639798489
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 54  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  8  0  0  0 39  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0 10  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2 10  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9 11  0  0  0  0  0  6]
 [ 0  0  0  0  2  0  0  0  0  0 15  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  4  0  0  2  9  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 25  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0 16  0  1  0]
 [ 0  0  0  0  0  0  0  7  1  0  1  2  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  5  1]
 [ 0  0  0  0  0  0  0  4  1  0  0  0  0  2  2  1 11]]

>>>>>>>>>>>>>> 9 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/9/weights.46-0.49.hdf5
------ TRAIN ACCURACY:  weights.46-0.49.hdf5  ------
0.92022541164
[[ 147    3    0    0    2    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  205    0    0    1    0    0    6    0    0    0    0    0    0
     0    1    0]
 [   0    0 1654    0   28    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1923    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    3    0  874    0   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    4   15    7 1245    0    0    0    0    0    0    0
     0    0    0]
 [   1    0    0    0    0    0    0  274    9    0    0    1    1    0
     2    0    0]
 [   0    0    0    0    0    0    1    6  181    0    0    0    0    0
     1    1    0]
 [   0    0    0    0    2    0    0    0    2  413    4    2    5   75
     0    2    4]
 [   0    0    1    0    1    0    0    0    0   11  406    2    5   22
     3   26    5]
 [   0    0    1    0    1    5    1    2    1    8   25  373    4   12
    42    7   24]
 [   0    0    0    0    0    0    0    3    0    0   15   19  567    8
     0    2   10]
 [   0    2    0    0    1    0    0    0    0   38    2    2    2  400
     2   12   12]
 [   1    0    0    0    3    0    0    8    1    1   13   42    4    1
   334    8    5]
 [   0    0    0    0    1    0    0    1    0    5   46    7   20   21
     7  332   42]
 [   0    0    1    0    0    0    0    0    0    4   23   11    2   25
     8   29  402]]
------ TEST ACCURACY:  weights.46-0.49.hdf5  ------
0.664251207729
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 1  0 45  0  0  0  4  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 60  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 17  0  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  7  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 10  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 15  0  5  0]
 [ 0  0  0  0  0  0  0  3  0  4 11  1  0  3  0  6  1]
 [ 0  0  0  0  0  0  0  0  0  0  9  0  0  0 11  0  0]
 [ 0  0  2  0  0  0  0  0  0  0  2  0 24  2  0  0  7]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  3  0  3  3]
 [ 0  0  0  0  1  0  0  0  0  0  0  3  0  0  9  0  0]
 [ 0  0  1  0  0  0  0  0  0  5  0  0  5  1  1 10  8]
 [ 0  0  0  0  1  0  0  0  0  6  1  0  0  0  3 11  7]]

>>>>>>>>>>>>>> 10 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/10/weights.49-0.49.hdf5
------ TRAIN ACCURACY:  weights.49-0.49.hdf5  ------
0.92258683889
[[ 151    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  206    0    0    1    0    0    6    0    0    0    0    0    0
     0    1    0]
 [   0    0 1699    0    2    2    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1927    0    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   25    0  854    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  729    0    0    0    0    0    0    0    0
     0    0    0]
 [   1    0   15    0    3    0 1276    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    1    0    0  286    5    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    5  181    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  450    3    2    5   39
     0    5    1]
 [   0    0    1    0    2    0    0    1    0   22  429   10    3   13
     0    6   12]
 [   0    0    0    0    1    2    0    0    0   13   23  427   11    4
    10    2   11]
 [   0    1    0    0    0    0    0    2    0    8   12   13  593    7
     0    7    0]
 [   1    3    1    0    0    0    0    2    0   73    6    0    7  355
     5    8    6]
 [   0    2    0    0    3    0    0    4    3    1   18   99   10    0
   264    4   12]
 [   0    0    0    0    0    0    0    1    0   19   43   15   10   21
     0  338   54]
 [   0    0    1    0    0    0    0    0    0    9   17   40    3   22
     5   14  406]]
------ TEST ACCURACY:  weights.49-0.49.hdf5  ------
0.715654952077
[[32  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 51  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0 13  0 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 17  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  7 22  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  8  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 20  0  0  2  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 11  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  6  9  2  0  0  0  5]
 [ 0  0  0  0  0  0  0  0  0  0 18  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  1  0  0  5  0  0  0]
 [ 0  1  0  0  0  0  0  0  3  1  0  0  6  0  3]
 [ 0  0  0  0  0  0  0  0  8  1  0  0  0  3  0]
 [ 0  0  0  0  0  0  0  5  0  1  0  1  0  0 10]]

>>>>>>>>>>>>>> 11 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/11/weights.40-0.51.hdf5
------ TRAIN ACCURACY:  weights.40-0.51.hdf5  ------
0.890939449864
[[ 141    5    0    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  195    2    0    2    0    1    7    0    0    0    0    0    0
     2    0    0]
 [   0    0 1698    0    4    6    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9 1850    0    6   38    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   18    0  828    2   30    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  725    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   60    1    3   13 1190    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    3    0    0    1    0  272    6    0    2    1    0    0
     1    0    0]
 [   0    1    0    0    0    0    1    6  187    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    2  448    3    0    7   45
     0    1    3]
 [   0    0    2    0    1    0    1    0    1   34  399   17    3   15
     1   16    1]
 [   0    0    2    0    1    2    0    1    0   10   39  397    6   10
    21    8   15]
 [   0    2    1    0    1    0    0    0    1    5   19   14  580    9
     0    5    0]
 [   1    4    0    0    1    2    0    0    0  103    8    5    5  317
     1   12    6]
 [   1    1    0    0    3    0    0   17    0    4   28   93    6    0
   247    6   10]
 [   0    0    0    0    1    0    0    2    2   28   87    5   15   22
     5  297   35]
 [   0    0    1    0    0    0    0    0    0   22   36   30    0   26
     3   33  367]]
------ TEST ACCURACY:  weights.40-0.51.hdf5  ------
0.732142857143
[[ 3  0  0  0  0  0  0  0  0  0  0  0  3  0  0  0  0]
 [ 0  3  0  0  0  1  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 23  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 82  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  9  0 34  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 28  0  0  0 29  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  7  0  0  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  0  4  0  3  2]
 [ 0  0  6  0  0  0  0  0  0  0 14  0  0  0  0  0  0]
 [ 0  0  0  0  0  1  0  0  0  0  0  3  3  0  1  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  0  0  0  5]
 [ 0  0  1  0  0  0  0  0  0  0  0  0  3 12  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0 11  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  5  0  0  5  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  4  0  0  0  9]]

>>>>>>>>>>>>>> 12 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/12/weights.18-0.53.hdf5
------ TRAIN ACCURACY:  weights.18-0.53.hdf5  ------
0.865761689291
[[ 111   27    0    0    1    0    0    3    5    0    0    0    0    0
     0    0    0]
 [   0  198    0    0    1    0    0   10    1    0    0    0    0    0
     0    1    0]
 [   0    2 1524    0   19    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   37 1823    3    2   46    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    6    0  868    0   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0   11  702    0    0    0    0    0    0    1    0
     0    0    0]
 [   0    1   44    1   76    8 1158    0    0    0    0    0    0    0
     0    0    0]
 [   0    6    0    0    2    0    0  272   14    0    1    0    0    0
     0    1    0]
 [   0    3    0    0    0    0    0    7  186    0    0    0    0    1
     0    0    0]
 [   0    0    0    0    0    0    0    3    3  350   25    1   11  112
     0    1    6]
 [   0    1    0    0    0    0    0    4    3    6  426    7    9   16
     4   10   10]
 [   0    0    1    0    1    0    0   16    3    3   65  328    8   14
    29   12   34]
 [   0    0    1    0    0    0    0    7    0    4    4    8  603    8
     0    2    4]
 [   1    4    0    0    0    2    0    3    1   47   18    4    7  360
     1    8    8]
 [   0    1    0    0    4    0    0   26    6    3   37   54    9    1
   257    2   24]
 [   0    3    0    0    0    0    0    7    0    9   86   17   39   30
    15  244   46]
 [   0    1    1    0    0    0    0    5    1   12   46   28   13   20
    12   28  348]]
------ TEST ACCURACY:  weights.18-0.53.hdf5  ------
0.728
[[  4   2   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   5   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 139   0  43   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  18  53   0   0   3   0   0   0   0   0   0   0   0   0   0]
 [  0   1   0   0  31   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   1   0   3  26   2   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   2   0  34   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   2   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   9   2   0   0   6   0   0   0]
 [  0   1   0   0   0   0   0   0   0   0   8   0   1   0   1   2   2]
 [  0   0   0   0   0   0   0   0   0   0   4   6   0   0   0   2   0]
 [  0   0   0   0   0   0   0   0   0   0  10   0  10   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0  20   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   1   0   0   0   7   0   2]
 [  0   0   0   0   0   0   0   0   0   0  13   0   0   0   0   2   2]
 [  0   0   0   0   0   0   0   0   0   1   3   0   3   0   1   3   8]]

>>>>>>>>>>>>>> 13 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/13/weights.44-0.53.hdf5
------ TRAIN ACCURACY:  weights.44-0.53.hdf5  ------
0.922064244339
[[ 150    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  203    0    0    0    0    0    4    0    0    0    0    0    0
     0    0    1]
 [   0    0 1699    0    5    1    9    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1914    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   38    0  803    1   43    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   15    9    0    7 1248    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0  265    8    0    1    0    0    0
     3    1    0]
 [   1    0    0    0    0    0    1    4  189    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    0    0    2    0  448    3    1    4   46
     0    0    3]
 [   0    0    1    0    1    0    0    0    0   17  410    0    4   18
     9   19   14]
 [   0    0    0    0    0    2    1    1    2   11   21  397    8    9
    29   16   11]
 [   0    0    0    0    0    0    1    3    0    1   13   14  591    7
     0    6    0]
 [   1    0    0    0    0    0    0    0    0   56    1    1    3  398
     3    3    8]
 [   1    0    1    1    0    0    1    3    0    1   13   60    7    1
   308    9   12]
 [   0    0    0    0    0    0    0    0    0   18   51    3    5   18
     8  351   41]
 [   0    0    1    0    0    0    0    1    0    6   16   16    3   26
     7   25  411]]
------ TEST ACCURACY:  weights.44-0.53.hdf5  ------
0.73474801061
[[ 0  3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  1  0  0  4  0]
 [ 0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  9  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0 44  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0 13  0  0  0  0  0  0  1  2  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  0  4  0  3  8]
 [ 0  0  0  0  0  0  1  0  0  0  5  0  0  0  0 10  2]
 [ 0  0  0  0  0  0  1  0  0  0  4  2  1  0  0  0 10]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 25  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  3 11  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  4  3  0  5  5]
 [ 0  0  0  0  0  0  0  0  0  0 12  0  0  1  0  1  8]]

>>>>>>>>>>>>>> 14 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/14/weights.48-0.53.hdf5
------ TRAIN ACCURACY:  weights.48-0.53.hdf5  ------
0.926046144399
[[ 149    1    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0  204    1    0    0    0    0    4    0    0    0    0    0    0
     1    0    0]
 [   0    0 1684    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1930    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  856    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    3  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   32   13   23    6 1200    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  283    6    0    0    1    0    0
     1    0    1]
 [   0    0    1    0    0    0    0    5  188    0    0    1    0    0
     0    0    0]
 [   1    1    0    0    0    0    0    0    0  467    5    2    1   37
     1    0    1]
 [   0    0    0    0    1    0    0    1    0   30  412    2    2   10
     5   20   10]
 [   0    0    0    0    2    1    0    0    0    8   18  420    9    9
    17    9   10]
 [   0    1    0    0    0    0    0    2    0    1   13   26  585    7
     0    4    2]
 [   1    2    0    0    0    0    0    0    0   65    1    1    0  385
     3    6   10]
 [   0    0    0    0    3    0    0    4    1    1   11   79    4    1
   293    4   13]
 [   0    0    0    0    0    0    0    2    0   22   49    8    8   10
     5  338   53]
 [   0    0    0    0    0    0    0    0    0    5   14   25    5   14
     6   11  443]]
------ TEST ACCURACY:  weights.48-0.53.hdf5  ------
0.838709677419
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0 51  0  3  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 40  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  5  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3 15  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1 20  0  0  1  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 13  0  1  1  5]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  9  0  0  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  2  0  0  0 11  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0  1  2  5]]

>>>>>>>>>>>>>> 15 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/15/weights.42-0.54.hdf5
------ TRAIN ACCURACY:  weights.42-0.54.hdf5  ------
0.901371308017
[[ 128   10    3    0    0    0    0    2    0    0    0    0    1    0
     0    0    0]
 [   0  188    8    0    0    0    0   11    0    0    1    0    0    0
     2    0    1]
 [   0    0 1691    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6 1886    0    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   36    0  849    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  696   18    0    0    0    0    0    0    0
     0    0    0]
 [   0    0  119   20   14    6 1110    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0    1    0    0  271    2    0    1    2    1    0
     3    1    0]
 [   0    0    0    0    0    0    0   32  150    0    0    1    0    0
     6    3    0]
 [   0    0    0    0    0    0    0    2    0  432    9    4    8   49
     0    7    6]
 [   0    0    1    0    1    0    0    0    0   12  406   23   14   10
     1   20    5]
 [   0    0    1    0    1    0    0    0    0    7   13  446   20    5
     8    5    6]
 [   0    0    1    0    0    0    0    0    0    1    4   16  610    5
     0    2    4]
 [   1    1    4    0    0    0    0    0    0   62    3    4   11  365
     1   12    5]
 [   0    1    0    0    3    0    0    2    0    0    9   91    1    3
   294    6    6]
 [   0    0    1    0    0    0    0    0    0   10   45   21   32    7
     2  334   48]
 [   0    0    1    0    0    0    0    0    0    4    9   57    9   16
     4   21  398]]
------ TEST ACCURACY:  weights.42-0.54.hdf5  ------
0.782278481013
[[ 4  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  2  0  0  1  0  0  0  0  0  0]
 [ 0  0 47  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 88  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 14  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 55  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0 11  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0  0  1  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  3  2  0  0  0]
 [ 0  0  1  0  0  0  0  0  0  0 12  0  0  0  2  0  3]
 [ 0  0  0  0  0  0  0  0  0  2  0  3  0  2  0  1  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 11  0  1  5  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2 11  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  6  8  0  0  2  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  3  3  5  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  5  3  3  0  0  0  4]]

>>>>>>>>>>>>>> 16 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/16/weights.41-0.53.hdf5
------ TRAIN ACCURACY:  weights.41-0.53.hdf5  ------
0.907369724852
[[ 128   12    0    0    1    0    0    3    1    0    0    0    0    0
     0    0    0]
 [   0  178    0    0    4    0    0   15    0    0    0    1    1    0
     0    0    0]
 [   0    0 1666    0   12    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1901    0    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  849    0   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  714    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   41    3   61    7 1153    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    4    0    0  259    4    0    1    1    1    0
     1    2    1]
 [   0    0    0    0    0    0    1   11  177    0    2    0    0    0
     1    1    0]
 [   0    0    0    0    1    0    0    1    0  420    8    8   10   47
     0    4   11]
 [   0    0    0    0    4    0    0    0    0    9  414   12   13   15
     3   13    9]
 [   0    0    0    0    0    1    0    1    0    5   14  451   12    5
     4    4   15]
 [   0    3    0    0    0    0    0    0    0    2    6   11  611    5
     0    2    0]
 [   0    2    0    0    2    0    0    0    0   47    8    5   12  365
     4   12   13]
 [   0    0    0    0    2    0    0    4    0    0   19  112    9    0
   252    6   19]
 [   0    0    0    0    1    0    0    0    0   11   56   25   28   10
     0  315   45]
 [   0    0    0    0    0    3    0    0    1    2   10   47    9   10
     1   22  403]]
------ TEST ACCURACY:  weights.41-0.53.hdf5  ------
0.611111111111
[[ 2  3  0  0  2  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 2  1  0  0  3  0  0  4  7  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 77  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 46  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 19 11  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 32  1  4  0 22  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0  0 10  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 14  0  1  4  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3 16  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  7  2  1  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 10  0  0  0  1  0  3  0]
 [ 0  0  0  0  0  0  0  1  0  0  2  8  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  8  4  2  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 22  0  0  0  0  4]]

>>>>>>>>>>>>>> 17 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/17/weights.49-0.53.hdf5
------ TRAIN ACCURACY:  weights.49-0.53.hdf5  ------
0.929317055909
[[ 146    2    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  189    0    0    0    0    0   11    0    0    0    0    0    0
     0    1    0]
 [   0    0 1626    0    6    0    2    0    0    0    0    0    0    0
     0    0    1]
 [   0    0    1 1900    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  871    0   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  727    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10   18   13    8 1225    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  274    7    0    0    0    0    0
     2    0    0]
 [   0    1    0    0    0    0    0    0  192    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    1  441    6    9    2   53
     1    1    1]
 [   0    0    0    0    1    0    1    2    1   12  435    7    8    9
     2   15    2]
 [   0    0    0    0    0    3    0    0    0    8   12  449    7    5
     9    1   11]
 [   0    0    0    0    0    0    0    3    0    0    7   12  612    2
     0    3    2]
 [   1    1    0    0    1    0    0    0    0   42    6    2    8  392
     2    3    6]
 [   0    2    0    0    2    0    0    6    2    0   12   69   11    2
   296    6    3]
 [   0    1    0    0    0    0    0    2    0    7   54   10   18   17
     0  333   53]
 [   0    0    0    0    0    1    0    1    0    2   26   42    6   20
     3   19  397]]
------ TEST ACCURACY:  weights.49-0.53.hdf5  ------
0.802997858672
[[  4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0  13   0   0   0   0   0   1   0   0   0   0   0   0   0   1   0]
 [  0   0 103   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  81   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  15   0  13   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  19   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  50   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0  13   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   6   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   5   0   0   3   2   0   2   0]
 [  0   0   0   0   0   0   0   0   0   0   5   1   0   0   1   0   9]
 [  0   0   0   0   0   0   0   0   0   0   3  17   0   1   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  17   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   4   0   0   2   5   0   9   0]
 [  0   0   0   0   0   0   0   0   0   0   0   6   0   0  13   1   3]
 [  0   0   0   0   0   0   0   0   0   0   7   0   3   0   2   4   2]
 [  0   0   0   0   0   0   0   0   0   0   4   0   0   0   4   2   7]]

>>>>>>>>>>>>>> 18 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/18/weights.41-0.54.hdf5
------ TRAIN ACCURACY:  weights.41-0.54.hdf5  ------
0.920738611619
[[ 136    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  199    0    0    1    0    0    6    0    0    0    0    0    0
     0    0    0]
 [   0    0 1736    0    1    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10 1904    0    0   15    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  868    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  729    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   25    3   11    6 1248    0    0    0    0    0    0    0
     0    0    0]
 [   0    5    1    0    2    0    0  269    4    0    0    2    0    0
     0    0    0]
 [   2    0    0    0    0    0    0    2  185    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  449   10    0    2   48
     0    4    2]
 [   0    1    0    0    2    0    0    2    0   18  422   12    1   13
     0   15    7]
 [   0    1    1    0    1    1    0    0    0    7   19  432    5   12
    11    7   12]
 [   0    0    0    0    0    0    0    3    0    5    9   17  597    6
     0    4    2]
 [   0    5    0    0    0    0    0    0    0   49    4    3    1  387
     1   11   10]
 [   2    0    0    0    3    0    0    6    1    5   14  110    5    0
   260    4   13]
 [   0    0    0    0    0    0    0    0    1   23   51   13   18    9
     2  329   57]
 [   0    0    1    0    0    0    0    0    0   10   11   35    3   15
     3   22  421]]
------ TEST ACCURACY:  weights.41-0.54.hdf5  ------
0.731034482759
[[ 6  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  7  0  0  0  0  1  0  0  0  0  0  0  0  1  0]
 [ 0  0 56  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  6  0  5  5  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  1  0 30  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 13  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 10  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  1  0  0  0 10  0  3  0]
 [ 0  0  0  0  0  0  0  0  0 14  3  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0 12  0  2  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0 12  3  0  3  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  7  1  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  7  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  2  1  7]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  0  0  0  5]]

>>>>>>>>>>>>>> 19 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/19/weights.38-0.51.hdf5
------ TRAIN ACCURACY:  weights.38-0.51.hdf5  ------
0.91012603216
[[ 142    4    0    0    0    0    0    0    0    0    0    0    1    0
     0    0    0]
 [   1  183    6    0    3    1    0    7    0    0    0    1    1    0
     1    0    0]
 [   0    0 1701    0    7    2   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1893    0    5   19    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    0  880    2   28    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    1    3   22 1260    0    0    0    0    0    0    0
     0    0    0]
 [   1    2    1    0    0    0    0  273    2    0    2    1    1    0
     4    2    1]
 [   1    1    0    0    0    0    1    6  179    0    1    0    0    0
     2    1    0]
 [   0    0    0    0    1    0    0    0    0  427   10    8    5   58
     0    9    3]
 [   0    1    1    0    1    4    0    0    0   17  413   11    9   17
     4   16    2]
 [   0    0    0    0    1    8    1    0    0   10   18  426   11    7
    12   10   13]
 [   0    0    1    0    0    0    1    1    0    4   11   11  607    5
     0    3    0]
 [   0    3    1    0    2    1    0    0    0   53    9    5   10  374
     1   14    1]
 [   0    1    0    0    2    8    0    1    1    5   17   91    8    1
   266    6   12]
 [   0    0    0    0    1    2    0    0    0   18   62   12   21   21
     4  313   50]
 [   0    0    1    0    0    4    0    0    0    8   18   29    2   26
     8   15  411]]
------ TEST ACCURACY:  weights.38-0.51.hdf5  ------
0.740601503759
[[ 3  3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  3  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 14  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0 30  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  4  0  0  0  0  0  1  1  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  1  4  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  2  2  0  0  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  3  0  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  1  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  9  1  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  0  0  6  0]
 [ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0 10  0]]

>>>>>>>>>>>>>> 20 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/20/weights.29-0.52.hdf5
------ TRAIN ACCURACY:  weights.29-0.52.hdf5  ------
0.8958443855
[[ 133    9    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   8  178    3    0    1    0    0   11    1    0    0    0    0    0
     0    0    1]
 [   0    1 1578    0    2    1    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6 1902    0    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    1   51    0  821    2   17    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  728    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   45    4   24    8 1193    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    2    0    1  272    9    0    0    1    1    0
     1    0    0]
 [   1    0    0    0    0    0    0   15  174    0    0    0    0    0
     1    1    0]
 [   0    2    0    0    0    0    0    0    1  450    3    2    6   39
     0    6    4]
 [   0    0    1    0    2    1    0    5    1   37  362   16   13   11
     4   28   20]
 [   0    0    1    0    2    0    1    5    0    6   11  404   16    7
    32    9   25]
 [   0    2    2    0    0    0    0    2    0    8    8   14  593    7
     0    2    5]
 [   1    4    0    0    2    0    0    0    0   93    2    2    2  332
     4   15   12]
 [   1    1    1    0    3    1    0    7    0    4   18   80    0    0
   277    9   23]
 [   0    0    0    0    1    0    0    1    0   23   45    9   16   13
     5  318   68]
 [   0    0    1    0    0    0    0    2    0   11   10   21    4   16
     6   37  417]]
------ TEST ACCURACY:  weights.29-0.52.hdf5  ------
0.733188720174
[[  8   2   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  9   2   1   0   0   0   0   1   0   0   0   0   0   0   0   0   0]
 [  0   0 147   0   0   0   9   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  71   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  25   4   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  18   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  11  31   0   4   3   0   0   0   0   0   0   0   0   0   1]
 [  0   0   0   0   0   0   0   8   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   8   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  11   0   0   0   5   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   9   0   0   0   1   0]
 [  0   0   0   0   0   0   0   0   0   0   0   2   0   0   1   2   2]
 [  0   0   0   0   0   0   0   0   0   0   0   0  18   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   6   0   0   0   9   0   0   0]
 [  0   0   0   0   0   0   0   1   0   0   0   1   0   0   5   2   0]
 [  0   0   0   0   0   0   0   0   0   0   7   2   0   0   1   1   3]
 [  0   0   0   0   0   0   0   0   0   0   4   3   0   0   0   0   2]]

>>>>>>>>>>>>>> 21 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/21/weights.43-0.52.hdf5
------ TRAIN ACCURACY:  weights.43-0.52.hdf5  ------
0.922112957967
[[ 142    3    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   1  188    3    0    1    0    0   10    0    0    1    0    0    0
     0    1    0]
 [   0    0 1727    0    5    0    3    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    0 1924    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  885    1   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  724    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    1    3   12 1253    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  277    3    0    0    2    0    0
     2    0    0]
 [   0    0    0    0    0    0    1   10  174    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    0    0    0    0  430   19    5   10   44
     0    1    7]
 [   0    0    0    0    1    0    0    1    0   11  445    6    3   10
     1   23    1]
 [   0    0    0    0    1    1    0    1    0    3   26  411   17   12
    14    9   14]
 [   0    1    0    0    0    0    0    2    0    2   15   11  604    3
     0    2    2]
 [   0    2    0    0    0    0    0    0    0   51   16    3   12  368
     4    7   10]
 [   0    0    0    0    2    0    0    5    1    3   19   83    7    1
   285    5   14]
 [   0    0    0    0    1    0    0    2    0    8   79   10   11   13
     3  332   42]
 [   0    0    0    0    0    0    0    2    0    1   12   38    2   18
     4   23  427]]
------ TEST ACCURACY:  weights.43-0.52.hdf5  ------
0.664285714286
[[ 5  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3 33  0  0 25  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  8  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 17  5  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  5  0  3  0 38  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  8  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  0  6  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  5  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0  0]
 [ 0  0  0  0  0  1  0  0  0  0  0  0 18  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  6  0  2  1]
 [ 0  1  0  0  0  0  0  0  0  0  0  8  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  2  0  6  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  1  0  1  0  4]]

>>>>>>>>>>>>>> 22 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/22/weights.34-0.53.hdf5
------ TRAIN ACCURACY:  weights.34-0.53.hdf5  ------
0.879684592894
[[ 132    2    0    0    0    0    0    0    2    0    0    0    0    0
     0    0    0]
 [  11  178    3    0    1    0    0    8    1    0    0    2    0    0
     0    1    0]
 [   0    0 1595    0    2    5   75    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1858    0    0   64    0    0    0    0    0    0    0
     0    0    0]
 [   1    0    9    0  748    3  114    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0    0    7 1261    0    0    0    0    0    0    0
     0    0    0]
 [   0    9    0    0    2    0    2  235   29    0    0    2    1    0
     0    0    0]
 [   0    1    0    0    0    0    0    2  180    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    2  445    6    5    2   42
     0    1    2]
 [   0    1    0    0    0    2    1    1    2   16  407   31    2   13
     0    5    9]
 [   0    0    1    0    1    4    1    1    0   10   18  423    3   10
    14    0   12]
 [   0    1    0    0    0    0    2    2    0    4    9   15  592   10
     0    3    0]
 [   0    0    0    0    0    4    0    0    0   78    8    5    3  350
     0   11    4]
 [   3    1    0    0    1    2    1    7    4    3   25  137    1    4
   217    4    7]
 [   0    0    0    0    1    5    5    1    2   18  101   34   24   16
     7  221   55]
 [   0    0    1    0    0    3    0    1    1   11   26   51    6   24
     1   17  370]]
------ TEST ACCURACY:  weights.34-0.53.hdf5  ------
0.615702479339
[[ 2  0  0  0  5  0  0  8  2  0  0  0  0  0  0  0  0]
 [ 2  6  0  0  1  1  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 56  0  5  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 18 26  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  2  0  9 36  0  0  0  0  3  0  0  0  0  0]
 [ 0  1  0  0  0  0  0 14  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0 10  3  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  6  0  0 11  8  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0 21  0  0  0  0]
 [ 3  4  0  0  0  0  0  1  0 12  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0  3  1 10]
 [ 0  0  0  6  0  0  0  0  0  0  9  0  2  0  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 10  3  0  0  0  9]]

>>>>>>>>>>>>>> 23 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/23/weights.28-0.53.hdf5
------ TRAIN ACCURACY:  weights.28-0.53.hdf5  ------
0.884141546527
[[ 122   15    0    0    3    0    3    4    0    0    0    0    0    0
     0    0    0]
 [   0  173    6    0    8    0    0   21    0    0    0    0    0    0
     0    1    0]
 [   0    0 1652    0   55    0   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1887    0    1   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  868    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  718    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   23    4   88   14 1150    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    4    0    0  268    2    0    1    2    0    0
     0    2    0]
 [   0    1    0    0    0    0    1   20  166    0    3    0    0    0
     0    3    0]
 [   0    2    0    0    0    0    0    0    0  397   30   12   19   31
     0   10    6]
 [   0    0    1    0    3    0    0    0    0    6  414   11   33    6
     0   27    1]
 [   0    0    2    0    1    5    0    3    0    3   22  419   15    6
     7   13   21]
 [   0    0    0    0    1    0    0    3    0    0    1    9  625    2
     0    5    0]
 [   0    3    0    0    4    0    0    0    0   56   21    4   28  324
     0   25    4]
 [   0    1    0    0    5    1    0   10    0    0   30   92   14    0
   247   11   14]
 [   0    0    0    0    1    0    0    0    0   10   71    9   50    7
     4  301   45]
 [   0    0    1    0    0    1    0    2    0    5   15   38   22   14
     3   31  388]]
------ TEST ACCURACY:  weights.28-0.53.hdf5  ------
0.739263803681
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 12  0  0  0  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 74  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0 24  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  8  0  1  8 28  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 15  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  0  0  0  5  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  0  0  0  6]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  8  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0 10  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  2  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  5  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  5  0  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  4  0  0  2  4]]

>>>>>>>>>>>>>> 24 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/24/weights.27-0.55.hdf5
------ TRAIN ACCURACY:  weights.27-0.55.hdf5  ------
0.899551971326
[[ 112   16    0    0    0    0    0    3    0    0    0    0    1    0
     0    0    0]
 [   0  177    0    0    1    0    0   16    0    0    0    0    1    0
     0    2    0]
 [   0    0 1545    0   11    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12 1869    0    0   35    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    0  825    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  717    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   52    0   24    7 1185    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    1    0    0  253   16    0    0    3    1    0
     1    1    0]
 [   0    3    0    0    0    0    0    9  177    0    0    1    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    2  384    5    9    9   87
     0    2    7]
 [   0    0    1    0    1    0    0    2    0   12  403   23    7   21
     0   21    5]
 [   0    0    0    0    1    0    0    5    0    2   23  428   11    9
    15    4   14]
 [   0    1    0    0    0    0    0    2    0    5    1   19  600    8
     0    2    2]
 [   1    4    0    0    0    0    0    0    0   33    3    3    6  397
     3   13    6]
 [   0    1    0    0    3    0    0    3    5    2   17   83    5    2
   265    5   18]
 [   0    0    0    0    1    0    0    0    0   13   46   15   11   24
     7  302   75]
 [   0    0    1    0    0    1    0    1    0    3   24   42    2   26
     5   12  400]]
------ TEST ACCURACY:  weights.27-0.55.hdf5  ------
0.705400981997
[[  3   8   0   0   0   0   0   6   1   0   0   2   0   0   0   0   1]
 [  0   7   0   0   0   0   0   3   0   0   0   1   1   0   0   7   0]
 [  0   0 174   0   5   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  69   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  60   3   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  27   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   9  13   2   0  32   0   0   0   0   0   0   0   0   0   0]
 [  1   3   0   0   0   0   0   9   0   0   0   0   0   1   0   4   0]
 [  0   0   0   0   0   0   0   5   3   0   0   0   0   2   0   0   0]
 [  0   0   0   0   0   0   0   2   0  12   0   0   0   9   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   4   0   2   0   0   9   0]
 [  0   0   0   0   0   0   0   0   0   3   0   5   2   4   0   0   0]
 [  0   0   0   0   0   0   0   0   0   1   0   0  20   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  12   0   0   0   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   4  17   4   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   5   2   1   7   0   0   3   1]
 [  0   0   0   0   0   0   0   0   0   0   3   4   2   0   0   8   0]]

>>>>>>>>>>>>>> 25 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/25/weights.36-0.51.hdf5
------ TRAIN ACCURACY:  weights.36-0.51.hdf5  ------
0.911050501496
[[ 147    3    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   2  198    3    0    1    0    0    7    0    0    0    0    0    0
     0    1    0]
 [   0    0 1676    0    0    0    9    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1905    0    0   10    0    0    0    0    0    0    0
     0    0    0]
 [   0    2   23    0  804    1   65    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   16    2    0    5 1249    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    2  273   10    0    0    0    0    0
     2    0    0]
 [   0    0    0    0    0    0    1    6  184    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    1    0    0    1    0  424    0    3    3   79
     0    0    1]
 [   0    0    0    0    3    1    1    2    1   19  389   12    6   21
     9   27    1]
 [   0    0    1    0    0    4    1    2    0    8   14  418    7   18
    34    3    2]
 [   0    2    2    0    0    0    1    1    0    8    6   16  566   19
     2    9    1]
 [   1    6    0    0    1    1    0    0    0   60    1    2    1  377
     3    4    6]
 [   1    1    1    0    0    0    0   13    2    5    9   62    0    0
   295   11   19]
 [   0    0    0    6    1    0    0    2    1   13   39    2   11   18
     5  344   43]
 [   0    0    1    0    0    1    0    0    0    8   11   23    1   33
    12   36  387]]
------ TEST ACCURACY:  weights.36-0.51.hdf5  ------
0.720987654321
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0]
 [ 0  1 41  5  1  4  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 24  0  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 21  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 52  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  4  1  0  0  0  0  2  0  1  0]
 [ 0  0  0  0  0  0  0  2  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  4  3  0  0  7  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  1  4  0  1  7  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  6  0  2  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 28  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  1  0 19  0  0  0]
 [ 0  0  2  0  0  0  0  0  0  0  7  6  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7 11  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  8  0  0  0  0 13]]

>>>>>>>>>>>>>> 26 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/26/weights.31-0.50.hdf5
------ TRAIN ACCURACY:  weights.31-0.50.hdf5  ------
0.906165282029
[[ 148    4    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  199    0    0    3    0    0    8    0    0    0    0    0    0
     0    0    0]
 [   0    0 1644    0   49    0   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1911    0    0   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  868    0   19    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    4   15    8 1246    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    0    0    0    0    0  272   17    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    4  195    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    3  423    2    0    6   75
     0    1    0]
 [   0    3    0    0    4    0    0    9    7   28  357    2    0   14
     6   50   10]
 [   0    2    1    0    1    2    1   10    4   13   20  351    4   10
    47   14   27]
 [   0    0    0    0    0    0    0    3    0   11   12   17  569   10
     0   12    2]
 [   2    3    0    0    1    0    0    0    3   51    2    0    1  389
     5   14    6]
 [   0    6    0    0    3    0    0   13    7    0   14   34    1    1
   314    8   20]
 [   0    5    0    6    1    0    0    5    1   18   35    6    6   22
     4  344   41]
 [   0    0    0    0    2    1    0    3    0    7   19   17    0   28
     6   26  409]]
------ TEST ACCURACY:  weights.31-0.50.hdf5  ------
0.758928571429
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0 28  0  1  0  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 48  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 15  0  0  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  1  3 12  0  0  2  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  7  0  0  7  0  1]
 [ 0  0  0  0  0  0  0  3  0  0  0  0 10  0  0  9  3]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0 11  0  0  0  2  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  1  0  1 16]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  6  1  9]]

>>>>>>>>>>>>>> 27 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/27/weights.50-0.49.hdf5
------ TRAIN ACCURACY:  weights.50-0.49.hdf5  ------
0.924748138414
[[ 140   13    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    1    0    0    3    0    0    0    0    0    0
     0    0    1]
 [   0    0 1699    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1914    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    2   23    0  853    0   18    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  715    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   35    5    4    2 1233    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    0    0    1    0    0  269    6    0    1    1    0    0
     7    0    0]
 [   0    1    0    0    0    0    0    6  191    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    1    0    0    1    0  438    3    3    6   56
     3    0    0]
 [   0    0    0    0    3    0    0    1    0   15  431   15    3   10
     3    5   11]
 [   0    0    0    0    0    1    1    0    0    4   13  421    9   18
    31    1    5]
 [   0    2    1    0    0    0    0    0    0    8   21   20  574    9
     0    3    2]
 [   0    3    0    0    1    0    0    0    0   41    8    1    2  403
     3    1    3]
 [   0    1    0    0    1    1    0    0    1    2    8   62    5    1
   340    0    1]
 [   0    0    0    0    1    0    0    0    0   17   47   16   16   22
     7  323   48]
 [   0    0    1    0    0    1    0    0    0    9   15   47    2   20
    10   11  402]]
------ TEST ACCURACY:  weights.50-0.49.hdf5  ------
0.780898876404
[[ 0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0 39  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  2 26  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  7  2  0 33  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  5  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  1  0  1  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  4 13  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  7  0  5  1]
 [ 0  0  0  0  0  0  0  0  0  2  1  1  0  2  1  4]
 [ 0  0  0  0  0  0  0  0  0 14  0  0  1  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  0  2  4  5]]

>>>>>>>>>>>>>> 28 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/28/weights.38-0.49.hdf5
------ TRAIN ACCURACY:  weights.38-0.49.hdf5  ------
0.900654735923
[[ 140   10    2    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  193    5    0    5    0    0    9    0    0    0    0    0    0
     0    2    0]
 [   0    0 1694    0    5    1    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1903    0    0   19    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    0  873    0   10    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    3  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   71    2   40    7 1163    0    0    0    0    0    0    0
     0    0    0]
 [   1    1    1    0    2    0    0  278    2    0    1    0    1    0
     0    0    1]
 [   0    0    1    0    0    0    0   12  184    0    1    0    0    0
     1    1    0]
 [   0    0    0    0    2    0    0    0    0  408   11    2    7   73
     0    4    5]
 [   0    0    1    0    5    0    0    0    0   15  441    6    6    9
     0    5    7]
 [   0    0    0    0    2    1    0    0    0   18   44  390    5   10
    16    0   23]
 [   0    0    0    0    0    0    0    3    0    7   13   10  592    8
     0    1    4]
 [   1    2    1    0    1    0    0    0    0   52   12    1    6  382
     1    5   10]
 [   0    2    2    0    1    3    0    8    1    3   33   62   10    0
   270    4   27]
 [   0    0    0    0    7    0    0    1    0   16   87   12   22   12
     1  293   46]
 [   0    0    0    0    0    1    0    0    0    3   36   25   14   18
     5   22  394]]
------ TEST ACCURACY:  weights.38-0.49.hdf5  ------
0.854430379747
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 30  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 56  1  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 30  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 24  0  0  0  0  0  0  0  0  0  0]
 [ 0 11  0  0  0 30  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  7  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 17  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 16  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1 13  0  0  1  0  2]
 [ 0  0  0  0  0  0  0  1  3  0 19  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  2  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0 16]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0  0 13]]

>>>>>>>>>>>>>> 29 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/29/weights.39-0.51.hdf5
------ TRAIN ACCURACY:  weights.39-0.51.hdf5  ------
0.910891968728
[[ 151    0    0    0    0    0    0    0    0    0    0    0    1    0
     0    0    0]
 [   2  187    0    0    1    0    0   14    1    0    0    0    0    0
     1    0    0]
 [   0    0 1583    0   30    1   18    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1911    0    2    4    0    0    0    0    0    0    0
     0    0    0]
 [   1    0    2    0  852   10   25    0    0    0    1    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    3    4   38 1237    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  277    5    0    1    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    7  181    0    3    0    0    0
     0    0    0]
 [   0    0    0    0    2    0    0    0    0  435    5    2    4   44
     0    6    2]
 [   0    0    0    0    0    0    0    1    0   16  421    1   10   10
     0   10   14]
 [   0    0    0    0    1    3    0    2    0   12   51  368   10    7
    27    7   16]
 [   0    0    0    0    0    0    0    3    1   10   12    4  588    8
     0    0    4]
 [   2    3    0    0    2    4    0    0    0   64    8    1    2  356
     0    6   10]
 [   1    1    0    0    2    2    0    5    2    0   38   40    5    0
   272    7   39]
 [   0    0    0    6    0    0    0    2    0   13   60    2   28    6
     5  308   63]
 [   0    0    0    0    0    0    0    1    0    7   18   21    7   11
     2   23  412]]
------ TEST ACCURACY:  weights.39-0.51.hdf5  ------
0.666019417476
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  6  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0 86  0  2  0 18  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  6  0 15  0  9  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  6  2  0  0 31  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 10  0  0  3  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 29  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2 25  0  1  0  0  0  0]
 [ 0  0  0  0  1  3  0  0  0  1  2  0  7  0  0  1  7]
 [ 0  0  0  0  0  0  0  0  0  0  5  5 20  0  0  0  1]
 [ 0  0  0  0  1  0  0  0  0 15  5  0  1  2  1  0  1]
 [ 0  0  0  0  0  0  0  0  0  2  2 13  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  1 15  0  3  0  0  0  1]
 [ 0  0  0  0  1  2  0  0  0  2  0  0  1  5  0 10 11]]

>>>>>>>>>>>>>> 30 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_spca_conv1d_10/30/weights.46-0.52.hdf5
------ TRAIN ACCURACY:  weights.46-0.52.hdf5  ------
0.917539382205
[[ 148    4    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   1  203    0    0    0    0    0    8    0    0    0    0    0    0
     0    0    0]
 [   0    1 1675    0   10    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9 1907    0    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    2    0  888    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  718    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    2   36    0   57    8 1179    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  281   10    0    0    0    0    0
     0    0    0]
 [   1    0    0    0    0    0    0    3  193    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    3  418    4    0    3   64
     0    0    4]
 [   0    1    0    0    0    0    0    9    3    4  418    3    1   10
     3   24   11]
 [   0    4    0    0    2    0    0    7    1    6   18  414    8    7
    16   10    7]
 [   0    0    0    0    1    0    0    4    0    6    8    8  589   10
     0    8    0]
 [   1    4    0    0    1    0    0    2    1   51    6    2    2  383
     1    8    3]
 [   0    2    0    0    3    0    0   19    5    0   17   70    2    0
   281    5   10]
 [   0    0    0    0    1    0    0    4    2   22   63    2    4    2
     1  352   42]
 [   0    0    1    0    0    0    0   11    2    2   20   38    1    5
     4   47  379]]
------ TEST ACCURACY:  weights.46-0.52.hdf5  ------
0.752450980392
[[ 2  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 15  0 27  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  2  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 22  0  1  0  8  0  0  0]
 [ 0  0  0  0  0  0  2  0  7 10  2  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1 16  0  0  5  4  0]
 [ 0  0  0  0  0  0  0  0  0  3  2 22  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  1  0  0 16  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0 17  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  2  0  4  1  2  8]
 [ 0  0  0  0  0  0  0  0  2  0  6  0 13  0  0  3]]
[0.671875, 0.7307032590051458, 0.819078947368421, 0.49517684887459806, 0.761744966442953, 0.8228155339805825, 0.7606060606060606, 0.818639798488665, 0.6642512077294686, 0.7156549520766773, 0.7321428571428571, 0.728, 0.7347480106100795, 0.8387096774193549, 0.7822784810126582, 0.6111111111111112, 0.8029978586723768, 0.7310344827586207, 0.7406015037593985, 0.7331887201735358, 0.6642857142857143, 0.6157024793388429, 0.7392638036809815, 0.7054009819967266, 0.7209876543209877, 0.7589285714285714, 0.7808988764044944, 0.8544303797468354, 0.6660194174757281, 0.7524509803921569]
0.731790937877
0.0741925397002

Process finished with exit code 0

'''
