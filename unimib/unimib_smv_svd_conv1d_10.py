import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import numpy as np
import cPickle as pickle
from keras.models import Model, load_model
from keras.initializers import Constant, TruncatedNormal
from keras.layers import Input, Dense, Conv1D, Flatten, Dropout, Activation, BatchNormalization
from keras.layers.merge import concatenate
from keras.optimizers import Adam
from keras.callbacks import ModelCheckpoint
import keras.backend as K
from keras import losses
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix

# Load SVD data + Signal Magnitude Vector

X_svd = pickle.load(open("data/X_unimib_svd.p", "rb"))
X_smv = pickle.load(open("data/X_unimib_smv.p", "rb"))
X = np.concatenate((X_svd, X_smv), axis=1)

y = pickle.load(open("data/y_unimib_smv.p", "rb"))

n_classes = 17


# Below builds 1D CNN.

for i in range(30):
    test = y.loc[y[1] == i+1]
    # print y_sub
    test_index = test.index.values
    # print len(test_index)

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index], y_values[test_index]
    y_train = np.eye(n_classes)[y_train - 1]
    print X_train.shape # (11188, 302)

    # input layer
    input_signal = Input(shape=(302, 1))
    print K.int_shape(input_signal)

    # define initial parameters
    b_init = Constant(value=0.0)
    k_init = TruncatedNormal(mean=0.0, stddev=0.01, seed=2018)

    # first feature extractor
    conv11 = Conv1D(16, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn11 = BatchNormalization()(conv11)
    actv11 = Activation('relu')(bn11)
    conv12 = Conv1D(32, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv11)
    bn12 = BatchNormalization()(conv12)
    actv12 = Activation('relu')(bn12)
    flat1 = Flatten()(actv12)

    # second feature extractor
    conv21 = Conv1D(16, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn21 = BatchNormalization()(conv21)
    actv21 = Activation('relu')(bn21)
    conv22 = Conv1D(32, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv21)
    bn22 = BatchNormalization()(conv22)
    actv22 = Activation('relu')(bn22)
    flat2 = Flatten()(actv22)

    # third feature extractor
    conv31 = Conv1D(16, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn31 = BatchNormalization()(conv31)
    actv31 = Activation('relu')(bn31)
    conv32 = Conv1D(32, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv31)
    bn32 = BatchNormalization()(conv32)
    actv32 = Activation('relu')(bn32)
    flat3 = Flatten()(actv32)

    # merge feature extractors
    merge = concatenate([flat1, flat2, flat3])

    # dropout & fully-connected layer
    do = Dropout(0.9, seed=2018)(merge)
    output = Dense(n_classes, activation='softmax', bias_initializer=b_init, kernel_initializer=k_init)(do)

    # result
    model = Model(inputs=input_signal, outputs=output)

    # summarize layers
    print(model.summary())

    new_dir = 'model/unimib_smv_svd_conv1d_10/' + str(i+1) + '/'
    if not os.path.exists(new_dir):
        os.makedirs(new_dir)

    fpath = new_dir + 'weights.{epoch:02d}-{val_acc:.2f}.hdf5'
    cp_cb = ModelCheckpoint(fpath, monitor='val_acc', verbose=1, save_best_only=True, mode='auto', period=1)

    adam = Adam(lr=0.001)
    model.compile(loss=losses.categorical_crossentropy, optimizer=adam, metrics=['accuracy'])
    model.fit(np.expand_dims(X_train, axis=2), y_train, batch_size=64, epochs=50, verbose=2, validation_split=0.10,
              callbacks=[cp_cb], shuffle=True)

    del model
    K.clear_session()


# Below calculates average test data accuracy (LOSO CV).

acc = []

for i in range(30):
    test = y.loc[y[1] == i+1]
    test_index = test.index.values

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index] - 1, y_values[test_index] - 1

    print "\n>>>>>>>>>>>>>>", str(i+1), "-fold <<<<<<<<<<<<<<<<"
    path_str = 'model/unimib_smv_svd_conv1d_10/' + str(i+1) + '/'
    for path, dirs, files in os.walk(path_str):
        dirs.sort()
        files.sort()
        top_acc = []
        top_acc.append(files[-1])
        files = top_acc
        for file in files:
            print "========================================"
            print os.path.join(path, file)
            model = load_model(os.path.join(path, file))
            pred = model.predict(np.expand_dims(X_train, axis=2), batch_size=32)
            print "------ TRAIN ACCURACY: ", file, " ------"
            print accuracy_score(y_train, np.argmax(pred, axis=1))
            print confusion_matrix(y_train, np.argmax(pred, axis=1))
            pred = model.predict(np.expand_dims(X_test, axis=2), batch_size=32)
            print "------ TEST ACCURACY: ", file, " ------"
            print accuracy_score(y_test, np.argmax(pred, axis=1))
            print confusion_matrix(y_test, np.argmax(pred, axis=1))

            del model
            K.clear_session()

    acc.append(accuracy_score(y_test, np.argmax(pred, axis=1)))

print acc
print np.mean(acc)
print np.std(acc)

'''
-----
[0.6979166666666666, 0.7272727272727273, 0.8782894736842105, 0.48231511254019294, 0.7785234899328859, 0.883495145631068, 0.8363636363636363, 0.8488664987405542, 0.6908212560386473, 0.7348242811501597, 0.7219387755102041, 0.802, 0.8063660477453581, 0.7553763440860215, 0.8126582278481013, 0.7735042735042735, 0.7708779443254818, 0.7448275862068966, 0.8270676691729323, 0.7874186550976139, 0.6678571428571428, 0.6880165289256198, 0.7852760736196319, 0.7659574468085106, 0.7530864197530864, 0.7767857142857143, 0.7556179775280899, 0.8259493670886076, 0.5902912621359223, 0.7254901960784313]
0.756501731353
0.080286106124
-----

/usr/bin/python2.7 /mnt/0cdd1a7e-3686-4cf7-9055-145eb5fe70f3/hcilab/OSS/electronicsletters2018/unimib/unimib_smv_svd_conv1d_10.py
/home/hcilab/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.

>>>>>>>>>>>>>> 1 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/1/weights.49-0.50.hdf5
------ TRAIN ACCURACY:  weights.49-0.50.hdf5  ------
0.937560375867
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  203    0    0    0    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1679    0    2    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1910    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    0  859    0   19    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  718    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    1    0    7 1261    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  285    3    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  197    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  478    6    0    2   27
     0    0    3]
 [   0    0    0    0    0    0    0    0    0   18  416   17   16    3
     0    5   19]
 [   0    0    1    0    0    2    1    2    1    8   19  430   18    9
     7    4    9]
 [   0    4    0    0    0    0    0    1    0    0    4   11  598    5
     0   10    9]
 [   0    0    0    0    0    0    0    0    0   44    0    4    5  414
     0    1    2]
 [   0    0    0    0    5    0    1    5    1    0   18   70   11    0
   297    1   10]
 [   0    0    0    0    0    0    1    0    1   23   48    8    9    2
     0  348   53]
 [   0    0    0    0    0    0    0    2    0   11   10   23   12    7
     2   13  436]]
------ TEST ACCURACY:  weights.49-0.50.hdf5  ------
0.697916666667
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0 30  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 28  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 20  0  0  0 22  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  5  0  0  0  0  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  7  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  1  2 10  0  0  0  1  2]
 [ 0  0  0  0  0  2  0  0  0  0  0  1  0  0  0  0 12]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  4  2  3  0  0  3  1]
 [ 0  0  0  0  1  0  0  0  0  0  5  4  2  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  1  0 11  2  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  5  0  0  0  0 11]]

>>>>>>>>>>>>>> 2 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/2/weights.48-0.48.hdf5
------ TRAIN ACCURACY:  weights.48-0.48.hdf5  ------
0.935734715767
[[ 145    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1591    0    4    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1910    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  852    0   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    7 1268    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  282    3    0    0    0    0    0
     1    0    1]
 [   0    0    0    0    0    0    1    1  194    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  466    8    3    3   19
     0    1    6]
 [   0    0    0    0    0    0    0    1    0   20  399   15   12    3
    13    5   20]
 [   0    0    1    0    0    2    1    4    0   18   10  409   16    2
    21    3   15]
 [   0    6    0    0    0    0    0    1    0    1    6    4  584    4
     2    2   11]
 [   0    0    0    0    0    0    0    0    0   58    5    7    2  369
     0    6    5]
 [   0    0    2    0    3    0    2    2    0    0   11   47   12    1
   322    0    7]
 [   0    0    0    0    0    0    0    0    0   18   41    9   15    4
     7  343   49]
 [   0    0    0    0    0    0    0    0    0    6    6   23   19    9
    10   20  414]]
------ TEST ACCURACY:  weights.48-0.48.hdf5  ------
0.727272727273
[[  7   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  2   8   0   0   0   0   0   0   1   0   0   0   0   0   0   0   1]
 [  0   0 127   0  16   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  37   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  29   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   5  44   0   0   0   0   0   0   0   0   0   0]
 [  0   0   1   0   1   0   0   7   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  20   1   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0  13   0   7   0   2   0   1]
 [  0   0   0   0   2   2   0   3   0   0   0   8   9   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   2   0  35   0   1   0   2]
 [  0   0   0   0   1   0   0   0   0  11   2   0   1   8   0   9   0]
 [  4   0   0   0   0   2   0   0   0   0   0   0  13   1   2   2   1]
 [  0   1   0   0   0   2   1   3   0   0   6   0   9   0   1   0   4]
 [  0   0   0   0   0   0   0   0   0   0   0   1  24   0   0   0   2]]

>>>>>>>>>>>>>> 3 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/3/weights.48-0.50.hdf5
------ TRAIN ACCURACY:  weights.48-0.50.hdf5  ------
0.934769338101
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  213    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1712    0    4    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1910    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    0  851    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    9    0    7 1262    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  277    5    0    1    0    0    0
     1    0    0]
 [   0    0    1    0    0    0    1    0  195    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  467    0    1    1   42
     0    2    0]
 [   0    0    1    0    0    0    0    0    0   22  403   22   11   10
     4   13   13]
 [   0    0    0    2    1    1    0    0    0    5   12  450   19    7
     9    5    5]
 [   0    2    0    0    0    0    0    2    0    0    4   10  607    7
     4    7    4]
 [   0    0    0    0    0    0    0    0    0   42    0    3    5  414
     1    5    1]
 [   0    0    0    0    4    0    3    4    0    0   17   64   11    1
   316    6    1]
 [   0    0    0    0    0    0    2    1    0   24   39    9    8    6
     5  387   22]
 [   0    0    0    0    0    0    0    0    0   11   13   37   15   22
     8   28  393]]
------ TEST ACCURACY:  weights.48-0.50.hdf5  ------
0.878289473684
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 73  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 39  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  0  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  8  1  0  0  1  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  6  0  0  3  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  6  0  6  0]
 [ 0  2  0  0  0  0  0  0  0  0  0  0  0  2  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  1  1  0  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0  0  3  0]]

>>>>>>>>>>>>>> 4 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/4/weights.39-0.50.hdf5
------ TRAIN ACCURACY:  weights.39-0.50.hdf5  ------
0.931064572426
[[ 152    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1717    0    4    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1927    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   35    0  833    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    0    0    6 1279    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  284    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    3  187    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  467    4    0    2   42
     0    3    2]
 [   0    0    0    0    0    0    0    1    0   18  412    8   15    6
    10   14    8]
 [   0    0    0    0    0    2    0    2    0   22   20  403   18    4
    13    9   10]
 [   0    5    0    0    0    0    0    2    0    0    5    2  597    8
     4   15    5]
 [   0    0    0    0    0    0    0    0    0   47    0    0    5  408
     1    5    1]
 [   0    0    4    0    0    0    2    4    0    0   17   43   11    3
   322    9    6]
 [   0    0    0    0    0    0    0    0    1   23   48    0   15    2
    14  362   32]
 [   0    0    0    0    0    0    0    0    0    6   32   16   16   16
    12   24  390]]
------ TEST ACCURACY:  weights.39-0.50.hdf5  ------
0.48231511254
[[ 2  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  6  0  0  0  7  3  0  0  0  0  0  0  0  0  0]
 [ 0  0 54  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  5  0 11  0  5  5  0  0  0  0  0  0  3  0  0]
 [ 0  0  0  0 11  0  2  0  1  3  1  9  0  0  0  0]
 [ 0  0  0  0  0 15 12  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  0  0  6  1  0  0  0  0  0  0  1  0]
 [ 0  1  0  0  0  0  6  1  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  7  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  1  0  0  0  0 13  0]
 [ 0  0  0  0  0  0  0  0  0  1  9  6  0  0  1  6]
 [ 0  0  0  0  0  0  0  0  0  0  0 11  0  1  1  5]
 [ 0  0  0  0  0  0  0  0  2  3  0  4  3  0  5  0]
 [ 0  0  0  0  0  0  0  0  0  6  4  2  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  4  1  0  4  3  0  3  1]
 [ 0  0  0  0  1  0  0  0  1  2  1  4  3  0  1  9]]

>>>>>>>>>>>>>> 5 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/5/weights.49-0.49.hdf5
------ TRAIN ACCURACY:  weights.49-0.49.hdf5  ------
0.939684476597
[[ 146    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1711    0    5    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1916    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  885    0   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0    3    6 1277    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  287    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  198    0    0    0    0    0
     0    0    0]
 [   2    0    0    0    0    0    0    0    0  488    7    0    0   12
     0    3    1]
 [   0    1    0    0    0    1    0    3    1   22  416   11   10    3
     5   10   19]
 [   0    0    0    0    1    2    0    5    3   18   17  409   12    6
    20    2   10]
 [   0    6    0    0    0    0    0    4    0    1    6    0  597    9
     3   10   10]
 [   1    3    0    0    0    0    0    0    0   80    0    2    3  376
     1    7    1]
 [   0    0    1    0    4    0    3   11    2    0    5   41    9    1
   335    3   10]
 [   0    0    0    0    1    0    2    2    1   23   40    3    7    1
     2  381   35]
 [   0    0    0    0    0    0    0   12    1    9    6   13   12   12
     7   15  429]]
------ TEST ACCURACY:  weights.49-0.49.hdf5  ------
0.778523489933
[[ 6  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 66  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 19  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  3  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  0  6  0  2  0]
 [ 0  0  0  0  0  0  0  1  0  1  1  0  0  0  0  4  2]
 [ 0  0  0  0  0  0  0  1  0  0  0  7  5  0  5  1  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 13  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  0  8  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  2  0 10  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 16  2]]

>>>>>>>>>>>>>> 6 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/6/weights.45-0.49.hdf5
------ TRAIN ACCURACY:  weights.45-0.49.hdf5  ------
0.932828594066
[[ 151    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  208    0    0    0    0    0    4    0    0    0    0    0    0
     0    0    0]
 [   0    0 1678    0    8    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1924    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  866    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    5   15    6 1240    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  279    0    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    5  189    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  444   12    2    7   33
     0    8    2]
 [   0    0    0    0    0    0    0    5    0    9  418   21   13    4
     5    3   18]
 [   0    0    1    0    0    1    0    4    0   12   21  412   16    7
    17    7    9]
 [   1    1    0    0    0    0    0    5    0    0    3    3  592    8
     3    9   13]
 [   0    0    0    0    0    0    0    0    0   57    1    4    1  388
     0   10    3]
 [   0    0    2    0    3    0    2    9    0    0    5   53    7    3
   327    2    3]
 [   0    0    0    0    0    0    1    1    0   16   55    5   16    2
     5  346   46]
 [   0    0    0    0    0    0    0    5    0    4   14   28   15   15
     5   12  418]]
------ TEST ACCURACY:  weights.45-0.49.hdf5  ------
0.883495145631
[[ 2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 42  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 29  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0 49  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0 13  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 15  1  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 11  3  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  3  3 11  0  1  1  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0 22  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  0 13  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  0 11  2  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 12  8]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  2 15]]

>>>>>>>>>>>>>> 7 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/7/weights.48-0.49.hdf5
------ TRAIN ACCURACY:  weights.48-0.49.hdf5  ------
0.94021501617
[[ 152    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1685    0    3    0    0    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    0 1933    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  858    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  725    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0    0    5 1283    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  288    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  191    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  484    5    0    0   22
     0    3    0]
 [   0    0    0    0    0    0    0    2    0   23  412    5   15    4
     4    9   22]
 [   0    0    1    0    0    1    0    6    1   24   24  404   12    7
    17    5    6]
 [   0    2    0    0    0    0    0    4    0    1    4    4  604    9
     3    5    7]
 [   0    1    0    0    0    0    0    0    0   50    0    3    4  396
     0    7    1]
 [   0    0    0    0    4    0    2    8    0    1   14   46   11    4
   318    5   13]
 [   0    0    0    0    0    0    0    7    1   22   36    2   13    3
     5  378   33]
 [   0    0    0    0    0    0    0   11    0   17    7    8   10   10
     3   20  436]]
------ TEST ACCURACY:  weights.48-0.49.hdf5  ------
0.836363636364
[[ 4  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0 47  0  0  0  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  7  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 13  0  1  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  2  0  2  5  2]
 [ 0  0  0  0  0  0  0  0  0  0  0 18  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0 14  0  2  0]
 [ 0  0  0  0  0  0  1  0  0  0  0  0  0  6  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  3 10]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  6  6]]

>>>>>>>>>>>>>> 8 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/8/weights.50-0.49.hdf5
------ TRAIN ACCURACY:  weights.50-0.49.hdf5  ------
0.934675575875
[[ 150    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  215    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1666    0    3    1    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1930    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  871    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3   17    1    7 1249    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  282    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    2  184    0    0    0    0    1
     0    0    0]
 [   1    1    0    0    0    0    0    0    0  471    0    2    1   23
     0    1    3]
 [   0    0    0    1    0    0    0    1    0   19  392   30   13    7
     5    3   23]
 [   0    0    0    1    0    1    1    4    1   21   18  430    8    8
    11    0    5]
 [   0    4    0    0    0    0    0    2    0    2    2    7  596    5
     3   10    5]
 [   0    0    0    0    0    0    0    0    0   61    0    4    2  394
     0    3    1]
 [   0    0    0    0    4    1    3    6    0    0    6   75    5    0
   315    1    4]
 [   0    0    0    0    0    0    1    2    0   28   31   16    9    3
     6  363   44]
 [   0    0    0    0    0    0    1    9    0    8    8   40   14   14
     6   11  402]]
------ TEST ACCURACY:  weights.50-0.49.hdf5  ------
0.848866498741
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 52  0  3  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  4  1  0  0 42  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  0  0  0  0  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  4  0  4  4  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 22  0  0  0  1  0  1  2]
 [ 0  0  0  0  0  0  0  1  0  0 14  0  1  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0 24  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  0 14  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  5  0  3  3  1  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  2  4  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  1  2  4 11]]

>>>>>>>>>>>>>> 9 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/9/weights.42-0.48.hdf5
------ TRAIN ACCURACY:  weights.42-0.48.hdf5  ------
0.933961433477
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  208    0    0    0    0    0    4    1    0    0    0    0    0
     0    0    0]
 [   0    0 1681    0    7    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1921    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  885    0   12    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14    1    7    7 1248    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  286    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    1  188    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  474    1    2    1   24
     1    4    0]
 [   0    0    0    0    2    0    0    1    0   16  396   22   12    5
     6    9   13]
 [   0    0    0    0    1    2    0    3    0   18   16  425   14    3
     8    5   11]
 [   0    2    0    0    0    0    0    5    0    0    1    3  585   11
     4   11    2]
 [   1    1    0    0    0    0    0    0    0   56    4    4    4  396
     1    5    1]
 [   0    0    0    0    7    0    0   10    0    0   11   62   12    3
   311    2    3]
 [   0    0    0    0    0    0    0    1    1   18   40   10   20    4
     1  353   34]
 [   0    0    0    0    0    0    0    7    1    2   10   53   17   13
     4   21  377]]
------ TEST ACCURACY:  weights.42-0.48.hdf5  ------
0.690821256039
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0 50  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 60  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 14  0  4  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  3  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  9  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  2  2  0 10  0  2  1]
 [ 0  0  0  0  0  0  0  2  1  0 12  5  0  0  0  7  2]
 [ 0  0  0  0  0  0  0  0  1  0  4  4  0  0 11  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0  0 36  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  4  0  4  0  1  0]
 [ 0  0  0  0  2  0  0  0  2  0  1  3  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  1  0  8  3  4  6  4]
 [ 0  0  0  0  1  0  0  0  0  1  1  5  2  0  0 13  6]]

>>>>>>>>>>>>>> 10 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/10/weights.29-0.47.hdf5
------ TRAIN ACCURACY:  weights.29-0.47.hdf5  ------
0.889945889335
[[ 150    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  211    0    0    0    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1703    0    3    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1931    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   84    0  801    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0   12    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0  180  115    0    0  999    0    0    0    0    0    0    0
     0    1    0]
 [   0    2    1    0    0    0    0  284    3    0    0    1    0    0
     2    1    0]
 [   0    1    2    0    0    0    0    2  181    0    0    0    0    0
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  435    0    3   17   47
     1    2    0]
 [   0    0    0    1    0    0    0    2    0   25  352   37   20    7
     8   16   31]
 [   0    0    1    3    0    1    0    3    0   11   10  418   21    6
    10    6   14]
 [   0    3    0    0    0    0    0    1    0    1    1    4  588    9
     6   22    8]
 [   0    2    0    0    0    0    0    0    0   64    0    2    7  383
     1    7    1]
 [   0    0    6    4    1    0    2    2    0    0    5   64   11    1
   316    2    6]
 [   0    0    0    2    0    0    0    0    0   22   32   16   18   10
     6  363   32]
 [   0    0    0    1    1    0    0    2    0   10    5   43   24   18
    11   37  365]]
------ TEST ACCURACY:  weights.29-0.47.hdf5  ------
0.73482428115
[[ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 32  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 51  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0 12  0 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 17  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  7 19  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 12  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0 20  0  0  2  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  4  3  0  0  4  0  0]
 [ 0  0  2  0  0  0  0  0  0  0 20  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0 11  0  0  3  3]
 [ 0  0  0  0  0  0  0  0  5  0  0  0 11  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  3  0  0  3  3  0]
 [ 0  0  0  0  0  0  0  0  5  0  5  1  0  0  0  6]]

>>>>>>>>>>>>>> 11 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/11/weights.50-0.49.hdf5
------ TRAIN ACCURACY:  weights.50-0.49.hdf5  ------
0.923543369365
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1706    0    9    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6 1891    0    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  848    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   17    1    4    7 1238    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    1    0    0    0    0  279    4    0    0    0    0    0
     1    0    0]
 [   0    0    1    0    0    0    0    3  190    0    0    0    0    1
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  472    5    0    1   29
     0    1    1]
 [   0    0    0    0    0    0    0    1    0   20  404    5   10    5
     2   13   31]
 [   0    0    1    0    0    1    2    3    1   20   33  400   15    4
     7    5   20]
 [   1    8    0    0    0    0    0    0    0    1   10    6  583    8
     1   13    6]
 [   1    3    0    0    0    0    0    0    0   52    2    1    0  398
     0    6    2]
 [   0    0    1    0    4    0    3    8    1    0   25   75   10    1
   268    4   16]
 [   0    0    0    0    0    0    0    0    2   22   53    4   15    8
     3  335   57]
 [   0    0    0    0    0    0    0    6    0    5   14   19   10   17
     4   28  415]]
------ TEST ACCURACY:  weights.50-0.49.hdf5  ------
0.72193877551
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 23  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1 81  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  6  0 36  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 14  0  0  0 43  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  0  0  0  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 12  0  0  0  6  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  6  0  0  2  0  4]
 [ 0  0  0  0  0  0  0  0  0  0 10  0  9  5  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  2  0  0  3  9  1  3  0]
 [ 0  5  0  0  0  0  0  0  0  0  0  0  0  0  7  2  4]
 [ 0  0  0  0  0  0  0  0  0  0  9  0  0  0  0  0  5]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  5  0  3  3  3]]

>>>>>>>>>>>>>> 12 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/12/weights.47-0.49.hdf5
------ TRAIN ACCURACY:  weights.47-0.49.hdf5  ------
0.930973294295
[[ 144    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1545    0    4    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1906    0    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  830    0   50    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0  705    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0    1 1286    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  294    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    1  193    0    0    2    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  461    1    1    1   39
     2    3    2]
 [   0    0    0    0    0    0    0    2    0   18  412   11   16    8
     6    4   19]
 [   0    0    1    0    1    0    0    6    0    5   13  430   19    8
    13    1   17]
 [   0    5    0    0    0    0    0    1    0    1    8    4  593   10
     5    1   13]
 [   0    0    0    0    0    0    0    0    0   47    0    4    3  403
     0    6    1]
 [   0    0    0    0    4    0    6    3    0    0    9   52   11    2
   331    0    6]
 [   0    0    0    0    0    0    0    2    0   19   45    7   16    4
     7  349   47]
 [   0    0    0    0    0    0    0    6    0    6    6   36   16   11
    11   22  401]]
------ TEST ACCURACY:  weights.47-0.49.hdf5  ------
0.802
[[  6   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  3   2   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 159   0   0   0  23   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   3   0  29   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  17  15   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  36   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  10   0   1   0   6   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0  10   0   0   1   1   2   1]
 [  0   0   0   0   0   0   0   0   0   0   0   7   0   1   2   2   0]
 [  0   0   0   0   6   0   0   0   0   0   4   0  10   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0  20   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   1   0   0   9   0   0]
 [  0   0   0   0   0   0   0   0   0   0  14   0   0   0   0   3   0]
 [  0   0   0   0   0   0   0   1   0   0   4   0   3   0   4   1   6]]

>>>>>>>>>>>>>> 13 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/13/weights.36-0.50.hdf5
------ TRAIN ACCURACY:  weights.36-0.50.hdf5  ------
0.928032297701
[[ 148    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  203    0    0    0    0    0    5    1    0    0    0    0    0
     0    0    0]
 [   0    0 1709    0    5    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1873    0    0   39    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  855    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  718    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0    3    5 1266    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  276    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    3  191    0    0    0    0    1
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  456    7    1    4   27
     1    3    6]
 [   0    0    0    0    0    0    0    3    0   11  398   15   18    6
     5   14   23]
 [   0    0    0    0    0    2    1    5    4   10   16  421   19    7
     9    3   11]
 [   0    3    0    0    0    0    0    4    0    0    1    2  603    9
     1    5    8]
 [   1    3    0    0    0    0    0    0    0   57    0    2    9  394
     0    6    2]
 [   0    1    0    0    3    0    4    8    3    0   15   50    8    4
   315    1    6]
 [   0    0    0    0    0    0    2    0    2   21   37    5   15    1
    12  349   51]
 [   0    2    0    0    0    0    0    5    0    5    7   30   18   10
    12   24  399]]
------ TEST ACCURACY:  weights.36-0.50.hdf5  ------
0.806366047745
[[ 3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 61  0  0  7  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0 15  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  0  4  0 11  0]
 [ 0  0  0  0  0  0  0  1  0  0  4  0  0  0  0  5  8]
 [ 0  0  1  0  0  0  0  0  0  1  0  5  1  1  0  0  9]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 25  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0 14  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  3  0 15  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  4  0  0 11  7]]

>>>>>>>>>>>>>> 14 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/14/weights.39-0.51.hdf5
------ TRAIN ACCURACY:  weights.39-0.51.hdf5  ------
0.935432932713
[[ 151    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  208    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1676    0    7    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1927    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  855    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  720    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    1    1    7 1261    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    0    0    0  286    3    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    1  193    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  477    7    0    6   19
     0    2    3]
 [   0    1    0    0    1    1    0    2    0   23  402   18   10    2
     4    7   22]
 [   0    0    1    0    0    2    0    3    0   12   14  411   19    5
    17    9   10]
 [   0    4    0    0    0    0    0    1    0    0    4    3  604    5
     4   11    5]
 [   1    1    0    0    0    0    0    0    0   62    0    4    4  397
     0    3    2]
 [   0    0    0    0    5    0    2    5    1    1   12   44   14    1
   320    0    9]
 [   0    0    0    0    0    0    0    1    0   24   43    8   11    4
    10  350   44]
 [   0    0    0    0    0    0    0    4    0    6    5   25   16   12
    10   20  425]]
------ TEST ACCURACY:  weights.39-0.51.hdf5  ------
0.755376344086
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0 49  0  2  0  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 40  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 50  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0  7  1  0  1]
 [ 0  0  0  0  0  0  0  0  0  3  7  3  0  0  0  0  5]
 [ 0  0  0  0  0  0  0  0  0  0  3  6  0  0  5  6  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 12  0  0  2  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  9  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  2 11  0  0  4  0  1  0]
 [ 0  0  0  0  0  1  0  0  0  0  0  2  0  0  6  0  2]]

>>>>>>>>>>>>>> 15 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/15/weights.46-0.49.hdf5
------ TRAIN ACCURACY:  weights.46-0.49.hdf5  ------
0.933544303797
[[ 141    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1686    0    5    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1897    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  899    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13   22   14    8 1211    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  283    1    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1  190    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  465    8    1    2   33
     0    3    3]
 [   0    0    0    0    0    0    0    3    0   12  415   13   15    3
     5    4   23]
 [   0    0    1    0    0    1    0    5    0   10   16  433   14    3
    12    1   16]
 [   1    5    0    0    0    0    0    2    0    0    5    5  597    9
     2   13    4]
 [   1    3    0    0    0    0    0    0    0   55    0    4    3  396
     0    5    2]
 [   0    0    0    0    6    0    2   11    0    0    8   61   10    2
   303    2   11]
 [   0    0    0    0    0    0    0    4    0   22   49    4   13    3
     6  353   46]
 [   0    0    0    0    0    0    0   10    0    8   11   24   11   15
     6    8  426]]
------ TEST ACCURACY:  weights.46-0.49.hdf5  ------
0.812658227848
[[ 4  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  2  1  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 88  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 16  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  1 54  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0 11  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  1  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  1  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 14  0  0  0  1  3  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  8  0  1  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  1  3  7  2  0  0  1  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  2 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  2  0  0  4  0  9]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  4  7]
 [ 0  0  0  0  0  0  0  0  0  0  7  0  0  0  0  0  8]]

>>>>>>>>>>>>>> 16 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/16/weights.49-0.50.hdf5
------ TRAIN ACCURACY:  weights.49-0.50.hdf5  ------
0.940546757498
[[ 144    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  198    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1670    0    9    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1900    0    1    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  857    0   15    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    2    7 1255    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  274    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  192    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    0  482    1    0    4   16
     0    4    2]
 [   0    0    0    0    0    1    0    1    0   24  414   12   11    6
     0    9   14]
 [   0    0    0    0    0    3    0    4    0   22   17  428   13    7
     7    3    8]
 [   0    3    0    0    0    0    0    2    0    0    4    4  608    7
     3    6    3]
 [   0    0    0    0    0    0    0    0    0   59    0    2    5  399
     0    3    2]
 [   0    0    0    0    6    0    2    7    2    0    8   56   10    2
   324    0    6]
 [   0    0    0    0    0    0    2    2    1   21   41    6   18    3
     1  359   37]
 [   0    0    0    0    0    0    0    3    0   11    9   17   17   12
     2   26  411]]
------ TEST ACCURACY:  weights.49-0.50.hdf5  ------
0.773504273504
[[ 8  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 7  3  0  0  0  0  0  6  0  0  0  0  0  0  0  1  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 77  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 46  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1 26  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  1  0 57  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  2  0 14  1  0  2  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 15  0  0  3  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  4  0  0  0  4  8]
 [ 0  0  0  0  0  0  0  0  0  1  0  5  2  0  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 10  3  0  0  1  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  2  5  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  4  2 16  0]
 [ 0  0  0  0  0  0  0  0  0  0 16  0  0  0  0  4  6]]

>>>>>>>>>>>>>> 17 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/17/weights.49-0.50.hdf5
------ TRAIN ACCURACY:  weights.49-0.50.hdf5  ------
0.937278839349
[[ 148    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  199    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1632    0    3    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1899    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  865    0   19    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  727    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10    1    1    6 1256    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  282    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    1  191    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  478    1    1    1   28
     0    3    3]
 [   0    0    0    0    0    1    0    1    0   17  404    6   14    9
     3   12   28]
 [   0    0    0    0    0    4    1    3    0   14   22  399   17   11
     9    5   20]
 [   0    0    0    0    0    0    0    5    0    0    4    5  596    5
     2   14   10]
 [   0    0    0    0    0    0    0    0    0   39    0    3    4  414
     0    3    1]
 [   0    0    0    0    4    1    7    5    0    1   10   41    6    1
   311    5   19]
 [   0    0    0    0    0    0    2    1    1   20   40    5   10    5
     1  367   43]
 [   0    0    0    0    0    0    0    2    0   11    5   10   13   21
     3   25  427]]
------ TEST ACCURACY:  weights.49-0.50.hdf5  ------
0.770877944325
[[  4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  1  12   0   0   0   0   0   2   0   0   0   0   0   0   0   0   0]
 [  0   0 103   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  81   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  25   0   3   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  19   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  50   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0  13   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   6   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   8   0   0   3   1   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   5   3   0   0   0   1   7]
 [  0   0   0   0   0   0   0   0   0   0   3   5   0   1   4   0   8]
 [  0   0   0   0   0   0   0   0   0   0   0   0  17   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   4   0   0   6   7   0   0   3]
 [  0   0   5   0   0   0   0   0   0   0   0   0   0   0  13   0   5]
 [  0   0   0   0   0   0   0   0   0   0   3   0   0   2   0   4   9]
 [  0   0   0   0   0   0   0   0   0   0   6   1   0   0   0   0  10]]

>>>>>>>>>>>>>> 18 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/18/weights.17-0.51.hdf5
------ TRAIN ACCURACY:  weights.17-0.51.hdf5  ------
0.891734169497
[[ 129    7    0    0    0    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   4  184    0    0    1    0    0   17    1    0    0    0    0    0
     0    0    0]
 [   0    0 1727    0   10    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   22 1868    1    0   38    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   18    0  853    0   22    2    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  723    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   42    0   20    6 1225    0    0    0    0    0    0    0
     0    0    0]
 [   1    3    0    0    0    0    0  273    4    0    1    0    0    0
     1    0    0]
 [   0    0    1    0    0    0    1   12  174    0    0    0    0    1
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  429   14    0    8   54
     1    3    4]
 [   0    0    0    0    0    0    1    7    0   18  361   33   16   14
     6    7   30]
 [   0    0    1    0    1    1    0    9    9   13   25  394   17    8
    18    4    9]
 [   1    4    0    0    0    0    0    3    0    3    8    7  585   13
     6    8    5]
 [   2    5    0    0    0    0    0    0    0   51   13    5    6  376
     2    7    4]
 [   2    1    0    0    7    0    3    9    1    0   21   71    8    2
   290    4    4]
 [   0    1    0    0    0    1    3    2    2   25   82    6   28   11
     8  276   58]
 [   0    0    0    0    0    0    0   12    1    6   25   32   24   15
    12   23  371]]
------ TEST ACCURACY:  weights.17-0.51.hdf5  ------
0.744827586207
[[12  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  7  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 56  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  9  0  7  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0 29  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  0  0  3  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 10  1  1  0  5  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  3  8  0  1  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0 12  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0 11  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  7  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  2  4  2]
 [ 0  0  0  0  0  0  0  0  0  1  8  0  2  0  0  2  0]]

>>>>>>>>>>>>>> 19 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/19/weights.40-0.51.hdf5
------ TRAIN ACCURACY:  weights.40-0.51.hdf5  ------
0.931942633638
[[ 145    1    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  200    0    0    0    0    0    4    0    0    0    0    0    0
     0    0    0]
 [   0    0 1719    0    4    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1918    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   15    0  891    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   15   27    1    7 1243    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  287    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    2  189    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  466    5    2    5   37
     1    3    0]
 [   0    0    0    0    0    0    0    2    0   12  411   18   12    7
    10    8   16]
 [   0    0    1    0    0    1    0    2    1    9   17  421   21    8
    20    5   11]
 [   1    4    0    0    0    0    0    1    0    1    1    2  604   11
     3   11    5]
 [   0    0    0    0    0    0    0    0    0   53    0    4    4  407
     0    6    0]
 [   0    0    0    0    3    0    2    4    0    0    4   59   11    3
   329    2    2]
 [   0    0    0    0    0    0    1    3    0   24   36    5   12    8
     6  380   29]
 [   0    0    0    0    0    0    0    4    0    7   11   39   18   14
    13   27  389]]
------ TEST ACCURACY:  weights.40-0.51.hdf5  ------
0.827067669173
[[ 3  3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 14  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0 30  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  7  0  0  1  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  6  0  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  4  0  0  8  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  2  0  0  6  0]
 [ 0  0  2  0  0  0  0  0  0  0  0  1  0  3  0  5  1]]

>>>>>>>>>>>>>> 20 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/20/weights.41-0.50.hdf5
------ TRAIN ACCURACY:  weights.41-0.50.hdf5  ------
0.932449160035
[[ 141    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  201    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1576    0    5    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1912    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   16    0  852    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  725    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0    0    6 1263    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  286    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    3  188    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    0  460    2    0    7   37
     0    4    2]
 [   0    0    1    0    0    0    1    0    0   18  389   19   15   11
     4   16   27]
 [   0    0    1    0    0    1    0    3    1   17   13  434   12    4
    14    6   13]
 [   0    4    0    0    0    0    0    1    0    0    2    2  597    7
     5   17    8]
 [   0    0    0    0    0    0    0    0    0   47    0    1    4  406
     1    9    1]
 [   0    0    0    0    5    0    2    6    0    1   13   48    6    1
   327    8    8]
 [   0    0    0    0    0    0    0    0    1   25   36    4    8    2
     2  380   41]
 [   0    0    0    0    0    0    0    0    0   11    4   30   14    8
     7   42  409]]
------ TEST ACCURACY:  weights.41-0.50.hdf5  ------
0.787418655098
[[  7   3   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0  11   0   0   0   0   0   2   0   0   0   0   0   0   0   0   0]
 [  0   0 144   0   0   0  12   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  71   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   5  21   3   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  18   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   1  32   0   0  17   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   6   2   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   8   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  12   0   0   0   4   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   8   0   0   2   0   0]
 [  0   0   0   0   0   0   0   0   0   0   2   3   0   0   2   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  18   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   1   0   1   2  11   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   1   1   0   0   5   2   0]
 [  0   0   0   0   0   0   0   0   0   0   2   0   0   0   0   9   3]
 [  0   0   0   0   0   0   0   0   0   0   3   3   0   0   0   1   2]]

>>>>>>>>>>>>>> 21 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/21/weights.42-0.49.hdf5
------ TRAIN ACCURACY:  weights.42-0.49.hdf5  ------
0.933687233487
[[ 145    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  202    0    0    0    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1718    0    1    3   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1922    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  868   12   28    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  724    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    2    0   12 1263    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  285    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    3  181    0    0    0    0    0
     1    0    0]
 [   0    2    0    0    0    0    0    0    0  455    3    1    2   45
     0    3    5]
 [   0    0    0    0    0    0    0    0    0   19  412   14   18    9
     4    9   17]
 [   0    0    0    2    0    4    0    4    0    9   10  423   21    8
    11    9    8]
 [   0    0    0    0    0    0    0    3    0    0    2    4  603   10
     1   12    7]
 [   0    0    0    0    0    0    0    0    0   37    0    5    8  418
     0    4    1]
 [   0    0    1    0    1    1    3    6    0    0   12   51   11    3
   325    4    7]
 [   0    0    0    0    0    0    1    4    0   23   39    5   22    8
     2  362   35]
 [   0    0    0    0    0    0    1    4    0    9    9   27   16   19
     5   14  423]]
------ TEST ACCURACY:  weights.42-0.49.hdf5  ------
0.667857142857
[[ 7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  8  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  5 23  0  0 33  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  8  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  4  0 41  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  6  3  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  2  0  0  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  1 16  1  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  1  3  5  0  1  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  8  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  1  0  6  3]
 [ 0  0  0  0  0  0  0  0  0  0  1  1  4  0  1  0  0]]

>>>>>>>>>>>>>> 22 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/22/weights.23-0.50.hdf5
------ TRAIN ACCURACY:  weights.23-0.50.hdf5  ------
0.915034996013
[[ 130    4    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   1  201    1    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1668    0    5    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1916    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   27    0  820    0   28    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    1    0    7 1256    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  274    3    0    0    0    0    0
     1    0    0]
 [   0    1    0    0    0    0    1    1  179    0    0    0    0    1
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  446   14    0    5   35
     1    2    2]
 [   0    0    0    0    0    0    0    1    0   11  385   21   11   12
     6   12   31]
 [   0    0    1    1    1    2    0    3    0   15   15  380   18    9
    28    6   19]
 [   0    3    0    0    0    0    0    2    0    2    6    6  575   16
     5   15    8]
 [   0    0    0    0    0    0    0    0    0   52    3    4    2  391
     1    7    3]
 [   0    0    0    0    4    0    6    2    0    0   11   57   12    3
   312    0   10]
 [   0    0    0    0    0    2    0    1    1   25   63   11    9   16
    10  297   55]
 [   0    2    0    0    1    0    0    4    1   10   22   29   14   17
    11   22  379]]
------ TEST ACCURACY:  weights.23-0.50.hdf5  ------
0.688016528926
[[ 0  6  0  0  2  0  0  9  0  0  0  0  0  0  0  0  0]
 [ 2  5  0  0  3  0  0  0  0  0  1  0  0  0  0  0  0]
 [ 0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 61  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 42  0  4  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 51  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0 12  1  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0 11  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 15  0  4  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  3  3  7  0  0  0  0  8]
 [ 0  0  0  0  0  0  0  0  0  4  3 13  0  0  8  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0 21  0  0  0  0]
 [ 1  3  0  0  0  0  0  1  0  5  0  0  2  1  5  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0  7  3  3]
 [ 0  0  0  0  0  0  0  0  0  0 12  0  0  0  0  5  6]
 [ 0  0  0  0  0  0  0  0  0  0  5 13  0  0  0  0  4]]

>>>>>>>>>>>>>> 23 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/23/weights.39-0.50.hdf5
------ TRAIN ACCURACY:  weights.39-0.50.hdf5  ------
0.926605504587
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  207    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1718    0    5    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6 1905    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   18    0  856    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  718    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   42    3    4    6 1224    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  279    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    8  185    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  454    4    0    4   36
     1    4    2]
 [   0    0    0    0    1    0    0    1    1   15  400    3   21    5
    11   23   21]
 [   0    0    1    0    1    1    0    3    1   10   20  367   21   10
    47   13   22]
 [   0    5    0    0    0    0    0    3    0    0    2    1  605    9
     5   10    6]
 [   0    0    0    0    0    0    0    0    0   49    0    0    5  402
     2    9    2]
 [   0    0    2    0    6    0    3    6    0    0    5   34    9    3
   346    2    9]
 [   0    0    0    0    0    0    0    0    1   17   36    0   25    7
    10  373   29]
 [   0    0    0    0    0    0    0    0    0    6    5   20   19   13
     8   29  420]]
------ TEST ACCURACY:  weights.39-0.50.hdf5  ------
0.78527607362
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 15  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 74  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 24  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0  7  0 11  0]
 [ 0  0  0  0  0  0  0  0  0  0  9  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  2  0  0  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  4  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  8  0  3  2]
 [ 0  0  0  0  0  0  0  1  0  0  0  5  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  4  0  1  8  1]
 [ 0  0  0  0  0  0  0  4  0  0  2  0  0  0  2  2  4]]

>>>>>>>>>>>>>> 24 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/24/weights.39-0.50.hdf5
------ TRAIN ACCURACY:  weights.39-0.50.hdf5  ------
0.932885304659
[[ 132    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  195    1    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1553    0    6    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1914    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    0  824    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11    0    0    6 1251    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  274    2    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    1  188    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  447    5    0    1   47
     0    3    3]
 [   0    1    0    0    0    0    0    1    0   16  403   10   22   10
     7    9   17]
 [   0    0    1    0    0    1    1    3    0   11   16  423   16    4
    18    4   14]
 [   0    4    0    0    0    0    0    2    0    5    2    3  600   15
     2    4    3]
 [   1    1    0    0    0    0    0    0    0   38    0    3    3  413
     1    7    2]
 [   0    0    2    0    2    0    3    9    0    1   11   36    0    4
   328    6    7]
 [   0    0    0    0    0    0    2    2    1   18   44    3   20    8
    11  343   42]
 [   0    0    0    0    0    0    1    6    0    8   15   14   22   19
    12   16  404]]
------ TEST ACCURACY:  weights.39-0.50.hdf5  ------
0.765957446809
[[  8  11   0   0   0   0   0   0   0   0   0   0   0   2   0   0   0]
 [  1  14   0   0   0   0   0   0   0   0   0   0   3   0   0   1   0]
 [  0   0 175   0   2   0   2   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  69   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  59   3   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  27   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   1  13   0   0  42   0   0   0   0   0   0   0   0   0   0]
 [  1   2   0   0   0   0   0   9   1   0   1   0   4   0   0   0   0]
 [  1   0   0   0   0   0   0   0   9   0   0   0   0   0   0   0   0]
 [  0   2   0   0   0   0   0   0   0  21   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0  10   3   0   0   0   0   2]
 [  0   0   0   0   0   0   0   0   0   3   4   0   2   1   3   0   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0  19   0   0   0   2]
 [  0   0   0   0   0   0   0   0   0  15   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0  13  11   0   0   1   0]
 [  0   0   0   0   0   0   0   0   0   0   1   3  10   0   0   4   1]
 [  0   0   0   0   0   0   0   0   0   0   0   7   1   0   3   4   2]]

>>>>>>>>>>>>>> 25 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/25/weights.38-0.48.hdf5
------ TRAIN ACCURACY:  weights.38-0.48.hdf5  ------
0.928382896358
[[ 150    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1659    0    2    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1911    0    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  851    2   33    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  725    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    1    0    7 1261    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  283    2    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    0    1    1  188    0    0    0    0    1
     0    1    0]
 [   0    0    0    0    0    0    0    2    0  463    3    0    1   42
     0    1    0]
 [   0    0    0    0    0    0    0    1    0   23  406    9   11    2
     5   17   18]
 [   0    0    1    0    0    1    0    1    1   20   20  413   14   12
    11    8   10]
 [   0    3    0    0    0    0    0    4    0    6    1    1  562   18
     3   31    4]
 [   2    3    0    0    0    0    0    1    1   62    0    1    2  377
     1    7    6]
 [   0    0    0    0    1    0    5    4    0    0    9   32   11    3
   322   10   22]
 [   0    0    0    0    0    0    2    0    0    5   38    0   13    3
     1  389   34]
 [   0    0    0    0    0    0    0    6    0   13   10   20   15   18
    10   39  382]]
------ TEST ACCURACY:  weights.38-0.48.hdf5  ------
0.753086419753
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 46  0  3  3  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 24  0  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 21  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 52  0  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  0  0  0  2  2  0  0  0  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 12  0  0  1  3  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  4  6  0  0  2  0  5  2]
 [ 0  0  0  0  0  0  0  0  0  2  9  0  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 27  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0 14  0  4  0]
 [ 0  0  0  0  1  0  2  0  0  1  4  4  0  1  2  0  0]
 [ 0  0  0  0  0  0  0  0  0 16 11  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0 20]]

>>>>>>>>>>>>>> 26 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/26/weights.27-0.48.hdf5
------ TRAIN ACCURACY:  weights.27-0.48.hdf5  ------
0.912461740271
[[ 150    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  208    0    0    0    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1618    0   81    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1921    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  881    0   10    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    1  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1   11   33    8 1223    0    0    0    0    0    0    0
     0    0    0]
 [   0    6    0    0    1    0    0  285    1    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    1    6  192    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  458    5    1    4   26
     0   15    1]
 [   0    1    0    0    1    0    0    4    0   21  384   22   19    4
     4   15   15]
 [   0    1    1    0    1    1    0    2    0   15   13  432   18    8
     4    3    8]
 [   0    1    0    0    0    0    0    0    0    6    4    5  582   13
     1   14   10]
 [   0    5    0    0    0    0    0    2    0   60    5    9    7  376
     0   11    2]
 [   0    3    0    0    4    0    2    2    0    0   12   74   14    2
   289   11    8]
 [   0    0    0    0    0    0    0    7    1   22   47   10   18    2
     7  350   30]
 [   0    0    0    0    0    0    0   10    0    5   22   49   16   12
     8   32  364]]
------ TEST ACCURACY:  weights.27-0.48.hdf5  ------
0.776785714286
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 30  0  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 48  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  9  6  0  0  0  1  5]
 [ 0  0  0  0  0  0  0  3  1  0  3  5  0  0  4  2  1]
 [ 0  4  0  0  0  0  0  4  0  0  0  0 17  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0  3  0  0  0]
 [ 0  0  0  0  1  0  0 11  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 10  9]
 [ 0  0  0  0  0  0  0  0  0  1  0  5  0  0  2  1  7]]

>>>>>>>>>>>>>> 27 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/27/weights.31-0.47.hdf5
------ TRAIN ACCURACY:  weights.31-0.47.hdf5  ------
0.911169513798
[[ 152    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  209    0    0    0    0    0    5    1    0    0    0    0    0
     0    0    0]
 [   0    0 1695    0    4    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6 1908    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   24    0  853    0   19    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    6    0  709    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   29   48    2    7 1193    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  281    5    0    0    0    0    0
     1    0    0]
 [   0    0    1    0    0    0    0    3  193    0    0    1    0    1
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  443    0    3    4   46
     1   12    0]
 [   0    0    1    1    1    0    0    0    0   21  383   32   26    9
     6   12    5]
 [   0    0    1    3    0    1    1    3    0   16   15  425   13    8
     8    5    5]
 [   0    2    0    0    0    0    0    4    0    6    3    6  601    8
     2    5    3]
 [   1    0    0    0    0    0    0    0    0   47    0    7   16  387
     2    5    1]
 [   0    0    0    0    4    0    0    4    0    0    7   72   20    0
   306    4    6]
 [   0    1    0    1    0    0    0    1    0   21   39   20   48    5
     4  330   27]
 [   0    0    0    0    0    0    0    4    0   10   15   60   35   16
    13   32  333]]
------ TEST ACCURACY:  weights.31-0.47.hdf5  ------
0.755617977528
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 39  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 31  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 18  3  3  0 21  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  4  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  4  4  1  1  1  0  1]
 [ 0  0  0  0  0  0  0  0  0  2 18  0  1  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0 11  0  3  0]
 [ 0  1  0  2  0  2  0  0  0  1  5  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4 12  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  7  0  3  1  0  4]]

>>>>>>>>>>>>>> 28 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/28/weights.42-0.45.hdf5
------ TRAIN ACCURACY:  weights.42-0.45.hdf5  ------
0.918201658664
[[ 152    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    1    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1703    0    4    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1898    0    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   19    0  838    0   33    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  718    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0    0    6 1271    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  283    2    0    2    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    2  197    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    0  453    8    0    4   28
     0   18    0]
 [   0    0    1    0    0    0    1    1    0   16  426    4   23    5
     7    6    5]
 [   0    0    1    0    0    2    1    5    1   17   39  385   21    4
    18    5   10]
 [   0    4    0    0    0    0    0    2    0    5    7    1  597    7
     4   10    1]
 [   0    0    0    0    0    0    0    0    0   51    9    1    8  395
     3    6    1]
 [   0    0    0    0    3    0    6    4    0    1   27   31   18    2
   324    5    5]
 [   0    0    0    0    0    0    2    0    1   20   85    2   27    8
    14  319   19]
 [   0    0    0    0    0    0    0    6    0   10   44   28   27   16
    16   23  348]]
------ TEST ACCURACY:  weights.42-0.45.hdf5  ------
0.825949367089
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 30  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1 39  0  0 18  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 31  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 24  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 41  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 15  0  0  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0 15  0  0  0  0  1  0]
 [ 0  0  0  1  0  0  1  0  3 12  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 21  2  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  1  6  7]
 [ 0  0  0  0  0  0  0  0  0  3  2  0  2  2  7]]

>>>>>>>>>>>>>> 29 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/29/weights.39-0.50.hdf5
------ TRAIN ACCURACY:  weights.39-0.50.hdf5  ------
0.92013148543
[[ 151    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  200    1    0    0    0    1    2    0    0    0    0    0    0
     1    0    0]
 [   0    0 1624    1    1    2    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1917    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   43    0  784    2   62    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0  711    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    3    1    7 1272    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  272    3    0    0    0    0    1
     5    2    0]
 [   0    0    0    0    0    0    1    7  177    0    0    0    0    4
     3    0    0]
 [   0    0    0    0    0    0    0    0    0  452    0    0    3   43
     1    1    0]
 [   0    0    0    0    0    0    0    0    0   30  360   18   18   15
    10   17   15]
 [   0    0    0    0    0    1    1    0    0   16   18  407    8   11
    28    3   11]
 [   0    3    0    0    0    0    0    1    0   10    1    2  597    8
     0    5    3]
 [   2    2    0    0    0    0    0    0    0   53    0    0    4  392
     3    0    2]
 [   0    0    0    1    0    1    7    2    0    0    9   26   15    2
   332   12    7]
 [   0    1    0    1    0    0    7    0    0   29   26    2   32   20
     8  341   26]
 [   0    2    0    0    0    0    0    0    0   14    4   33   14   19
    20   28  368]]
------ TEST ACCURACY:  weights.39-0.50.hdf5  ------
0.590291262136
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  5  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0 72  1  0  0 33  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 13  0 13  0  4  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  9  0  0 29  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  9  0  0  3  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  1  5  0  0  0  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  0 26  0  0  3  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  9  2  9  0  3  0  4]
 [ 0  0  0  2  0  3  0  0  0  5  0  3  9  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 22  2  2  4  1]
 [ 0  0  0  0  0  0  0  0  0 13  0  2  4  5  1  1  0]
 [ 0  0  0  3  0  0  0  0  0  0  0 13  0  3  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  2  7  0  8  0  0  1  2]
 [ 0  0  0  0  0  0  0  0  0  7  0  1 12  4  2  2  4]]

>>>>>>>>>>>>>> 30 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_svd_conv1d_10/30/weights.39-0.49.hdf5
------ TRAIN ACCURACY:  weights.39-0.49.hdf5  ------
0.928275983455
[[ 151    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    1    1    0    0    0    0    0
     0    0    0]
 [   0    0 1669    0    6    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1923    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    0  855    0   28    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6   25    1    9 1241    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  285    4    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    3  193    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  456    0    2    2   17
     0   12    7]
 [   0    0    0    0    0    0    0    1    0   13  398   27    8    4
     6    4   26]
 [   0    0    1    1    0    1    0    1    0    9   15  447    4    6
     6    2    7]
 [   0    0    0    0    0    0    0    5    0    6    1   15  590    7
     4    5    1]
 [   1    3    0    0    0    0    0    2    0   70    0    7    7  363
     0    8    4]
 [   0    0    0    0    2    0    3    3    0    0    4   78    6    2
   299    5   12]
 [   0    0    0    0    0    0    0    1    0   25   54   12   18    0
     7  341   37]
 [   0    0    0    0    0    0    0    6    0    5    4   47   14    4
    14    8  408]]
------ TEST ACCURACY:  weights.39-0.49.hdf5  ------
0.725490196078
[[ 1  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 42  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 22  2  2  0  5  0  0  0]
 [ 0  0  0  0  1  0  0  0 12  3  1  4  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  1 17  6  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  1  4 12  0  0  8  2]
 [ 0  0  0  0  0  0  0  0 11  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  8  0  0 12  0  0]
 [ 0  0  1  0  0  0  0  0  1  0  6  0  0  0  3  7]
 [ 0  0  0  0  1  0  0  0  3  0  7  3  3  0  2  5]]
[0.6979166666666666, 0.7272727272727273, 0.8782894736842105, 0.48231511254019294, 0.7785234899328859, 0.883495145631068, 0.8363636363636363, 0.8488664987405542, 0.6908212560386473, 0.7348242811501597, 0.7219387755102041, 0.802, 0.8063660477453581, 0.7553763440860215, 0.8126582278481013, 0.7735042735042735, 0.7708779443254818, 0.7448275862068966, 0.8270676691729323, 0.7874186550976139, 0.6678571428571428, 0.6880165289256198, 0.7852760736196319, 0.7659574468085106, 0.7530864197530864, 0.7767857142857143, 0.7556179775280899, 0.8259493670886076, 0.5902912621359223, 0.7254901960784313]
0.756501731353
0.080286106124

Process finished with exit code 0

'''
