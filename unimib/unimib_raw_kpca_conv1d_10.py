import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import numpy as np
import cPickle as pickle
from sklearn.decomposition import TruncatedSVD
from sklearn.preprocessing import StandardScaler
from keras.models import Model, load_model
from keras.initializers import Constant, TruncatedNormal
from keras.layers import Input, Dense, Conv1D, Flatten, Dropout, Activation, BatchNormalization
from keras.layers.merge import concatenate
from keras.optimizers import Adam
from keras.callbacks import ModelCheckpoint
import keras.backend as K
from keras import losses
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix

# Load SVD data + Signal Magnitude Vector

X_kpca = pickle.load(open("data/X_unimib_kpca.p", "rb"))
X_raw = pickle.load(open("data/X_unimib_raw.p", "rb"))
X = np.concatenate((X_kpca, X_raw), axis=1)

y = pickle.load(open("data/y_unimib_raw.p", "rb"))

n_classes = 17


# Below builds 1D CNN.

for i in range(30):
    test = y.loc[y[1] == i+1]
    # print y_sub
    test_index = test.index.values
    # print len(test_index)

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index], y_values[test_index]
    y_train = np.eye(n_classes)[y_train - 1]
    print X_train.shape # (11188, 604)

    # input layer
    input_signal = Input(shape=(604, 1))
    print K.int_shape(input_signal)

    # define initial parameters
    b_init = Constant(value=0.0)
    k_init = TruncatedNormal(mean=0.0, stddev=0.01, seed=2018)

    # first feature extractor
    conv11 = Conv1D(16, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn11 = BatchNormalization()(conv11)
    actv11 = Activation('relu')(bn11)
    conv12 = Conv1D(32, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv11)
    bn12 = BatchNormalization()(conv12)
    actv12 = Activation('relu')(bn12)
    flat1 = Flatten()(actv12)

    # second feature extractor
    conv21 = Conv1D(16, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn21 = BatchNormalization()(conv21)
    actv21 = Activation('relu')(bn21)
    conv22 = Conv1D(32, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv21)
    bn22 = BatchNormalization()(conv22)
    actv22 = Activation('relu')(bn22)
    flat2 = Flatten()(actv22)

    # third feature extractor
    conv31 = Conv1D(16, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn31 = BatchNormalization()(conv31)
    actv31 = Activation('relu')(bn31)
    conv32 = Conv1D(32, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv31)
    bn32 = BatchNormalization()(conv32)
    actv32 = Activation('relu')(bn32)
    flat3 = Flatten()(actv32)

    # merge feature extractors
    merge = concatenate([flat1, flat2, flat3])

    # dropout & fully-connected layer
    do = Dropout(0.9, seed=2018)(merge)
    output = Dense(n_classes, activation='softmax', bias_initializer=b_init, kernel_initializer=k_init)(do)

    # result
    model = Model(inputs=input_signal, outputs=output)

    # summarize layers
    print(model.summary())

    new_dir = 'model/unimib_raw_kpca_conv1d_10/' + str(i+1) + '/'
    if not os.path.exists(new_dir):
        os.makedirs(new_dir)

    fpath = new_dir + 'weights.{epoch:02d}-{val_acc:.2f}.hdf5'
    cp_cb = ModelCheckpoint(fpath, monitor='val_acc', verbose=1, save_best_only=True, mode='auto', period=1)

    adam = Adam(lr=0.001)
    model.compile(loss=losses.categorical_crossentropy, optimizer=adam, metrics=['accuracy'])
    model.fit(np.expand_dims(X_train, axis=2), y_train, batch_size=64, epochs=50, verbose=2, validation_split=0.10,
              callbacks=[cp_cb], shuffle=True)

    del model
    K.clear_session()


# Below calculates average test data accuracy (LOSO CV).

acc = []

for i in range(30):
    test = y.loc[y[1] == i+1]
    test_index = test.index.values

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index] - 1, y_values[test_index] - 1

    print "\n>>>>>>>>>>>>>>", str(i+1), "-fold <<<<<<<<<<<<<<<<"
    path_str = 'model/unimib_raw_kpca_conv1d_10/' + str(i+1) + '/'
    for path, dirs, files in os.walk(path_str):
        dirs.sort()
        files.sort()
        top_acc = []
        top_acc.append(files[-1])
        files = top_acc
        for file in files:
            print "========================================"
            print os.path.join(path, file)
            model = load_model(os.path.join(path, file))
            pred = model.predict(np.expand_dims(X_train, axis=2), batch_size=32)
            print "------ TRAIN ACCURACY: ", file, " ------"
            print accuracy_score(y_train, np.argmax(pred, axis=1))
            print confusion_matrix(y_train, np.argmax(pred, axis=1))
            pred = model.predict(np.expand_dims(X_test, axis=2), batch_size=32)
            print "------ TEST ACCURACY: ", file, " ------"
            print accuracy_score(y_test, np.argmax(pred, axis=1))
            print confusion_matrix(y_test, np.argmax(pred, axis=1))

            del model
            K.clear_session()

    acc.append(accuracy_score(y_test, np.argmax(pred, axis=1)))

print acc
print np.mean(acc)
print np.std(acc)

'''
-----
[0.6510416666666666, 0.7324185248713551, 0.8289473684210527, 0.49517684887459806, 0.761744966442953, 0.7961165048543689, 0.796969696969697, 0.8866498740554156, 0.7246376811594203, 0.731629392971246, 0.6530612244897959, 0.764, 0.7320954907161804, 0.7150537634408602, 0.8151898734177215, 0.7457264957264957, 0.8094218415417559, 0.7586206896551724, 0.7819548872180451, 0.7830802603036876, 0.6571428571428571, 0.7066115702479339, 0.8128834355828221, 0.7364975450081833, 0.7530864197530864, 0.7976190476190477, 0.800561797752809, 0.8860759493670886, 0.6310679611650486, 0.7794117647058824]
0.750816513338
0.0773519070291
-----

/usr/bin/python2.7 /mnt/0cdd1a7e-3686-4cf7-9055-145eb5fe70f3/hcilab/OSS/electronicsletters2018/unimib/unimib_raw_kpca_conv1d_10.py
/home/hcilab/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.

>>>>>>>>>>>>>> 1 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/1/weights.50-0.50.hdf5
------ TRAIN ACCURACY:  weights.50-0.50.hdf5  ------
0.944498111882
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  206    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1677    0    4    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1914    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  882    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  718    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    2    1    8 1268    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  287    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  198    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    2  474    2    4    1   32
     0    1    0]
 [   0    0    0    0    0    1    0    0    0   23  426   11   15   12
     1    3    2]
 [   0    0    0    1    0    8    0    9    0    9   16  411    5   10
    17    5   20]
 [   0    0    0    0    2    0    0    3    0    4   12    7  599    8
     1    5    1]
 [   0    0    0    0    0    0    0    0    0   43    3    0    1  417
     0    3    3]
 [   0    0    0    0    1    0    0    6    2    1    7   48    5    1
   336    5    7]
 [   0    0    0    0    0    0    0    1    0    8   40    1   18   15
     2  360   48]
 [   0    0    0    1    0    2    0    0    0    7    4   25    2   11
     6   23  435]]
------ TEST ACCURACY:  weights.50-0.50.hdf5  ------
0.651041666667
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0 27  0  0  0  0  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0 28  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 32  0  0  0 10  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  7  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  1  0  0  0  1  1  1  0  1  0  5  1]
 [ 0  0  0  0  0  0  0  1  0  3  2  0  3  2  0  1  5]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  5  9]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  2  3]
 [ 0  0  0  0  0  0  0  0  0  0  1  1  0  1  0  6  5]
 [ 0  0  0  0  0  1  0  0  0  2  3  0  0  1  2  5  1]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0  7  6  3  1]
 [ 0  0  0  0  0  0  0  0  0  2  3  2  1  0  0  0 10]]

>>>>>>>>>>>>>> 2 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/2/weights.35-0.51.hdf5
------ TRAIN ACCURACY:  weights.35-0.51.hdf5  ------
0.941812656418
[[ 146    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1594    0    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1911    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  854    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    1    0    2 1270    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  285    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  195    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    0  474    5    3    3   17
     0    0    5]
 [   0    0    0    0    0    0    0    2    0   15  427   11    5    4
     4   13    7]
 [   0    0    0    0    1    3    1    8    0   20   17  389    9    5
    29    4   16]
 [   0    1    0    0    1    0    0    5    0    1   14    9  571    4
     1   12    2]
 [   0    0    0    0    0    1    0    0    0   62    5    0    0  375
     0    5    4]
 [   0    0    0    0    2    0    0   11    0    2    4   27    7    1
   348    7    0]
 [   0    0    0    0    0    0    0    1    1    9   44    4   14    9
     5  354   45]
 [   0    0    0    0    0    2    0    2    0   11    3   19    5    8
     9   25  423]]
------ TEST ACCURACY:  weights.35-0.51.hdf5  ------
0.732418524871
[[  7   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  1   7   0   0   0   0   0   0   0   0   0   0   0   0   2   2   0]
 [  0   0 140   0   3   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  37   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  29   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   1   0  48   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   1   8   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  20   0   0   1   0   0   0   0]
 [  0   0   0   0   0   2   0   1   0   0   4   0  14   0   0   1   1]
 [  0   0   0   0   2   0   0   3   0   0   0   1   1   0   5   9   3]
 [  0   0   0   0   0   0   0   0   0   0   2   0  34   0   0   4   0]
 [  0   0   0   0   0   1   0   0   0  18   0   0   8   5   0   0   0]
 [  0   5   0   1   0   6   0   0   0   0   1   0   0   0   5   7   0]
 [  0   0   0   0   0   3   0   0   0   5   2   0  11   0   1   2   3]
 [  0   0   0   0   0   3   0   0   0   0   1   6   6   0   0   8   3]]

>>>>>>>>>>>>>> 3 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/3/weights.43-0.52.hdf5
------ TRAIN ACCURACY:  weights.43-0.52.hdf5  ------
0.946367838144
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  215    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1716    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1903    1    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  881    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0    3    3 1277    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  285    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  197    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    1  485    2    3    1   20
     0    1    0]
 [   0    0    0    0    0    3    1    2    0   20  421   15   11   10
     5    8    3]
 [   0    0    0    0    0    4    0    2    0   19   14  415    5    7
    23    8   19]
 [   0    0    0    0    3    0    0    2    0    2    4    8  606    9
     1    6    6]
 [   0    0    0    0    0    0    0    0    0   53    4    0    0  410
     0    0    4]
 [   0    0    0    0    2    0    0    8    0    2    4   45    4    0
   354    5    3]
 [   0    0    0    0    1    0    0    1    1   15   29    4   16   12
     9  373   42]
 [   0    0    0    0    0    2    0    1    0    8    4   25    5   12
     9   10  451]]
------ TEST ACCURACY:  weights.43-0.52.hdf5  ------
0.828947368421
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 73  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0 38  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0  8  0  2  0]
 [ 0  0  0  0  0  0  0  8  0  0  1  1  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  6  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  3  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  6  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  2  5  0  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0  1  3  0]]

>>>>>>>>>>>>>> 4 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/4/weights.47-0.51.hdf5
------ TRAIN ACCURACY:  weights.47-0.51.hdf5  ------
0.946422338569
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1722    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1930    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  879    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    2    0    2 1292    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  285    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  191    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    0  481    4    5    1   28
     2    0    0]
 [   0    0    0    0    0    0    0    0    0   18  422    9   12   10
     8   11    2]
 [   0    0    0    2    0    2    0    6    0   13   22  390    2    8
    27   11   20]
 [   0    0    0    0    1    0    0    4    0    1    7    9  602    8
     0    4    7]
 [   0    0    0    0    0    0    0    0    0   53    3    0    0  406
     0    1    4]
 [   0    0    0    0    2    0    1    3    0    1    9   36    5    0
   350    5    9]
 [   0    0    0    0    1    0    0    0    0   17   37    4   12   10
     4  370   42]
 [   0    0    0    1    0    1    0    0    0    9   16   15    2    7
     9   10  442]]
------ TEST ACCURACY:  weights.47-0.51.hdf5  ------
0.495176848875
[[ 2  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  2  0  7  0  0  0  0  1  0  0  0  0  0]
 [ 0  0 54  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 23  0  4  0  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0 11  0  0  0  2  0  0  2  0  9  3  0]
 [ 0  0  0  2  0 15  6  0  0  1  2  0  0  1  0  0]
 [ 0  0  0  1  0  0  6  0  0  1  1  0  0  1  0  0]
 [ 0  0  0  0  0  0  3  0  0  0  1  0  0  4  0  1]
 [ 0  0  0  0  0  0  0  0  6  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  1  1  0  0  0 12  0]
 [ 0  0  0  0  0  0  0  0  2  0  8  0  2  2  9  0]
 [ 0  0  0  0  0  0  0  0  1  0  1 15  1  0  0  0]
 [ 0  0  0  0  0  0  0  0 12  3  0  0  2  0  0  0]
 [ 0  0  2  0  0  0  0  0  0  2  2  1  0  5  1  0]
 [ 0  0  0  0  0  1  0  0  6  2  1  0  4  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  5  5  4  0  2  0]]

>>>>>>>>>>>>>> 5 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/5/weights.50-0.52.hdf5
------ TRAIN ACCURACY:  weights.50-0.52.hdf5  ------
0.948226270374
[[ 146    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1716    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1919    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  898    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    2 1289    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  290    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  199    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    3  463    2    2    1   32
     0    1    7]
 [   0    0    0    0    0    2    0    0    0   17  450    4   13    6
     2    5    3]
 [   0    0    0    0    0    0    1    8    0    5   22  408    3   11
    12   10   25]
 [   0    1    0    0    3    0    0    2    0    1    8   11  592   12
     1   12    3]
 [   0    0    0    0    0    0    0    0    0   41    5    0    0  419
     0    3    6]
 [   0    0    0    0    2    1    0   18    0    1   12   28    5    0
   341    9    8]
 [   0    0    0    0    1    0    0    1    1    7   41    3   11   14
     0  367   52]
 [   0    0    0    1    0    2    0    1    0    4    9   16    3    9
     2   17  452]]
------ TEST ACCURACY:  weights.50-0.52.hdf5  ------
0.761744966443
[[ 6  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 11  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 66  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 19  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0 13  0  2  0]
 [ 0  0  0  0  0  0  0  0  1  0  3  0  0  0  0  5  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  3  0  0  3  1 13]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  1  0  0  7  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  0  0  1  0  0  4  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  0  0  0  6  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  3  0  9  6]]

>>>>>>>>>>>>>> 6 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/6/weights.42-0.50.hdf5
------ TRAIN ACCURACY:  weights.42-0.50.hdf5  ------
0.946210053702
[[ 151    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1685    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1926    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  875    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0    2    1 1266    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  278    3    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  195    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    2  458    3    8    1   36
     1    0    0]
 [   0    0    0    1    0    2    0    0    0   16  423   19   14    9
     5    6    1]
 [   0    0    0    1    1    4    0    7    0   10   15  415    3    7
    22    8   14]
 [   0    0    0    0    3    0    0    1    1    7    6   12  592    8
     0    6    2]
 [   0    0    0    0    0    0    0    0    0   38    1    1    0  418
     2    1    3]
 [   0    0    0    0    1    1    0    4    0    0    7   40    5    2
   346    7    3]
 [   0    0    0    0    1    0    0    0    1   11   35   13   18   20
     2  356   36]
 [   0    0    0    0    0    2    0    1    0    5    2   28    3   14
     7   19  435]]
------ TEST ACCURACY:  weights.42-0.50.hdf5  ------
0.796116504854
[[ 2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0 43  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 29  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1 10  0  0 39  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3 12  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  9  6  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  1  0 22  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0 17  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0 10  0  4]
 [ 0  0  0  0  0  0  0  0  0  1  0  2  1  1  2  1 12]
 [ 0  0  0  0  0  0  0  0  0  0  0  7  0  0  0  2  9]]

>>>>>>>>>>>>>> 7 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/7/weights.41-0.52.hdf5
------ TRAIN ACCURACY:  weights.41-0.52.hdf5  ------
0.94598374268
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1688    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1932    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  869    0   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    2    0    5 1283    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  287    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  192    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    2  480    1    0    0   29
     0    2    0]
 [   0    0    0    0    0    1    0    0    0   21  432    2   21    6
     4    6    3]
 [   0    0    0    2    0    4    2    6    0   11   19  413    4   11
    14    9   13]
 [   0    1    0    0    1    0    0    2    1    2   14    3  599   11
     0    5    4]
 [   0    0    0    0    0    0    0    0    0   43    3    0    0  406
     0    8    2]
 [   0    0    1    0    3    0    0   10    0    2    8   48    5    0
   337   11    1]
 [   0    0    0    0    0    0    0    1    1   24   39    4   25    9
     1  366   30]
 [   0    0    0    1    0    2    0    2    0   11   10   23    4    7
     4    9  449]]
------ TEST ACCURACY:  weights.41-0.52.hdf5  ------
0.79696969697
[[ 5  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 49  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 34  0  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 33  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  9  0  0  0  0  5  0]
 [ 0  0  0  0  0  0  0  0  0  8  2  0  0  5  0  3]
 [ 0  1  0  0  0  0  0  0  0  0  0 16  0  0  1  0]
 [ 0  0  0  0  0  0  0  0 17  0  0  0  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  9  4]
 [ 0  0  0  0  0  0  1  0  0  0  0  0  0  0  7  4]]

>>>>>>>>>>>>>> 8 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/8/weights.38-0.51.hdf5
------ TRAIN ACCURACY:  weights.38-0.51.hdf5  ------
0.945050114296
[[ 151    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  216    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1670    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1929    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  887    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    2    3 1271    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  281    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  188    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    3  464    5    6    2   19
     0    2    2]
 [   0    0    0    0    0    0    0    0    1   17  436   10   13    2
     4    8    3]
 [   0    0    0    0    1    0    1    7    0   16   19  414    3    6
    11   20   11]
 [   0    0    0    0    1    0    0    2    2    4    9    4  594    8
     0    6    6]
 [   0    0    0    0    0    0    0    0    0   54    2    0    0  394
     2   11    2]
 [   0    0    0    0    2    0    0    5    1    1   16   37    5    0
   340    7    6]
 [   0    1    0    0    0    0    0    0    1   11   42    6   13   10
     3  374   42]
 [   0    2    0    0    0    2    0    0    0    5    5   24    3   16
     5   32  419]]
------ TEST ACCURACY:  weights.38-0.51.hdf5  ------
0.886649874055
[[ 1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  7  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 12  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 24  0  0  0  1  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0 14  2  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  5 10  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  1  0 24  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0 18  0  0  0]
 [ 0  2  0  0  0  0  0  1  3  0  1  1  0  0  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  1  0  5  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  7  0  2  0  2 10]]

>>>>>>>>>>>>>> 9 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/9/weights.49-0.52.hdf5
------ TRAIN ACCURACY:  weights.49-0.52.hdf5  ------
0.948754072378
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  213    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1688    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1925    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  891    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    1 1275    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  287    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  190    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  461    1   13    0   30
     0    1    1]
 [   0    0    0    0    0    3    1    0    0   15  426   16    4    8
     3    5    1]
 [   0    0    0    1    0    6    0    3    0    8   17  429    5    9
    14    5    9]
 [   0    0    0    0    0    0    0    4    0    1    8   15  570   11
     1   14    0]
 [   0    0    0    0    0    0    0    0    0   45    2    2    0  419
     0    3    2]
 [   0    0    0    0    3    4    0    4    0    1    7   45    5    0
   348    2    2]
 [   0    0    0    0    1    0    1    0    0    5   34   12   12   21
     3  360   33]
 [   0    0    0    1    1    2    0    0    0    2    5   38    2   18
     4   12  420]]
------ TEST ACCURACY:  weights.49-0.52.hdf5  ------
0.724637681159
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0 50  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 60  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 18  0  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  8  0  1  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0 13  0  4  2]
 [ 0  0  0  0  0  0  0  2  0  3 19  0  0  3  0  0  2]
 [ 0  0  0  0  2  0  0  0  0  0  3  0  0  0 15  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 36  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  1  0  0  4  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  1  1  2  0  0  7 11  0  6  3]
 [ 0  0  0  0  1  0  0  0  0  9  0  2  0  1  0 10  6]]

>>>>>>>>>>>>>> 10 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/10/weights.31-0.50.hdf5
------ TRAIN ACCURACY:  weights.31-0.50.hdf5  ------
0.937860010473
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  216    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1702    0    4    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1932    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  877    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  729    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0 1294    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  294    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2  185    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    0  488    3    3    2    9
     0    0    1]
 [   0    0    0    0    0    2    0    0    0   24  425    7   18    1
     6   11    5]
 [   0    0    0    0    0    3    0    5    0   22   19  405    7    6
    10   16   11]
 [   0    0    0    0    3    0    0    2    0    2    8   10  608    6
     0    1    3]
 [   0    0    0    0    0    1    0    0    0  119    2    0    2  336
     0    6    1]
 [   0    0    0    0    0    5    1    5    0    2   20   47    5    0
   323    8    4]
 [   0    0    0    0    0    0    0    0    1   23   42    8   13    5
     4  354   51]
 [   0    0    0    0    0    2    0    1    0   16   19   18    2    9
     1   24  425]]
------ TEST ACCURACY:  weights.31-0.50.hdf5  ------
0.731629392971
[[32  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 51  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0 13  0 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 17  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  7 22  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  5  7  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0 22  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  9  0  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  5  6  0  3  0  0  8]
 [ 0  0  0  0  0  0  0  0  0  0 18  0  0  0  0]
 [ 0  0  0  0  0  0  0 15  0  0  0  2  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  3  0  0  9  1  0]
 [ 0  0  0  0  0  0  0  0  4  1  0  0  1  6  0]
 [ 0  0  0  0  0  0  0  3  0  0  0  0  0  1 13]]

>>>>>>>>>>>>>> 11 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/11/weights.09-0.50.hdf5
------ TRAIN ACCURACY:  weights.09-0.50.hdf5  ------
0.869232797258
[[ 145    0    0    0    0    0    0    0    0    0    0    0    0    0
     2    0    0]
 [  19  161    3    0    0    0    2   19    0    0    0    0    0    0
     6    1    0]
 [   0    0 1700    0   10    0    4    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    2 1886    0    0   15    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   55    0  758    0   64    0    0    0    0    0    0    1
     0    0    0]
 [   0    0    0    0    2  719    1    0    0    0    0    0    3    0
     1    0    0]
 [   0    0   44   13    6    7 1196    0    0    0    0    0    0    0
     1    0    0]
 [   4    6    2    0    1    0    1  228   22    1    2    2    0    0
    13    3    3]
 [   1    0    1    0    0    0    0    2  185    0    0    0    0    0
     6    0    0]
 [   0    0    0    0    0    0    0    0    2  427    3    1   16   45
     5    6    6]
 [   0    0    1    0    2    0    5    6    2   42  345    9   13    6
    22   26   12]
 [   0    0    2    0    2    3    1    9    5   11   35  290   18    7
    72   20   37]
 [   0    0    3    0    1    0    0    4    0    5    6   13  586   12
     4    1    2]
 [   1    0    0    0    0    0    0    2    1   99    5    0   11  319
    11    7    9]
 [   1    0    2    0    0    3    3    7    0    4   18   39    7    0
   319    4    9]
 [   0    0    0    0    0    1    0    0    1   26   56    5   28   14
    38  282   48]
 [   0    0    2    0    0    1    1    1    1   16   19   35    9   20
    23   45  345]]
------ TEST ACCURACY:  weights.09-0.50.hdf5  ------
0.65306122449
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  3  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 23  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 82  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 21  0 16  0  6  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  1  0 18  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 15 10  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  5  0  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  0  0  5  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  9  0  0  8  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  6  0  0  7  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 16  3  0  0  5]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0 12  0  0  3]
 [ 0  0  0  0  2  0  0  0  0  0  0  0  7  0  9  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  2  0  2  0  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  3  2  0  8]]

>>>>>>>>>>>>>> 12 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/12/weights.45-0.50.hdf5
------ TRAIN ACCURACY:  weights.45-0.50.hdf5  ------
0.94587880401
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1555    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1910    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  876    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    1 1287    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  294    1    0    0    0    1    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  197    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    3  452    3    8    1   36
     4    1    2]
 [   0    0    0    0    0    1    2    1    0   19  418   22   10   11
     2    7    3]
 [   0    0    0    0    0    6    0    1    0   14   17  419    5   14
    16    6   16]
 [   0    0    0    0    2    0    0    3    0    2    6    8  602    8
     1    6    3]
 [   0    0    0    0    0    0    0    0    0   38    2    0    1  415
     0    3    5]
 [   0    0    0    0    0    3    0    3    0    1   12   40    4    1
   351    6    3]
 [   0    0    0    0    0    0    0    1    1   11   33    5   16   12
     3  374   40]
 [   0    0    0    0    0    2    0    0    0    5    4   23    4   11
    10   17  439]]
------ TEST ACCURACY:  weights.45-0.50.hdf5  ------
0.764
[[  5   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  4   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0]
 [  0   0 147   0   4   0  31   0   0   0   0   0   0   0   0   0]
 [  0   0   1  65   0   0   8   0   0   0   0   0   0   0   0   0]
 [  0   1   0   0  31   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   1   0   0  31   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  36   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   8   0   2   0   5   0   0   2]
 [  0   0   1   0   0   0   0   0   0   6   0   0   2   0   3   3]
 [  0   0   0   0   0   0   0   0   2   0   7   0   0   0   1   2]
 [  0   0   0   0   0   0   0   0   3  10   0   7   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  16   0   0   4]
 [  0   0   0   0   0   0   0   0   0   1   0   0   0   7   2   0]
 [  0   0   0   0   0   0   0   0   0  13   2   0   0   0   2   0]
 [  0   0   0   0   0   0   0   0   0   0   1   0   2   4   1  11]]

>>>>>>>>>>>>>> 13 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/13/weights.49-0.50.hdf5
------ TRAIN ACCURACY:  weights.49-0.50.hdf5  ------
0.947340705635
[[ 150    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1714    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1917    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  879    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    3 1276    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  278    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1  195    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    1  469    5    1    0   25
     3    1    0]
 [   0    0    0    0    0    3    0    1    0   20  433    9   11    4
     4    8    0]
 [   0    0    0    1    0   10    1    4    0   16   15  414    2    9
    13    8   15]
 [   0    0    0    0    0    0    0    5    0    5    9    8  588    9
     0    6    6]
 [   0    0    0    0    0    0    0    0    0   42    4    0    1  423
     1    1    2]
 [   0    0    0    0    0    1    1    6    0    1    6   51    4    0
   334    2   12]
 [   0    0    0    0    0    0    0    0    1   17   40    6   21   10
     3  361   36]
 [   0    0    0    0    0    2    0    0    0   10    6   23    4    9
     9   17  432]]
------ TEST ACCURACY:  weights.49-0.50.hdf5  ------
0.732095490716
[[ 3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  5  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  6 47  0  0 15  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  1  0  0 13  0  0  0  0  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  3  0  5  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  0  1  0  9  3]
 [ 0  0  1  0  0  0  0  0  0  0  3  9  1  0  0  1  3]
 [ 0  0  0  0  0  0  0  0  0  4  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  2  0  0  5  0  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 12  0  3  3]
 [ 0  0  0  0  0  0  0  0  0  4  5  0  0  0  0  0 13]]

>>>>>>>>>>>>>> 14 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/14/weights.48-0.52.hdf5
------ TRAIN ACCURACY:  weights.48-0.52.hdf5  ------
0.947188349855
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1684    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1930    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  859    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    3 1271    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  291    0    0    0    0    0    0
     0    0    1]
 [   0    0    0    0    0    0    0    1  194    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  482    3    2    3   25
     0    0    1]
 [   0    0    0    0    1    2    0    0    0   13  432   13   17    9
     1    3    2]
 [   0    0    0    1    0   10    0    6    1    6   14  418    3    8
    14    8   14]
 [   0    0    0    0    2    0    0    3    0    1    8   14  597    9
     0    4    3]
 [   0    0    0    0    0    0    0    0    0   45    2    0    0  421
     0    3    3]
 [   0    0    0    0    1    1    0    7    1    2    4   51    7    0
   330    4    6]
 [   0    0    0    0    0    0    0    0    1   10   36   10   15   12
     0  363   48]
 [   0    0    0    1    0    2    0    0    0    9    7   35    3    9
     4   12  441]]
------ TEST ACCURACY:  weights.48-0.52.hdf5  ------
0.715053763441
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  4  0  0  1  0  0  0  0  0  0]
 [ 0  0 30  0  5  0 19  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 35  0  5  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0 49  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  4  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  1  1  3  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3 15  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3 11  0  0  2  6  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 15  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  8  9  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  8  0  0  0  0  6  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  2  1  0  1  6]]

>>>>>>>>>>>>>> 15 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/15/weights.26-0.55.hdf5
------ TRAIN ACCURACY:  weights.26-0.55.hdf5  ------
0.93688466948
[[ 144    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1685    0    5    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1897    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  884    0   17    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5   14    4    7 1239    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    0    0  278    4    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    0    0    1  191    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    2  451    5    0    4   52
     0    0    3]
 [   0    0    0    1    0    2    1    0    0   18  420   10   15   11
     3    4    8]
 [   0    0    0    0    2   12    2    8    0    6   18  406    3   13
     9    5   28]
 [   0    0    0    0    3    0    0    2    0    1    6    9  600   12
     0    7    3]
 [   0    0    0    0    0    1    0    0    0   40    6    0    1  410
     0    4    7]
 [   0    0    1    0    2    2    0    5    0    2   18   42    5    1
   322    8    8]
 [   0    0    0    0    0    0    0    1    0    9   41    5   18   11
     3  365   47]
 [   0    0    0    1    0    2    0    0    0    5   14   12    4   15
     4   21  441]]
------ TEST ACCURACY:  weights.26-0.55.hdf5  ------
0.815189873418
[[ 4  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  2  0  0  1  0  0  0  0  0  0]
 [ 0  0 47  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 88  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 14  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 55  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  9  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  6  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  2  3  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0 13  0  0  3  1  0  0]
 [ 0  0  0  0  0  1  0  0  0  0  3  6  0  2  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  1  0  0 10  4  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  7  0  0  2  0  2]
 [ 0  0  0  0  1  0  0  0  0  0  3  0  0  0  0  1  8]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  0  0  0  0 11]]

>>>>>>>>>>>>>> 16 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/16/weights.39-0.52.hdf5
------ TRAIN ACCURACY:  weights.39-0.52.hdf5  ------
0.944351057241
[[ 145    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  198    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1677    0    3    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1907    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  852    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    4 1260    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  274    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  193    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    2  474    5    1    1   24
     0    1    0]
 [   0    0    0    0    0    2    1    1    0   20  427    8   11   11
     3    8    0]
 [   0    0    0    0    0   11    0    6    1   12   19  410    3    8
    19   10   13]
 [   0    1    0    0    0    0    0    6    1    1    9   11  590    9
     0   10    2]
 [   0    0    0    0    0    0    0    0    0   48    5    0    0  410
     0    3    4]
 [   0    0    0    0    1    2    0    5    3    0    9   38    4    3
   355    1    2]
 [   0    0    0    0    1    0    0    0    1    9   45   10   13   10
     3  368   31]
 [   0    0    0    0    0    2    0    0    0    7    9   21    5   15
     4   27  418]]
------ TEST ACCURACY:  weights.39-0.52.hdf5  ------
0.745726495726
[[ 6  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 4  6  0  0  0  0  0  6  1  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 77  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 46  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0 57  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  2  0  0 15  0  0  0  0  0  0  0  1  3]
 [ 0  0  0  0  0  0  0  3  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 17  0  0  1  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3 12  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  3  0  1  6  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  0  1  3  3  0]
 [ 0  0  0  0  0  0  0  1  0  1  0  3  0  0  4  0  2]
 [ 0  0  0  0  0  0  0  0  0 16  0  0  0  0  2  0  4]
 [ 0  0  0  0  0  0  0  0  0  0 18  0  0  0  0  4  4]]

>>>>>>>>>>>>>> 17 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/17/weights.29-0.52.hdf5
------ TRAIN ACCURACY:  weights.29-0.52.hdf5  ------
0.940640481246
[[ 149    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  200    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1629    0    5    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1902    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  883    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  727    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    1    3    6 1260    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  282    1    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1  191    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    2  470    3    1    0   37
     1    1    0]
 [   0    0    0    0    0    3    0    2    1   21  425    6    4   12
     5   14    2]
 [   0    0    0    0    0    7    1   10    0   12   16  394    4   10
    26   13   12]
 [   0    0    0    0    3    0    0    2    0    2   10   10  584   10
     1   15    4]
 [   0    0    0    0    0    0    0    0    0   53    2    0    0  395
     0    9    5]
 [   0    0    1    0    1    0    0    7    0    1   10   31    4    1
   343    9    3]
 [   0    0    0    0    1    0    0    0    2   11   31    5   14   11
     4  386   30]
 [   0    0    1    0    0    2    0    1    0    7   20   25    2   14
     5   27  413]]
------ TEST ACCURACY:  weights.29-0.52.hdf5  ------
0.809421841542
[[  4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0  14   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0]
 [  0   0 103   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  81   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  16   0  12   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  19   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  50   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0  13   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   7   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   0   2   2   0   0   1]
 [  0   0   0   0   0   0   0   0   0   6   8   2   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0  11   5   0   1   4   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  17   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   4   0   0   6   7   0   3   0]
 [  0   0   0   0   0   0   0   0   0   0   0   5   0   0  13   0   5]
 [  0   0   0   0   0   0   0   0   0   3   0   0   0   2   2  11   0]
 [  0   0   0   0   0   0   0   0   0   0   4   3   0   0   1   2   7]]

>>>>>>>>>>>>>> 18 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/18/weights.50-0.52.hdf5
------ TRAIN ACCURACY:  weights.50-0.52.hdf5  ------
0.94678163923
[[ 139    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  207    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1738    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1929    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0  877    0   10    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  730    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    6    0    1 1283    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  281    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  189    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    3  462    3    4    1   38
     2    0    1]
 [   0    0    0    0    0    1    0    0    1   17  432   11    9   12
     4    6    0]
 [   0    0    0    1    0    5    0    5    0    5   26  418    8    8
    15    4   14]
 [   0    0    0    0    0    0    0    3    0    0    7   11  611   10
     0    1    0]
 [   0    0    0    0    0    0    0    0    0   39    1    0    0  423
     0    4    4]
 [   0    0    0    0    0    4    1    3    1    1   13   45    5    0
   341    5    4]
 [   0    0    0    0    0    0    0    0    2    8   40    5   17   15
     0  367   49]
 [   0    0    0    1    0    1    0    0    0    5    9   19    2   12
     8   21  443]]
------ TEST ACCURACY:  weights.50-0.52.hdf5  ------
0.758620689655
[[12  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  8  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 56  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  8  0  8  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0 30  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  1  9  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 11  2  0  0  4  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  0  7  0  2  0  4  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 11  3  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 11  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  7  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  2  1  6]
 [ 0  0  0  0  0  0  0  0  0  0  5  1  0  0  0  5  2]]

>>>>>>>>>>>>>> 19 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/19/weights.37-0.54.hdf5
------ TRAIN ACCURACY:  weights.37-0.54.hdf5  ------
0.942546718818
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1718    0    2    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1914    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  902    0   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0    4 1288    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  288    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  192    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    3  478    2    1    1   27
     0    0    7]
 [   0    0    0    0    0    2    0    2    0   20  421    4   11    8
     1    7   20]
 [   0    0    0    0    0    8    2    9    1    6   17  393    8    6
    16   13   38]
 [   0    0    0    0    3    0    0    1    0    2    7    7  604   12
     2    2    4]
 [   0    0    0    0    0    0    0    0    0   51    2    0    1  405
     0    7    8]
 [   0    1    0    0    5    0    1    8    0    2    5   28   11    0
   336    7   15]
 [   0    4    0    0    0    0    0    3    0    8   40    3   14    9
     1  357   65]
 [   0    4    0    0    0    2    0    1    0    2    7    3    7    9
     0   12  475]]
------ TEST ACCURACY:  weights.37-0.54.hdf5  ------
0.781954887218
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 13  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0 30  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  5  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  1  1  0  0  1  0  8  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  3  2  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  3  0  0  0  4  5  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  4  0  5  0]
 [ 0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  6  4]]

>>>>>>>>>>>>>> 20 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/20/weights.49-0.53.hdf5
------ TRAIN ACCURACY:  weights.49-0.53.hdf5  ------
0.946772767462
[[ 143    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  203    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1582    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1914    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  870    0   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  728    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0    0    6 1265    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  285    3    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  192    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    0    0    1    1  464    5    9    1   29
     2    0    0]
 [   0    0    0    0    0    3    0    0    0   14  436   19   12    4
     6    5    2]
 [   0    0    0    1    0    6    0    2    0   16   17  440    4    5
    17    3    8]
 [   0    0    0    0    3    0    0    0    1    0    6   11  612    5
     1    3    1]
 [   0    0    0    0    0    0    0    0    0   41    4    0    1  418
     1    2    2]
 [   0    0    0    0    2    1    0    4    0    4    5   43    7    0
   357    0    2]
 [   0    0    0    0    0    0    0    0    2   12   39   13   16    4
     8  365   40]
 [   0    0    1    0    0    0    0    0    0    7    1   35    7   10
    14   16  434]]
------ TEST ACCURACY:  weights.49-0.53.hdf5  ------
0.783080260304
[[  6   4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  3   5   0   0   0   0   0   2   0   0   0   0   0   0   3   0   0]
 [  0   0 151   0   2   0   3   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  71   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  29   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  18   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   7  30   0   0  13   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   7   1   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   7   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  11   0   0   0   5   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   9   0   0   1   0   0]
 [  0   0   0   0   0   0   0   0   0   0   1   5   0   0   1   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  18   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   4   0   0   1  10   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   2   0   0   0   7   0   0]
 [  0   0   1   0   0   0   0   0   0   0   0   0   0   1   3   3   6]
 [  0   0   0   0   0   0   0   0   0   0   4   4   0   0   0   1   0]]

>>>>>>>>>>>>>> 21 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/21/weights.32-0.51.hdf5
------ TRAIN ACCURACY:  weights.32-0.51.hdf5  ------
0.939865982073
[[ 146    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  201    0    0    0    0    0    4    0    0    0    0    0    0
     0    0    0]
 [   0    0 1734    0    2    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1924    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  889    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  724    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    5    3    6 1260    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  284    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2  184    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  466    3    0    2   42
     0    1    0]
 [   0    0    0    0    1    3    0    2    0   18  437    9    6    2
     6   12    6]
 [   0    0    1    0    1    8    0    9    0   13   19  396    3   10
    24    8   17]
 [   0    0    0    0    1    0    0    4    0    0   12    7  596    9
     0    8    5]
 [   0    0    0    0    0    0    0    0    0   47    1    0    1  416
     1    4    3]
 [   1    0    0    0    1    0    0    8    4    1    9   41    4    0
   342    6    8]
 [   0    1    0    0    1    0    0    0    0   15   43    6   15   10
     6  358   46]
 [   0    0    0    1    0    2    0    1    0    9    7   16    4   17
    10   17  443]]
------ TEST ACCURACY:  weights.32-0.51.hdf5  ------
0.657142857143
[[ 7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 10  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 12  0  0 49  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  8  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 21  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  7  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  8  0  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  3  0  3  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  1 17  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  7  0  0  2]
 [ 1  0  0  0  0  0  0  0  0  0  3  1  0  2  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  0  1  0  5  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  5]]

>>>>>>>>>>>>>> 22 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/22/weights.37-0.52.hdf5
------ TRAIN ACCURACY:  weights.37-0.52.hdf5  ------
0.946044121556
[[ 136    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  205    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1677    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1923    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  861    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  720    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0    1    6 1264    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  278    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  183    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0    1  449    5   10    3   34
     2    0    2]
 [   0    0    0    0    0    3    0    0    1   15  434    5   12    3
     3   12    2]
 [   0    0    0    0    0    5    0    4    0    9   20  407    5    7
    20    9   12]
 [   0    0    0    0    3    0    0    2    0    1   11    9  594    6
     0   11    1]
 [   0    0    0    0    0    0    0    0    0   35    6    1    1  413
     0    4    3]
 [   0    0    0    0    3    0    1    6    0    1    9   38    5    1
   345    3    5]
 [   0    0    0    0    0    0    0    0    0    9   42    6   13   10
     4  365   41]
 [   0    0    0    0    0    2    0    0    0    4   13   23    7   12
     5   22  424]]
------ TEST ACCURACY:  weights.37-0.52.hdf5  ------
0.706611570248
[[ 3  7  0  0  0  0  0  7  0  0  0  0  0  0  0  0  0]
 [ 2  3  0  0  1  0  0  1  0  0  0  0  0  0  0  2  2]
 [ 0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 58  0  0  4  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 28 15  2  0  0  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  2  0  0 49  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  1  0  0  2  1  0  0  0  1]
 [ 1  4  0  0  0  0  0 10  1  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  8]
 [ 0  0  0  0  0  0  0  0  0  8 10  3  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  5 15  0  0  8  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 23  0  0  0  0]
 [ 0  1  0  0  0  0  0  1  0  9  0  3  3  1  0  2  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  7  0  0  6  1  3]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  0  6 15  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  4 18]]

>>>>>>>>>>>>>> 23 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/23/weights.35-0.53.hdf5
------ TRAIN ACCURACY:  weights.35-0.53.hdf5  ------
0.942158147663
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  208    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1723    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1908    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14    0  860    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    3    1    7 1263    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  279    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  194    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    2  452    6    5    5   35
     0    0    2]
 [   0    0    0    0    0    4    0    0    0   22  423   26   11    7
     2    4    3]
 [   0    0    0    0    0    2    1    2    0   12   14  451    6    7
     7    6    9]
 [   0    0    0    0    3    0    0    2    0    3   11   15  602    5
     0    3    2]
 [   0    0    0    0    0    1    0    0    0   41    1    4    1  414
     0    3    4]
 [   0    0    0    0    1    1    0    5    0    1    5   58    6    1
   343    0    4]
 [   0    0    0    0    0    0    0    0    2    8   42   19   12   13
    11  352   39]
 [   0    0    0    1    0    2    0    0    0    6    5   40    1    9
     3   11  442]]
------ TEST ACCURACY:  weights.35-0.53.hdf5  ------
0.812883435583
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  5  0  0  0  0  0  0  1  0  1  0  0  0  0  0  0]
 [ 0  0 15  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 74  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 23  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 15  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 15  0  0  0  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  9  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  0  8  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  5  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  5  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  1  3 10]
 [ 0  2  0  0  0  0  0  0  0  0  0  1  0  2  4  0  5]]

>>>>>>>>>>>>>> 24 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/24/weights.45-0.55.hdf5
------ TRAIN ACCURACY:  weights.45-0.55.hdf5  ------
0.94811827957
[[ 132    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  197    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1559    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1916    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10    0  824    1   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    2 1265    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  278    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  190    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  480    5    1    0   17
     2    0    1]
 [   0    0    0    0    0    3    0    0    0   18  460    4    2    2
     2    4    1]
 [   0    0    0    1    0    6    0    2    0   11   29  424    0    2
    23    4   10]
 [   0    0    0    0    3    0    0    0    0   11   10    5  595   10
     1    2    3]
 [   0    0    0    0    0    0    0    0    0   54    9    0    0  402
     0    0    4]
 [   0    0    0    0    0    3    2    5    0    2    9   30    1    0
   344    2   11]
 [   0    0    0    0    1    0    0    0    1    7   57    5    5   17
     7  352   42]
 [   0    0    0    0    0    3    0    1    0    5    8   25    0   12
     5   14  444]]
------ TEST ACCURACY:  weights.45-0.55.hdf5  ------
0.736497545008
[[  6   5   0   0   1   0   0   7   0   0   0   0   0   1   1   0   0]
 [  1   9   0   0   0   0   0   1   0   0   0   0   3   2   3   0   0]
 [  0   0 179   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  69   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  53   6   4   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  27   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   1  11   0   0  44   0   0   0   0   0   0   0   0   0   0]
 [  0   7   0   0   1   0   0   4   0   0   0   0   0   0   1   5   0]
 [  0   0   0   0   0   0   0   2   5   0   0   0   0   3   0   0   0]
 [  0   0   0   0   0   0   0   1   0  16   0   0   1   5   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   6   2   7   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   3   0   5   2   3   1   0   0]
 [  0   0   0   0   0   0   0   0   0   1   0   0  19   1   0   0   0]
 [  0   0   0   0   0   0   0   0   0  12   0   0   0   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   6   9   5   0   4   0   1]
 [  0   0   0   0   0   0   0   0   0   0   2   0  12   0   0   1   4]
 [  0   0   0   0   0   0   0   0   0   0   6   3   3   0   0   5   0]]

>>>>>>>>>>>>>> 25 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/25/weights.29-0.51.hdf5
------ TRAIN ACCURACY:  weights.29-0.51.hdf5  ------
0.939116663734
[[ 151    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1684    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1915    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  870    0   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  725    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    1    3    7 1253    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  287    1    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0  191    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  460    0    5    3   40
     0    0    2]
 [   0    0    1    0    0    0    0    1    0   18  448    1   17    2
     1    1    2]
 [   0    0    1    1    0    3    0    4    0    9   17  408   16    8
    27    7   11]
 [   0    0    0    0    0    0    0    5    0   15   10   10  578    9
     0    4    2]
 [   0    1    0    0    0    0    0    2    0   62    6    0    4  382
     0    2    4]
 [   4    0    0    0    0    0    0    8    0    1   10   29    5    2
   343    1   16]
 [   0    1    0    0    0    0    0    0    0    1   46    4   24    2
     6  357   44]
 [   0    0    1    1    0    0    0    0    0   10   24   25    2   10
     6   22  412]]
------ TEST ACCURACY:  weights.29-0.51.hdf5  ------
0.753086419753
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  5  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3 65  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 25  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 21  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 52  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  1  1  0  0  0  1  0  1  0  3]
 [ 0  0  0  0  0  0  0  1  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  4  5  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 11  3  1  1  0  3  0]
 [ 0  0  0  0  0  0  0  3  0  0  5  0  0  2  0  1  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 28  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0 15  1  3  1]
 [ 0  0  0  0  1  0  0  2  0  0  5  2  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  6 16  0  0  5  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2 19]]

>>>>>>>>>>>>>> 26 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/26/weights.33-0.52.hdf5
------ TRAIN ACCURACY:  weights.33-0.52.hdf5  ------
0.942107564495
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1707    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1926    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  867    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0    3    2 1262    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1  290    1    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    0    1    2  196    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    0    0    1    0  471    1    5    1   32
     0    1    0]
 [   0    0    0    0    0    0    0    0    0   15  433   18    8    5
     2    8    1]
 [   0    0    1    1    0    3    1    4    0   11   15  420    5    7
    22    6   11]
 [   0    0    0    0    0    0    0    0    0   11    4   11  585   10
     1   13    1]
 [   0    0    0    0    0    0    0    0    0   50    4    2    0  419
     0    0    2]
 [   0    0    0    0    3    0    0    1    0    2   10   45    5    0
   334   11   10]
 [   0    1    0    0    1    0    0    0    1   10   55    6   11   13
     6  364   26]
 [   0    0    1    1    0    2    0    0    0    8   14   31    4   14
     1   29  413]]
------ TEST ACCURACY:  weights.33-0.52.hdf5  ------
0.797619047619
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0 29  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 48  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  4 15  1  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  1  0  4 11  0  0  0  1  2]
 [ 0  0  0  0  3  0  0  4  0  8  0  6  0  0  4  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  4  0  0  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  0  0  4 11]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  4  2 10]]

>>>>>>>>>>>>>> 27 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/27/weights.49-0.50.hdf5
------ TRAIN ACCURACY:  weights.49-0.50.hdf5  ------
0.94673674989
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  214    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1699    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1914    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  894    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  715    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0    1    2 1274    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  288    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  199    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  465    5   11    1   22
     0    0    5]
 [   0    0    0    0    0    2    0    0    0   21  445    4   14    4
     1    2    4]
 [   0    0    0    0    0    9    1    4    0   11   23  414    7    7
    11    7   10]
 [   0    0    0    0    3    0    0    2    0   10   12    9  593    5
     0    4    2]
 [   0    0    0    0    0    0    0    0    0   49    4    0    0  408
     0    0    5]
 [   4    0    0    0    0    3    0    3    0    2    7   54    5    0
   335    3    7]
 [   0    0    0    6    1    0    0    0    1   11   37    3   21    9
     2  359   47]
 [   0    0    0    0    0    2    0    0    0    7   11   12   10   12
     3   23  438]]
------ TEST ACCURACY:  weights.49-0.50.hdf5  ------
0.800561797753
[[ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 39  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2 69  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 31  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  5  4  2  0 34  0  0  0  0  0  0  0  0  0  0]
 [ 1  2  0  0  0  0  1  3  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 11  1  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  7  0  0  9  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  0  9  0  0  0]
 [ 0  0  0  0  1  0  0  0  0  0  3  1  0  0  1  3  2]
 [ 0  0  0  0  0  0  0  0  0  0 14  0  0  1  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  0 14]]

>>>>>>>>>>>>>> 28 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/28/weights.42-0.49.hdf5
------ TRAIN ACCURACY:  weights.42-0.49.hdf5  ------
0.94011348756
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  215    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1707    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1927    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  887    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    3   13    6 1253    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  287    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  200    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    1  479    1    2    3   19
     0    1    6]
 [   0    0    0    0    0    4    0    0    0   22  420   15   23   10
     0    0    1]
 [   0    0    0    0    1    8    0    6    0   16   18  412   10    3
    15    3   17]
 [   0    0    0    0    3    0    0    0    0    9    8    8  603    4
     0    1    2]
 [   0    0    0    0    0    0    0    0    0   60    3    0    0  402
     0    3    6]
 [   0    0    0    0    1    1    0    9    0    2   11   63    6    2
   321    2    8]
 [   0    0    0    0    0    0    0    0    1   24   42   10   25    7
     8  351   29]
 [   0    0    0    1    0    2    0    0    2   10    9   30    3   11
     0   20  430]]
------ TEST ACCURACY:  weights.42-0.49.hdf5  ------
0.886075949367
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 30  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1 57  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 31  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 24  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  1  0 40  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 16  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0 16  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0 14  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0 21  2  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  8  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1 15]
 [ 0  0  0  0  0  0  0  0  1  3  0  3  0  0  9]]

>>>>>>>>>>>>>> 29 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/29/weights.49-0.54.hdf5
------ TRAIN ACCURACY:  weights.49-0.54.hdf5  ------
0.948116560057
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  206    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1625    0    6    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1916    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  885    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0    0    6 1276    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  282    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  192    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  470    5    0    1   22
     0    0    0]
 [   0    0    0    0    0    2    0    0    0   22  428   13   10    2
     2    4    0]
 [   0    0    0    0    0    1    0    2    0   18   14  411    3    6
    33    7    9]
 [   0    0    0    0    0    0    0    3    0   13    9    1  593    9
     0    2    0]
 [   0    4    0    0    0    0    0    1    0   56    0    1    2  390
     0    4    0]
 [   0    0    0    0    2    0    0    5    0    0    6   36    4    0
   338   14    9]
 [   0    0    0    0    0    0    0    0    0   10   35   12   19   12
     7  372   26]
 [   0    0    0    0    0    0    0    1    0    9   11   31    3    5
     0   20  422]]
------ TEST ACCURACY:  weights.49-0.54.hdf5  ------
0.631067961165
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  7  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0 78 14  0  0 14  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  6  4 13  0  7  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  3  0  0 35  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  9  0  0  1  0  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  6  0  2  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 26  0  0  1  2  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  1 20  2  3  0  0  1  0]
 [ 0  0  0  0  0  2  0  0  0  6  4  1  5  0  0  2  2]
 [ 0  0  0  0  0  0  0  0  0  0  2  7 18  0  0  3  1]
 [ 0  0  0  0  0  0  0  0  0 15  4  0  1  2  0  1  3]
 [ 0  0  0  0  0  0  0  0  0  2  2 15  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  1  1 12  2  3  0  0  1  0]
 [ 0  0  0  0  0  2  0  0  0  3  0  0  2  5  0 12  8]]

>>>>>>>>>>>>>> 30 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_kpca_conv1d_10/30/weights.31-0.50.hdf5
------ TRAIN ACCURACY:  weights.31-0.50.hdf5  ------
0.939716624131
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1679    0    7    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1924    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  888    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    3    4    7 1266    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  290    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1  196    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    1  455    3    0    2   26
     0    5    6]
 [   0    0    0    0    0    0    0    0    0    7  444   14    7    1
     0    7    7]
 [   0    0    0    1    0    3    1    7    0    9   23  413    3    7
    16    8    9]
 [   0    0    0    0    0    0    0    5    0   12   12    9  575   14
     0    3    4]
 [   1    3    0    0    0    0    0    2    0   52    7    1    2  391
     0    4    2]
 [   0    0    0    0    0    0    1    8    0    0   13   61    5    0
   308    6   12]
 [   0   10    0    0    1    0    0    0    0   14   54    8   21    9
     4  335   39]
 [   0    4    0    0    0    2    0    0    0    3   12   29    1    8
     7   14  430]]
------ TEST ACCURACY:  weights.31-0.50.hdf5  ------
0.779411764706
[[ 1  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 59  0  2  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  2  0 40  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 23  2  5  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0 12  7  1  3  1  0  0  0]
 [ 0  0  0  0  2  0  0  0  0  2 15  2  1  0  2  2]
 [ 0  0  0  0  0  0  0  0  0  3  2 20  0  0  0  2]
 [ 0  0  0  0  0  0  0  0 11  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 20  0  0]
 [ 0  0  0  0  0  0  0  0  2  0  1  0  1  1  9  4]
 [ 0  0  0  0  0  0  0  0  5  0 12  1  1  0  0  5]]
[0.6510416666666666, 0.7324185248713551, 0.8289473684210527, 0.49517684887459806, 0.761744966442953, 0.7961165048543689, 0.796969696969697, 0.8866498740554156, 0.7246376811594203, 0.731629392971246, 0.6530612244897959, 0.764, 0.7320954907161804, 0.7150537634408602, 0.8151898734177215, 0.7457264957264957, 0.8094218415417559, 0.7586206896551724, 0.7819548872180451, 0.7830802603036876, 0.6571428571428571, 0.7066115702479339, 0.8128834355828221, 0.7364975450081833, 0.7530864197530864, 0.7976190476190477, 0.800561797752809, 0.8860759493670886, 0.6310679611650486, 0.7794117647058824]
0.750816513338
0.0773519070291

Process finished with exit code 0

'''