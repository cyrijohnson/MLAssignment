import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import numpy as np
import cPickle as pickle
from keras.models import Model, load_model
from keras.initializers import Constant, TruncatedNormal
from keras.layers import Input, Dense, Conv1D, Flatten, Dropout, Activation, BatchNormalization
from keras.layers.merge import concatenate
from keras.optimizers import Adam
from keras.callbacks import ModelCheckpoint
import keras.backend as K
from keras import losses
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix

# Load Sparse PCA + Signal Magnitude Vector

X_spca = pickle.load(open("data/X_unimib_spca.p", "rb"))
X_smv = pickle.load(open("data/X_unimib_smv.p", "rb"))
X = np.concatenate((X_spca, X_smv), axis=1)

y = pickle.load(open("data/y_unimib_smv.p", "rb"))

n_classes = 17


# Below builds 1D CNN.

for i in range(30):
    test = y.loc[y[1] == i+1]
    # print y_sub
    test_index = test.index.values
    # print len(test_index)

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index], y_values[test_index]
    y_train = np.eye(n_classes)[y_train - 1]
    print X_train.shape # (11188, 302)

    # input layer
    input_signal = Input(shape=(302, 1))
    print K.int_shape(input_signal)

    # define initial parameters
    b_init = Constant(value=0.0)
    k_init = TruncatedNormal(mean=0.0, stddev=0.01, seed=2018)

    # first feature extractor
    conv11 = Conv1D(16, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn11 = BatchNormalization()(conv11)
    actv11 = Activation('relu')(bn11)
    conv12 = Conv1D(32, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv11)
    bn12 = BatchNormalization()(conv12)
    actv12 = Activation('relu')(bn12)
    flat1 = Flatten()(actv12)

    # second feature extractor
    conv21 = Conv1D(16, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn21 = BatchNormalization()(conv21)
    actv21 = Activation('relu')(bn21)
    conv22 = Conv1D(32, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv21)
    bn22 = BatchNormalization()(conv22)
    actv22 = Activation('relu')(bn22)
    flat2 = Flatten()(actv22)

    # third feature extractor
    conv31 = Conv1D(16, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn31 = BatchNormalization()(conv31)
    actv31 = Activation('relu')(bn31)
    conv32 = Conv1D(32, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv31)
    bn32 = BatchNormalization()(conv32)
    actv32 = Activation('relu')(bn32)
    flat3 = Flatten()(actv32)

    # merge feature extractors
    merge = concatenate([flat1, flat2, flat3])

    # dropout & fully-connected layer
    do = Dropout(0.9, seed=2018)(merge)
    output = Dense(n_classes, activation='softmax', bias_initializer=b_init, kernel_initializer=k_init)(do)

    # result
    model = Model(inputs=input_signal, outputs=output)

    # summarize layers
    print(model.summary())

    new_dir = 'model/unimib_smv_spca_conv1d_10/' + str(i+1) + '/'
    if not os.path.exists(new_dir):
        os.makedirs(new_dir)

    fpath = new_dir + 'weights.{epoch:02d}-{val_acc:.2f}.hdf5'
    cp_cb = ModelCheckpoint(fpath, monitor='val_acc', verbose=1, save_best_only=True, mode='auto', period=1)

    adam = Adam(lr=0.001)
    model.compile(loss=losses.categorical_crossentropy, optimizer=adam, metrics=['accuracy'])
    model.fit(np.expand_dims(X_train, axis=2), y_train, batch_size=64, epochs=50, verbose=2, validation_split=0.10,
              callbacks=[cp_cb], shuffle=True)

    del model
    K.clear_session()


# Below calculates average test data accuracy (LOSO CV).

acc = []

for i in range(30):
    test = y.loc[y[1] == i+1]
    test_index = test.index.values

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index] - 1, y_values[test_index] - 1

    print "\n>>>>>>>>>>>>>>", str(i+1), "-fold <<<<<<<<<<<<<<<<"
    path_str = 'model/unimib_smv_spca_conv1d_10/' + str(i+1) + '/'
    for path, dirs, files in os.walk(path_str):
        dirs.sort()
        files.sort()
        top_acc = []
        top_acc.append(files[-1])
        files = top_acc
        for file in files:
            print "========================================"
            print os.path.join(path, file)
            model = load_model(os.path.join(path, file))
            pred = model.predict(np.expand_dims(X_train, axis=2), batch_size=32)
            print "------ TRAIN ACCURACY: ", file, " ------"
            print accuracy_score(y_train, np.argmax(pred, axis=1))
            print confusion_matrix(y_train, np.argmax(pred, axis=1))
            pred = model.predict(np.expand_dims(X_test, axis=2), batch_size=32)
            print "------ TEST ACCURACY: ", file, " ------"
            print accuracy_score(y_test, np.argmax(pred, axis=1))
            print confusion_matrix(y_test, np.argmax(pred, axis=1))

            del model
            K.clear_session()

    acc.append(accuracy_score(y_test, np.argmax(pred, axis=1)))

print acc
print np.mean(acc)
print np.std(acc)

'''
-----
[0.6536458333333334, 0.5694682675814752, 0.8388157894736842, 0.45016077170418006, 0.7013422818791947, 0.8131067961165048, 0.7606060606060606, 0.7984886649874056, 0.6497584541062802, 0.6837060702875399, 0.7627551020408163, 0.858, 0.6525198938992043, 0.7043010752688172, 0.7949367088607595, 0.7243589743589743, 0.7366167023554604, 0.7275862068965517, 0.8233082706766918, 0.7592190889370932, 0.6, 0.6301652892561983, 0.7239263803680982, 0.6808510638297872, 0.7382716049382716, 0.7410714285714286, 0.7752808988764045, 0.8544303797468354, 0.6213592233009708, 0.7377450980392157]
0.718860079343
0.088854008434
-----

/usr/bin/python2.7 /mnt/0cdd1a7e-3686-4cf7-9055-145eb5fe70f3/hcilab/OSS/electronicsletters2018/unimib/unimib_smv_spca_conv1d_10.py
/home/hcilab/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.

>>>>>>>>>>>>>> 1 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/1/weights.35-0.43.hdf5
------ TRAIN ACCURACY:  weights.35-0.43.hdf5  ------
0.897514709757
[[ 144    1    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0  197    1    0    0    0    0    8    0    0    0    0    0    0
     0    0    0]
 [   0    0 1677    0    2    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8 1906    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   46    0  814    0   30    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  710    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   16    1    2    7 1256    0    0    0    0    0    0    0
     0    0    0]
 [   1    2    3    0    0    0    0  278    2    0    0    0    0    0
     1    1    0]
 [   0    2    1    0    0    0    0   10  180    0    0    0    0    4
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  454    3    2    4   45
     0    7    1]
 [   0    0    0    0    0    4    2    3    0   21  339   32   27    5
     1   32   28]
 [   0    0    1    0    1   11    2    3    0   13   24  394   27   11
    14    8    2]
 [   0    2    2    0    0    0    0    4    0    7    7    8  545   16
     9   39    3]
 [   0    0    0    0    0    0    0    0    0   56    1    1    5  397
     3    6    1]
 [   0    0    5    3    8    0   14    2    1    0   14   56    5    4
   286   15    6]
 [   0    0    0    0    0    1    1    0    2   23   37   15    9    9
     6  379   11]
 [   0    0    0    0    0    3    1    0    0   17   58   28   26    9
    12   98  264]]
------ TEST ACCURACY:  weights.35-0.43.hdf5  ------
0.653645833333
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0 28  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 27  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 18  0  0  0 24  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  5  1  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  9  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  8  0  0  1  2  4]
 [ 0  0  0  0  0  5  0  0  0  0  7  1  1  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 18  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  6  0  0  7  1]
 [ 0  0  0  0  0  1  0  0  0  0  1  1  8  0  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  5  0  8  0  4  0]
 [ 0  0  0  0  0  0  0  1  0  3  6  3  2  0  2  1  0]]

>>>>>>>>>>>>>> 2 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/2/weights.48-0.42.hdf5
------ TRAIN ACCURACY:  weights.48-0.42.hdf5  ------
0.911780479085
[[ 142    1    0    0    0    0    0    0    3    0    0    0    0    0
     0    0    0]
 [   0  197    0    0    1    0    0    6    0    0    0    0    0    0
     0    0    0]
 [   0    0 1573    0   16    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1904    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  867    0   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    1   28    7 1234    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  284    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    4  189    0    0    2    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  474    2    4    6    9
     0    8    3]
 [   0    0    0    1    0    0    0    1    0   21  345   51   23    1
     0   13   32]
 [   0    0    0    1    2    2    1    1    0   19   16  436   12    1
     3    3    5]
 [   0    3    0    0    0    0    0    5    0    4    1   10  562   11
     3   14    8]
 [   0    1    0    0    0    0    0    0    0   97    0   12    6  328
     3    4    1]
 [   0    0    0    0   17    1    6    0    0    0    3   84    7    0
   282    2    7]
 [   0    0    0    0    2    0    0    0    1   26   35   41   21    1
     6  313   40]
 [   0    0    0    0    0    0    0    2    0    9   27   58   24   12
     5   16  354]]
------ TEST ACCURACY:  weights.48-0.42.hdf5  ------
0.569468267581
[[ 7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  8  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0 52  0 91  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 74  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 37  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 29  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  2  5 42  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  2  0  0  7  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 18  0  0  3  0  0  0  0]
 [ 0  0  0  0  3  0  0  0  0  0  0  2 12  0  3  2  1]
 [ 0  0  0  0  2  7  0  3  0  0  2 10  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1 34  0  0  5  0]
 [ 0  1  0  0  0  0  0  0  0  8  0  1  7  9  0  6  0]
 [ 4  2  0  0  0  5  0  0  0  2  0  0  9  0  1  2  0]
 [ 1  0  0  0  1  4  0  0  0  0  1  5  8  0  1  1  5]
 [ 0  0  0  0  0  0  0  2  0  0  4  5 15  0  0  1  0]]

>>>>>>>>>>>>>> 3 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/3/weights.47-0.43.hdf5
------ TRAIN ACCURACY:  weights.47-0.43.hdf5  ------
0.914624574867
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  207    0    0    1    0    0    6    0    0    1    0    0    0
     0    0    0]
 [   0    0 1711    0    5    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1906    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   20    0  847    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0  715    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    3    4    7 1263    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    2    0    0    0    0  279    2    0    0    0    0    0
     0    0    1]
 [   0    0    1    0    0    0    0    6  182    0    2    2    0    3
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  421    2    0   21   57
     0    7    5]
 [   0    0    0    0    1    0    0    0    0   15  355   16   41   13
     5   24   29]
 [   0    0    0    0    0    1    0    0    0    5   17  426   34   10
     4    5   14]
 [   0    1    1    0    0    0    0    1    0    3    3    3  597    9
     2   23    4]
 [   0    0    0    0    0    0    0    0    0   55    0    2   19  389
     0    6    0]
 [   0    1    1    0   13    1    9    0    0    0    2   63    2    4
   310    7   14]
 [   0    0    0    0    0    0    0    0    0   21   33    7   41   10
     6  354   31]
 [   0    0    0    0    0    0    0    0    0    8   31   22   33   18
     7   28  380]]
------ TEST ACCURACY:  weights.47-0.43.hdf5  ------
0.838815789474
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 73  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  2  0 37  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  4  0  0  2  2  0]
 [ 0  0  0  0  0  0  1  0  0  0  0  9  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 11  0  1  2  0]
 [ 0  0  0  0  0  0  0  0  0  2  1  0  0  8  0  2  0]
 [ 1  3  0  0  0  0  0  0  0  0  0  0  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  3  0  0  4  1]
 [ 0  0  0  0  0  0  0  0  0  0  2  2  0  0  0  3  0]]

>>>>>>>>>>>>>> 4 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/4/weights.40-0.45.hdf5
------ TRAIN ACCURACY:  weights.40-0.45.hdf5  ------
0.90479930192
[[ 150    1    0    0    0    0    0    1    0    0    0    0    0    1
     0    0    0]
 [   0  207    0    0    1    0    1    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1719    0    3    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1930    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   68    0  787    0   37    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    4    0  705   10    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   24   11    0    6 1256    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    1    0    0    0    0  281    1    0    0    0    1    0
     1    0    0]
 [   0    1    0    0    0    0    1    6  174    0    0    4    0    2
     0    3    0]
 [   0    0    0    0    0    0    0    2    0  405    3    1   11   92
     0    4    4]
 [   0    0    0    1    1    0    0    2    0   14  345   27   30   10
     3   21   38]
 [   0    0    0    1    0    0    0    2    0    1   29  401   27   20
     3    9   10]
 [   1    1    0    0    0    0    0    5    0    0    7    3  564   17
     1   37    7]
 [   0    0    0    0    0    0    0    0    0   30    0    6   10  408
     1    9    3]
 [   1    0    5    4    4    0   12    0    1    0    9   44    4    4
   297   21   15]
 [   0    0    1    0    0    0    0    0    0   13   31   12   10   13
     6  374   37]
 [   0    0    0    0    0    0    0    0    0    8   35   26   17   13
     6   41  366]]
------ TEST ACCURACY:  weights.40-0.45.hdf5  ------
0.450160771704
[[ 2  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  0  0  1  8  0  0  1  0  0  0  0  0  0]
 [ 0  0 54  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  0  7  0  3  7  0  0  0  2  0  0  1  0  0]
 [ 0  0  0  0 11  0  0  0  0  0  0 16  0  0  0  0]
 [ 0  0  0  0  0 15 12  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  6  0  0  0  0  0  0  0  1  0]
 [ 0  0  0  3  0  0  0  3  0  2  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  3  1  0  0  0]
 [ 0  0  5  0  0  0  0  0  3  1  0  5  2  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0 14  3  0  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  7  1  0  4  1]
 [ 0  3  0  0  0  0  0  0  5  0  0  3  2  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  4  3  3  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  1  0  1  3  8  0  3  0]
 [ 0  0  0  0  0  0  0  0  3  2  2  5  3  0  1  6]]

>>>>>>>>>>>>>> 5 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/5/weights.48-0.43.hdf5
------ TRAIN ACCURACY:  weights.48-0.43.hdf5  ------
0.907086202388
[[ 144    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  195    1    0    0    0    0    7    0    0    1    0    0    0
     0    0    0]
 [   0    0 1716    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1914    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   92    0  780    0   30    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   33    1    1    7 1250    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0    0    0    0  276   12    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    2  195    0    0    0    0    1
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  435    1    1   17   52
     0    3    2]
 [   0    0    1    1    0    1    0    1    0   21  378   12   32    8
     8    7   32]
 [   0    0    7    0    0    2    1    1    0   14   30  386   27   14
     8    7    8]
 [   1    0    0    0    0    0    0    5    0    3    1    3  597   11
     2   16    7]
 [   0    0    0    0    0    0    0    0    0   51    1    3   17  399
     1    2    0]
 [   0    0   17    3    1    1    9    1    0    1   13   39   10    5
   310    7    8]
 [   0    0    2    0    0    0    0    0    2   25   37   12   33    9
     4  343   31]
 [   0    0    0    0    0    1    0    0    0   15   36   21   27   18
    11   24  363]]
------ TEST ACCURACY:  weights.48-0.43.hdf5  ------
0.701342281879
[[ 1  6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  0  0  1  0  1  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 66  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0 18  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  2  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  7  8  0  0  0]
 [ 0  0  1  0  0  0  0  0  0  0  0  0  0  4  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 10  0  0  7  3  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 12  1  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  3  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  1  2  1  2  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 15  3]]

>>>>>>>>>>>>>> 6 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/6/weights.30-0.40.hdf5
------ TRAIN ACCURACY:  weights.30-0.40.hdf5  ------
0.893740646184
[[ 150    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  197    0    0    1    0    0   11    0    0    1    0    0    0
     0    0    0]
 [   0    0 1660    2   14    0   10    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1924    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  852    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2   24    4   13 1230    0    0    0    0    1    0    0
     0    0    0]
 [   0    0    0    0    1    0    0  279    1    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    1   15  175    0    0    0    0    1
     1    1    0]
 [   0    2    0    0    0    0    0    0    0  455    3    3    5   40
     0    1    1]
 [   0    0    0    0    1    0    0    5    0   33  331   42   32    7
    11    7   27]
 [   0    0    0    0    0    0    0    3    1   13   19  397   34   14
    15    2    9]
 [   0    2    0    0    0    0    0    5    0   14   13   10  547    7
     7   16   17]
 [   1    1    0    0    0    0    0    1    0   79    3    5    5  359
     3    4    3]
 [   0    0    0    2    7    0   11    3    0    0    3   78    2    2
   296    1   11]
 [   0    0    0    0    0    1    0    6    2   32   45   35   23   18
    22  261   48]
 [   0    0    0    0    0    0    0    4    0   28   45   45   20   20
    19   13  322]]
------ TEST ACCURACY:  weights.30-0.40.hdf5  ------
0.813106796117
[[ 2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 44  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 29  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 50  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 18  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  7  3  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  4  0  7  0  6  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  1 19  1  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0 16  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  6  0  6  2]
 [ 0  0  0  0  0  0  0  0  0  0  2  2  0  1  0  8  7]
 [ 0  0  0  0  0  0  0  0  0  0  5  1  0  0  0  1 11]]

>>>>>>>>>>>>>> 7 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/7/weights.46-0.42.hdf5
------ TRAIN ACCURACY:  weights.46-0.42.hdf5  ------
0.904291582904
[[ 150    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  206    0    0    0    0    0    2    0    0    0    2    0    0
     0    0    1]
 [   0    0 1677    1    3    1    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1932    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   23    1  828    2   31    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0  725    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1   25    0    7 1257    0    0    0    0    0    0    0
     1    0    0]
 [   0    2    0    0    0    0    0  283    1    0    0    2    0    0
     0    0    0]
 [   0    1    0    0    0    0    1    5  172    0    0    9    0    2
     2    0    0]
 [   0    2    0    0    0    0    0    0    0  448    0    6    9   38
     0   10    3]
 [   0    1    0    1    0    0    0    1    0   14  260   71   36    8
    12   16   76]
 [   0    0    0    1    0    2    0    2    0    3    4  441   18    9
    15    7    6]
 [   0    2    0    0    0    0    0    2    0    2    0   13  585    9
     5    5   20]
 [   1    0    0    0    0    0    0    0    0   60    0    6    9  370
     3   13    0]
 [   0    0    2    1    2    0   13    2    0    0    0   65   10    0
   317    1   13]
 [   0    0    0    1    0    0    0    0    0   18    8   29   38    6
    27  311   62]
 [   0    0    0    0    0    0    0    0    0   13    5   65   13   12
    17   13  384]]
------ TEST ACCURACY:  weights.46-0.42.hdf5  ------
0.760606060606
[[ 5  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 33  6  0  0 10  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 33  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  1  0  0  6  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  2  4  5  0]
 [ 0  0  0  0  0  0  0  0  0  0 11  1  0  4  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 17  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  1  0 17  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  0  0  2  7]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  2  2  8]]

>>>>>>>>>>>>>> 8 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/8/weights.49-0.43.hdf5
------ TRAIN ACCURACY:  weights.49-0.43.hdf5  ------
0.919992966415
[[ 150    0    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  214    0    0    0    0    0    1    0    0    1    0    0    0
     0    0    0]
 [   0    0 1654    0    8    0    9    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1927    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0  861    1   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    8 1268    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  277    5    0    0    0    0    0
     0    1    0]
 [   0    0    1    0    0    0    0    1  185    0    0    0    0    1
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  428    2    2   16   46
     0    4    3]
 [   0    0    0    0    0    0    0    2    0   15  360   19   31   11
     4   29   23]
 [   0    0    1    0    1    2    0    2    0    9   26  398   29    6
    12   15    8]
 [   0    3    0    0    0    1    0    5    0    7    7    2  576    9
     0   20    6]
 [   0    0    0    0    0    0    0    0    0   49    0    2    8  394
     0   12    0]
 [   0    0    4    1    4    1   12    0    0    1   11   51    6    7
   297   17    8]
 [   0    0    0    0    0    0    0    0    0   18   30   12   17   15
     4  387   20]
 [   0    0    0    0    0    1    0    0    0   17   30   14   22   20
     3   39  367]]
------ TEST ACCURACY:  weights.49-0.43.hdf5  ------
0.798488664987
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 52  0  3  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0  0  0 44  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  7  3  0  0  0  0  0  0  2  0]
 [ 0  0  0  0  0  0  1  0  6  0  0  3  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  0 17  0  0  0  3  0  1  5]
 [ 0  0  0  0  0  0  0  1  0  0  8  1  0  0  0  1  6]
 [ 0  0  0  0  0  0  0  1  0  0  2 14  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 22  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  0 14  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  2  1  3  4  2  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  1  1  1  4  2]
 [ 0  0  0  0  0  0  0  0  0  0  1  2  0  0  4  8  6]]

>>>>>>>>>>>>>> 9 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/9/weights.41-0.43.hdf5
------ TRAIN ACCURACY:  weights.41-0.43.hdf5  ------
0.902350972968
[[ 151    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  205    1    0    1    0    0    5    0    0    0    0    0    0
     0    0    1]
 [   0    0 1676    0    3    1    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1925    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   38    1  823    9   30    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  720    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    4    1   10 1255    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    6    0    1    0    0  264    5    0    1    3    3    1
     1    1    1]
 [   0    0    1    0    0    0    0    2  180    0    0    3    0    1
     0    1    2]
 [   0    2    0    0    0    0    0    0    0  449    2    1   12   38
     0    4    1]
 [   0    0    0    1    0    1    0    0    0   18  302   40   41   15
     4   14   46]
 [   0    0    1    1    0    1    2    0    0    9   20  416   26   11
     5    6    8]
 [   0    1    1    0    0    0    0    1    0    3    1    7  571   15
     3   11   10]
 [   0    0    0    0    0    0    0    0    0   71    0    3   10  386
     0    2    1]
 [   1    0    7    0    2    1   13    0    0    0    4   83    8    4
   275    8   15]
 [   0    0    0    2    0    0    1    0    0   19   43   16   34   18
     8  294   47]
 [   0    0    0    0    1    0    0    0    0   13   29   37   27   20
     5   17  356]]
------ TEST ACCURACY:  weights.41-0.43.hdf5  ------
0.649758454106
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 50  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 60  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0 12  0  7  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  4  0  1  0  1  1  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  9  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  0 12  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  6  1  7  0  0  7  8]
 [ 0  0  0  1  2  0  1  0  0  0  3  2  0  0  6  5  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 37  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0  5  0  2  0]
 [ 0  0  0  0  2  0  2  0  0  0  5  0  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  5  0  6  9  3  2  2]
 [ 0  0  0  0  0  0  0  0  0  5  2  5  7  0  0  6  4]]

>>>>>>>>>>>>>> 10 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/10/weights.30-0.40.hdf5
------ TRAIN ACCURACY:  weights.30-0.40.hdf5  ------
0.883574794903
[[ 148    4    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  208    1    0    1    0    0    6    0    0    0    0    0    0
     0    0    0]
 [   0    0 1702    0    4    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9 1925    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   37    0  847    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    2  726    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0  125   19   14    0 1137    0    0    0    0    0    0    0
     0    0    0]
 [   0    7    1    0    1    0    0  271   13    0    0    0    0    0
     0    1    0]
 [   0    1    1    0    0    0    0    9  175    0    1    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  373    0    2   55   58
     0   15    2]
 [   0    0    0    0    2    0    0    3    0   17  319   38   33    6
     4   27   50]
 [   0    0    1    0    3    1    0    4    1    6   17  391   39   12
    13    4   12]
 [   0    6    0    0    0    0    0    3    0    1    1    2  590    8
     2   15   15]
 [   0    2    0    0    0    0    0    0    1   52    3    4   24  361
     3   16    1]
 [   0    2    6    4   15    0    4    2    1    0    1   63   10    2
   291   10    9]
 [   0    0    0    1    1    0    0    1    2   22   39   21   39    3
     8  321   43]
 [   0    0    3    0    1    0    0    0    0    9   36   35   31   12
     7   44  339]]
------ TEST ACCURACY:  weights.30-0.40.hdf5  ------
0.683706070288
[[ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 32  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 51  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 13  0 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 17  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  7 21  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 10  0  0  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  0 17  0  0  5  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  6  1  0  5  0  0]
 [ 0  0  1  0  0  0  0  0  0  0 17  4  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0 11  0  0  3  2]
 [ 0  0  0  0  0  0  0  0  6  0  0  4  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  3  0  3  5  0]
 [ 0  0  0  0  0  0  0  0  2  0 11  3  0  0  0  1]]

>>>>>>>>>>>>>> 11 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/11/weights.43-0.42.hdf5
------ TRAIN ACCURACY:  weights.43-0.42.hdf5  ------
0.881536163107
[[ 145    1    0    0    0    0    0    0    0    0    0    0    0    1
     0    0    0]
 [   1  194    2    0    2    0    2    9    1    0    0    0    0    0
     0    0    0]
 [   0    0 1703    0    5    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6 1895    0    1    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   49    0  774    0   55    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    4    0  719    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    4    1    7 1243    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    5    0    3    0    0  267    5    0    3    0    0    0
     1    0    1]
 [   0    1    0    0    1    0    1    9  175    1    0    1    0    3
     1    0    2]
 [   0    2    0    0    0    0    0    0    0  412    2    3   14   72
     0    5    1]
 [   0    0    1    1    1    0    0    0    0   16  299   48   35   15
     5   27   43]
 [   0    0    1    0    0    3    0    2    0   13   24  403   29   14
     7    7    9]
 [   0    4    0    0    0    0    0    4    0    9   10   10  559   10
     3   15   13]
 [   1    0    0    0    0    0    0    0    0   51    3    5   15  382
     3    3    2]
 [   0    0   11    0    7    0   11    0    0    0   28   66    7   14
   240   11   21]
 [   0    0    0    1    0    0    0    0    0   21   70   22   31   20
     9  275   50]
 [   0    0    0    0    0    0    0    0    0   13   49   40   18   17
     1   34  346]]
------ TEST ACCURACY:  weights.43-0.42.hdf5  ------
0.762755102041
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 23  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 82  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  5  0 37  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  4  0  0  0 53  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0 13  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  0  5  0  2  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  9  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  2 14  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 16  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  0  0  7  2  4]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  0  3  0  1  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  2  5  3  3]]

>>>>>>>>>>>>>> 12 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/12/weights.47-0.42.hdf5
------ TRAIN ACCURACY:  weights.47-0.42.hdf5  ------
0.910034602076
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  208    0    0    0    0    0    2    0    0    0    0    1    0
     0    0    0]
 [   0    0 1531    0    4    2   19    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1902    0    1    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   19    0  828   10   32    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    3    0   12 1272    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    1    0    0    1    0  291    1    0    0    0    1    0
     0    0    0]
 [   0    0    0    0    0    0    1    3  190    0    0    0    0    3
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  450    1    1    8   44
     0    3    3]
 [   0    0    0    1    0    0    0    0    0   23  346   42   39   11
     3    6   25]
 [   0    0    1    0    0    2    0    1    0   11   22  420   31    9
     9    2    6]
 [   0    0    0    0    0    0    1    4    0    3    1    5  602   14
     1    7    3]
 [   0    0    0    0    0    1    0    0    0   54    1    5    6  396
     0    1    0]
 [   0    0    1    0    2    0   13    2    0    1    4   77    5    0
   302    5   12]
 [   0    0    0    0    0    3    0    0    1   23   30   21   49   22
     5  312   30]
 [   0    0    0    0    0    4    0    2    0   18   40   34   31   18
     5   16  347]]
------ TEST ACCURACY:  weights.47-0.42.hdf5  ------
0.858
[[  6   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  5   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 182   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  32   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  32   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  36   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0  12   0   0   0   5   0   0   0]
 [  0   0   0   0   0   0   0   0   2   3   3   0   1   1   3   2]
 [  0   0   0   0   0   0   0   0   0   1   7   2   0   2   0   0]
 [  0   0   0   0   0   0   0   0   2  10   0   6   0   0   2   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  20   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   4   0   0   6   0   0]
 [  0   0   0   0   0   0   0   0   0   5   3   0   0   0   6   3]
 [  0   0   0   0   0   0   0   0   5   1   1   4   0   3   1   4]]

>>>>>>>>>>>>>> 13 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/13/weights.30-0.43.hdf5
------ TRAIN ACCURACY:  weights.30-0.43.hdf5  ------
0.866947516237
[[ 143    2    0    0    4    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   1  173   14    0    3    0    4    5    0    0    1    0    1    0
     7    0    1]
 [   0    0 1700    0    5    0    9    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1914    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   82    1  743    0   59    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0   10    0  705    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8   30    0    6 1235    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    7    0    4    2    0  237   15    0    1    1    2    2
     4    2    0]
 [   0    0    3    0    4    0    0    2  176    0    0    5    0    3
     0    1    2]
 [   0    1    0    0    0    0    0    1    0  396    0    1   27   74
     0    4    3]
 [   0    0    0    7    1    0    1    0    0   32  264   26   60   15
     8   28   51]
 [   0    0    0    2    1    3    6    0    0    5   22  370   39   18
    28    6    8]
 [   0    0    1    0    0    0    0    3    0    5    2    3  593   15
     2    4    8]
 [   0    0    3    0    0    0    0    0    0   42    1    0   35  390
     2    1    0]
 [   0    0    9    4    6    2   13    0    0    0   26   47   11    5
   275    2   18]
 [   0    0    0    2    0    4    1    0    1   23   30   10   78   28
    21  246   51]
 [   0    0    0    1    0    0    0    0    0   20   32   13   60   22
    13   33  318]]
------ TEST ACCURACY:  weights.30-0.43.hdf5  ------
0.652519893899
[[ 3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  5  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  4  0 32  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  6 19  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0 44  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  2  0  0 11  0  0  0  0  2  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 11  0 11  0]
 [ 0  0  0  0  0  0  0  1  0  0  8  0  2  0  0  4  3]
 [ 0  0  1  0  0  0  0  0  0  2  5  3  1  1  0  0  5]
 [ 0  0  0  0  0  0  0  0  0  0  6  0 14  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  2  0 10  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  9  0  0  3  0  2  4]
 [ 0  0  0  0  0  0  0  0  0  0  7  0  5  0  0  6  4]]

>>>>>>>>>>>>>> 14 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/14/weights.49-0.44.hdf5
------ TRAIN ACCURACY:  weights.49-0.44.hdf5  ------
0.912711641372
[[ 146    5    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  203    0    0    0    0    0    7    0    0    0    0    0    0
     0    0    0]
 [   0    0 1611    0   51    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1917    0    3   10    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  861    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    4   12 1258    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  287    3    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    4  190    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  455    5    2    2   43
     0    4    3]
 [   0    1    0    0    0    1    0    0    0   16  337   29   32   10
     2   18   47]
 [   0    1    0    0    0    2    0    4    0   12   16  413   23   10
     8    6    8]
 [   0    5    0    0    0    0    0    3    0    5    0    4  589   10
     2   13   10]
 [   0    0    0    0    0    0    0    0    0   58    0    6    5  401
     0    3    1]
 [   0    0    0    0   10    0   10    3    1    0    1   70    4    0
   295    6   14]
 [   0    0    0    0    0    1    0    0    1   16   32   21   26   13
     6  331   48]
 [   0    0    0    0    0    0    0    5    0   16   30   28   17   18
     2   19  388]]
------ TEST ACCURACY:  weights.49-0.44.hdf5  ------
0.704301075269
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0 34  0  7  0 13  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 40  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 50  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  1  0  0  8  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  8  0  0  3  0  0  7]
 [ 0  0  0  0  0  0  0  0  0  0  1 10  0  0  2  6  4]
 [ 0  0  0  0  0  0  0  0  0  0  5  3 11  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  3  0  0  3  0  9]
 [ 0  0  0  0  0  0  0  0  0  0  3  2  3  4  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  4  2  0  1  0  2]]

>>>>>>>>>>>>>> 15 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/15/weights.40-0.42.hdf5
------ TRAIN ACCURACY:  weights.40-0.42.hdf5  ------
0.902426160338
[[ 143    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  209    0    0    0    0    0    1    0    0    1    0    0    0
     0    0    0]
 [   0    0 1687    0    4    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7 1890    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   30    0  853    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   16    6    1   10 1236    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    2    0    1    0    0  265   12    0    0    0    0    0
     0    2    0]
 [   0    0    0    0    0    0    0    2  186    0    0    0    0    2
     0    2    0]
 [   0    2    0    0    0    0    0    0    0  440    1    1   16   54
     0    2    1]
 [   0    0    0    0    0    0    2    0    0   22  306   37   52   14
     3   34   23]
 [   0    0    1    0    1    1    0    0    0    4   18  407   35   17
     7   12    9]
 [   1    6    0    0    0    0    1    2    0    5    2    2  596   13
     1   12    2]
 [   0    0    0    0    0    0    0    0    0   54    0    0   20  395
     0    0    0]
 [   0    0    3    1    9    0    9    0    0    1    1   68   12    7
   277   25    3]
 [   0    0    0    0    1    1    1    0    1   28   18   17   38   15
     8  350   22]
 [   0    0    0    0    0    2    0    0    0   24   31   38   35   21
     3   53  312]]
------ TEST ACCURACY:  weights.40-0.42.hdf5  ------
0.794936708861
[[ 4  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 88  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  5  0 11  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 55  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  8  0  0  0  0  0  0  1  0  0]
 [ 0  0  1  0  0  0  0  0  6  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  2  2  0  0  0]
 [ 0  0  0  0  1  0  0  0  0  0 13  3  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  8  0  2  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  7  4  0  0  5  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  8  0  3  7  0  0]
 [ 0  0  0  0  0  1  0  0  0  0  1  1  0  1  0  6  3]
 [ 0  0  0  0  0  0  0  0  0  0  9  1  3  0  1  0  1]]

>>>>>>>>>>>>>> 16 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/16/weights.49-0.42.hdf5
------ TRAIN ACCURACY:  weights.49-0.42.hdf5  ------
0.923560116783
[[ 144    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  198    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1673    0    7    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1908    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    0  844    0   23    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  715    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4   11    1    7 1242    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  273    1    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    4  188    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  464    2    2    2   30
     0    3    5]
 [   0    0    0    1    0    0    0    2    1   15  364   17   21    5
     6   18   42]
 [   0    1    0    1    0    2    1    6    1   15   21  398   23    9
    21    8    5]
 [   0    7    0    0    0    0    0    2    0    4    2    5  563   12
     6   27   12]
 [   2    0    0    0    0    0    0    0    0   64    1    4    3  386
     0    9    1]
 [   1    1    2    2    3    0    9    6    3    0    7   44    3    3
   322    4   13]
 [   0    0    0    0    1    0    0    6    2   18   23    4    9    6
     5  369   48]
 [   0    0    0    0    0    0    0    9    1   15   30   14   12   18
     3   18  388]]
------ TEST ACCURACY:  weights.49-0.42.hdf5  ------
0.724358974359
[[ 8  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 5  7  0  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 77  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 46  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  7  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  8  0  0 48  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  6  0 11  1  0  0  0  0  1  2  0  0]
 [ 0  0  0  0  0  0  0  0  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 14  0  1  0  3  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  3  4  0  0  0  8  4]
 [ 0  0  0  0  0  0  0  0  0  2  0  5  1  0  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  0  0 13  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  3  0  0  4  0  0  0]
 [ 0  0  0  0  1  0  0  0  1  0  0  2  0  0  5  0  2]
 [ 0  0  0  0  0  0  0  0  0  0 13  2  0  4  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0 14  0  0  0  0  4  8]]

>>>>>>>>>>>>>> 17 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/17/weights.46-0.43.hdf5
------ TRAIN ACCURACY:  weights.46-0.43.hdf5  ------
0.91127034678
[[ 148    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  198    0    0    0    0    0    2    0    0    0    0    0    0
     1    0    0]
 [   0    0 1634    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1901    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   44    0  818    0   31    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  725    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   28    3    0    5 1238    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0    0    0    0  279    2    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    3  189    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  437    1    3    8   52
     0   11    3]
 [   0    0    0    0    0    0    1    2    0   20  378   10   32    8
     9   19   16]
 [   0    0    0    0    0    1    2    1    0    4   34  380   27   10
    23    7   16]
 [   0    3    0    0    0    0    0    5    0    9    5    7  555   14
     1   27   15]
 [   0    0    0    0    0    0    0    0    0   58    0    2    7  386
     2    9    0]
 [   0    0    7    2    3    0    7    1    1    0   15   31    2    3
   323    8    8]
 [   0    0    0    0    0    0    0    0    1   20   40    7   16    7
    19  349   36]
 [   0    0    0    0    0    0    0    0    0    7   42   20   15   23
    15   32  363]]
------ TEST ACCURACY:  weights.46-0.43.hdf5  ------
0.736616702355
[[  4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0  13   0   0   0   0   0   2   0   0   0   0   0   0   0   0   0]
 [  0   0 103   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  81   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  28   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  19   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  50   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0  13   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   3   4   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   8   0   0   1   1   0   0   2]
 [  0   0   0   0   0   0   0   0   0   0   2   2   0   0   0   0  12]
 [  0   0   0   0   0   0   0   0   0   0  15   5   0   1   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   5  12   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   4   0   6   3   7   0   0   0]
 [  0   0   5   0   0   0   0   0   0   0   1   0   0   0  13   1   3]
 [  0   0   0   0   0   0   0   0   0   0   5   0   4   0   2   4   3]
 [  0   0   0   0   0   0   0   0   0   0   8   2   0   0   1   0   6]]

>>>>>>>>>>>>>> 18 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/18/weights.48-0.45.hdf5
------ TRAIN ACCURACY:  weights.48-0.45.hdf5  ------
0.917515895828
[[ 136    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  202    0    0    0    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1736    0    2    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1925    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   26    0  845    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  730    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0    1    6 1281    0    0    0    0    0    0    0
     0    0    0]
 [   0    5    1    0    0    0    0  274    2    0    0    0    0    1
     0    0    0]
 [   0    0    1    0    0    0    0    2  186    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  469    2    2    2   32
     0    4    2]
 [   0    1    0    0    0    0    0    0    0   29  316   12   34   12
     7   41   41]
 [   0    1    1    0    0    0    0    1    0   13   11  395   25   19
    21   11   11]
 [   0    2    0    0    0    0    0    6    0    5    2    2  556   16
     2   44    8]
 [   0    0    0    0    0    0    0    0    0   53    0    4    6  401
     1    6    0]
 [   0    0    3    0    7    0   13    0    0    1    3   45    2    6
   315   26    2]
 [   0    0    0    0    0    0    0    0    1   20   15    5   14   11
     5  405   27]
 [   0    0    0    0    0    0    0    0    0   24   17   13   20   21
    10   54  362]]
------ TEST ACCURACY:  weights.48-0.45.hdf5  ------
0.727586206897
[[12  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 56  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 14  0  2  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 31  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 12  1  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  0  0  0  9  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  3  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 10  4  0  0  0  1  3]
 [ 0  0  0  0  0  0  0  0  1  0 12  0  1  0  3  0]
 [ 0  0  0  0  0  0  0  0  3  3  0  2  3  0  7  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 11  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  1  0  7  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  2  7  1]
 [ 0  0  0  0  0  0  0  0  1  3  0  2  0  0  7  0]]

>>>>>>>>>>>>>> 19 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/19/weights.47-0.43.hdf5
------ TRAIN ACCURACY:  weights.47-0.43.hdf5  ------
0.912994350282
[[ 144    1    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0  193    1    0    0    0    0    9    0    0    1    0    0    0
     0    0    0]
 [   0    0 1713    0    6    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1918    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   18    0  877    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    3    1    8 1276    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0    0    0    0  287    1    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    9  178    0    0    2    0    1
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  460    3    3   10   38
     0    2    3]
 [   0    0    0    1    0    0    0    3    0   18  329   52   38    8
     4   11   32]
 [   0    0    1    2    0    1    1    2    0    3   13  442   22   15
     9    3    3]
 [   0    3    0    0    0    0    0    4    0    3    1   12  580    5
     4   18   14]
 [   0    0    0    0    0    0    0    0    0   43    0    5   20  403
     1    2    0]
 [   0    0    2    0    7    0    7    3    1    0    8   71    5    1
   299    1   14]
 [   0    0    0    1    0    0    0    3    1   22   37   28   39    8
     8  324   33]
 [   0    0    0    0    1    0    0    6    0   12   26   58   20   13
     5   22  359]]
------ TEST ACCURACY:  weights.47-0.43.hdf5  ------
0.823308270677
[[ 3  3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 10  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0 14  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  2  0 29  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  7  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  6  2  0  0  0  6  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  9  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0 14  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  3  0  2  7  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  2  0  0  6  0]
 [ 0  0  0  0  0  0  0  2  0  0  0  2  3  0  0  0  5]]

>>>>>>>>>>>>>> 20 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/20/weights.32-0.43.hdf5
------ TRAIN ACCURACY:  weights.32-0.43.hdf5  ------
0.884880636605
[[ 140    2    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   1  186    1    0    4    0    0    8    0    0    0    1    1    0
     0    1    0]
 [   0    0 1559    0   10    0   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1884    0    2   27    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   16    0  839    1   36    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  727    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0    0   12 1260    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    4    0    3    0    0  270    4    0    0    0    1    0
     1    2    2]
 [   0    0    1    0    1    0    0    8  172    0    0    3    0    2
     1    2    2]
 [   0    1    0    0    0    0    0    1    0  451    1    2   18   31
     0    4    4]
 [   0    0    0    0    0    2    2    1    0   30  269   35   60    5
     4   18   75]
 [   0    0    1    0    0    7    0    2    0   11   10  397   49    9
     7   10   16]
 [   0    3    0    0    0    0    0    4    0    8    3    3  601    6
     2    9    4]
 [   1    1    0    0    0    0    0    0    0   92    0    0   33  323
     0   10    9]
 [   1    0    0    0    7    4   14    0    0    1    4   78   17    1
   275   13   10]
 [   0    0    0    0    0    3    0    0    1   26   18   21   79    5
     2  289   55]
 [   0    0    0    0    0    0    0    0    0   20   17   29   58   10
     2   23  366]]
------ TEST ACCURACY:  weights.32-0.43.hdf5  ------
0.759219088937
[[ 10   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0  10   0   0   0   0   0   3   0   0   0   0   0   0   0   0   0]
 [  0   0 136   0   0   0  20   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  71   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   4  21   4   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  18   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   4  23   0   0  23   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   7   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   8   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  13   0   0   0   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   2   6   2   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   7   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   0  11   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   3   0   1   2   8   0   0   1]
 [  0   0   0   0   0   0   0   0   0   0   0   3   0   0   4   1   1]
 [  0   0   0   0   0   0   0   0   0   2   7   0   0   0   0   5   0]
 [  0   0   0   0   0   0   0   0   0   0   4   3   0   0   0   0   2]]

>>>>>>>>>>>>>> 21 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/21/weights.45-0.44.hdf5
------ TRAIN ACCURACY:  weights.45-0.44.hdf5  ------
0.912453224262
[[ 145    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  199    1    0    0    0    0    4    1    0    0    0    0    0
     0    0    0]
 [   0    0 1733    0    3    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1920    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   55    0  819    0   38    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  724    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14    0    0    7 1257    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0    0    0    0  276    5    0    0    0    0    0
     0    2    0]
 [   0    2    1    0    0    0    0    5  176    0    0    1    0    0
     1    0    0]
 [   0    2    0    0    0    0    0    0    0  453    2    0    3   53
     0    3    0]
 [   0    0    2    1    0    0    0    0    0   13  350   12   31   11
     5   31   46]
 [   0    0    2    0    0    2    0    1    0   15   17  392   30   10
    22    6   12]
 [   0    1    2    0    0    0    0    2    0    9    3    2  578    8
     5   23    9]
 [   0    0    0    0    0    0    0    0    0   51    1    3    6  405
     1    4    2]
 [   0    0    3    0    4    0   15    1    1    0    4   50    3    7
   316   15    6]
 [   0    0    0    0    0    0    0    1    0   18   32    7   21   11
     8  372   31]
 [   0    0    0    0    0    1    0    0    0   15   27   21   22   18
    15   38  370]]
------ TEST ACCURACY:  weights.45-0.44.hdf5  ------
0.6
[[ 7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  8 12  0  0 41  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  8  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 11 11  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0  1  0 42  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  9  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  2  0  0  0  3  2]
 [ 0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  1 16  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  8  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  6  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  1  0  5  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  1  1  2]]

>>>>>>>>>>>>>> 22 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/22/weights.47-0.44.hdf5
------ TRAIN ACCURACY:  weights.47-0.44.hdf5  ------
0.91716133605
[[ 135    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1673    0    3    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1920    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   21    0  831    0   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    3    1    7 1253    0    0    0    0    0    0    0
     2    0    0]
 [   0    0    0    0    0    0    0  268   10    0    0    0    0    0
     0    2    0]
 [   0    0    0    0    0    0    1    0  181    0    0    0    0    1
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  463    0    2    9   24
     0    6    1]
 [   0    1    0    0    0    0    0    1    0   21  297   11   29    5
    15   41   69]
 [   0    0    1    0    0    0    0    0    0   13   20  369   20    9
    31   12   23]
 [   1    4    1    1    0    0    0    0    0    2    3    1  572    9
     6   24   14]
 [   0    0    0    0    0    0    0    0    0   65    0    0    9  375
     2   12    0]
 [   0    0    2    0    3    0   10    2    0    3    7   30    2    1
   322   17   18]
 [   0    0    0    0    0    0    0    0    1   20   15    5   20    4
    16  374   35]
 [   0    2    0    0    0    0    0    0    0   11    8   11   29   13
    10   32  396]]
------ TEST ACCURACY:  weights.47-0.44.hdf5  ------
0.630165289256
[[ 0 14  0  0  0  0  0  0  0  0  0  0  0  0  3  0  0]
 [ 0 10  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 58  0  2  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 62  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  9  0  0  0  2  0  0  0  6  2  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  1  0  0  5  0  0]
 [ 0  2  0  0  0  0  0  8  0  0  0  0  2  0  0  3  1]
 [ 0 12  0  0  0  0  0  1  3  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0 14  0  0  5  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  0  0  0 18]
 [ 0  0  0  0  0  0  0  0  0  4  2 11  0  0  8  0  3]
 [ 0  0  0  0  0  0  0  0  0  2  4  0 15  0  0  0  2]
 [ 2  2  0  0  0  0  0  0  0  7  0  3  2  1  2  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0  7  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  9  0  0  8  6]
 [ 0  0  0  0  0  0  0  0  0  0  7  0  4  0  3  0  8]]

>>>>>>>>>>>>>> 23 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/23/weights.26-0.45.hdf5
------ TRAIN ACCURACY:  weights.26-0.45.hdf5  ------
0.892005242464
[[ 138    6    0    0    0    0    0    2    1    0    0    0    0    0
     0    0    0]
 [   0  194    0    0    0    0    0   15    0    0    0    0    0    0
     0    0    0]
 [   0    0 1711    0    9    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1906    0    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   16    0  851    0   28    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    5    1    7 1254    0    0    0    0    0    0    0
     0    0    0]
 [   0    5    0    0    0    0    0  273    2    0    0    0    0    0
     0    1    0]
 [   0    2    0    0    0    0    0   10  179    0    0    1    0    0
     1    1    0]
 [   0    2    0    0    0    0    0    0    0  350    4    4   19  105
     3   13    7]
 [   0    0    0    1    0    0    0    2    0    5  275   48   40   16
     7   37   71]
 [   0    0    1    0    0    1    0    3    0    4    8  426   28   17
    14    6    9]
 [   0    2    0    0    0    0    0    4    0    2    3    6  586   10
     2   21   10]
 [   0    0    3    0    0    0    0    2    0   31    0    6   15  396
     5   10    1]
 [   0    0    3    0    7    0    5    2    0    0   11   65    7   12
   301    8    4]
 [   0    0    0    0    0    0    0    0    2   12   19   27   45   18
     9  318   48]
 [   0    0    0    0    0    0    0    0    0    5   22   55   25   23
    10   50  330]]
------ TEST ACCURACY:  weights.26-0.45.hdf5  ------
0.723926380368
[[ 2  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 15  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 74  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  6  0 20  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0 43  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0  0 12  0  0  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  5 10  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  6  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  5  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  7  3  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  3  8  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  5  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  1  8  0  0  4  1]
 [ 0  0  0  0  0  0  0  6  0  0  2  0  2  0  0  2  2]]

>>>>>>>>>>>>>> 24 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/24/weights.48-0.42.hdf5
------ TRAIN ACCURACY:  weights.48-0.42.hdf5  ------
0.91353046595
[[ 128    3    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  187    0    0    0    0    0    9    0    0    0    0    0    0
     1    0    0]
 [   0    0 1537    0    5    1   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1913    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  826    1   25    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    3    0    8 1256    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  277    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    3  185    0    0    0    0    0
     0    0    1]
 [   0    0    0    0    0    0    0    0    0  425    4    2    7   56
     0    6    6]
 [   0    1    0    1    0    0    0    1    0   16  319   49   33    8
     1    9   58]
 [   0    0    1    0    0    1    1    1    0    8    9  432   27    8
    13    1   10]
 [   0    0    0    0    0    0    0    4    0    5    0    4  580   20
     1   12   14]
 [   0    0    0    0    0    0    0    0    0   50    0    5    8  400
     0    5    1]
 [   0    1    1    0    5    1    6    9    1    0    1   54    5    0
   304    7   14]
 [   0    0    0    0    0    0    1    2    0   18   30   21   32    8
     6  308   68]
 [   0    0    0    0    0    2    0    2    0   13   12   27   32   13
     6   11  399]]
------ TEST ACCURACY:  weights.48-0.42.hdf5  ------
0.68085106383
[[  7   3   0   0   0   0   0   0   0   0   0   0   0  10   1   0   0]
 [  0   8   0   0   0   0   0   1   0   0   0   0   1   3   6   0   0]
 [  0   0 133   0  15   0  31   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  69   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  54   4   5   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  27   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  12   0   1  43   0   0   0   0   0   0   0   0   0   0]
 [  0   3   0   0   0   0   0  12   1   0   0   0   0   1   0   0   1]
 [  0   0   0   0   0   0   0   0   8   0   0   0   0   2   0   0   0]
 [  0   2   0   0   0   0   0   0   0  13   0   0   3   5   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   6   0   5   0   0   0   4]
 [  0   0   0   0   0   0   0   0   0   0   4   6   0   4   0   0   0]
 [  0   0   0   0   0   0   0   1   0   0   0   0  18   0   0   0   2]
 [  0   0   0   0   0   0   0   0   0  10   0   0   0   5   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0  15   4   0   5   1   0]
 [  0   0   0   0   0   0   0   0   0   0   2   3   4   0   0   0  10]
 [  0   0   0   0   0   0   0   0   0   0   7   6   0   0   0   2   2]]

>>>>>>>>>>>>>> 25 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/25/weights.47-0.41.hdf5
------ TRAIN ACCURACY:  weights.47-0.41.hdf5  ------
0.9089389407
[[ 150    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  206    0    0    0    0    0    5    0    0    1    0    0    0
     0    0    0]
 [   0    0 1685    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1912    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   33    0  830    0   32    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  724    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   15    2    1    7 1247    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    1    0    0    0    0  280    6    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    2  188    0    0    0    0    1
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  445    0    2    4   41
     0   16    2]
 [   0    0    1    1    0    0    0    1    0   26  321   29   23    8
     4   32   46]
 [   0    0    1    0    0    3    1    0    0   17    5  432   19   12
     3    9   10]
 [   1    2    1    0    0    0    0    2    0   15    0    8  545   10
     2   40    7]
 [   3    2    1    0    0    0    0    1    0   68    0    7   12  365
     0    3    1]
 [   0    0    2    2    2    0   11    1    1    5    3   71    5    2
   289   15   10]
 [   0    0    0    0    0    0    0    0    1   10   19   16   28    9
     6  367   29]
 [   0    0    0    0    0    0    0    0    0   28   29   44   19   12
     5   31  345]]
------ TEST ACCURACY:  weights.47-0.41.hdf5  ------
0.738271604938
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 45  0  7  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0 23  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 21  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 52  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  4  2  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 10  1  2  0  3  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  6  3  1  3  2  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  1  7  2  1  1  0  1  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  1 27  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0 19  0  1  0]
 [ 0  0  2  0  0  0  1  0  0  0  1  5  0  1  0  3  2]
 [ 0  0  0  0  0  0  0  0  0 16  4  2  0  1  0  1  4]
 [ 0  0  0  0  0  0  0  0  0  0  3  4  0  0  0  1 13]]

>>>>>>>>>>>>>> 26 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/26/weights.50-0.43.hdf5
------ TRAIN ACCURACY:  weights.50-0.43.hdf5  ------
0.924180148666
[[ 151    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  206    0    0    0    0    0    4    1    0    0    0    0    0
     0    0    0]
 [   0    0 1686    0   15    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1925    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  881    0    9    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    5    7 1263    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  290    2    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    6  193    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  449    3    0    6   44
     0    7    1]
 [   0    1    0    0    0    0    0    0    0   17  396   14   29    5
     6    6   16]
 [   0    0    0    0    0    1    0    2    0    9   27  410   23   12
    12    4    7]
 [   1    0    0    0    0    0    0    0    0   10    9    5  576   15
     3    8    9]
 [   1    0    0    0    0    0    0    0    0   71    6    2    9  380
     2    2    4]
 [   0    0    0    0    3    0    4    1    1    0   17   49    3    2
   319    9   13]
 [   0    0    0    0    0    0    0    0    1   17   56    8   21    5
    19  328   39]
 [   0    0    0    0    0    0    0    0    0    8   40   21   20   10
    15   12  392]]
------ TEST ACCURACY:  weights.50-0.43.hdf5  ------
0.741071428571
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  0  0  0  1  1  0  0  0  0  0  0  0  0]
 [ 0  0 29  0  0  0  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 48  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 14  1  0  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  8  4  0  0  0  0  9]
 [ 0  0  0  0  0  0  0  1  0  0  2  3  0  0  8  2  3]
 [ 0  1  0  0  0  0  0  5  0  0  0  1 16  0  0  1  1]
 [ 0  0  0  0  0  0  0  0  0  6  0  0  0  1  0  0  0]
 [ 0  0  0  0  1  0  4  7  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  3  0  0  5 10]
 [ 0  0  0  0  0  0  0  0  0  0  1  1  3  0  1  2  8]]

>>>>>>>>>>>>>> 27 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/27/weights.50-0.40.hdf5
------ TRAIN ACCURACY:  weights.50-0.40.hdf5  ------
0.918878668419
[[ 150    1    0    0    0    0    0    0    2    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    3    1    0    0    0    0    0
     0    0    0]
 [   0    0 1691    0    7    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1910    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10    0  864    0   21    0    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  715    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    1    0    7 1269    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  283    5    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    1    1  195    0    0    0    0    1
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  449    2   13    0   35
     0    9    1]
 [   0    1    0    0    0    0    0    0    0   18  340   44   32    4
     7   17   34]
 [   0    0    1    0    0    1    0    0    0   16   11  426   20    2
    15    8    4]
 [   0    7    0    0    0    0    0    1    0   14    1    8  565    9
     8   23    4]
 [   1    0    0    0    0    0    0    0    0   66    0    6    5  380
     3    5    0]
 [   0    0    2    0    3    0    2    6    1    3    1   66    4    0
   316   10    9]
 [   0    0    0    0    0    0    0    0    1   14   21   25   28   10
    10  356   32]
 [   0    0    0    0    0    0    0    4    0   11   14   57   18   11
     9   25  369]]
------ TEST ACCURACY:  weights.50-0.40.hdf5  ------
0.775280898876
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 39  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 31  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  1  0 42  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  6  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  2  1  3  0  0  1  1  5]
 [ 0  0  0  0  0  0  0  0  1  5 10  0  4  1  1  0]
 [ 0  0  0  0  0  0  0  0  2  0  0 19  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 11  0  0  0  7  0  0  0]
 [ 0  0  0  2  0  3  0  1  0  0  5  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  7  3  0  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  1  6  0  3  0  1  5]]

>>>>>>>>>>>>>> 28 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/28/weights.25-0.38.hdf5
------ TRAIN ACCURACY:  weights.25-0.38.hdf5  ------
0.874378000873
[[ 147    6    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  192    2    0    1    0    0   15    3    0    0    0    0    0
     0    0    0]
 [   0    0 1699    0    5    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9 1917    0    1    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   58    0  798    0   34    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0  719    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   31   11    1    9 1231    0    0    0    0    0    0    0
     0    0    0]
 [   1    3    5    0    1    0    0  257   20    0    0    0    1    0
     0    0    0]
 [   0    0    1    0    0    0    0    5  192    0    0    1    0    1
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  425    1    3   24   49
     0    5    3]
 [   0    0    0    1    1    0    0    3    1   28  241   45   49    9
    12   34   71]
 [   0    0    5    0    1    4    1    3    1   17   12  375   34   13
    22   11   10]
 [   1    3    1    0    0    0    0    3    0   15    2    8  565    6
     6   17   11]
 [   1    2    3    0    0    0    0    2    0   89    0    6   13  347
     1    6    4]
 [   1    0   10    1    4    1   16    1    2    0    7   61    8    5
   273   23   13]
 [   0    0    0    1    0    4    0    1    2   24   24   17   37   15
    14  330   28]
 [   0    0    0    0    0    3    0    0    1   28   33   40   32   15
    11   47  308]]
------ TEST ACCURACY:  weights.25-0.38.hdf5  ------
0.854430379747
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 30  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1 57  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 31  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0 40  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  7  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 10  2  0  0  1  1  2]
 [ 0  0  0  0  0  0  1  0  0  2 12  0  0  1  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0 18  2  1  2  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  1  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  0  7  7]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0  0  2 10]]

>>>>>>>>>>>>>> 29 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/29/weights.37-0.44.hdf5
------ TRAIN ACCURACY:  weights.37-0.44.hdf5  ------
0.908137882018
[[ 151    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  194    0    0    0    0    0   10    2    0    0    0    0    0
     0    0    0]
 [   0    0 1622    0    6    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1915    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   20    0  844    0   27    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9   19    2    9 1246    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  270   11    0    0    0    0    0
     0    1    0]
 [   0    1    1    0    0    0    0    4  185    0    0    1    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  440    1    2   10   36
     0    9    0]
 [   0    0    0    0    1    0    0    2    0   23  320   28   24    4
     8   44   29]
 [   0    0    0    0    0    1    0    4    0   17   22  393   15    6
    22   12   12]
 [   0    2    0    1    0    0    0    2    0   11    4    5  564    7
     1   23   10]
 [   3    1    0    0    0    0    0    0    0   85    0    4   10  336
     2   15    2]
 [   0    0    1    1    6    0   12    1    1    0   12   37    7    0
   301   29    6]
 [   0    0    0    0    1    0    0    1    1   21   18    7   22    7
     6  390   19]
 [   0    0    0    0    0    2    0    0    0   17   42   16   18    9
    12   49  337]]
------ TEST ACCURACY:  weights.37-0.44.hdf5  ------
0.621359223301
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  4  0  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0 93  1  0  0 12  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 12  0 17  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  8  0  1 27  0  0  0  0  0  0  0  1  1  0]
 [ 0  0  0  0  0  0  0 11  1  0  0  0  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 27  0  0  2  0  0  0  0]
 [ 0  0  0  1  0  0  0  1  0  0  5  3  7  0  1  3  7]
 [ 0  0  0  2  0  1  0  0  0  1  0  3 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1 12  0  3 13  2]
 [ 0  0  0  0  0  0  0  0  0  9  0  3  6  4  0  4  0]
 [ 0  0  0  3  0  0  0  0  0  0  0 16  0  0  0  0  1]
 [ 0  0  0  1  0  0  0  0  0  1  6  2  4  0  0  4  2]
 [ 0  0  0  0  0  0  0  0  0  6  0  3 11  3  3  2  4]]

>>>>>>>>>>>>>> 30 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_spca_conv1d_10/30/weights.23-0.42.hdf5
------ TRAIN ACCURACY:  weights.23-0.42.hdf5  ------
0.878465194051
[[ 150    2    0    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   5  192    3    0    2    0    0   10    0    0    0    0    0    0
     0    0    0]
 [   0    0 1676    0    4    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1917    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   64    0  785    7   40    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   31    2    0   10 1239    0    0    0    0    0    0    0
     0    0    0]
 [   1    2    5    0    1    2    0  261    8    0    0    0    2    2
     3    3    1]
 [   1    1    1    0    1    0    1    6  180    0    0    1    0    1
     0    3    1]
 [   0    2    0    0    0    0    0    0    0  425    2    2   26   26
     0   13    2]
 [   0    0    0    0    1    0    0    1    0   12  262   21   43    8
     6   35   98]
 [   0    1    3    0    1    6    3    0    0   14   20  369   30    7
    13   15   18]
 [   1    6    0    0    0    0    0    2    0   12    4    4  574   10
     2   14    5]
 [   2    3    3    0    0    0    0    1    0   87    0    4   35  315
     1   10    4]
 [   1    0    8    0    6    0   13    0    0    3   13   53   17    3
   242   21   34]
 [   0    0    0    0    0    1    1    0    0   24   22   11   61    3
     5  311   56]
 [   0    0    2    0    0    0    0    0    0    5   32   15   39    6
     4   39  368]]
------ TEST ACCURACY:  weights.23-0.42.hdf5  ------
0.737745098039
[[ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 23  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 42  0  0  0  0  0  0  0  0  0  0]
 [ 1  2  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 29  0  0  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0 11  1  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0 15 10  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  0  4 14  0  1  4  3]
 [ 0  0  0  0  0  0  0  0  0 17  0  0  0  2  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0  3  0  0 16  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  1  2  0  2 12  0]
 [ 0  0  0  0  0  0  0  0  0 10  0  3  1  5  0  3  2]]
[0.6536458333333334, 0.5694682675814752, 0.8388157894736842, 0.45016077170418006, 0.7013422818791947, 0.8131067961165048, 0.7606060606060606, 0.7984886649874056, 0.6497584541062802, 0.6837060702875399, 0.7627551020408163, 0.858, 0.6525198938992043, 0.7043010752688172, 0.7949367088607595, 0.7243589743589743, 0.7366167023554604, 0.7275862068965517, 0.8233082706766918, 0.7592190889370932, 0.6, 0.6301652892561983, 0.7239263803680982, 0.6808510638297872, 0.7382716049382716, 0.7410714285714286, 0.7752808988764045, 0.8544303797468354, 0.6213592233009708, 0.7377450980392157]
0.718860079343
0.088854008434

Process finished with exit code 0

'''
