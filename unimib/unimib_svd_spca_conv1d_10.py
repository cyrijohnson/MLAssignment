import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import numpy as np
import cPickle as pickle
from keras.models import Model, load_model
from keras.initializers import Constant, TruncatedNormal
from keras.layers import Input, Dense, Conv1D, Flatten, Dropout, Activation, BatchNormalization
from keras.layers.merge import concatenate
from keras.optimizers import Adam
from keras.callbacks import ModelCheckpoint
import keras.backend as K
from keras import losses
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix

# Load SVD + Sparse PCA

X_svd = pickle.load(open("data/X_unimib_svd.p", "rb"))
X_spca = pickle.load(open("data/X_unimib_spca.p", "rb"))
X = np.concatenate((X_svd, X_spca), axis=1)

y = pickle.load(open("data/y_unimib_svd.p", "rb"))

n_classes = 17


# Below builds 1D CNN.

for i in range(30):
    test = y.loc[y[1] == i+1]
    # print y_sub
    test_index = test.index.values
    # print len(test_index)

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index], y_values[test_index]
    y_train = np.eye(n_classes)[y_train - 1]
    print X_train.shape # (11188, 302)

    # input layer
    input_signal = Input(shape=(302, 1))
    print K.int_shape(input_signal)

    # define initial parameters
    b_init = Constant(value=0.0)
    k_init = TruncatedNormal(mean=0.0, stddev=0.01, seed=2018)

    # first feature extractor
    conv11 = Conv1D(16, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn11 = BatchNormalization()(conv11)
    actv11 = Activation('relu')(bn11)
    conv12 = Conv1D(32, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv11)
    bn12 = BatchNormalization()(conv12)
    actv12 = Activation('relu')(bn12)
    flat1 = Flatten()(actv12)

    # second feature extractor
    conv21 = Conv1D(16, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn21 = BatchNormalization()(conv21)
    actv21 = Activation('relu')(bn21)
    conv22 = Conv1D(32, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv21)
    bn22 = BatchNormalization()(conv22)
    actv22 = Activation('relu')(bn22)
    flat2 = Flatten()(actv22)

    # third feature extractor
    conv31 = Conv1D(16, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn31 = BatchNormalization()(conv31)
    actv31 = Activation('relu')(bn31)
    conv32 = Conv1D(32, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv31)
    bn32 = BatchNormalization()(conv32)
    actv32 = Activation('relu')(bn32)
    flat3 = Flatten()(actv32)

    # merge feature extractors
    merge = concatenate([flat1, flat2, flat3])

    # dropout & fully-connected layer
    do = Dropout(0.9, seed=2018)(merge)
    output = Dense(n_classes, activation='softmax', bias_initializer=b_init, kernel_initializer=k_init)(do)

    # result
    model = Model(inputs=input_signal, outputs=output)

    # summarize layers
    print(model.summary())

    new_dir = 'model/unimib_svd_spca_conv1d_10/' + str(i+1) + '/'
    if not os.path.exists(new_dir):
        os.makedirs(new_dir)

    fpath = new_dir + 'weights.{epoch:02d}-{val_acc:.2f}.hdf5'
    cp_cb = ModelCheckpoint(fpath, monitor='val_acc', verbose=1, save_best_only=True, mode='auto', period=1)

    adam = Adam(lr=0.001)
    model.compile(loss=losses.categorical_crossentropy, optimizer=adam, metrics=['accuracy'])
    model.fit(np.expand_dims(X_train, axis=2), y_train, batch_size=64, epochs=50, verbose=2, validation_split=0.10,
              callbacks=[cp_cb], shuffle=True)

    del model
    K.clear_session()


# Below calculates average test data accuracy (LOSO CV).

acc = []

for i in range(30):
    test = y.loc[y[1] == i+1]
    test_index = test.index.values

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index] - 1, y_values[test_index] - 1

    print "\n>>>>>>>>>>>>>>", str(i+1), "-fold <<<<<<<<<<<<<<<<"
    path_str = 'model/unimib_svd_spca_conv1d_10/' + str(i+1) + '/'
    for path, dirs, files in os.walk(path_str):
        dirs.sort()
        files.sort()
        top_acc = []
        top_acc.append(files[-1])
        files = top_acc
        for file in files:
            print "========================================"
            print os.path.join(path, file)
            model = load_model(os.path.join(path, file))
            pred = model.predict(np.expand_dims(X_train, axis=2), batch_size=32)
            print "------ TRAIN ACCURACY: ", file, " ------"
            print accuracy_score(y_train, np.argmax(pred, axis=1))
            print confusion_matrix(y_train, np.argmax(pred, axis=1))
            pred = model.predict(np.expand_dims(X_test, axis=2), batch_size=32)
            print "------ TEST ACCURACY: ", file, " ------"
            print accuracy_score(y_test, np.argmax(pred, axis=1))
            print confusion_matrix(y_test, np.argmax(pred, axis=1))

            del model
            K.clear_session()

    acc.append(accuracy_score(y_test, np.argmax(pred, axis=1)))

print acc
print np.mean(acc)
print np.std(acc)

'''
-----
[0.7265625, 0.7667238421955404, 0.8223684210526315, 0.5916398713826366, 0.6946308724832215, 0.8203883495145631, 0.7818181818181819, 0.7682619647355163, 0.678743961352657, 0.6900958466453674, 0.7219387755102041, 0.796, 0.8010610079575596, 0.8467741935483871, 0.8202531645569621, 0.7243589743589743, 0.8115631691648822, 0.7275862068965517, 0.7255639097744361, 0.7331887201735358, 0.45, 0.6528925619834711, 0.7300613496932515, 0.7594108019639935, 0.725925925925926, 0.7797619047619048, 0.8061797752808989, 0.8734177215189873, 0.7126213592233009, 0.7450980392156863]
0.742829712423
0.0805119922572
-----

/usr/bin/python2.7 /mnt/0cdd1a7e-3686-4cf7-9055-145eb5fe70f3/hcilab/OSS/electronicsletters2018/unimib/unimib_svd_spca_conv1d_10.py
/home/hcilab/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.

>>>>>>>>>>>>>> 1 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/1/weights.49-0.52.hdf5
------ TRAIN ACCURACY:  weights.49-0.52.hdf5  ------
0.936067445332
[[ 144    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  202    0    0    1    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1672    0    3    0    5    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    0 1914    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  868    0   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  718    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    4    2    7 1263    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  284    2    0    0    1    0    0
     0    1    0]
 [   0    0    0    0    0    0    1    3  194    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    1    0    0    0  435    4    0    3   64
     4    2    5]
 [   0    0    0    0    0    0    1    4    0   15  423    5    8   28
     2    6    2]
 [   0    1    0    0    0    1    2    3    1    3   25  397   12   15
    29    3   19]
 [   0    0    0    0    0    0    0    4    0    1    2    7  617    8
     0    3    0]
 [   0    0    0    0    0    0    0    0    0   23    1    2    2  428
     1    7    6]
 [   0    1    0    0    0    3    0    5    3    0    9   40   22    0
   324    4    8]
 [   0    0    0    0    1    0    0    0    0   13   48    1   20   19
     2  353   36]
 [   0    1    1    0    0    0    0    0    0    5    4   17    6   32
    14   13  423]]
------ TEST ACCURACY:  weights.49-0.52.hdf5  ------
0.7265625
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  1  0 25  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 28  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  9  0  0  0 33  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  8  1  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  0  9  0  0  1  0  5  0]
 [ 0  0  0  0  0  8  0  0  0  0  1  0  0  0  1  5  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  0  0  1  1  1  0  2  2  2]
 [ 0  0  0  0  0  1  0  0  0  0  5  1  0  2  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  5  1  0  5  3  3  1]
 [ 0  0  0  0  0  0  0  1  0  0  4  4  2  0  1  1  5]]

>>>>>>>>>>>>>> 2 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/2/weights.42-0.50.hdf5
------ TRAIN ACCURACY:  weights.42-0.50.hdf5  ------
0.928226671434
[[ 145    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  199    1    0    1    0    0    2    0    0    0    0    0    0
     0    1    0]
 [   0    0 1586    0    4    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1903    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14    0  846    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    1    2    5 1259    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  282    2    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    5  189    0    0    0    0    0
     0    0    1]
 [   0    0    0    0    0    1    0    0    0  464    7    2    2   31
     1    0    0]
 [   0    0    1    0    2    0    0    2    0   20  416   12    1   21
     5    5    3]
 [   0    1    1    0    2    1    0    0    0   13   20  401    5    9
    28    1   20]
 [   0    1    0    0    0    0    0    5    0    4    3   11  577    8
     1    9    2]
 [   0    2    0    0    0    0    0    0    0   45    4    3    1  385
     3    1    8]
 [   0    1    0    0    2    0    1    8    0    0   14   41   20    2
   308    2   10]
 [   0    1    0    0    1    0    0    0    0   22   73    2   10   11
     7  318   41]
 [   0    1    0    0    0    0    1    4    0    9   12   20    3   30
     7   27  393]]
------ TEST ACCURACY:  weights.42-0.50.hdf5  ------
0.766723842196
[[  6   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0]
 [  1   9   0   0   2   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 128   0  15   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  37   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   2  27   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  49   0   0   0   0   0   0   0   0   0   0]
 [  0   2   0   0   1   0   0   6   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   3   0   0   0   0   0   0   1   0]
 [  0   0   0   0   0   0   0   0   0  18   0   0   0   2   1   0   0]
 [  0   1   0   0   0   0   0   1   0   0  14   4   3   0   0   0   0]
 [  0   3   0   0   1   0   0   3   0   0   0  16   0   0   0   0   1]
 [  0   0   0   0   0   0   0   0   0   2   4   0  30   3   0   1   0]
 [  0   0   0   0   0   0   0   0   1   6   1   1   1  22   0   0   0]
 [  0   5   4   1   0   0   0   0   0   0   0   0   1   0   0  14   0]
 [  0   0   0   0   1   0   2   2   0   2   4   7   6   0   0   1   2]
 [  0   0   0   0   0   0   0   0   0   0   0  12   1   1   0   6   7]]

>>>>>>>>>>>>>> 3 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/3/weights.47-0.50.hdf5
------ TRAIN ACCURACY:  weights.47-0.50.hdf5  ------
0.932153135083
[[ 144    1    0    0    1    0    0    0    1    0    0    0    0    0
     0    0    0]
 [   0  210    2    0    1    0    0    1    1    0    0    0    0    0
     0    0    0]
 [   0    0 1714    0    1    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1908    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  859    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    1    2    7 1270    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    1    0    0  277    4    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    0    1    1  195    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    1    0    0    1  475    8    0    2   25
     0    2    1]
 [   0    0    2    1    2    1    0    2    2   27  428    7    3   13
     3    6    2]
 [   0    0    0    0    2    1    0    1    2   17   17  407   14    7
    27    1   20]
 [   0    0    0    0    0    0    0    4    0    2    2   11  605   11
     1    7    4]
 [   2    0    0    0    0    0    0    0    0   66    4    4    1  386
     0    6    2]
 [   0    1    0    0    1    2    1    8    0    1   18   39   19    0
   326    1   10]
 [   0    1    0    0    1    0    1    0    0   18   56    5   20   12
     4  350   35]
 [   0    1    0    0    0    0    1    4    0   14   11   34    4   20
     7   12  419]]
------ TEST ACCURACY:  weights.47-0.50.hdf5  ------
0.822368421053
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 73  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  2 33  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 10  0  0  0  4  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  4  2  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  2  6  0  0  1  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  0  2  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  7  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  1  0  0  3  2  0  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  4  1  0  0  0  0]]

>>>>>>>>>>>>>> 4 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/4/weights.44-0.51.hdf5
------ TRAIN ACCURACY:  weights.44-0.51.hdf5  ------
0.933682373473
[[ 151    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  206    2    0    0    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1715    0    3    0    3    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    1 1926    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  860    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    1    1    4 1290    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  284    1    0    0    1    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    4  186    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    1    0    0    0  445   11    0    4   60
     1    0    0]
 [   0    0    0    0    1    0    0    4    0   15  433   11    1   17
     1    6    3]
 [   0    1    0    0    0    0    0    2    0    6   23  403   15   15
    15    3   20]
 [   0    0    0    0    0    0    0    7    0    1    5    9  606   11
     2    1    1]
 [   1    0    0    0    0    0    0    1    0   25    7    2    0  425
     0    1    5]
 [   0    1    0    0    1    0    0    7    1    0   13   56   21    0
   307    0   14]
 [   0    1    0    0    1    0    0    1    0    9   56    6   12   27
     7  340   37]
 [   0    2    0    0    0    0    0    1    0    7   10   36    4   29
     8    9  406]]
------ TEST ACCURACY:  weights.44-0.51.hdf5  ------
0.591639871383
[[ 0  1  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  0  0 10  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 53  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 20  0  2  1  1  0  1  0  0  0  3  0  0]
 [ 0  0  5  2 12  1  2  0  0  4  0  0  0  0  0  1]
 [ 0  0  0  0  0 17  9  0  0  0  0  0  0  1  0  0]
 [ 1  0  0  0  0  0  6  1  0  0  0  0  0  2  0  0]
 [ 1  0  0  0  0  0  7  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  7  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4 12  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1 17  1  0  2  0  2]
 [ 0  0  0  0  0  0  0  0  1  1  0 16  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  3  0  0  7  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  2  4  0  0  6  1  0]
 [ 0  0  0  0  0  0  0  0  2  0  4  0  8  0  1  1]
 [ 0  0  0  0  0  0  0  0  2  3  2  2  4  1  4  4]]

>>>>>>>>>>>>>> 5 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/5/weights.48-0.52.hdf5
------ TRAIN ACCURACY:  weights.48-0.52.hdf5  ------
0.934019001133
[[ 143    1    2    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  201    0    0    1    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1711    0    2    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7 1896    0    0   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  877    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    2  722    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0    5    2 1280    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  289    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    3  194    0    0    0    0    0
     0    1    0]
 [   0    2    0    0    0    1    0    0    2  454    9    0    1   38
     1    1    4]
 [   1    0    0    0    1    0    0    1    0   19  432   12    1   12
     7    7    9]
 [   0    2    0    0    2    1    0    4    0    7   23  392    8    9
    18    4   35]
 [   0    1    0    0    0    0    0    4    0    0    2   10  615    5
     0    6    3]
 [   2    0    0    0    0    0    0    0    0   44    7    3    2  403
     1    5    7]
 [   0    1    0    0    0    4    1   10    2    1    9   30   20    0
   328    2   17]
 [   0    0    0    0    1    0    0    1    0    4   54    3   17   26
     4  343   45]
 [   0    0    2    0    0    0    0    3    0    2    5   32    2   20
     2   12  436]]
------ TEST ACCURACY:  weights.48-0.52.hdf5  ------
0.694630872483
[[ 2  1  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  8  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 66  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 19  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  3  0  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  1  1  0  1  0  0  0  1  2  3]
 [ 0  0  0  0  0  0  0  1  0  0  0  2  0  0  2  0 16]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  0  0  0  0  2  0  4]
 [ 0  0  0  0  0  0  0  0  2  0  2  0  0  2  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  3  0 10  2]]

>>>>>>>>>>>>>> 6 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/6/weights.44-0.50.hdf5
------ TRAIN ACCURACY:  weights.44-0.50.hdf5  ------
0.930451624263
[[ 150    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  207    1    0    1    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1676    0    4    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1919    0    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  855    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0    3    8 1261    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    1    0    0  270    8    0    0    0    1    0
     0    0    0]
 [   0    0    0    0    0    0    1    2  192    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    1    0    0    0  459    5    1    3   32
     1    3    5]
 [   0    0    1    0    1    0    0    2    0   25  425   13    0   13
     1   11    4]
 [   0    1    0    0    1    1    0    1    0   22   15  398   11    9
    23    0   25]
 [   0    0    0    0    0    0    0    4    0    1    2    8  591   10
     3   12    7]
 [   1    2    0    0    0    0    0    0    0   51    4    6    5  391
     0    2    2]
 [   0    1    0    0    0    2    1    8    1    2   10   41   18    0
   320    1   11]
 [   0    0    0    0    1    0    0    0    0   19   57    5   12   21
     3  332   43]
 [   0    0    0    0    0    0    0    0    0   13   21   25    4   28
     8   11  406]]
------ TEST ACCURACY:  weights.44-0.50.hdf5  ------
0.820388349515
[[ 2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 42  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 29  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  3  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0  0  1 12  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 17  0  0  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3 10  1  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1 13  0  0  5  0  0]
 [ 0  0  0  0  0  0  2  0  0  0  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 12  1  0  0  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0 12  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  3 15]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  2 15]]

>>>>>>>>>>>>>> 7 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/7/weights.34-0.49.hdf5
------ TRAIN ACCURACY:  weights.34-0.49.hdf5  ------
0.921335547592
[[ 151    1    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   8  191    4    0    1    0    0    6    0    0    1    0    0    0
     0    0    0]
 [   0    0 1685    0    1    0    2    0    0    0    0    1    0    0
     0    0    0]
 [   0    0   10 1918    0    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10    0  848    0   27    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    4  717    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11    1    2    2 1275    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    1  277    4    0    2    0    1    0
     1    0    0]
 [   0    0    0    0    0    0    1    4  185    0    1    0    0    0
     0    0    1]
 [   1    1    0    0    0    1    0    0    0  458    7    0    1   40
     1    3    3]
 [   0    0    1    2    0    1    0    3    0   21  428    6    3   19
     4    6    2]
 [   0    0    0    0    2    1    0    6    0   20   23  379   13    8
    22   10   24]
 [   0    1    0    0    0    0    0    3    0    2    5    9  594   10
     0   10    9]
 [   2    1    0    0    0    0    0    0    1   62    5    0    1  371
     1    9    9]
 [   0    0    0    0    2    1    0    8    0    1    9   57   23    0
   307    1   17]
 [   0    0    0    0    1    0    0    2    0   21   64    1   18    9
     6  336   42]
 [   0    0    1    0    0    0    0    1    0   11   22   20    4   15
     5   22  421]]
------ TEST ACCURACY:  weights.34-0.49.hdf5  ------
0.781818181818
[[ 4  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0 41  0  0  0  8  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  1  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  2  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  7  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  0  0  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 14  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  4  0  0  0  0  5]
 [ 0  1  0  0  0  0  0  0  0  0  0 15  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  5  0  0  0 14  0  1  2]
 [ 0  0  0  0  0  0  1  0  0  0  1  0  0  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  1 12]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  4  8]]

>>>>>>>>>>>>>> 8 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/8/weights.45-0.50.hdf5
------ TRAIN ACCURACY:  weights.45-0.50.hdf5  ------
0.928345349042
[[ 150    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  214    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1670    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1930    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    0  862    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   16   24    1    7 1229    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  277    3    0    0    0    1    0
     0    0    0]
 [   0    0    0    0    0    0    0    3  185    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    1    0    0    1  441    5    0    0   46
     4    1    2]
 [   1    1    0    0    3    0    0    3    1   20  412    7    3   23
     7    8    5]
 [   0    3    0    0    1    1    0    6    0   15   21  378   10   13
    38    0   23]
 [   0    1    0    0    0    0    0    2    0    1    8    7  597    8
     4    5    3]
 [   1    1    0    0    1    0    0    0    0   42    2    2    2  407
     4    1    2]
 [   0    1    0    0    1    2    0    6    0    1    8   43   23    0
   324    0   11]
 [   0    2    0    0    1    0    0    0    0   10   64    2   11   20
     4  354   35]
 [   0    1    1    0    0    0    0    0    0    7   10   17    4   25
    12   28  408]]
------ TEST ACCURACY:  weights.45-0.50.hdf5  ------
0.768261964736
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 52  0  0  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  8  7  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  5  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 12  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  7  0  0  0  9  0  0  9]
 [ 0  0  0  0  0  0  0  3  0  0 14  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  1  0  3  7  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 25  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  0  0  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  4  3  0  0  6  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  7  2]
 [ 0  1  0  0  0  0  0  0  0  2  0  3  0  5  1  3  6]]

>>>>>>>>>>>>>> 9 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/9/weights.49-0.49.hdf5
------ TRAIN ACCURACY:  weights.49-0.49.hdf5  ------
0.930879633706
[[ 149    2    1    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  209    1    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1685    0    1    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1922    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   26    0  844    0   31    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    4    0    8 1257    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    1  279    5    0    0    0    0    0
     1    1    0]
 [   0    0    0    0    0    0    1    1  188    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    1    0    0    0  459    8    1    3   32
     4    0    1]
 [   0    1    0    0    0    0    0    2    0   26  417    5    3   19
     1    0    8]
 [   0    2    0    0    0    1    1    2    0   11   22  405    6    8
    29    0   19]
 [   0    0    0    0    0    0    0    3    0    0    5   17  578   14
     2    4    1]
 [   0    0    0    0    1    0    0    0    0   32   10    3    1  417
     1    6    2]
 [   0    0    0    0    1    2    0    5    2    1    8   43   23    0
   329    0    7]
 [   0    1    0    0    2    0    0    0    1    6   68    7   18   23
     9  307   40]
 [   0    1    0    0    1    0    1    1    0    2   13   23    3   32
    15    7  406]]
------ TEST ACCURACY:  weights.49-0.49.hdf5  ------
0.678743961353
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 50  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 60  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 11  0  9  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  7  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  9  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0 18  0  1  0]
 [ 0  1  0  0  0  2  0  2  0  5 13  0  0  1  0  3  2]
 [ 0  0  0  0  0  0  0  0  0  0  9  0  0  0 10  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  1  0 31  3  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  2  2  0  4  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  1  3  0  0  9  0  0]
 [ 0  0  0  0  0  0  0  0  1  5  0  1  1  5  3  6  9]
 [ 0  0  0  0  2  0  0  1  0 10  0  1  1  0  0  8  6]]

>>>>>>>>>>>>>> 10 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/10/weights.18-0.47.hdf5
------ TRAIN ACCURACY:  weights.18-0.47.hdf5  ------
0.888636760342
[[ 131    8    5    0    4    0    0    0    5    0    0    0    0    0
     0    0    0]
 [   1  193    5    0    2    0    0   13    0    0    1    0    0    0
     0    1    0]
 [   0    0 1675    3    6    3   18    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    3 1931    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    1   27    0  828    4   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0  727    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   17   64    1    3 1210    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    3    0    1  266   13    0    1    3    2    0
     2    0    0]
 [   0    0    0    0    0    0    1    7  174    0    0    0    0    1
     2    1    1]
 [   0    0    0    0    0    1    0    0    0  451    5    3    9   33
     2    0    3]
 [   0    0    1    0    1    0    1    0    0   35  394   20    9   14
     8   11    5]
 [   0    0    1    0    0    2    1    8    1   17   24  364   14    8
    25    2   37]
 [   0    1    0    0    0    0    0    2    0    6    3    9  596   10
     4    6    6]
 [   1    3    0    0    0    0    0    2    0  105    7    6    7  321
     0    3   12]
 [   0    1    0    0    2    0    1    6    0    1   16   62   28    0
   282    2   19]
 [   0    0    0    0    1    0    1    1    0   39   54   15   32   10
    12  267   69]
 [   0    0    0    0    0    0    0    0    0   19   20   54   12   21
     5   14  372]]
------ TEST ACCURACY:  weights.18-0.47.hdf5  ------
0.690095846645
[[32  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 51  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0 13  0 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 17  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  7 22  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  3  8  0  0  0  0  0  1  1  0]
 [ 0  0  0  0  0  0  0 19  0  0  3  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 11  0  0  0  1  0  0]
 [ 2  0  0  0  0  0  0  1  5  5  2  0  0  0  7]
 [ 0  0  0  0  0  0  0  0  1  0 16  0  0  0  1]
 [ 0  0  0  0  0  0  0 11  0  0  1  5  0  0  0]
 [ 0  1  0  0  0  0  0  0  1  4  1  0  6  0  1]
 [ 0  0  0  0  0  0  0  0 12  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  0  0  3  0  0  0  9]]

>>>>>>>>>>>>>> 11 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/11/weights.39-0.52.hdf5
------ TRAIN ACCURACY:  weights.39-0.52.hdf5  ------
0.918973547763
[[ 140    3    0    0    1    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   4  193    1    0    1    0    0    9    0    0    2    0    0    0
     0    1    0]
 [   0    0 1706    1    6    0    0    0    0    0    0    0    0    0
     0    2    0]
 [   0    0    4 1894    0    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  852    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  724    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    2    7   10 1243    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    1    1  280    4    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    1  193    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    1    0    0    0  452    7    1    7   32
     0    3    7]
 [   1    0    1    0    0    0    0    3    1   28  421   14    3    6
     3    4    6]
 [   0    1    0    0    1    2    0    1    0   10   28  395    9    7
    20    4   34]
 [   0    0    0    0    1    0    0    3    0    1    1   13  599    6
     0   11    2]
 [   1    1    0    0    1    0    0    0    0   62    9    1    8  358
     0   15    9]
 [   0    1    0    0    1    2    1    4    0    1   19   50   26    0
   299    3    9]
 [   0    0    0    0    1    0    0    2    0   11   80    5   20    7
     7  310   56]
 [   0    0    1    0    0    0    0    1    0    3   27   27   14   23
     4   20  398]]
------ TEST ACCURACY:  weights.39-0.52.hdf5  ------
0.72193877551
[[ 3  0  0  0  0  0  0  0  0  0  0  0  3  0  0  0  0]
 [ 1  3  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 23  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 82  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  7  3 30  1  1  0  0  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 12  0  1  4 40  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  1  0  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  1  0  7  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0 14  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  2  0  0  4  0  7]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  0  0  5  0]
 [ 0  0  1  0  0  0  0  0  0  6  0  0  0  8  0  1  3]
 [ 0  0  0  0  0  0  0  0  0  0  2  3  0  0  9  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  3  0  0  5  2]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  0  3  0  3  5]]

>>>>>>>>>>>>>> 12 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/12/weights.45-0.52.hdf5
------ TRAIN ACCURACY:  weights.45-0.52.hdf5  ------
0.933546269186
[[ 145    1    0    0    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   1  205    1    0    0    0    0    4    0    0    0    0    0    0
     0    0    0]
 [   0    0 1553    0    1    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1911    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0  860    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    4    1    5 1270    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1  288    6    0    1    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  196    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    1    0    0    1  479    6    2    5   13
     1    1    3]
 [   1    0    1    1    1    0    0    3    0   25  435    6    7    7
     2    3    4]
 [   0    0    0    0    1    0    0    1    1   12   31  401   11    6
    15    6   29]
 [   0    0    0    0    0    0    0    3    0    2    7    7  611    4
     1    5    1]
 [   2    1    0    0    0    0    0    0    0   74    6    1    7  359
     2    3    9]
 [   0    0    0    0    0    3    0   11    0    2   15   40   17    0
   331    0    5]
 [   0    0    0    0    1    0    0    1    0   23   65    3    7    8
     0  338   50]
 [   0    0    1    0    0    0    0    3    0    7   10   25    7   10
    10   16  426]]
------ TEST ACCURACY:  weights.45-0.52.hdf5  ------
0.796
[[  6   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  1   4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 153   0  25   0   4   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  71   0   0   3   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  29   0   3   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  26   6   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  36   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   2   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  13   0   2   1   0   0   0   1]
 [  0   0   0   0   0   0   0   0   0   0  10   0   0   1   1   2   1]
 [  0   0   0   0   0   0   0   0   0   0   0   8   0   0   0   2   2]
 [  0   0   0   0   0   0   0   0   0   0  10   0  10   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   0   0  13   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   1   0   0   0   8   1   0]
 [  0   0   0   0   0   0   0   0   0   0  12   0   0   0   0   0   5]
 [  0   0   0   0   0   0   0   0   0   0   2   0   1   2   0   5   9]]

>>>>>>>>>>>>>> 13 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/13/weights.49-0.51.hdf5
------ TRAIN ACCURACY:  weights.49-0.51.hdf5  ------
0.93373705459
[[ 147    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  207    0    0    0    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1713    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1913    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0  860    0   17    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   17    1    2    9 1250    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  275    3    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    3  192    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    1    0    1    0  454    6    4    2   35
     2    0    2]
 [   1    0    0    0    0    0    0    0    0   23  431    7    1   15
     1   12    2]
 [   0    1    0    0    1    1    1    3    0    6   24  421    6    8
    13    4   19]
 [   0    1    0    0    0    0    0    4    0    0   12    7  592   11
     1    5    3]
 [   1    1    0    0    0    0    0    0    0   43   11    1    1  400
     0    7    9]
 [   0    0    0    0    0    2    0    4    3    1   13   53   15    2
   305    0   20]
 [   0    0    0    0    1    0    0    2    0   13   72    4    8   17
     4  332   42]
 [   0    0    1    0    0    0    0    1    0    6   16   23    2   20
     2   15  426]]
------ TEST ACCURACY:  weights.49-0.51.hdf5  ------
0.801061007958
[[ 1  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  0  0  0  1  0  0  0  0  0  0  0  3  0]
 [ 0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0 13  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  5  0  0  0  0  0  6]
 [ 0  0  1  0  0  0  0  0  0  0  5  0  0  0  0 12  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  3  1  0  0  2  8]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 25  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  8  0  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  0 15  0]
 [ 0  0  0  0  0  0  0  0  0  1  9  0  0  0  0  3  9]]

>>>>>>>>>>>>>> 14 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/14/weights.45-0.51.hdf5
------ TRAIN ACCURACY:  weights.45-0.51.hdf5  ------
0.931748398982
[[ 150    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  207    2    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1681    0    2    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1924    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    0  843    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10    4    0    7 1253    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  291    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2  192    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    1    0    0    0  473    6    0    3   23
     7    2    1]
 [   0    0    1    0    2    0    0    2    0   24  428   10    5   12
     2    5    2]
 [   0    1    0    0    1    0    0    5    0   15   17  392   13    8
    33    0   18]
 [   0    2    0    0    0    0    0    2    0    2    3    5  612    4
     3    6    2]
 [   0    0    0    0    1    0    0    0    0   69    3    1    3  388
     1    3    5]
 [   0    0    0    0    0    3    0    5    2    2   12   41   19    2
   320    0    8]
 [   0    1    0    0    1    0    0    1    0   14   58    1   14   23
     4  343   35]
 [   0    1    0    0    0    0    0    1    0   12   18   23    5   25
    16   19  403]]
------ TEST ACCURACY:  weights.45-0.51.hdf5  ------
0.846774193548
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  2  0  0  1  0  0  0  0  0  0]
 [ 0  0 47  0  1  0  6  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 38  0  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 50  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  1  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0  0  0  0  3  2  0  0  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 15  0  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  6  8  6  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 20  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0 20  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  7  0  0  0  0 10  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  1  8]]

>>>>>>>>>>>>>> 15 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/15/weights.27-0.52.hdf5
------ TRAIN ACCURACY:  weights.27-0.52.hdf5  ------
0.914029535865
[[ 141    2    0    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  198    1    0    1    0    0    7    1    0    0    0    0    1
     0    1    0]
 [   0    0 1668    0    5    0   18    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1883    0    0   12    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  871    0   28    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  713    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5   10    2    9 1243    0    0    0    0    0    0    0
     0    0    0]
 [   1    1    0    0    0    0    1  266   11    0    0    1    1    0
     2    0    0]
 [   0    0    0    0    0    0    0   11  179    0    0    0    0    0
     0    1    1]
 [   0    1    0    0    0    1    0    0    0  427    5    0    4   74
     0    3    2]
 [   1    0    1    0    0    0    0    4    1   21  398   13    6   28
     3    9    8]
 [   0    0    0    1    0    1    1    4    1    5   18  392   14   16
    25    0   34]
 [   0    1    0    0    0    0    0    4    0    1    3   13  598   12
     0    5    6]
 [   2    3    0    0    0    0    0    0    0   37    5    3    0  407
     1    5    6]
 [   0    1    0    0    2    0    1    4    4    1   15   50   22    0
   301    1   14]
 [   0    0    0    0    1    0    1    0    1   21   68    3   26   22
     9  296   52]
 [   0    0    1    0    0    0    0    1    0    1   17   25    3   28
    13   13  417]]
------ TEST ACCURACY:  weights.27-0.52.hdf5  ------
0.820253164557
[[ 2  0  0  0  0  0  0  2  5  0  0  0  0  0  0  0  0]
 [ 2  1  0  0  0  0  0  1  1  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 88  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 16  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  1 54  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  0  0  0  0  0  0  0  0  1]
 [ 1  0  0  0  0  0  1  0  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  3  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 14  0  3  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  5  0  2  4  0  1]
 [ 0  0  0  2  0  0  0  0  0  0  0  0  9  0  2  2  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  3  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  3  0  0  1  6]
 [ 0  0  0  0  0  0  0  0  0  3  8  0  0  0  0  0  4]]

>>>>>>>>>>>>>> 16 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/16/weights.32-0.51.hdf5
------ TRAIN ACCURACY:  weights.32-0.51.hdf5  ------
0.918871096169
[[ 142    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  193    0    0    1    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1676    0    3    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1894    0    0   10    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0  841    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11    4    3    7 1240    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    1    0    1  261    5    0    2    0    1    0
     1    0    0]
 [   0    0    0    0    0    0    1    6  185    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    1    0    0    3  427    6    2    8   58
     3    0    2]
 [   1    0    1    1    1    0    0    3    1   19  404   16    5   27
     4    5    4]
 [   0    1    0    0    1    1    1    4    0    9   27  400    9   15
    27    1   16]
 [   0    0    0    0    1    0    0    3    0    0    2   12  605   10
     0    6    1]
 [   1    3    0    0    1    0    0    0    0   42    5    5    1  402
     1    4    5]
 [   0    0    0    0    2    0    0    4    1    0   14   54   19    0
   322    1    6]
 [   0    0    0    0    1    0    1    3    1   13   72    7   22   34
     4  303   30]
 [   0    0    0    0    0    0    0    1    0    5   18   47    7   30
     7   16  377]]
------ TEST ACCURACY:  weights.32-0.51.hdf5  ------
0.724358974359
[[ 5  2  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 7  7  0  0  0  0  0  1  2  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 77  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 46  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 12 17  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  1  0  0 57  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0 16  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  4  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 15  0  0  3  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3 12  1  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  1  0  5  0  2  4  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  0  3  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  2  2  2  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0 12  0  0  0  4  2  0  4]
 [ 0  0  0  0  0  0  0  0  0  0 16  0  6  0  0  0  4]]

>>>>>>>>>>>>>> 17 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/17/weights.39-0.51.hdf5
------ TRAIN ACCURACY:  weights.39-0.51.hdf5  ------
0.92745930644
[[ 144    5    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  200    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1630    1    2    1    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1903    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    4    0  864    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6   18    3    7 1240    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  279    2    0    0    0    1    0
     0    0    0]
 [   0    0    0    0    0    0    1    2  190    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    1    0    0    1  490    5    0    2   14
     1    1    2]
 [   0    0    1    0    1    0    1    3    0   35  422    4    7   14
     3    1    3]
 [   0    2    0    1    1    2    0    1    0   17   29  382   13    6
    25    0   26]
 [   0    1    0    0    0    0    0    2    0    1    2    7  616    3
     1    4    4]
 [   0    4    0    0    1    0    0    0    0   69    4    1    7  364
     4    8    2]
 [   0    1    0    0    2    0    0    5    0    1   13   32   28    1
   313    0   15]
 [   0    0    0    0    1    0    0    0    0   23   76    4   15    8
     6  308   54]
 [   0    0    1    0    0    0    0    0    0   15   26   24    5   17
     7    9  413]]
------ TEST ACCURACY:  weights.39-0.51.hdf5  ------
0.811563169165
[[  4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  1  10   0   0   0   0   0   4   0   0   0   0   0   0   0   0   0]
 [  0   0 103   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  81   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  10   0  18   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  19   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  50   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0  13   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   6   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   0   3   2   0   0   0]
 [  0   0   0   0   0   0   0   0   0   3   6   3   0   0   0   3   1]
 [  0   0   0   0   0   0   0   0   0   0   3  17   0   1   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  17   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   8   0   0   8   4   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   5   0   0   6   9   0   3]
 [  0   0   0   0   0   0   0   0   0   0   3   1   3   0   1   6   4]
 [  0   0   0   0   0   0   0   0   0   0   4   2   0   0   2   0   9]]

>>>>>>>>>>>>>> 18 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/18/weights.36-0.52.hdf5
------ TRAIN ACCURACY:  weights.36-0.52.hdf5  ------
0.921174113753
[[ 128    5    3    0    1    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0  196    4    0    0    0    0    6    0    0    0    0    0    0
     1    0    0]
 [   0    0 1729    0    3    0    5    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    5 1924    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   18    0  851    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  727    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   15   15    0    7 1256    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    0    0    0  274    5    0    1    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0   10  176    0    0    0    0    0
     1    1    0]
 [   0    0    1    0    0    0    0    0    0  460    5    1    5   37
     0    3    3]
 [   0    0    1    0    0    0    0    3    0   26  402   13    2   22
     8   14    2]
 [   0    1    1    0    2    1    0    5    1    2   24  382    5   13
    42   10   20]
 [   0    1    0    0    0    0    0    6    0    1    2    5  608    4
     3   11    2]
 [   1    2    0    0    0    0    0    0    0   47    1    4    3  401
     0    5    7]
 [   0    1    0    0    2    0    1    8    2    0    8   44   19    2
   327    3    6]
 [   0    0    0    0    1    0    1    2    0   23   58    4   14   14
    12  333   41]
 [   0    0    0    0    1    0    0    0    0   10    9   35    2   21
    11   30  402]]
------ TEST ACCURACY:  weights.36-0.52.hdf5  ------
0.727586206897
[[11  1  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  5  0  0  0  0  0  2  0  0  0  0  0  0  0  1  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 56  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  3  0  6  7  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 31  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  5  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 11  0  0  0  4  2  1]
 [ 0  0  0  0  0  0  0  0  0  1  0  5  0  3  0  5  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 15  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 11  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0  6  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  4  4]
 [ 0  0  0  0  0  0  0  3  0  0  5  0  0  0  0  2  3]]

>>>>>>>>>>>>>> 19 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/19/weights.33-0.52.hdf5
------ TRAIN ACCURACY:  weights.33-0.52.hdf5  ------
0.915080399826
[[ 144    2    0    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  192    0    0    2    0    0    7    0    0    0    0    0    0
     1    1    0]
 [   0    0 1646    0   71    0    6    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    1 1903    0    0   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    7    0  894    0   15    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10    1   27   12 1243    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    1    0    0  278    9    0    0    1    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    3  186    0    0    0    0    0
     0    2    0]
 [   0    1    0    0    0    1    0    1    1  454    2    3    4   48
     0    2    4]
 [   0    0    2    0    2    0    0    5    2   25  381   23    1   22
     3   22    8]
 [   0    2    0    0    1    1    0    1    1    9   13  426    9    9
    20    6   19]
 [   0    0    0    0    0    0    0    4    0    1    1   13  600   11
     0    7    7]
 [   2    1    0    0    1    0    0    0    0   46    1    1    2  409
     3    5    3]
 [   0    2    0    0    3    0    0    5    2    2    8   72    5    1
   305    3   11]
 [   0    0    0    0    1    0    0    1    0   19   42   11   13   32
     3  355   27]
 [   0    1    0    0    0    0    0    3    0    7    5   42    1   31
     8   35  389]]
------ TEST ACCURACY:  weights.33-0.52.hdf5  ------
0.725563909774
[[ 5  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 10  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 15  0 16  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  6  0  0  1]
 [ 0  0  0  0  0  0  0  3  0  0  0  0  0  2  0 10  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  9]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  1  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  7  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  9  1]]

>>>>>>>>>>>>>> 20 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/20/weights.43-0.50.hdf5
------ TRAIN ACCURACY:  weights.43-0.50.hdf5  ------
0.928293545535
[[ 140    2    0    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  196    2    0    1    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1579    0    2    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1911    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  864    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  723    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    6    2    3 1261    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    1  276    9    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    0    1    1  190    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    1    0    0    1  443    8    1    4   52
     1    2    0]
 [   0    0    0    0    2    0    0    2    1   20  440   10    1   15
     3    3    4]
 [   0    1    0    0    0    3    2    3    1    6   21  417   11   11
    20    1   22]
 [   0    0    0    0    0    0    0    3    0    0    7   12  601    8
     1    6    5]
 [   1    2    0    0    1    0    0    0    1   29   10    4    8  399
     1   11    2]
 [   1    1    0    0    1    2    0    5    0    1   13   51   21    0
   319    0   10]
 [   0    0    0    0    1    0    0    0    1   11   70    3   15    9
     7  348   34]
 [   0    0    1    0    0    0    0    0    0    4    9   43    3   27
    15   31  392]]
------ TEST ACCURACY:  weights.43-0.50.hdf5  ------
0.733188720174
[[  6   4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0  10   0   0   2   0   0   1   0   0   0   0   0   0   0   0   0]
 [  0   0 138   0   0   0  18   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  71   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   1  24   4   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  18   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   8  32   0   3   7   0   0   0   0   0   0   0   0   0   0]
 [  2   0   0   0   0   0   0   5   1   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   8   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   9   0   0   0   7   0   0   0]
 [  0   3   0   0   0   0   0   0   0   0   2   3   0   0   2   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   6   0   0   1   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  18   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   6   0   0   1   8   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   2   2   0   0   5   0   0]
 [  0   0   0   0   0   0   0   0   0   0   4   5   0   0   3   1   1]
 [  0   0   0   0   0   0   0   0   0   2   4   1   0   0   0   0   2]]

>>>>>>>>>>>>>> 21 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/21/weights.49-0.51.hdf5
------ TRAIN ACCURACY:  weights.49-0.51.hdf5  ------
0.933600208859
[[ 143    2    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  201    0    0    1    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1720    0   11    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1916    0    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  901    0   10    0    0    0    0    0    0    1
     0    0    0]
 [   0    0    0    0    0  724    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0   23    9 1245    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  280    5    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    2  183    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    1    0    0    0  474    2    2    2   32
     1    1    1]
 [   1    0    1    0    0    0    0    4    0   28  413   12    2   21
     2   13    5]
 [   0    0    0    0    1    0    0    2    1    8   15  416   11   12
     9    1   33]
 [   0    1    0    0    0    0    0    2    0    2    6   12  598   12
     0    7    2]
 [   1    0    0    0    0    0    0    0    0   36    1    3    1  424
     0    3    4]
 [   0    0    0    0    2    0    0    5    1    1    9   52   10    1
   315    8   21]
 [   0    0    0    0    0    1    0    1    0   20   49   11   17   19
     5  339   39]
 [   0    1    0    0    0    0    0    3    0    9   14   19    2   31
     1   11  436]]
------ TEST ACCURACY:  weights.49-0.51.hdf5  ------
0.45
[[ 2  4  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0]
 [ 0  4  0  0  0  0  0  7  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  6  0  0 52  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  8  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  5  0 22  0 19  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  5  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  0  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  4  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  7  0  0  2  5  3  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2 16  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0  6  0  0  2]
 [ 0  1  0  0  0  0  0  0  0  0  1  2  1  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  4  0  5  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  3  0  0  2  0]]

>>>>>>>>>>>>>> 22 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/22/weights.44-0.51.hdf5
------ TRAIN ACCURACY:  weights.44-0.51.hdf5  ------
0.9314255338
[[ 134    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  200    1    0    0    0    0    3    0    0    1    0    0    0
     0    0    0]
 [   0    0 1667    0    5    0    4    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    4 1912    0    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  858    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  720    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    1    6    7 1253    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  275    3    0    0    0    1    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  182    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    1    0    0    0  470   10    0    2   21
     1    2    0]
 [   1    0    1    1    0    0    0    2    1   21  412    7    5   16
     3   14    6]
 [   0    0    0    0    1    1    0    1    1   12   29  380   16    8
    28    5   16]
 [   0    0    0    0    0    0    0    3    0    0    2   10  607    6
     0    7    3]
 [   0    0    0    0    0    0    0    0    0   65    8    2    4  374
     0    4    6]
 [   0    1    0    0    0    2    0    5    2    0   16   41   24    0
   314    6    6]
 [   0    0    0    0    1    0    0    1    0   20   52    3   10   11
     3  351   38]
 [   0    0    0    0    0    0    0    0    0    8   16   17    8   21
     7   31  404]]
------ TEST ACCURACY:  weights.44-0.51.hdf5  ------
0.652892561983
[[ 8  3  0  0  3  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 1  4  0  0  4  0  0  1  0  0  0  0  0  0  0  1  0]
 [ 0  1 57  0  3  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 60  0  0  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 29 16  0  0  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  2  0  5 43  0  0  0  0  1  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  8  4  0  0  1  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  6  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 19  0  0  0  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  3  3  0  0  0  0  0 15]
 [ 0  0  0  0  0  0  0  0  0  4  5  0  0  0  8  0 11]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 23  0  0  0  0]
 [ 2  3  0  0  0  0  0  1  0 12  1  0  0  1  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0 10  4  0]
 [ 0  0  6  0  0  0  0  0  0  0 12  0  0  0  0  5  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  7  0  0  0  3 12]]

>>>>>>>>>>>>>> 23 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/23/weights.24-0.51.hdf5
------ TRAIN ACCURACY:  weights.24-0.51.hdf5  ------
0.905373525557
[[ 136    7    3    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   5  190    3    0    1    0    0    9    0    0    0    0    0    0
     0    1    0]
 [   0    1 1714    0    3    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1906    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   24    0  843    0   28    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   36   16    3    9 1215    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    1    0    2  262   11    0    0    0    1    0
     1    1    0]
 [   0    0    0    0    0    0    1    4  184    0    0    0    0    1
     1    2    1]
 [   0    0    1    0    0    1    0    0    0  426    5    0    7   65
     0    0    2]
 [   0    0    2    1    2    0    1    3    0   24  416    8    2   24
     8    7    4]
 [   0    1    0    0    1    2    0    6    0   14   34  366   20   15
    25    1   32]
 [   0    0    0    0    0    0    0    4    0    1    4    7  604   18
     0    5    3]
 [   1    3    1    0    1    1    0    0    0   36    7    4    3  401
     0    2    9]
 [   1    0    0    1    2    0    1    5    1    3   19   51   15    1
   299    3   23]
 [   0    0    7    0    1    0    1    4    0   21   78    3   19   18
     6  288   52]
 [   0    0    0    0    0    0    1    7    0    4   20   25    8   36
    11   17  391]]
------ TEST ACCURACY:  weights.24-0.51.hdf5  ------
0.730061349693
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 4  3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  8  0  0  0  7  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 74  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  4  0 19  0  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  1 44  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  2  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0 21  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  0  2  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  6  0  0  1  0  2]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  5  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  0  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  4  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  4  0  0  7  1]
 [ 0  0  0  0  0  0  0  0  0  0  8  0  0  0  2  0  4]]

>>>>>>>>>>>>>> 24 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/24/weights.42-0.50.hdf5
------ TRAIN ACCURACY:  weights.42-0.50.hdf5  ------
0.92688172043
[[ 130    1    0    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  192    0    0    0    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1548    2    2    1    5    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    0 1914    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    5    0  824    0   28    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    2    0    9 1252    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  273    3    0    0    0    1    0
     0    0    0]
 [   0    0    0    0    0    0    1    7  182    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    1    0    0    0  422   12    2    2   61
     1    3    2]
 [   0    0    1    1    1    0    0    5    0   22  433    8    4   15
     0    5    1]
 [   0    0    0    1    0    3    1    1    1    8   36  400    5    5
    29    3   19]
 [   0    0    0    0    0    0    0    3    0    2    6    9  593   19
     0    7    1]
 [   1    1    0    0    1    0    0    0    0   37    5    3    0  407
     1    7    6]
 [   0    1    0    0    1    3    0    8    3    0   13   41    6    0
   324    5    4]
 [   0    1    0    6    0    0    1    0    0   10   62    3    5   25
     4  336   41]
 [   0    2    1    0    0    0    0    2    0    3   12   30    9   24
    12   27  395]]
------ TEST ACCURACY:  weights.42-0.50.hdf5  ------
0.759410801964
[[  7  11   0   0   0   0   0   1   1   0   0   0   0   0   0   1   0]
 [  0   6   0   0   0   0   0   8   0   0   0   2   0   0   0   3   0]
 [  0   0 179   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  69   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   2   0  55   6   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  27   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   2  12   0   0  42   0   0   0   0   0   0   0   0   0   0]
 [  0   2   2   0   0   0   0   5   0   0   1   0   5   0   0   3   0]
 [  1   0   0   0   0   0   0   2   7   0   0   0   0   0   0   0   0]
 [  0   2   0   0   0   0   0   0   0  21   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0  10   0   0   0   0   5   0]
 [  0   0   0   0   0   0   0   0   0   0   0   1   2   7   0   4   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  19   2   0   0   0]
 [  0   0   0   0   0   0   0   0   0   3   0   0   0  12   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0  13  11   0   0   1   0]
 [  0   0   0   0   0   0   0   0   0   0   5   0  10   1   0   3   0]
 [  0   0   0   0   0   0   0   1   0   0   4   6   1   1   0   3   1]]

>>>>>>>>>>>>>> 25 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/25/weights.37-0.49.hdf5
------ TRAIN ACCURACY:  weights.37-0.49.hdf5  ------
0.919672708077
[[ 149    1    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   4  202    0    0    1    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1683    0    2    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1914    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11    0  867    0   17    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   24    7    9    8 1224    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    1    0    1  281    1    0    1    0    1    0
     0    0    0]
 [   0    0    0    0    0    0    1    6  182    0    0    0    0    0
     1    2    0]
 [   0    2    0    0    0    0    0    0    0  446    0    1    3   55
     2    1    2]
 [   1    0    1    0    1    0    0    3    1   29  399    7   10   17
     6    9    8]
 [   0    0    0    1    1    3    0    3    0   23   14  394   10    9
    26    2   26]
 [   0    0    0    0    0    0    0    4    0    8    2    7  585   17
     2    6    2]
 [   2    3    0    0    1    0    0    1    1   73    3    3    8  363
     1    3    1]
 [   0    1    0    0    1    0    0    7    1    0    6   49   24    0
   315    1   14]
 [   0    0    0    0    0    0    0    0    0   13   37    4   25   18
     7  343   38]
 [   0    0    1    0    0    0    0    2    0   12    9   32    5   28
    13   28  383]]
------ TEST ACCURACY:  weights.37-0.49.hdf5  ------
0.725925925926
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  2  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 43  2  4  0  1  0  0  0  0  0  0  0  0  3  0]
 [ 0  0  1 66  0  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 21  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  2  0 50  0  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  0  0  0  2  1  0  0  0  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  4  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  1  0  0  0  5  4  0  0  6  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  3  8  0  1  3  0  3  1]
 [ 0  0  0  0  0  0  0  0  0  1  6  3  0  1  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 27  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  1  0 19  0  0  0]
 [ 0  0  0  0  2  1  0  0  0  0  4  4  1  0  1  2  0]
 [ 0  0  0  0  0  0  0  0  0  9 15  1  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  3 17]]

>>>>>>>>>>>>>> 26 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/26/weights.46-0.50.hdf5
------ TRAIN ACCURACY:  weights.46-0.50.hdf5  ------
0.929164844775
[[ 149    2    1    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  208    1    0    1    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1707    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1921    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    1   10    0  860    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   24    3    2    6 1241    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  274   16    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    0  199    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    1    0    0    2  447    4    0    2   55
     1    0    0]
 [   0    0    1    0    0    0    0    2    1   21  436    4    1   12
     1    8    3]
 [   0    0    0    0    1    1    1    5    0   14   24  404    9    8
    19    0   21]
 [   0    0    0    0    0    0    0    0    0    6    1   10  598   11
     0    9    1]
 [   1    2    0    0    0    0    0    0    0   51    6    3    2  401
     0    9    2]
 [   0    2    0    0    2    0    0    3    2    1   16   44   20    0
   314   10    7]
 [   0    0    6    0    0    0    0    0    2   18   76    2   16   17
     6  327   24]
 [   0    0    1    0    0    0    0    0    0    6   14   27    2   23
     4   24  417]]
------ TEST ACCURACY:  weights.46-0.50.hdf5  ------
0.779761904762
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 31  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 48  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  6  0  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  3 14  2  1  0  0  0  1]
 [ 0  1  0  0  0  0  0  1  0  0  4  2  0  0  0  0 11]
 [ 0  0  0  0  0  0  0  3  0  0  0  0 20  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  5  0  0  0]
 [ 0  0  0  0  0  0  0  5  2  0  0  4  1  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  6 12]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  0  5  2  8]]

>>>>>>>>>>>>>> 27 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/27/weights.44-0.49.hdf5
------ TRAIN ACCURACY:  weights.44-0.49.hdf5  ------
0.928427507665
[[ 147    5    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  209    1    0    0    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1688    0    7    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1909    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  878    0   17    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    2    6    7 1261    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    1    0    0  282    4    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    4  194    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    1    0    0    0  444    8    1    3   48
     1    0    5]
 [   0    0    2    2    0    0    0    4    1   20  413    9    5   10
     2   12   17]
 [   0    1    0    1    1    0    0    4    0   11   16  403   17    9
    14    1   26]
 [   0    2    0    0    0    0    0    2    0    7    3    7  594    9
     3   10    3]
 [   0    0    0    0    0    0    0    1    0   63    3    2    9  387
     0    1    0]
 [   0    1    1    0    2    1    0    5    1    0    5   59   24    0
   314    6    4]
 [   0    1    0    0    1    0    0    0    0   18   38    0   20   17
     7  354   41]
 [   0    0    1    0    0    0    0    0    0   10   11   20    7   24
     7   31  407]]
------ TEST ACCURACY:  weights.44-0.49.hdf5  ------
0.806179775281
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 39  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 70  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 30  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  2  4  0 38  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  1  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 13  0  0  0  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  2  6  1  4  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1 14  0  0  7  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 18  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  2  1  0  0  0  1  6]
 [ 0  0  0  0  0  0  0  0  4 12  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  5  0  0  1  0  9]]

>>>>>>>>>>>>>> 28 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/28/weights.42-0.47.hdf5
------ TRAIN ACCURACY:  weights.42-0.47.hdf5  ------
0.92204277608
[[ 152    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  209    0    0    0    0    0    4    1    0    0    0    0    0
     0    0    0]
 [   0    0 1699    0    2    0    6    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    0 1923    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  862    1   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    4    2    8 1267    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    0    0    0  279    4    0    0    0    1    0
     1    0    0]
 [   0    0    0    0    0    0    1    2  196    0    0    0    0    0
     0    1    0]
 [   1    0    0    0    0    1    0    0    0  442    7    2    3   52
     3    0    1]
 [   0    0    0    0    0    0    1    1    0   26  414   13    5   23
     6    3    3]
 [   0    2    0    0    1    1    0    0    0   16   18  421   14    9
    15    0   12]
 [   0    2    0    0    0    0    0    2    0    3    4    9  599   16
     0    2    1]
 [   0    2    0    0    1    0    0    0    0   46    7    5    3  400
     1    5    4]
 [   0    0    0    0    2    0    1    5    0    1   12   62   22    0
   307    1   13]
 [   0    0    0    0    1    0    1    0    0   16   83    5   31   20
     4  297   39]
 [   0    0    0    0    1    0    0    5    0    7   16   55   10   29
     9   13  373]]
------ TEST ACCURACY:  weights.42-0.47.hdf5  ------
0.873417721519
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 30  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 31  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 41  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 15  1  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  2  0  0 14  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  0 15  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 22  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  1  1  0  0  7  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  5  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  1  0  0  0  1 13]
 [ 0  0  0  0  0  0  0  0  1  1  4  0  0  1  1  8]]

>>>>>>>>>>>>>> 29 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/29/weights.34-0.50.hdf5
------ TRAIN ACCURACY:  weights.34-0.50.hdf5  ------
0.921286425018
[[ 145    4    2    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  195    0    0    1    0    0    8    0    0    0    0    0    0
     0    1    0]
 [   0    0 1625    0    3    0    3    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    2 1910    0    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  866    0   19    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  713    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    8   12    7 1252    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    1    0    0  269    9    0    1    0    1    0
     0    0    0]
 [   0    0    0    0    0    0    1    4  186    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    0    0    0    0  417    4    1    4   68
     1    3    2]
 [   0    0    1    0    1    0    1    3    1   33  397   11    0   17
     4    9    5]
 [   0    1    0    0    0    1    0    3    0   10   23  386    7   18
    27    7   21]
 [   0    0    0    0    0    0    0    3    0    3    1    1  589   24
     0    8    1]
 [   2    3    0    0    0    0    1    2    0   43    0    0    1  398
     0    6    2]
 [   1    2    0    0    0    4    0    6    0    1   12   38   15    0
   308   11   16]
 [   0    1    7    0    1    0    1    0    0   18   48    1   10   20
     4  339   43]
 [   0    0    0    0    0    0    0    6    0    5   23   22    4   28
    11   28  375]]
------ TEST ACCURACY:  weights.34-0.50.hdf5  ------
0.712621359223
[[  1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  1   9   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 100   2   0   0   4   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  68   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  10   0  19   0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  32   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   3   5   0   0  31   0   0   0   0   0   0   0   0   0   0]
 [  0   1   0   0   0   0   0   9   0   0   3   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   3   4   0   0   0   0   0   0   1   0]
 [  0   0   0   0   0   0   0   0   0  29   0   0   0   0   0   0   0]
 [  0   0   1   0   1   0   0   0   0   6  16   1   3   0   0   0   0]
 [  0   0   0   0   1   2   1   0   0   3   2   6   2   0   0   0   5]
 [  0   0   0   0   0   0   0   0   0   0   0  10  19   0   0   2   0]
 [  0   0   0   0   1   0   0   0   0  12   1   2   2   6   1   0   1]
 [  0   0   0   0   0   0   0   0   0   0   1  17   0   2   0   0   0]
 [  0   0   0   0   1   0   0   0   0   4  14   0   0   1   0   0   0]
 [  0   0   1   0   0   0   0   0   0   2   0   1   1   4   0   5  18]]

>>>>>>>>>>>>>> 30 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_spca_conv1d_10/30/weights.30-0.50.hdf5
------ TRAIN ACCURACY:  weights.30-0.50.hdf5  ------
0.915955293496
[[ 148    3    0    0    1    0    0    0    1    0    0    0    0    0
     0    0    0]
 [   1  200    2    0    0    0    0    8    1    0    0    0    0    0
     0    0    0]
 [   0    1 1681    1    1    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1920    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14    0  850    1   31    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    1  714    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13   15    1    7 1246    0    0    0    0    0    0    0
     0    0    0]
 [   1    2    0    0    1    0    1  269   14    0    0    0    1    0
     0    2    0]
 [   0    0    0    0    0    0    1    6  189    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    1    0    2    0  428    4    0    5   46
     0    3    9]
 [   0    0    0    1    0    0    2    2    1   23  417   11    3   11
     2    6    8]
 [   0    0    1    0    1    2    1    4    1   20   15  406    5    8
    22    0   14]
 [   0    1    0    0    0    0    1    4    0    7    0   10  581   18
     0    9    3]
 [   2    3    0    0    1    0    0    2    0   75    2    5    3  359
     0    7    6]
 [   0    1    0    0    0    2    1    7    1    0   16   59   22    0
   289    1   15]
 [   0    0    6    0    1    0    0    1    0   20   69   10   15   11
     2  304   56]
 [   0    0    0    0    0    0    1    5    0    6   20   28    5    7
     6   25  407]]
------ TEST ACCURACY:  weights.30-0.50.hdf5  ------
0.745098039216
[[ 1  0  0  0  0  0  2  0  0  0  0  0  0  1  0  0]
 [ 0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 42  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 29  0  1  0  1  0  0  0]
 [ 0  0  2  0  1  0  0  0 13  3  0  0  4  1  0  0]
 [ 0  0  0  1  0  0  0  0  0  3 13  5  0  3  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  0 19  0  0  2  5]
 [ 0  0  0  0  0  0  0  0  8  1  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0 17  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  5  1  0  8]
 [ 0  0  0  0  0  0  0  0  4  0  4  0 15  0  0  1]]
[0.7265625, 0.7667238421955404, 0.8223684210526315, 0.5916398713826366, 0.6946308724832215, 0.8203883495145631, 0.7818181818181819, 0.7682619647355163, 0.678743961352657, 0.6900958466453674, 0.7219387755102041, 0.796, 0.8010610079575596, 0.8467741935483871, 0.8202531645569621, 0.7243589743589743, 0.8115631691648822, 0.7275862068965517, 0.7255639097744361, 0.7331887201735358, 0.45, 0.6528925619834711, 0.7300613496932515, 0.7594108019639935, 0.725925925925926, 0.7797619047619048, 0.8061797752808989, 0.8734177215189873, 0.7126213592233009, 0.7450980392156863]
0.742829712423
0.0805119922572

Process finished with exit code 0

'''
