import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import numpy as np
import cPickle as pickle
from keras.models import Model, load_model
from keras.initializers import Constant, TruncatedNormal
from keras.layers import Input, Dense, Conv1D, Flatten, Dropout, Activation, BatchNormalization
from keras.layers.merge import concatenate
from keras.optimizers import Adam
from keras.callbacks import ModelCheckpoint
import keras.backend as K
from keras import losses
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix

# Load train and test data (Kernel PCA + Signal Magnitude Vector)

X_kpca = pickle.load(open("data/X_unimib_kpca.p", "rb"))
X_smv = pickle.load(open("data/X_unimib_smv.p", "rb"))
X = np.concatenate((X_kpca, X_smv), axis=1)

y = pickle.load(open("data/y_unimib_smv.p", "rb"))

n_classes = 17


# Below builds 1D CNN.

for i in range(30):
    test = y.loc[y[1] == i+1]
    # print y_sub
    test_index = test.index.values
    # print len(test_index)

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index], y_values[test_index]
    y_train = np.eye(n_classes)[y_train - 1]
    print X_train.shape # (11188, 302)

    # input layer
    input_signal = Input(shape=(302, 1))
    print K.int_shape(input_signal)

    # define initial parameters
    b_init = Constant(value=0.0)
    k_init = TruncatedNormal(mean=0.0, stddev=0.01, seed=2018)

    # first feature extractor
    conv11 = Conv1D(16, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn11 = BatchNormalization()(conv11)
    actv11 = Activation('relu')(bn11)
    conv12 = Conv1D(32, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv11)
    bn12 = BatchNormalization()(conv12)
    actv12 = Activation('relu')(bn12)
    flat1 = Flatten()(actv12)

    # second feature extractor
    conv21 = Conv1D(16, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn21 = BatchNormalization()(conv21)
    actv21 = Activation('relu')(bn21)
    conv22 = Conv1D(32, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv21)
    bn22 = BatchNormalization()(conv22)
    actv22 = Activation('relu')(bn22)
    flat2 = Flatten()(actv22)

    # third feature extractor
    conv31 = Conv1D(16, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn31 = BatchNormalization()(conv31)
    actv31 = Activation('relu')(bn31)
    conv32 = Conv1D(32, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv31)
    bn32 = BatchNormalization()(conv32)
    actv32 = Activation('relu')(bn32)
    flat3 = Flatten()(actv32)

    # merge feature extractors
    merge = concatenate([flat1, flat2, flat3])

    # dropout & fully-connected layer
    do = Dropout(0.9, seed=2018)(merge)
    output = Dense(n_classes, activation='softmax', bias_initializer=b_init, kernel_initializer=k_init)(do)

    # result
    model = Model(inputs=input_signal, outputs=output)

    # summarize layers
    print(model.summary())

    new_dir = 'model/unimib_smv_kpca_conv1d_10/' + str(i+1) + '/'
    if not os.path.exists(new_dir):
        os.makedirs(new_dir)

    fpath = new_dir + 'weights.{epoch:02d}-{val_acc:.2f}.hdf5'
    cp_cb = ModelCheckpoint(fpath, monitor='val_acc', verbose=1, save_best_only=True, mode='auto', period=1)

    adam = Adam(lr=0.001)
    model.compile(loss=losses.categorical_crossentropy, optimizer=adam, metrics=['accuracy'])
    model.fit(np.expand_dims(X_train, axis=2), y_train, batch_size=64, epochs=50, verbose=2, validation_split=0.10,
              callbacks=[cp_cb], shuffle=True)

    del model
    K.clear_session()


# Below calculates average test data accuracy (LOSO CV).

acc = []

for i in range(30):
    test = y.loc[y[1] == i+1]
    test_index = test.index.values

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index] - 1, y_values[test_index] - 1

    print "\n>>>>>>>>>>>>>>", str(i+1), "-fold <<<<<<<<<<<<<<<<"
    path_str = 'model/unimib_smv_kpca_conv1d_10/' + str(i+1) + '/'
    for path, dirs, files in os.walk(path_str):
        dirs.sort()
        files.sort()
        top_acc = []
        top_acc.append(files[-1])
        files = top_acc
        for file in files:
            print "========================================"
            print os.path.join(path, file)
            model = load_model(os.path.join(path, file))
            pred = model.predict(np.expand_dims(X_train, axis=2), batch_size=32)
            print "------ TRAIN ACCURACY: ", file, " ------"
            print accuracy_score(y_train, np.argmax(pred, axis=1))
            print confusion_matrix(y_train, np.argmax(pred, axis=1))
            pred = model.predict(np.expand_dims(X_test, axis=2), batch_size=32)
            print "------ TEST ACCURACY: ", file, " ------"
            print accuracy_score(y_test, np.argmax(pred, axis=1))
            print confusion_matrix(y_test, np.argmax(pred, axis=1))

            del model
            K.clear_session()

    acc.append(accuracy_score(y_test, np.argmax(pred, axis=1)))

print acc
print np.mean(acc)
print np.std(acc)

'''
-----
[0.6822916666666666, 0.7015437392795884, 0.8881578947368421, 0.4758842443729904, 0.7818791946308725, 0.8252427184466019, 0.7787878787878788, 0.8639798488664987, 0.6956521739130435, 0.6996805111821086, 0.7602040816326531, 0.848, 0.7851458885941645, 0.7473118279569892, 0.8354430379746836, 0.7200854700854701, 0.7730192719486081, 0.7310344827586207, 0.8007518796992481, 0.7462039045553145, 0.6142857142857143, 0.6962809917355371, 0.7699386503067485, 0.7021276595744681, 0.7679012345679013, 0.7708333333333334, 0.7837078651685393, 0.8607594936708861, 0.6563106796116505, 0.7083333333333334]
0.749025955723
0.0813236219342
-----

/usr/bin/python2.7 /mnt/0cdd1a7e-3686-4cf7-9055-145eb5fe70f3/hcilab/OSS/electronicsletters2018/unimib/unimib_smv_kpca_conv1d_10.py
/home/hcilab/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.

>>>>>>>>>>>>>> 1 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/1/weights.50-0.51.hdf5
------ TRAIN ACCURACY:  weights.50-0.51.hdf5  ------
0.935364889787
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  205    1    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1680    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9 1904    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   46    0  818    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   21    0    0    0 1261    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  287    1    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    1  196    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  473   16    0    8   16
     0    2    1]
 [   0    0    1    0    0    4    0    1    0   16  419   17   15    3
     3    6    9]
 [   0    0    1    0    0    9    0    0    1    9   21  411   20    7
    16    5   11]
 [   0    3    0    0    0    0    0    1    0    1   10    1  586    5
     6   23    6]
 [   0    0    0    0    0    0    0    0    0   46    4    5    1  408
     0    3    3]
 [   0    0    5    0    0    0    3    8    0    0   16   42    3    0
   333    2    7]
 [   0    0    0    0    0    0    0    0    0   12   40    5    8    3
     3  381   41]
 [   0    0    0    0    0    2    0    0    1   11   11   19   12    5
     6   22  427]]
------ TEST ACCURACY:  weights.50-0.51.hdf5  ------
0.682291666667
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 11  0 19  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 28  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 21  0  0  0 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  5  0  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  1  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  9  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  5  0  0  0  2  1  8]
 [ 0  0  0  0  0  3  0  0  0  0  0  0  1  0  1  0 10]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  6  0  0  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  3  0  0  4  2  1]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0  7  2  6  1]
 [ 0  0  0  0  0  0  0  1  0  3  2  2  0  0  0  0 10]]

>>>>>>>>>>>>>> 2 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/2/weights.38-0.50.hdf5
------ TRAIN ACCURACY:  weights.38-0.50.hdf5  ------
0.928047908473
[[ 144    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  203    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1589    0    5    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1910    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  852    0   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    9    2    7 1252    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  282    2    0    0    0    1    0
     0    0    0]
 [   0    0    0    0    0    0    1    2  189    0    2    0    0    0
     1    1    0]
 [   0    2    0    0    0    0    0    0    0  410   14    0   16   59
     0    5    2]
 [   0    2    0    0    0    0    0    1    0   12  389   30   24   11
     1   12    6]
 [   0    0    1    0    0    1    0    2    0    4   21  421   22    5
    13    3    9]
 [   0    3    0    0    0    0    0    1    0    1    3    5  587    7
     1   12    1]
 [   0    2    0    0    0    0    0    0    0   32    2    5    5  400
     1    5    0]
 [   0    0    0    3    5    0    3    6    0    0   10   58   13    0
   307    2    2]
 [   0    0    0    0    0    0    0    0    0   13   29    8   24   14
     6  363   29]
 [   0    0    0    0    1    0    0    0    0    4   10   27   25   22
    10   40  368]]
------ TEST ACCURACY:  weights.38-0.50.hdf5  ------
0.70154373928
[[  7   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  1   9   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1]
 [  0   0 133   0  10   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  37   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  29   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   1  48   0   0   0   0   0   0   0   0   0   0]
 [  0   1   0   0   1   0   0   6   0   0   0   0   0   0   1   0   0]
 [  0   0   0   0   0   0   0   2   2   0   0   0   0   0   0   0   0]
 [  0   1   0   0   0   0   0   0   0  12   2   0   0   3   0   3   0]
 [  0   0   0   0   0   0   0   0   0   0   3   0  17   0   0   2   1]
 [  0   0   0   0   2   6   0   2   0   0   0   3   2   0   1   1   7]
 [  0   1   0   0   0   0   0   1   0   0   4   0  30   0   0   4   0]
 [  0   0   0   0   0   0   0   2   0   2   0   1   4  14   1   8   0]
 [  2  11   0   1   0   2   2   0   0   2   1   0   1   0   1   1   1]
 [  0   0   0   0   0   2   1   0   0   0   0   1  15   0   5   0   3]
 [  0   0   0   0   0   0   0   0   0   0   1   1  24   0   0   0   1]]

>>>>>>>>>>>>>> 3 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/3/weights.49-0.49.hdf5
------ TRAIN ACCURACY:  weights.49-0.49.hdf5  ------
0.937734368187
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  215    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1703    0    7    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1906    0    1    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  865    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    6 1279    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  285    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    1  195    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  485   12    1    2   11
     0    1    1]
 [   0    0    0    0    0    1    0    0    0   30  422   14   15    2
     5    3    7]
 [   0    0    1    2    1    5    2    1    1   19   15  434   13    5
    11    2    4]
 [   0    3    0    0    0    0    0    1    0    2    7    5  608    7
     2    8    4]
 [   0    0    0    0    0    0    0    0    0   78    1    5    3  378
     0    4    2]
 [   0    0    0    0    6    0    3    7    1    1   17   48    3    0
   334    2    5]
 [   0    0    0    0    0    0    4    1    0   25   34   10   25    2
     0  366   36]
 [   0    2    0    0    1    1    0    0    0   18   15   26   16    7
     6   20  415]]
------ TEST ACCURACY:  weights.49-0.49.hdf5  ------
0.888157894737
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 73  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 39  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  1  0  0  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  9  2  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  6  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  1  0  5  0  5  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  0  0  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  1  3  0  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  1  0  1  2  1]]

>>>>>>>>>>>>>> 4 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/4/weights.50-0.48.hdf5
------ TRAIN ACCURACY:  weights.50-0.48.hdf5  ------
0.934991273997
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1721    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1922    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    0  864    0   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  715    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    0    1    1 1282    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  284    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  190    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  475   12    0    0   31
     0    2    0]
 [   0    0    0    0    2    0    0    1    0   22  418    7   12   13
     1    6   10]
 [   0    0    0    0    0    3    0    3    2   16   29  393   16   13
    15    2   11]
 [   0    6    0    0    0    0    0    1    0    1   10    2  592    9
     3    9   10]
 [   0    1    0    0    0    0    0    0    0   51    2    1    4  403
     1    4    0]
 [   0    0    2    0    3    0    4    7    1    0   16   53    1    0
   326    2    6]
 [   0    0    0    0    0    0    0    0    0   15   46    2   19    4
     3  350   58]
 [   0    0    0    0    0    1    0    2    1   12   13   19   16   10
    11   12  415]]
------ TEST ACCURACY:  weights.50-0.48.hdf5  ------
0.475884244373
[[ 3  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  6  0  0  0 10  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 54  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0 13  0  8  5  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0 11  0  2  0  0  0 10  2  1  0  1  0]
 [ 0  0  0  0  0 16 11  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  1  0  0  7  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  2  6  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  1  0  1  1  0  8  4]
 [ 0  0  0  0  0  0  0  0  0  3 12  1  2  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  6  2  0  1  0]
 [ 0  0  0  0  0  0  0  0 10  3  0  0  4  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  6  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  3  0  3  0  8  0  1  0]
 [ 0  0  0  0  1  0  0  0  3  5  5  1  3  0  2  2]]

>>>>>>>>>>>>>> 5 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/5/weights.49-0.49.hdf5
------ TRAIN ACCURACY:  weights.49-0.49.hdf5  ------
0.93820273686
[[ 145    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1713    0    3    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1916    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  882    0   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  725    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    0    3    5 1277    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  290    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    1  197    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  459   16    1    6   26
     0    2    1]
 [   0    0    0    0    0    0    0    0    0   12  433    6   21    8
     4    6   12]
 [   0    0    0    0    0    1    0    4    0   18   32  399   15   11
    15    1    9]
 [   0    3    0    0    0    0    0    1    0    1   13    1  604    6
     5    7    5]
 [   0    0    0    0    0    0    0    0    0   48    2    2    4  404
     2   10    2]
 [   0    0    0    0    5    0    3   13    0    0   15   35    6    2
   332    5    9]
 [   0    1    0    0    0    0    1    0    0    5   52    2   26    0
     9  361   41]
 [   0    2    0    0    0    0    0    0    0   10   13   19   18   13
     7   11  423]]
------ TEST ACCURACY:  weights.49-0.49.hdf5  ------
0.781879194631
[[ 2  5  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 11  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 66  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 19  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  3  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  3  0  0  1  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 12  0  0  8  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  1  0  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  0  8  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  2  0 11  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  0 16  0]]

>>>>>>>>>>>>>> 6 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/6/weights.45-0.52.hdf5
------ TRAIN ACCURACY:  weights.45-0.52.hdf5  ------
0.939695395721
[[ 150    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  209    0    0    1    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1672    0   14    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1923    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  865    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    5    5 1263    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  280    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1  193    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  455   13    3    1   33
     0    1    2]
 [   0    0    0    0    0    0    0    1    0   13  422   16   14    7
     5   10    8]
 [   0    0    1    1    1    3    0    4    2   11   16  412   14   12
    15    4   11]
 [   0    4    0    0    0    0    0    3    0    1   12    1  593    8
     3    3   10]
 [   0    0    0    0    0    0    0    0    0   47    1    0    2  400
     3    7    4]
 [   0    1    1    0    6    0    0    5    1    0    5   32    4    4
   345    3    9]
 [   0    1    0    0    0    0    0    1    1   11   35    2   32    5
     5  360   40]
 [   0    2    0    0    0    0    0    4    0    5    9   24   15   18
     8   16  415]]
------ TEST ACCURACY:  weights.45-0.52.hdf5  ------
0.825242718447
[[ 2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 44  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 29  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 50  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  1 13  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 15  2  0  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  8  4  0  0  0  2  1]
 [ 0  0  0  0  0  0  0  0  0  0  2 11  0  2  2  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 22  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  0 11  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  7  5  1  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  7 12]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  2 15]]

>>>>>>>>>>>>>> 7 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/7/weights.34-0.49.hdf5
------ TRAIN ACCURACY:  weights.34-0.49.hdf5  ------
0.913643912245
[[ 152    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  201    2    0    2    0    0    6    0    0    0    0    0    0
     0    0    0]
 [   0    0 1686    0    3    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1932    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   59    0  799    0   27    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  720    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   56    6    0    6 1223    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0  278    4    0    1    0    1    0
     3    0    0]
 [   0    0    1    0    0    0    1    3  184    0    0    0    0    1
     2    0    0]
 [   0    2    0    0    0    0    0    0    0  465   14    0    3   27
     0    2    3]
 [   0    0    0    0    0    0    0    0    0   22  402    6   20    5
     3   12   26]
 [   0    0    1    2    1    1    0    2    0    9   35  378   22   13
    13    4   27]
 [   0    3    0    0    0    0    0    3    0    2   10    1  590   11
     4    8   11]
 [   0    0    0    0    0    0    0    0    0   53    2    3    6  374
     4   15    5]
 [   0    0    2    1    1    0    7    5    0    0   27   51    9    1
   292    8   22]
 [   0    0    0    1    0    0    1    4    0   19   44    3   29    7
     5  339   48]
 [   0    0    0    1    0    0    0    4    0   11   12   10   11    6
    10   19  438]]
------ TEST ACCURACY:  weights.34-0.49.hdf5  ------
0.778787878788
[[ 4  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0 47  1  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0 29  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  7  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  4  0  3  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 10  0  0  2  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  0  7  4  3]
 [ 0  0  0  0  0  0  0  0  0  1  0 15  0  0  1  1]
 [ 0  0  0  0  0  0  0  0 13  0  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  5  1  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  0  5  7]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  6  6]]

>>>>>>>>>>>>>> 8 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/8/weights.37-0.48.hdf5
------ TRAIN ACCURACY:  weights.37-0.48.hdf5  ------
0.926147353614
[[ 150    0    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  206    0    0    2    0    0    8    0    0    0    0    0    0
     0    0    0]
 [   0    0 1668    0    3    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1926    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   21    0  843    0   30    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0  715    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    7    0    0 1257    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  281    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    4  183    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  421   14    2   10   49
     0    1    4]
 [   0    0    0    0    0    0    1    1    0   20  412   18   13    9
     2   11    7]
 [   0    0    1    0    0    1    0    2    1    5   21  425   20   10
    13    4    6]
 [   0    3    0    0    0    0    0    4    0    1   16    4  567   16
     3   14    8]
 [   0    0    0    0    0    0    0    0    0   37    2    5    3  408
     1    6    3]
 [   0    1    0    0    3    0    4    8    0    0   16   47    2    0
   329    2    8]
 [   0    0    0    0    0    0    0    4    0   20   46    8   18    9
    12  346   40]
 [   0    0    0    0    0    0    0    6    0    8   11   31   18   15
     8   19  397]]
------ TEST ACCURACY:  weights.37-0.48.hdf5  ------
0.863979848866
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 52  0  0  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 10  2  0  0  0  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  9  0  2  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0 16  0  0  0  0  0  4  6]
 [ 0  0  0  0  0  0  0  2  0  0 15  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0 23  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 19  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  0  0  3  0  3  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  6  4]
 [ 0  0  0  0  0  0  0  1  0  0  0  2  0  0  3  9  6]]

>>>>>>>>>>>>>> 9 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/9/weights.35-0.49.hdf5
------ TRAIN ACCURACY:  weights.35-0.49.hdf5  ------
0.929558862376
[[ 151    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    1    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1684    0    4    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1923    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   16    0  865    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3   15    0    7 1252    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  288    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    1  188    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  467    7    2    3   25
     0    3    0]
 [   0    0    1    0    0    2    0    2    1   27  373   18   17   11
     6   10   14]
 [   0    0    1    2    0    2    1    3    0    9   22  415   21    4
    14    4    8]
 [   0    2    0    0    0    0    0    5    0    1   11    4  571    9
     3   11    7]
 [   0    0    0    0    0    0    0    0    0   68    1    5    3  389
     1    5    1]
 [   0    0    2    0    3    1    3    4    0    0   20   42   10    0
   329    4    3]
 [   0    0    0    0    0    0    0    1    1   10   34   10   32    7
     4  346   37]
 [   0    0    0    0    1    0    0    2    1   14   11   33   17   12
    11   18  385]]
------ TEST ACCURACY:  weights.35-0.49.hdf5  ------
0.695652173913
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 50  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 60  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 11  0  9  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  8  0  0  0  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  2  0  8  0  4  2]
 [ 0  0  0  0  0  0  0  1  0  1 13  1  1  0  2  7  3]
 [ 0  0  0  0  2  0  0  0  2  0  5  5  0  0  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1 34  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  3  0  2  0  5  0  1  0]
 [ 0  0  0  0  2  0  0  0  1  0  1  4  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  1  0  5  8  0  5  7]
 [ 0  0  0  0  1  0  0  0  0  4  0  1  3  0  1 11  8]]

>>>>>>>>>>>>>> 10 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/10/weights.43-0.45.hdf5
------ TRAIN ACCURACY:  weights.43-0.45.hdf5  ------
0.91045557689
[[ 149    2    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0  209    0    0    1    0    0    6    0    0    0    0    0    0
     0    0    0]
 [   0    0 1701    3    2    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1933    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   20    0  866    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0  728    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   45   74    1    1 1174    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  294    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1   11  173    0    0    2    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  363   11    2   24   93
     0    2   10]
 [   0    0    0    0    1    1    0    1    0   16  364   23   25   20
    13   13   22]
 [   0    0    1    1    0    1    0    1    0    2   10  396   32   14
    25    3   18]
 [   0    2    0    0    0    0    0    3    0    1    6    2  592   10
     5    5   17]
 [   0    0    0    0    0    0    0    0    0   27    4    0    7  419
     5    2    3]
 [   0    0    2    3    3    0    4   11    0    0   11   34    1    6
   319    3   23]
 [   0    0    0    0    0    0    0    1    0   16   24    8   35   18
    11  351   37]
 [   0    0    0    1    0    0    0    5    1    4    5   21   22   23
    15   19  401]]
------ TEST ACCURACY:  weights.43-0.45.hdf5  ------
0.699680511182
[[ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 32  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 51  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 13  0 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 17  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  7 22  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  3  8  0  0  0  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0 17  0  0  5  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  0  0  5  0  0]
 [ 0  0  3  0  0  0  0  0  0  0 14  1  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0 13  0  2  3  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  2 12  0  0  0]
 [ 0  0  1  0  0  0  0  0  0  0  1  0  0 11  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  9  3  0]
 [ 0  0  0  0  0  0  0  0  2  0  7  2  0  0  0  6]]

>>>>>>>>>>>>>> 11 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/11/weights.38-0.49.hdf5
------ TRAIN ACCURACY:  weights.38-0.49.hdf5  ------
0.914227963793
[[ 145    1    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   2  203    0    0    0    0    0    6    0    0    0    0    0    0
     0    0    0]
 [   0    0 1710    0    4    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1896    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    0  843    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  724    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14    6    4    7 1236    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    0    0    0    0    0  280    4    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    5  187    0    0    0    0    1
     1    0    0]
 [   0    2    0    0    0    0    0    0    0  433   13    1    1   59
     0    1    1]
 [   0    0    0    0    0    0    0    2    1   14  383   29   10   11
     4    7   30]
 [   0    0    1    0    0    1    0    6    3   16   24  405   10   10
    21    2   13]
 [   0    5    0    0    0    0    0    2    0    4   11    3  555   12
     7   20   18]
 [   1    3    0    0    0    0    0    4    0   45    3    2    4  394
     3    3    3]
 [   1    0    1    2    4    0    4   13    0    0   20   60    3    1
   291    1   15]
 [   0    0    0    0    0    0    0    1    0   10   65    7   20   21
    13  291   71]
 [   0    0    0    0    0    0    0    3    4    8   10   28    8   10
     6   14  427]]
------ TEST ACCURACY:  weights.38-0.49.hdf5  ------
0.760204081633
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 23  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 82  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  8  0 35  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 10  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 12  0  0  0  2  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0  7  0  3]
 [ 0  0  0  0  0  0  0  0  0  0 11  0 10  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 18  1  0  0]
 [ 0  5  0  0  0  0  0  0  0  0  0  0  0  0  9  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  2  0  0  1  6]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  3  0  0  3  5]]

>>>>>>>>>>>>>> 12 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/12/weights.49-0.51.hdf5
------ TRAIN ACCURACY:  weights.49-0.51.hdf5  ------
0.940466684411
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1553    0    3    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1910    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  865    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    1    2    7 1277    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  295    1    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1  195    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  466   16    1    3   22
     0    1    1]
 [   0    0    0    0    0    3    0    1    0   22  418   10   11   10
     1    5   15]
 [   0    0    1    0    0    1    0    4    1   12   19  424   16   11
    17    3    5]
 [   1    1    0    0    0    0    0    2    0    0    6    6  601    5
     4    8    7]
 [   0    0    0    0    0    0    0    0    0   53    1    2    2  400
     2    0    4]
 [   0    0    0    0    5    0    2    4    0    0    9   49    7    1
   334    5    8]
 [   0    1    0    0    0    0    0    0    0   16   37    5   16   16
     2  369   34]
 [   0    4    0    0    0    0    0    1    1   12    9   14   16   12
     7   17  422]]
------ TEST ACCURACY:  weights.49-0.51.hdf5  ------
0.848
[[  4   2   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  2   3   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 176   0   6   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   1   0   0  31   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  32   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  36   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0  11   0   0   0   6   0   0   0]
 [  0   0   0   0   0   0   0   0   0   6   1   0   2   1   5   0]
 [  0   0   0   0   0   0   0   0   0   0   5   0   1   2   4   0]
 [  0   0   0   0   0   0   0   0   2   4   0   5   0   0   3   6]
 [  0   0   0   0   0   0   0   0   4   0   0   0  16   0   0   0]
 [  0   0   0   0   0   0   0   0   0   1   1   0   0   8   0   0]
 [  0   0   0   0   0   0   0   0   0  12   0   0   0   0   5   0]
 [  0   0   0   0   0   0   0   0   1   0   1   3   0   4   1   9]]

>>>>>>>>>>>>>> 13 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/13/weights.50-0.49.hdf5
------ TRAIN ACCURACY:  weights.50-0.49.hdf5  ------
0.937774267158
[[ 150    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1708    0    3    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1916    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10    0  854    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    1    0    6 1270    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  278    1    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    1  194    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  470   11    3    3   17
     0    0    1]
 [   0    0    0    0    0    1    0    0    0   19  418   19   16    2
     3    3   12]
 [   0    0    0    1    0    4    0    3    0   16   18  424   17    2
    12    6    5]
 [   0    4    0    0    0    0    0    0    0    1    7    7  592    5
     2   14    4]
 [   0    0    0    0    0    0    0    0    0   63    1    4    7  395
     0    3    1]
 [   0    1    0    0    5    0    3    2    0    0   18   59    4    0
   320    0    6]
 [   0    1    0    0    0    0    1    0    0   14   41    8   24    1
     5  360   40]
 [   0    2    0    0    0    0    0    0    1   10   14   41   18    4
     7   10  405]]
------ TEST ACCURACY:  weights.50-0.49.hdf5  ------
0.785145888594
[[ 3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0 16  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0  8  0 11  0]
 [ 0  0  0  0  0  0  0  1  0  0  5  0  0  0  0  0 12]
 [ 0  0  1  0  0  0  0  0  0  1  5  6  1  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 25  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  3  0 10  5]
 [ 0  0  0  0  0  0  0  0  0  0 12  0  1  0  0  8  1]]

>>>>>>>>>>>>>> 14 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/14/weights.40-0.50.hdf5
------ TRAIN ACCURACY:  weights.40-0.50.hdf5  ------
0.93657338363
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1675    0    8    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1929    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  867    0   12    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    3    3    4 1263    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  289    1    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0  194    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  464   15    1    1   31
     0    2    0]
 [   0    1    0    0    0    0    0    1    1   17  416   15    6    8
     2   12   14]
 [   0    1    0    0    0    1    0    3    3   17   21  409   12   13
    10    4    9]
 [   0    6    0    0    0    0    0    1    0    3    6    3  579   16
     5   16    6]
 [   0    4    0    0    0    0    0    0    0   53    1    5    2  402
     0    6    1]
 [   0    0    0    0    4    0    2    9    1    0   19   43    2    2
   319    6    7]
 [   0    1    0    0    0    0    0    0    1    7   50    3   15   12
     5  363   38]
 [   0    0    0    0    0    0    0    1    4   10   12   20    8   15
     7   22  424]]
------ TEST ACCURACY:  weights.40-0.50.hdf5  ------
0.747311827957
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0 43  0 10  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 40  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 50  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  1  0  0  6  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  9  0  0  4  6  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 11  0  2  1  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  5 10  0  0  3  0  2]
 [ 0  0  0  0  0  0  0  0  0  2  9  0  0  4  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  4  3  4]]

>>>>>>>>>>>>>> 15 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/15/weights.49-0.49.hdf5
------ TRAIN ACCURACY:  weights.49-0.49.hdf5  ------
0.940752461322
[[ 143    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1688    0    3    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1897    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  887    0   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    4    1    2 1258    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  283    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1  191    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  465   13    2    3   29
     0    1    2]
 [   0    1    0    0    0    0    0    3    1   23  401   22    7   10
     4    8   13]
 [   0    0    1    3    0    1    0    6    2    9   14  431   14    3
    20    1    7]
 [   0    4    0    0    0    0    0    3    0    0    5    1  595    9
     4   12   10]
 [   0    0    0    0    0    0    0    0    0   46    1    4    4  409
     0    3    2]
 [   0    0    1    1    3    0    0   14    0    0   15   38    1    0
   334    3    6]
 [   0    1    0    0    0    0    0    1    0   15   28    8   18   11
     6  364   48]
 [   0    0    0    0    0    0    0    3    0   11    3   26   15   13
     8    9  431]]
------ TEST ACCURACY:  weights.49-0.49.hdf5  ------
0.835443037975
[[ 4  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 88  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 14  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 55  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0 10  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  6  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 17  0  0  0  0  0  1]
 [ 0  0  0  1  0  0  0  0  0  3  0  9  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  6  0  0  1  4  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  1  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  1  2  0  2  1  6]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  0  0  1  0  9]]

>>>>>>>>>>>>>> 16 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/16/weights.31-0.49.hdf5
------ TRAIN ACCURACY:  weights.31-0.49.hdf5  ------
0.917278598602
[[ 143    1    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  194    0    0    1    0    0    4    0    0    0    0    0    0
     0    0    0]
 [   0    0 1675    0    6    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1907    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  855    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0  715    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10   43   27    7 1178    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  271    1    0    0    2    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    5  184    0    0    1    0    1
     1    0    0]
 [   0    2    0    0    0    0    0    0    0  465    8    2   14   16
     0    3    0]
 [   0    0    1    1    0    1    0    0    0   27  345   39   20    5
     6   14   33]
 [   0    0    1    1    0    2    0    1    0   11   11  434   22    4
    10    2   13]
 [   0    4    0    0    0    0    0    1    0    1    3   10  602    6
     0    9    4]
 [   1    1    0    0    0    0    0    0    0   87    1    6    8  359
     0    6    1]
 [   0    1    0    0    3    1    3    7    0    0    2   74    6    0
   313    9    4]
 [   0    0    0    1    0    1    0    0    0   23   28   13   28    8
     4  336   49]
 [   0    0    0    0    0    0    0    0    0   14    6   40   13   14
     9   20  392]]
------ TEST ACCURACY:  weights.31-0.49.hdf5  ------
0.720085470085
[[ 8  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 8  4  0  0  0  0  0  3  0  0  0  1  0  0  1  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 77  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 46  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4 26  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3 16  1  0 39  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  6  4  0  5  1  0  0  3  2  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 15  0  0  2  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  4  0  0  4  4  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  9  2  1  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 20  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  0  4  0  3  0]
 [ 0  0  0  0  0  0  0  1  0  0  2  3  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  3  4  0 13  0]
 [ 0  0  0  0  0  0  0  0  0  4  8  0  0  0  0 14  0]]

>>>>>>>>>>>>>> 17 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/17/weights.41-0.49.hdf5
------ TRAIN ACCURACY:  weights.41-0.49.hdf5  ------
0.931970983723
[[ 148    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  200    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1631    0    4    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1904    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11    0  866    0   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  727    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   20    8    0    7 1239    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  274    7    0    0    0    0    0
     1    0    0]
 [   1    0    0    0    0    0    0    0  190    0    0    0    0    1
     1    0    0]
 [   0    2    0    0    0    0    0    0    0  474   10    3    1   23
     0    3    1]
 [   0    0    0    0    0    1    0    1    0   27  376   19    9    5
    13   16   28]
 [   0    0    1    0    0    1    1    2    1   20   12  407   17    2
    33    3    5]
 [   0    4    0    0    0    0    0    0    0    1    1    8  585    9
     7   15   11]
 [   1    2    0    0    0    0    0    0    0   47    2    6    1  393
     2    8    2]
 [   0    0    0    0    5    0    3    7    1    0   10   37    3    4
   326    0   15]
 [   0    0    0    0    0    0    3    0    1   19   31   10    4    2
    12  360   53]
 [   0    0    0    0    0    0    0    0    1   14    4   16   11    7
    15   14  435]]
------ TEST ACCURACY:  weights.41-0.49.hdf5  ------
0.773019271949
[[  3   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  1  14   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 103   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  81   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  24   0   4   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  19   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  50   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0  13   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   7   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   0   3   2   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   8   2   0   0   0   6   0]
 [  0   0   0   0   0   0   0   0   0   0   0   5   0   1   4   0  11]
 [  0   0   0   0   0   0   0   0   0   0   0   0  17   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   8   0   0   6   6   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   5   0   0  13   3   2]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   2   4  12]
 [  0   0   0   0   0   0   0   0   0   0   4   0   0   0   4   2   7]]

>>>>>>>>>>>>>> 18 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/18/weights.37-0.50.hdf5
------ TRAIN ACCURACY:  weights.37-0.50.hdf5  ------
0.926922741921
[[ 138    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  199    0    0    0    0    0    6    0    0    0    0    0    0
     0    0    0]
 [   0    0 1736    0    2    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1927    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   42    0  829    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0  727    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   19   18    0    7 1249    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  283    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0    0    0    0    4  183    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  465    8    0    2   34
     0    2    2]
 [   0    0    0    0    0    0    0    1    0   23  406    6   16   11
    10    8   12]
 [   0    0    1    1    0    2    0    3    0    9   23  385   18   12
    37    5   13]
 [   0    6    0    0    0    0    0    2    0    1    5    2  604    5
     5    5    8]
 [   1    0    0    0    0    0    0    0    0   57    2    1    6  394
     5    3    2]
 [   0    0    3    0    4    0    3    4    0    0    5   36    7    7
   348    3    3]
 [   0    0    0    0    0    0    0    0    0   20   49    2   25   11
    10  352   34]
 [   0    0    0    0    0    0    0    0    1   17   14    7   17   11
    12   25  417]]
------ TEST ACCURACY:  weights.37-0.50.hdf5  ------
0.731034482759
[[12  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  6  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 56  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 15  0  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0 30  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  3  5  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0 11  1  0  0  5  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  0  8  0  1  3  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0 12  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 11  1  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  1  0  8  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  7  1]
 [ 0  0  0  0  0  0  0  0  0  0  7  0  2  0  3  0  1]]

>>>>>>>>>>>>>> 19 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/19/weights.50-0.49.hdf5
------ TRAIN ACCURACY:  weights.50-0.49.hdf5  ------
0.938374619731
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  202    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1719    0    4    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1916    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  882    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0    0    1 1289    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  288    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  192    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  470   14    1    3   29
     0    1    1]
 [   0    1    0    0    0    0    0    0    0   14  426   13   10   11
     0    5   16]
 [   0    0    1    0    0    2    0    3    0   14   16  433   18   11
    10    4    5]
 [   0    3    0    0    0    0    0    2    0    0    6    4  606    7
     2    7    7]
 [   0    0    0    0    0    0    0    0    0   49    1    3    6  412
     0    2    1]
 [   0    0    0    0    3    0    5    7    0    0   11   64    4    1
   309    6    9]
 [   0    1    0    0    0    0    2    0    0   15   39    6   25   14
     1  365   36]
 [   0    2    0    0    0    0    0    2    1   12   11   34   14   13
     3   10  420]]
------ TEST ACCURACY:  weights.50-0.49.hdf5  ------
0.800751879699
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 14  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0 30  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  2  3  0  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  7  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  1  0 16  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  9  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  0  0  6  0]
 [ 0  0  2  0  0  0  0  0  0  0  0  3  0  0  0  4  3]]

>>>>>>>>>>>>>> 20 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/20/weights.49-0.50.hdf5
------ TRAIN ACCURACY:  weights.49-0.50.hdf5  ------
0.934305923961
[[ 142    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  201    1    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1576    0    4    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1914    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10    0  858    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  728    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    2    1    7 1263    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    0    0  286    0    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    0    1    4  182    0    3    0    0    1
     1    0    0]
 [   0    2    0    0    0    0    0    0    0  465   18    0    2   22
     0    1    3]
 [   0    0    0    0    0    4    0    0    0   24  414   17   14    5
     3    0   20]
 [   0    0    1    0    1    3    0    0    0   15   15  438   17    3
     8    6   12]
 [   0    2    0    0    0    0    0    3    0    1   10    5  589    8
     3   11   11]
 [   0    0    0    0    0    0    0    0    0   54    1    5    3  400
     0    3    3]
 [   0    0    0    0    5    0    2    5    0    0   23   44    4    3
   326    0   13]
 [   0    0    0    0    0    0    0    0    0   17   51    7   12    4
     6  360   42]
 [   0    0    0    0    0    0    0    0    0   13    8   32   16   12
     6   13  425]]
------ TEST ACCURACY:  weights.49-0.50.hdf5  ------
0.746203904555
[[ 10   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  1  10   0   0   0   0   0   2   0   0   0   0   0   0   0   0   0]
 [  0   0 137   0   0   0  19   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  71   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   2  22   5   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  18   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   5  35   0   0  10   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   4   4   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   8   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   9   0   0   0   7   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   1   6   0   0   2   1   0]
 [  0   0   0   0   0   0   0   0   0   0   0   2   0   0   2   0   3]
 [  0   0   0   0   0   0   0   0   0   0   0   0  18   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   2   0   0   1  12   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   1   1   0   0   5   2   0]
 [  0   0   0   0   0   0   0   0   0   2   5   0   0   1   0   6   0]
 [  0   0   0   0   0   0   0   0   0   0   4   4   0   0   0   0   1]]

>>>>>>>>>>>>>> 21 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/21/weights.38-0.50.hdf5
------ TRAIN ACCURACY:  weights.38-0.50.hdf5  ------
0.932816987207
[[ 146    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  199    1    0    0    0    0    4    0    0    0    0    0    0
     0    0    0]
 [   0    0 1727    0    7    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1921    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  884    0   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  724    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    1    0    7 1266    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  279    6    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    1  184    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  450   13    2    0   46
     0    1    2]
 [   0    0    0    0    0    5    0    1    0   14  399   28    9    8
     4   10   24]
 [   0    0    1    0    0    2    0    4    0   18   20  424   10   11
     7    2   10]
 [   0    1    0    0    0    0    0    4    0    2    6    6  584    8
     2   20    9]
 [   0    0    0    0    0    0    0    0    0   34    2    5    7  417
     1    6    1]
 [   0    0    1    0    4    0    5    5    4    0    7   77    4    4
   306    3    5]
 [   0    0    0    0    0    0    1    0    0   11   45    8    9    7
     6  379   35]
 [   0    0    0    0    0    0    0    0    0   11   14   27   14   10
     6   15  430]]
------ TEST ACCURACY:  weights.38-0.50.hdf5  ------
0.614285714286
[[ 7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  5 16  0  0 40  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  5  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 15  7  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  5  0 40  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  6  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  0  0  3  3]
 [ 0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2 16  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  1  0  6  0  1  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  6  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  1  1  0  0  0  2  8]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  1  0  0  3  1]]

>>>>>>>>>>>>>> 22 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/22/weights.39-0.48.hdf5
------ TRAIN ACCURACY:  weights.39-0.48.hdf5  ------
0.930362363781
[[ 134    1    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  202    0    0    0    0    0    2    1    0    0    0    0    0
     0    0    0]
 [   0    0 1669    0    4    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1919    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14    0  841    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    1    0    2 1265    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  276    4    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1  181    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  439   16    2    2   42
     0    4    0]
 [   0    0    0    0    0    0    0    1    0   16  412   16   13    7
     3   11   11]
 [   0    1    1    0    0    2    0    3    0   15   33  390   15   11
    17    4    6]
 [   0    5    0    0    0    0    0    0    0    1   14    4  578   14
     5   11    6]
 [   0    0    0    0    0    0    0    0    0   41    2    3    3  406
     1    5    2]
 [   0    1    2    0    1    0    5    8    0    0   27   41    6    0
   320    2    4]
 [   0    1    0    0    0    0    0    0    0   13   52    7    6    3
     9  348   51]
 [   0    2    0    0    0    0    0    0    1   14   19   16   12   12
     7   25  404]]
------ TEST ACCURACY:  weights.39-0.48.hdf5  ------
0.696280991736
[[ 0 14  0  0  0  0  0  2  0  0  1  0  0  0  0  0  0]
 [ 0  7  0  0  1  0  0  2  0  0  1  0  0  0  0  0  0]
 [ 0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 62  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 37  0  8  0  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 50  0  0  0  0  0  0  0  1  0  0]
 [ 0  5  0  0  0  0  0  8  1  0  0  0  1  0  0  0  1]
 [ 0  7  0  0  0  0  0  6  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 19  0  0  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  9  7  0  0  0  0  5]
 [ 0  0  0  0  0  0  0  0  0  4  3 13  0  0  8  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0 21  0  0  0  0]
 [ 0  6  0  0  0  0  0  0  0  5  0  3  2  1  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  1  0  0  9  3  0]
 [ 0  0  0  0  0  0  0  0  0  0 10  0  0  0  0  6  7]
 [ 0  0  0  0  0  0  0  0  0  0  5 10  0  0  3  0  4]]

>>>>>>>>>>>>>> 23 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/23/weights.44-0.50.hdf5
------ TRAIN ACCURACY:  weights.44-0.50.hdf5  ------
0.9374399301
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  209    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1717    0    4    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1910    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  869    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    1    0    7 1268    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  281    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    3  191    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  461   12    2    1   24
     0    2    3]
 [   0    0    0    0    0    0    0    2    0   14  414   21   15    7
     7    9   13]
 [   0    0    0    0    0    4    0    3    0   13   12  444   16    6
    15    1    3]
 [   0    5    0    0    0    0    0    0    0    1    3    7  592    7
     6   18    7]
 [   0    2    0    0    0    0    0    0    0   53    2    3    5  393
     5    5    1]
 [   0    0    0    0    4    0    4    5    2    0    8   43    2    1
   344    3    9]
 [   0    0    0    0    0    0    2    0    0   13   34   18    8    4
    16  362   41]
 [   0    0    0    0    0    0    0    1    1   10    6   48    7   13
    14   14  406]]
------ TEST ACCURACY:  weights.44-0.50.hdf5  ------
0.769938650307
[[ 4  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 15  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 74  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0 23  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 15  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  0  4  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  0  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  2  0  0  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  4  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  3  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  5  0  0  4  0  0]
 [ 0  1  0  0  0  0  0  1  0  0  0  0  8  0  0  2  3]
 [ 0  0  0  0  0  0  0  6  0  0  0  0  2  0  0  2  4]]

>>>>>>>>>>>>>> 24 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/24/weights.41-0.50.hdf5
------ TRAIN ACCURACY:  weights.41-0.50.hdf5  ------
0.930555555556
[[ 132    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  189    0    0    1    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1531    0    7    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1913    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  834    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    3   10 1255    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  276    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  189    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  452    8    0    1   44
     0    1    0]
 [   0    0    0    0    0    2    0    0    0   18  421   20   11    7
     1   11    5]
 [   0    0    0    0    0    3    0    0    0   10   15  449   17    4
     7    2    5]
 [   0    3    0    0    0    0    0    1    0    8   12    7  568   12
     3   19    7]
 [   0    0    0    0    0    0    0    0    0   50    1    4    4  399
     0   10    1]
 [   0    0    0    0    3    0    2    5    0    0    7   68    1    3
   307    5    8]
 [   0    1    0    0    0    0    0    1    0   15   58   12   10    5
     7  347   38]
 [   0    2    0    0    0    0    0    0    2    7   10   53   13   10
     3   13  404]]
------ TEST ACCURACY:  weights.41-0.50.hdf5  ------
0.702127659574
[[  8  10   0   0   0   0   0   0   0   0   0   0   0   3   0   0   0]
 [  1   7   0   0   0   0   0   1   0   0   0   0   7   0   2   1   0]
 [  0   0 150   0  16   0  13   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  69   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  52   9   2   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  27   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  10   0   2  44   0   0   0   0   0   0   0   0   0   0]
 [  0   2   0   0   0   0   0   9   0   0   0   0   6   0   0   1   0]
 [  1   0   0   0   0   0   0   1   8   0   0   0   0   0   0   0   0]
 [  0   2   0   0   0   0   0   0   0  16   0   0   0   5   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   6   3   0   0   0   0   6]
 [  0   0   0   0   0   0   0   0   0   0   4   7   0   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  19   0   0   0   2]
 [  0   0   0   0   0   0   0   0   0  10   0   0   0   5   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   4  15   2   0   0   0   4]
 [  0   0   0   0   0   0   0   0   0   0   2   4   5   0   0   2   6]
 [  0   0   0   0   0   0   0   0   0   0   0  11   2   0   3   1   0]]

>>>>>>>>>>>>>> 25 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/25/weights.37-0.48.hdf5
------ TRAIN ACCURACY:  weights.37-0.48.hdf5  ------
0.928470878057
[[ 150    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  209    0    0    1    0    0    1    1    0    0    0    0    0
     0    0    0]
 [   0    0 1674    0    1    0   10    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1914    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10    0  860    0   25    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  725    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    1    7 1263    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  284    3    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    1    0  190    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  431   12    0    6   42
     0   16    3]
 [   0    1    0    0    0    2    0    0    0   16  411   13   17    9
     3   10   10]
 [   0    0    1    0    0    2    2    0    2   16   16  434   16    8
     1    5    9]
 [   0    0    0    0    0    0    0    4    0    5    6    4  576   18
     2   13    5]
 [   1    4    0    0    0    0    0    0    0   43    1    4    8  395
     2    4    1]
 [   0    0    0    0    5    0    6    9    1    0   11   78    7    3
   283    8    8]
 [   0    0    0    0    0    0    0    0    0    1   39    5   18    6
     7  380   29]
 [   0    0    0    0    0    0    0    0    1    8   14   44   12   12
     4   44  374]]
------ TEST ACCURACY:  weights.37-0.48.hdf5  ------
0.767901234568
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  2  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 46  0  7  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 21  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 52  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  4  2  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  2  1  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1 11  0  0  3  0  3  1]
 [ 0  0  0  0  0  0  0  0  0  2  9  0  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 28  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 19  0  1  1]
 [ 0  0  2  0  0  0  1  0  0  0  3  5  0  0  1  2  1]
 [ 0  0  0  0  0  0  0  0  0  9 14  2  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0 20]]

>>>>>>>>>>>>>> 26 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/26/weights.40-0.48.hdf5
------ TRAIN ACCURACY:  weights.40-0.48.hdf5  ------
0.918758198513
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    2    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1704    0    3    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1926    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   30    2  836    0   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   26   78    1   10 1161    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  288    3    0    0    0    0    0
     2    0    0]
 [   0    0    0    0    0    0    1    3  193    0    0    1    0    1
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  423   11    2    0   62
     1   11    0]
 [   0    0    1    0    0    0    0    0    0   12  378   36   13    9
     6   23   12]
 [   0    0    1    1    0    2    0    1    0    8   15  441   13    8
     9    3    5]
 [   0    0    0    0    0    0    0    0    0    7    3    3  560   14
     5   38    6]
 [   0    1    0    0    0    0    0    0    0   37    2   11    2  409
     2   11    2]
 [   0    0    0    1    3    0    2    0    0    0    7   58    4    0
   324   10   12]
 [   0    0    0    1    0    0    0    1    0    9   40    8    9    9
     4  390   23]
 [   0    0    0    1    0    0    0    0    1    4    8   45    6   12
    13   40  388]]
------ TEST ACCURACY:  weights.40-0.48.hdf5  ------
0.770833333333
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0 31  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0 47  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0 14  2  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  1 13  5  0  0  0  1  1]
 [ 0  0  0  0  0  0  0  0  0  1  4  0  0  9  5  0]
 [ 0  4  0  0  0  0  0  1  0  2  0 14  1  0  3  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0  1  0  0  0]
 [ 0  0  0  0  1  0  0  5  0  0  4  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  8 11]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  3  2  8]]

>>>>>>>>>>>>>> 27 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/27/weights.47-0.48.hdf5
------ TRAIN ACCURACY:  weights.47-0.48.hdf5  ------
0.934034165572
[[ 150    2    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1688    0    4    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1910    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  871    1   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  715    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    6    1   10 1259    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  289    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    1  196    0    0    1    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  447   17    0    8   21
     0   14    2]
 [   0    0    0    0    0    2    0    1    0   22  411   15   13    4
     4    8   17]
 [   0    0    1    0    0    4    0    0    0   15   14  418   13    6
    20    5    8]
 [   0    3    0    0    0    0    0    2    0    8    4    5  580   10
     7   20    1]
 [   0    0    0    0    0    0    0    0    0   54    2    4    3  395
     2    5    1]
 [   0    0    0    0    1    1    0    9    0    0    1   62    2    0
   333    5    9]
 [   0    0    0    0    0    0    0    0    0   17   23    5   10    2
    13  382   45]
 [   0    0    0    0    0    0    0    2    0   12    6   33   13    8
    15   21  408]]
------ TEST ACCURACY:  weights.47-0.48.hdf5  ------
0.783707865169
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 39  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 69  0  1  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 31  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 15  1  3  0 26  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  9  1  0  1  2  0  0]
 [ 0  0  0  0  0  0  0  0  1  1 13  0  0  7  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  7  0  0  0  9  0  2  0]
 [ 0  0  0  1  0  3  1  0  0  0  3  0  0  1  0  2]
 [ 0  0  0  0  0  0  0  0  1 14  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  1  1  1 10]]

>>>>>>>>>>>>>> 28 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/28/weights.39-0.46.hdf5
------ TRAIN ACCURACY:  weights.39-0.46.hdf5  ------
0.924487123527
[[ 151    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    4    0    0    0    0    0    0
     0    0    0]
 [   0    0 1705    0    3    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1924    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   23    0  843    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    1    1    5 1269    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  282    5    0    0    0    0    0
     1    0    0]
 [   0    0    1    0    0    0    0    5  194    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  410   17    2    8   47
     0   18    8]
 [   0    0    0    0    0    0    0    1    1   11  393   25   13    9
    10   19   13]
 [   0    0    1    0    0    1    0    0    1    7   19  399   22    7
    35    3   14]
 [   0    2    0    0    0    0    0    3    0    6    2    5  577   11
     7   18    7]
 [   0    0    0    0    0    0    0    0    0   36    4    3    2  403
     9   12    5]
 [   0    0    0    0    5    0    4    9    1    0    7   42    2    0
   338    9    9]
 [   0    0    0    0    0    0    0    2    0    7   44   14   14    3
     9  374   30]
 [   0    0    0    0    0    0    0    2    0    2    9   38   12    7
    23   27  398]]
------ TEST ACCURACY:  weights.39-0.46.hdf5  ------
0.860759493671
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 30  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1 49  0  0  8  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 31  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 41  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  7  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 13  0  0  0  4  0  0  0]
 [ 0  0  0  1  0  0  0  0  0 12  1  2  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 16  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 20  2  0  1  0]
 [ 0  0  0  0  0  0  0  0  2  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  2  7  7]
 [ 0  0  0  0  0  0  0  1  0  1  2  0  0  1  3  8]]

>>>>>>>>>>>>>> 29 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/29/weights.45-0.52.hdf5
------ TRAIN ACCURACY:  weights.45-0.52.hdf5  ------
0.931680881308
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  200    0    0    0    0    0    6    0    0    0    0    0    0
     0    0    0]
 [   0    0 1628    0    3    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1913    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   24    0  833    1   33    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    2    0    9 1274    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  281    1    0    0    0    0    0
     1    0    0]
 [   0    0    1    0    0    0    1    3  186    0    0    0    0    0
     1    0    0]
 [   0    2    0    0    0    0    0    0    0  438    3    1    4   39
     0   12    1]
 [   0    0    0    0    0    1    0    1    0   19  386   25   26   11
     2   12    0]
 [   0    0    0    1    0    1    0    0    0   11   17  438    7    8
    11    2    8]
 [   0    0    0    0    0    0    0    5    0    7    3    6  594   10
     0    4    1]
 [   1    3    0    0    0    0    0    3    0   39    1    6    1  397
     0    7    0]
 [   0    0    1    0    3    0    6    2    0    0    8   59    4    0
   319    3    9]
 [   0    0    0    0    0    0    0    0    0   14   30   23   36    8
     4  345   33]
 [   0    0    0    1    0    2    0    0    0    8   10   41   11   14
    18    8  389]]
------ TEST ACCURACY:  weights.45-0.52.hdf5  ------
0.656310679612
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 3  2  0  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0 94  0  0  0 12  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 13  0 17  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  4  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  3  0  2  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  2  0  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0 29  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 14  6  8  0  0  0  0]
 [ 0  0  0  0  0  4  0  1  0  6  0  6  5  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  3 15  0  3  5  3]
 [ 0  0  0  0  0  0  0  0  0 12  0  6  3  4  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0 20  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  5  4  6  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  4 10  3  1  3  8]]

>>>>>>>>>>>>>> 30 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_kpca_conv1d_10/30/weights.46-0.49.hdf5
------ TRAIN ACCURACY:  weights.46-0.49.hdf5  ------
0.933996303793
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  208    1    0    0    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1679    0    2    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1922    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0  866    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0    0    6 1273    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  290    1    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    0  196    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  473    3    0    3    9
     0    8    0]
 [   0    0    1    0    0    0    0    0    0   12  430    9   12    0
     9    7    7]
 [   0    0    1    0    0    1    0    3    0   22   23  417   13    2
    10    2    6]
 [   0    2    0    0    0    0    0    1    0   12    8    4  587    7
     6    4    3]
 [   0    3    0    0    0    0    0    1    0   85    1    4    7  350
     4    9    1]
 [   0    0    0    0    3    0    7    8    1    0   22   54    3    0
   296    4   16]
 [   0    0    0    0    0    0    1    1    0   21   47    3   32    0
     4  351   35]
 [   0    0    0    0    0    0    0    0    1    5   21   34   17    2
     9   18  403]]
------ TEST ACCURACY:  weights.46-0.49.hdf5  ------
0.708333333333
[[ 1  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 42  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 23  8  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 17  1  4  2  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  0 13  8  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  3  2 13  0  0  5  4]
 [ 0  0  0  0  0  0  0  0 16  1  0  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0 18  0  0]
 [ 0  0  0  0  0  2  0  0  1  0  3  2  0  1  4  5]
 [ 0  0  0  0  0  0  0  0 10  0 12  0  1  0  1  0]]
[0.6822916666666666, 0.7015437392795884, 0.8881578947368421, 0.4758842443729904, 0.7818791946308725, 0.8252427184466019, 0.7787878787878788, 0.8639798488664987, 0.6956521739130435, 0.6996805111821086, 0.7602040816326531, 0.848, 0.7851458885941645, 0.7473118279569892, 0.8354430379746836, 0.7200854700854701, 0.7730192719486081, 0.7310344827586207, 0.8007518796992481, 0.7462039045553145, 0.6142857142857143, 0.6962809917355371, 0.7699386503067485, 0.7021276595744681, 0.7679012345679013, 0.7708333333333334, 0.7837078651685393, 0.8607594936708861, 0.6563106796116505, 0.7083333333333334]
0.749025955723
0.0813236219342

Process finished with exit code 0

'''
