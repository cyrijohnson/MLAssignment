import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import numpy as np
import cPickle as pickle
from keras.models import Model, load_model
from keras.initializers import Constant, TruncatedNormal
from keras.layers import Input, Dense, Conv1D, Flatten, Dropout, Activation, BatchNormalization
from keras.layers.merge import concatenate
from keras.optimizers import Adam
from keras.callbacks import ModelCheckpoint
import keras.backend as K
from keras import losses
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix

# Load Sparse PCA + Kernel PCA data

X_spca = pickle.load(open("data/X_unimib_spca.p", "rb"))
X_kpca = pickle.load(open("data/X_unimib_kpca.p", "rb"))
X = np.concatenate((X_spca, X_kpca), axis=1)

y = pickle.load(open("data/y_unimib_spca.p", "rb"))

n_classes = 17


# Below builds 1D CNN.

for i in range(30):
    test = y.loc[y[1] == i+1]
    # print y_sub
    test_index = test.index.values
    # print len(test_index)

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index], y_values[test_index]
    y_train = np.eye(n_classes)[y_train - 1]
    print X_train.shape # (11188, 302)

    # input layer
    input_signal = Input(shape=(302, 1))
    print K.int_shape(input_signal)

    # define initial parameters
    b_init = Constant(value=0.0)
    k_init = TruncatedNormal(mean=0.0, stddev=0.01, seed=2018)

    # first feature extractor
    conv11 = Conv1D(16, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn11 = BatchNormalization()(conv11)
    actv11 = Activation('relu')(bn11)
    conv12 = Conv1D(32, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv11)
    bn12 = BatchNormalization()(conv12)
    actv12 = Activation('relu')(bn12)
    flat1 = Flatten()(actv12)

    # second feature extractor
    conv21 = Conv1D(16, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn21 = BatchNormalization()(conv21)
    actv21 = Activation('relu')(bn21)
    conv22 = Conv1D(32, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv21)
    bn22 = BatchNormalization()(conv22)
    actv22 = Activation('relu')(bn22)
    flat2 = Flatten()(actv22)

    # third feature extractor
    conv31 = Conv1D(16, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn31 = BatchNormalization()(conv31)
    actv31 = Activation('relu')(bn31)
    conv32 = Conv1D(32, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv31)
    bn32 = BatchNormalization()(conv32)
    actv32 = Activation('relu')(bn32)
    flat3 = Flatten()(actv32)

    # merge feature extractors
    merge = concatenate([flat1, flat2, flat3])

    # dropout & fully-connected layer
    do = Dropout(0.9, seed=2018)(merge)
    output = Dense(n_classes, activation='softmax', bias_initializer=b_init, kernel_initializer=k_init)(do)

    # result
    model = Model(inputs=input_signal, outputs=output)

    # summarize layers
    print(model.summary())

    new_dir = 'model/unimib_kpca_spca_conv1d_10/' + str(i+1) + '/'
    if not os.path.exists(new_dir):
        os.makedirs(new_dir)

    fpath = new_dir + 'weights.{epoch:02d}-{val_acc:.2f}.hdf5'
    cp_cb = ModelCheckpoint(fpath, monitor='val_acc', verbose=1, save_best_only=True, mode='auto', period=1)

    adam = Adam(lr=0.001)
    model.compile(loss=losses.categorical_crossentropy, optimizer=adam, metrics=['accuracy'])
    model.fit(np.expand_dims(X_train, axis=2), y_train, batch_size=64, epochs=50, verbose=2, validation_split=0.10,
              callbacks=[cp_cb], shuffle=True)

    del model
    K.clear_session()


# Below calculates average test data accuracy (LOSO CV).

acc = []

for i in range(30):
    test = y.loc[y[1] == i+1]
    test_index = test.index.values

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index] - 1, y_values[test_index] - 1

    print "\n>>>>>>>>>>>>>>", str(i+1), "-fold <<<<<<<<<<<<<<<<"
    path_str = 'model/unimib_kpca_spca_conv1d_10/' + str(i+1) + '/'
    for path, dirs, files in os.walk(path_str):
        dirs.sort()
        files.sort()
        top_acc = []
        top_acc.append(files[-1])
        files = top_acc
        for file in files:
            print "========================================"
            print os.path.join(path, file)
            model = load_model(os.path.join(path, file))
            pred = model.predict(np.expand_dims(X_train, axis=2), batch_size=32)
            print "------ TRAIN ACCURACY: ", file, " ------"
            print accuracy_score(y_train, np.argmax(pred, axis=1))
            print confusion_matrix(y_train, np.argmax(pred, axis=1))
            pred = model.predict(np.expand_dims(X_test, axis=2), batch_size=32)
            print "------ TEST ACCURACY: ", file, " ------"
            print accuracy_score(y_test, np.argmax(pred, axis=1))
            print confusion_matrix(y_test, np.argmax(pred, axis=1))

            del model
            K.clear_session()

    acc.append(accuracy_score(y_test, np.argmax(pred, axis=1)))

print acc
print np.mean(acc)
print np.std(acc)

'''
-----
[0.7291666666666666, 0.692967409948542, 0.8453947368421053, 0.5369774919614148, 0.7348993288590604, 0.7864077669902912, 0.7333333333333333, 0.818639798488665, 0.6545893719806763, 0.7156549520766773, 0.7397959183673469, 0.716, 0.7480106100795756, 0.7795698924731183, 0.8126582278481013, 0.6666666666666666, 0.7922912205567452, 0.7103448275862069, 0.8195488721804511, 0.665943600867679, 0.5928571428571429, 0.6632231404958677, 0.7147239263803681, 0.7463175122749591, 0.7506172839506173, 0.7470238095238095, 0.8033707865168539, 0.8829113924050633, 0.7029126213592233, 0.7132352941176471]
0.733868453455
0.0714214761732
-----

/usr/bin/python2.7 /mnt/0cdd1a7e-3686-4cf7-9055-145eb5fe70f3/hcilab/OSS/electronicsletters2018/unimib/unimib_kpca_spca_conv1d_10.py
/home/hcilab/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.

>>>>>>>>>>>>>> 1 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/1/weights.50-0.51.hdf5
------ TRAIN ACCURACY:  weights.50-0.51.hdf5  ------
0.927724598226
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  202    0    0    0    0    0    3    0    0    0    0    0    0
     0    0    1]
 [   0    0 1679    0    1    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1907    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   26    0  842    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  718    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10    9    0    6 1257    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0  278    5    0    3    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    0    3  194    0    0    0    0    0
     0    0    1]
 [   0    1    0    0    0    0    0    0    0  416   16    3   15   59
     0    0    8]
 [   0    0    1    0    0    1    0    0    0   18  417   19    8   10
     2    5   13]
 [   1    0    1    0    0    1    0    0    0    7   21  410    9   10
    17   13   21]
 [   0    4    0    0    0    0    0    1    0    0   12   11  600    5
     0    6    3]
 [   0    2    1    0    1    0    0    0    0   35    5    2    1  412
     0    1   10]
 [   0    0    2    0    1    0    1    7    3    0   11   58    1    2
   314    1   18]
 [   0    0    0    0    0    0    0    0    0    4   56   14   16    6
     6  319   72]
 [   0    0    0    0    0    1    0    0    0    3   17   21    5    6
     5    5  453]]
------ TEST ACCURACY:  weights.50-0.51.hdf5  ------
0.729166666667
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  9  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  2  0 28  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 28  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 15  0  0  0 27  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  1  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  6  0  0  0  0  1]
 [ 0  0  0  0  1  0  0  0  0  2  6  0  0  0  0  6  2]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  1  0 13]
 [ 0  0  0  0  0  0  0  0  0  0  1  0 16  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  3  0  0  2  6  2]
 [ 0  0  0  0  0  1  0  0  0  0  5  2  0  0  4  1  2]
 [ 0  0  0  0  0  1  0  0  0  1  5  1  0  2  0  7  3]
 [ 0  0  0  0  0  0  0  0  0  1  2  0  0  0  0  2 13]]

>>>>>>>>>>>>>> 2 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/2/weights.35-0.48.hdf5
------ TRAIN ACCURACY:  weights.35-0.48.hdf5  ------
0.910976045763
[[ 146    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  183    5    0    2    0    0   12    0    0    0    0    0    0
     0    1    0]
 [   0    0 1586    2    4    1    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1907    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    1  850    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   25   23    2    7 1218    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    0    0  274    9    0    1    0    0    0
     2    0    0]
 [   0    1    0    0    0    0    1    3  187    0    2    0    0    0
     0    1    1]
 [   0    0    0    0    0    0    0    2    2  447   22    1    7   23
     0    0    4]
 [   0    0    1    0    2    2    1    0    0   29  394   10    5    7
     6   23    8]
 [   0    0    1    2    0    1    1    3    1   20   37  348   10    5
    36    9   28]
 [   0    0    1    0    0    0    0    1    0    5   15   12  572    8
     1    4    2]
 [   0    2    0    0    1    0    0    1    0  115    7    4    2  306
     3    9    2]
 [   0    0    0    0    1    0    0   13    1    2   17   27    8    0
   332    2    6]
 [   0    0    0    0    1    0    0    1    0   10   54    7   16    9
    13  334   41]
 [   0    0    1    0    0    2    0    0    0   30    9   22    7   10
    12   22  392]]
------ TEST ACCURACY:  weights.35-0.48.hdf5  ------
0.692967409949
[[  7   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  5   4   0   0   1   0   0   0   0   0   0   0   0   0   0   0   2]
 [  0   0 122   0  20   0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  37   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  29   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   1   0  48   0   0   0   0   0   0   0   0   0   0]
 [  1   3   0   0   0   0   0   4   0   0   0   0   0   0   1   0   0]
 [  0   0   0   0   0   0   0   1   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  13   1   0   3   2   0   2   0]
 [  0   0   0   0   0   0   0   0   0   0   6   6  10   0   0   0   1]
 [  0   0   0   0   2   0   0   1   0   0   0   5   6   0   5   4   1]
 [  0   0   0   0   0   0   0   4   0   2   2   0  27   0   0   4   1]
 [  0   0   1   0   0   0   0   0   0  18   3   0   3   5   0   1   1]
 [  2   0   0   4   1   1   0   0   0   0   0   0   0   0  14   3   0]
 [  0   0   0   0   1   0   1   0   0   4   2   0  11   0   1   1   6]
 [  0   0   0   0   0   0   0   2   0   0   1   8   7   0   1   3   5]]

>>>>>>>>>>>>>> 3 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/3/weights.50-0.49.hdf5
------ TRAIN ACCURACY:  weights.50-0.49.hdf5  ------
0.931019447109
[[ 143    3    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1709    0    0    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1910    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    0  845    0   37    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  711    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    7    0    1 1274    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  280    3    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    0    3  194    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    1  430   12    2    6   51
     7    4    0]
 [   0    0    0    0    0    0    1    1    0   23  408    7   10    8
    16   20    5]
 [   0    0    1    1    1    0    0    1    0   12   15  400    5   14
    34   12   20]
 [   0    4    0    0    0    0    0    1    0    0   12   16  603    3
     3    5    0]
 [   0    0    1    0    1    0    0    0    1   45    6    0    0  401
     4    6    6]
 [   0    0    3    0    0    0    0    8    2    2   11   41    2    1
   353    2    2]
 [   0    0    0    0    0    0    0    1    0   10   50    4    4    5
     6  371   52]
 [   0    0    0    1    0    3    0    0    0    5   12   36    2   15
    10    9  434]]
------ TEST ACCURACY:  weights.50-0.49.hdf5  ------
0.845394736842
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 73  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0 31  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 39  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 10  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  0  8  0  1  0]
 [ 0  1  0  0  0  0  0  4  0  0  6  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  3  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  4  0  1  4  0  2  0]
 [ 0  1  0  0  0  0  0  0  0  1  0  2  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  2  0  0  0  0  0  0  1  7  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  1  0  0  3  1  1]]

>>>>>>>>>>>>>> 4 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/4/weights.44-0.51.hdf5
------ TRAIN ACCURACY:  weights.44-0.51.hdf5  ------
0.929232111693
[[ 152    0    0    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  204    2    0    0    0    0    4    0    0    0    0    0    0
     1    0    0]
 [   0    0 1715    0    3    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1926    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11    0  852    0   29    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  718    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6   11    1    7 1272    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0  283    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1  190    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  450   10    2    6   52
     2    0    0]
 [   0    0    0    0    0    1    1    1    1   24  400   17    4   16
    10   14    3]
 [   0    0    0    0    0    1    2    0    0   20   21  392    2    8
    36   10   11]
 [   0    1    0    0    0    0    0    2    0    4   10   13  595    9
     1    6    2]
 [   0    0    1    0    1    0    0    0    0   55    5    0    0  396
     2    5    2]
 [   0    0    0    0    1    0    1    7    1    3    9   51    1    0
   340    4    3]
 [   0    1    0    0    0    0    0    0    0    8   42   10   17   11
    11  345   52]
 [   0    0    0    0    0    0    0    0    0   20    7   32    3    9
    15    7  419]]
------ TEST ACCURACY:  weights.44-0.51.hdf5  ------
0.536977491961
[[ 0  1  0  0  0  0  1  0  0  0  0  0  0  2  0  0]
 [ 0  6  0  3  0  7  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 53  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  0 24  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 11  0 16  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 27  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  0  1  4  0  0  0  0  0  1  2  0  0]
 [ 2  0  0  0  0  0  5  0  0  0  0  0  0  1  1  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0 13  1  0  0  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  5 10  1  0  5  1  0]
 [ 0  0  0  0  0  0  0  0  3  1  0 14  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  7  3  0  0  7  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  1  8  0  0  2  1  0]
 [ 0  0  0  0  0  0  0  0  2  0  3  0  8  0  2  1]
 [ 0  0  0  0  4  0  0  0  7  1  1  0  4  0  5  0]]

>>>>>>>>>>>>>> 5 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/5/weights.41-0.49.hdf5
------ TRAIN ACCURACY:  weights.41-0.49.hdf5  ------
0.922688050205
[[ 144    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  199    0    0    1    0    0    2    0    0    0    0    0    0
     1    0    0]
 [   0    0 1691    1   20    1    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1918    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  887    0   12    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4   19   31   17 1221    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  284    4    0    0    0    0    1
     0    0    0]
 [   0    0    0    0    0    0    1    3  195    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0    2  425   10   10    4   58
     2    1    0]
 [   0    0    0    0    1    2    0    0    0   21  425   20    5   16
     0   12    0]
 [   0    0    0    2    1    1    2    4    0   15   17  417    3    7
    12    8   16]
 [   0    0    0    0    0    0    0    2    0    4   18   17  591   11
     0    2    1]
 [   0    1    0    0    1    0    0    1    0   48    5    3    0  406
     3    3    3]
 [   0    1    0    0    0    0    0   13    2    5   15   41    0    1
   334    2   11]
 [   0    0    0    0    0    0    0    0    0    9   68   21   15    8
     1  325   51]
 [   0    0    0    1    0    1    0    0    0    7   18   41    2   23
     5   17  401]]
------ TEST ACCURACY:  weights.41-0.49.hdf5  ------
0.734899328859
[[ 5  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  8  3  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 66  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 18  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  4  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  1  1  0  1  0  0  0  4  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 10  0  0  4  5  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  0  7  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  8  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  1  0  0  0  2  6  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  9  0  7  0  0]]

>>>>>>>>>>>>>> 6 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/6/weights.36-0.49.hdf5
------ TRAIN ACCURACY:  weights.36-0.49.hdf5  ------
0.92147196056
[[ 150    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  203    3    0    0    0    0    5    0    0    0    1    0    0
     0    0    0]
 [   0    0 1680    0    2    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1923    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    0  843    0   27    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   22    7    2    6 1237    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  271    7    0    1    1    0    0
     0    1    0]
 [   0    0    0    0    0    0    1    2  191    0    0    0    0    0
     0    0    1]
 [   0    2    0    0    0    0    0    0    0  427    6    4    5   56
     2    1    7]
 [   0    0    0    0    1    1    1    0    1   15  400   18    9   11
     4   19   16]
 [   0    0    1    1    0    0    1    3    0   15   14  380    5   10
    20   10   47]
 [   0    2    0    0    0    0    0    2    0    0   19    4  593    7
     0    6    5]
 [   0    4    1    0    1    0    0    0    0   53    1    4    1  381
     2    2   14]
 [   0    0    1    0    1    0    0    9    3    2   16   38    3    1
   324    4   14]
 [   0    0    0    0    0    0    0    0    0    4   56   12   25   11
     7  303   75]
 [   0    0    1    0    0    2    0    0    2    6    8   31    3   11
     3    4  445]]
------ TEST ACCURACY:  weights.36-0.49.hdf5  ------
0.78640776699
[[ 2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  2  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 44  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 29  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  6  0  0 44  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0  0  1 13  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 17  0  0  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  7  1  0  0  0  5  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 13  0  0  2  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0 14  0  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  7  0  0  7  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  1 17]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  1 15]]

>>>>>>>>>>>>>> 7 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/7/weights.47-0.49.hdf5
------ TRAIN ACCURACY:  weights.47-0.49.hdf5  ------
0.928939777991
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  206    0    0    0    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1670    0    5    0   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1927    0    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  857    0   27    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    3    2    7 1277    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    0    0  284    3    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    4  187    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  465   15    2    2   25
     0    0    5]
 [   0    0    1    0    0    0    0    1    1   29  394   16    6   10
     4   20   14]
 [   0    0    1    1    0    0    1    2    0   19   18  403    8    6
    11   12   26]
 [   0    1    0    0    0    0    0    5    0    4    7    7  602    6
     0    8    3]
 [   0    0    0    0    0    0    0    1    0   63    5    0    2  379
     0    7    5]
 [   0    0    2    0    0    0    1   12    2    2   14   58    1    2
   299    9   24]
 [   0    0    0    0    0    0    0    1    0   16   43   12   18    8
     3  355   44]
 [   0    0    0    0    0    2    0    0    0   14    4   34    7    6
     3    8  444]]
------ TEST ACCURACY:  weights.47-0.49.hdf5  ------
0.733333333333
[[ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 39  0  0  0 10  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 33  0  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 33  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  4  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 13  0  0  0  0  2  0]
 [ 1  0  0  0  0  0  0  0  0  0  5  6  0  0  1  0  5]
 [ 0  0  1  0  0  0  0  0  0  0  0  0 12  0  0  4  1]
 [ 0  0  0  0  0  0  0  0  0 20  0  0  0  1  0  0  1]
 [ 0  0  0  0  0  0  0  1  1  0  0  3  0  0  2  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  6  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  6  6]]

>>>>>>>>>>>>>> 8 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/8/weights.43-0.47.hdf5
------ TRAIN ACCURACY:  weights.43-0.47.hdf5  ------
0.925180235625
[[ 151    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  208    0    0    0    0    0    6    0    0    0    1    0    0
     0    0    0]
 [   0    0 1666    0    4    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1930    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  878    0   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3   21   17   11 1225    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  281    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    3  184    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  428   13    4    5   47
     1    3    0]
 [   0    0    1    0    0    4    0    1    1   26  399   12    8   11
     3   13   15]
 [   1    0    1    0    0    1    0    0    0   13   13  407    9   14
    13   19   18]
 [   0    0    0    0    0    0    0    1    0    0   15   11  590    7
     0    6    6]
 [   0    0    0    0    1    0    0    0    0   48    2    3    2  389
     2   15    3]
 [   0    0    3    0    2    0    0    7    1    2   14   55    1    0
   315    2   18]
 [   0    0    0    0    0    0    0    0    0   13   39   13   18    6
     3  352   59]
 [   0    0    0    0    0    2    0    0    0    7    9   52    9   19
     9    7  399]]
------ TEST ACCURACY:  weights.43-0.47.hdf5  ------
0.818639798489
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  7  1  0  0 39  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  7  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  9  0  0  0  0  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0 17  0  0  0  2  0  0  7]
 [ 0  0  0  0  1  0  0  1  0  0 15  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  1  0  2 11  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  1  0 24  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0 12  0  3  0]
 [ 0  0  0  0  0  0  0  4  0  0  3  4  0  0  2  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  4  6]
 [ 0  0  0  0  0  0  0  0  0  3  0  6  0  1  0  0 11]]

>>>>>>>>>>>>>> 9 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/9/weights.18-0.50.hdf5
------ TRAIN ACCURACY:  weights.18-0.50.hdf5  ------
0.894426344985
[[ 145    4    0    0    1    0    0    1    1    0    0    0    0    0
     0    0    0]
 [   8  185    3    0    0    0    0   13    2    0    0    1    1    0
     0    0    0]
 [   0    1 1667    0    6    1   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7 1914    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   32    0  840    1   28    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    2  718    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    2   38   11    4   14 1208    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    1    0    1  273   10    0    0    2    0    0
     0    0    0]
 [   1    0    0    0    0    0    0   11  176    0    0    0    0    0
     0    1    1]
 [   0    0    0    0    0    0    0    0    0  407   12    2    8   64
     5    2    9]
 [   0    0    1    1    4    7    0    4    1   31  362   19   12   13
     2   16    9]
 [   0    0    2    0    0    1    3    5    0   10   34  380    7    8
    18    5   33]
 [   0    0    2    0    0    0    0    2    0    8    7   16  571    6
     2    4    6]
 [   0    5    1    0    0    0    0    2    1   78   11    3    3  333
     3   22   11]
 [   0    1    2    0    3    1    2    8    1    1   13   65    7    0
   298    5   14]
 [   0    1    0    0    1    2    3    2    0    7   51   17   22   10
    13  300   53]
 [   0    0    1    0    1    2    0    0    1    4   16   55    4   15
     7   18  381]]
------ TEST ACCURACY:  weights.18-0.50.hdf5  ------
0.654589371981
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 50  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 60  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 15  0  5  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  2  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  3  0  1  2  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  2  0  9  0  3  4]
 [ 0  0  0  0  0  0  0  2  3  2 14  0  4  3  0  1  0]
 [ 0  0  0  0  3  0  0  1  0  0  7  0  0  0  9  0  0]
 [ 0  0  3  0  1  0  0  0  0  0  0  0 32  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  3  0  1  0  0  4]
 [ 0  0  0  0  2  1  0  0  1  0  0  0  0  0  9  0  0]
 [ 0  1  0  0  0  0  0  2  0  1  0  0 19  0  0  3  5]
 [ 0  0  0  0  0  0  0  0  0 10  0  5  3  0  0  9  2]]

>>>>>>>>>>>>>> 10 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/10/weights.37-0.46.hdf5
------ TRAIN ACCURACY:  weights.37-0.46.hdf5  ------
0.917961249782
[[ 150    1    0    0    1    0    0    0    1    0    0    0    0    0
     0    0    0]
 [   2  203    2    0    1    0    0    7    0    0    0    0    0    0
     1    0    0]
 [   0    0 1701    0    1    1    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1932    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   18    0  864    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  728    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   28   12    0    1 1254    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  287    4    0    1    0    0    0
     1    0    0]
 [   0    0    1    0    0    0    0    6  179    0    0    0    0    0
     0    0    1]
 [   0    2    0    0    0    0    0    0    0  438    7    3   16   37
     2    0    2]
 [   0    0    1    0    0    4    0    0    0   26  407   17    9    9
     6   17    3]
 [   0    0    1    0    1    3    2    2    1   13   21  380   16    9
    33    6   16]
 [   0    1    1    0    0    0    0    3    0    6   16   10  598    6
     2    0    0]
 [   1    0    0    0    1    0    0    2    0   87    6    3    5  351
     1    6    4]
 [   0    0    3    0    2    1    0    9    2    3   11   49    6    1
   325    1    7]
 [   0    0    0    0    0    0    0    1    0   10   66   11   28    5
     8  318   54]
 [   0    0    1    0    0    2    0    1    0   13   17   28    3   14
    12   23  403]]
------ TEST ACCURACY:  weights.37-0.46.hdf5  ------
0.715654952077
[[32  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 51  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0 13  0 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 17  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  7 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  4  8  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0 22  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  7  1  0  0  3  0  1]
 [ 0  0  0  0  0  0  0  0  1  3  2  1  4  0 11]
 [ 0  0  0  0  0  0  0  0  0  0 18  0  0  0  0]
 [ 0  0  0  0  0  0  0 13  0  0  0  4  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0 13  0  0]
 [ 0  0  0  0  0  0  0  0  6  2  0  0  2  2  0]
 [ 0  0  0  0  0  0  0  4  0  0  1  0  0  1 11]]

>>>>>>>>>>>>>> 11 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/11/weights.49-0.51.hdf5
------ TRAIN ACCURACY:  weights.49-0.51.hdf5  ------
0.915546181563
[[ 144    2    0    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   5  189    3    0    1    0    0   11    0    0    0    1    1    0
     0    0    0]
 [   0    0 1702    2    6    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1896    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   24    0  828    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    1  722    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   23    9    1    4 1230    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  282    3    0    1    1    0    0
     1    0    0]
 [   0    0    0    0    0    0    0   11  182    0    0    0    0    0
     1    0    1]
 [   0    0    0    0    0    0    0    0    1  429   10    0    6   55
     0    8    2]
 [   0    0    0    0    2    2    0    2    1   20  400    7    4   18
     3   29    3]
 [   0    0    0    1    1    0    1    3    0   15   28  381    6   10
    14   30   22]
 [   0    0    0    0    0    0    0    1    0    4    9    9  600    6
     1    7    0]
 [   0    1    1    0    0    0    0    3    0   56    4    2    3  374
     0   12    9]
 [   0    0    0    0    3    0    0    7    0    2   14   52    6    2
   308   13    9]
 [   0    0    0    0    0    0    0    0    0    5   50    9    9   12
     7  364   43]
 [   0    0    0    0    0    0    0    0    0   15   15   35    3    8
     7   48  387]]
------ TEST ACCURACY:  weights.49-0.51.hdf5  ------
0.739795918367
[[ 3  0  0  0  0  0  0  1  0  0  0  0  2  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  1  0]
 [ 0  0 23  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 82  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  4  0 37  0  0  1  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 11  0  0  1 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0  7  0  6  1]
 [ 0  0  0  0  0  0  0  0  0  0 14  0  0  0  0  4  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0  0  3  7]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 16  0  0  5  3]
 [ 0  0  0  0  0  0  0  0  0  6  3  0  0  7  0  3  0]
 [ 0  0  0  0  0  0  0  2  0  0  3  0  0  0  5  4  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  4  0  7  0]
 [ 0  0  3  0  0  0  0  0  0  0  3  0  0  0  0  3  7]]

>>>>>>>>>>>>>> 12 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/12/weights.24-0.50.hdf5
------ TRAIN ACCURACY:  weights.24-0.50.hdf5  ------
0.900008872327
[[ 133    8    0    0    1    0    0    2    3    0    0    0    0    0
     0    0    0]
 [   1  195    3    0    2    0    0    7    1    0    0    1    1    0
     0    0    0]
 [   0    0 1540    1    6    1    7    0    0    0    0    1    0    0
     0    0    0]
 [   0    0    4 1906    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   23    0  837    0   29    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    1  708    3    0    0    0    0    1    0    0
     0    0    0]
 [   0    0   32   21    2   11 1222    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    3    0    0  275   11    0    0    2    0    0
     1    1    0]
 [   0    0    0    0    0    0    1   12  183    0    0    0    0    0
     0    0    1]
 [   0    1    0    0    0    0    0    0    2  413    9    6    9   62
     7    2    1]
 [   0    0    1    0    1    2    0    3    1   25  370   26    5   11
    10   35    6]
 [   0    0    5    0    1    0    0    4    1    9   19  405   12   11
    17   13   17]
 [   0    0    1    0    0    0    0    0    0    1    9   12  603    8
     0    5    2]
 [   0    2    2    0    3    0    0    0    0   77    6    0    4  343
     4   17    6]
 [   0    0    1    0    4    0    0   12    3    1   11   57    2    1
   315    3   14]
 [   0    0    0    0    0    0    0    0    1   13   50   20   12    5
     7  351   37]
 [   0    0    1    1    0    1    0    1    0   12    9   47    3   24
    10   61  345]]
------ TEST ACCURACY:  weights.24-0.50.hdf5  ------
0.716
[[  5   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0]
 [  3   2   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 119   0   0   0  63   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  71   0   0   3   0   0   0   0   0   0   0   0   0   0]
 [  0   2   1   0  29   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  28   4   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  36   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   2   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   6   0   0   0   2   0   5   4]
 [  0   0   0   0   0   0   1   0   0   0   3   1   0   2   0   3   5]
 [  0   0   0   0   0   0   0   0   0   0   0  10   0   0   0   0   2]
 [  0   0   0   0   0   0   0   0   0   0   0   0  11   0   0   9   0]
 [  0   0   0   0   0   0   0   0   0   1   0   0   0  16   0   3   0]
 [  0   0   0   0   0   0   0   0   0   0   0   1   0   0   7   0   2]
 [  0   0   0   0   0   0   0   0   0   3   4   3   0   0   0   5   2]
 [  0   0   0   0   0   0   0   0   0   3   0   0   0   0   2   6   8]]

>>>>>>>>>>>>>> 13 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/13/weights.46-0.51.hdf5
------ TRAIN ACCURACY:  weights.46-0.51.hdf5  ------
0.923995085133
[[ 148    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  199    2    0    0    0    0    7    1    0    0    1    0    0
     0    0    0]
 [   0    0 1706    0    3    1    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1914    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   34    0  812    0   39    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0  719    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   31   16    1    3 1228    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  275    2    0    0    1    0    0
     0    1    0]
 [   1    0    0    0    0    0    0    5  186    0    2    0    0    0
     0    1    1]
 [   0    2    0    0    0    0    0    0    0  407   14   11    8   65
     0    0    0]
 [   0    0    0    0    1    6    0    1    0   16  423    9    9   10
     1   15    2]
 [   0    0    0    1    0    4    1    1    0    9   11  428    6   11
    12   15    9]
 [   0    1    0    0    0    0    0    2    0    2   19    8  592    7
     1    2    2]
 [   0    0    1    0    1    0    0    0    0   27    3    4    1  429
     1    6    1]
 [   0    2    2    0    0    0    0   10    0    0   14   53    9    4
   313    4    7]
 [   0    0    0    0    0    0    1    0    0    4   64    3   14   20
     4  341   44]
 [   0    0    0    0    0    1    0    0    1    8    8   37    1   14
     9   25  408]]
------ TEST ACCURACY:  weights.46-0.51.hdf5  ------
0.74801061008
[[ 3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  5  0  0  0  0]
 [ 0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0 35  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0 14  0  0  0  0  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  3  0  8  8  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  8  0  0  0  0  5  4]
 [ 0  0  1  0  0  0  0  0  0  0  9  2  2  0  1  1  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 25  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  0 14  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  0  5  3  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  6  0  0 13  2]]

>>>>>>>>>>>>>> 14 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/14/weights.46-0.49.hdf5
------ TRAIN ACCURACY:  weights.46-0.49.hdf5  ------
0.930607948066
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  205    1    0    2    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1679    0    4    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1921    0    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  856    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    2    5    6 1255    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  290    1    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    0    0    2  193    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    2  449   14    1    2   44
     4    0    0]
 [   0    0    0    0    1    3    0    1    1   23  395   21    8   11
     6   21    2]
 [   0    0    1    0    1    2    0    2    0   15   22  399    6   12
    14    9   20]
 [   0    0    0    0    0    0    0    2    0    7   10    4  598    9
     1    3    7]
 [   0    0    1    0    1    0    0    0    0   47    7    1    0  411
     0    2    4]
 [   0    0    1    0    4    0    0   12    3    2   11   46    3    6
   313    2   11]
 [   1    0    0    0    0    0    0    0    0   11   52    8   11    2
     4  341   65]
 [   0    0    0    0    0    1    0    0    0   10    6   47    5   15
     2    7  430]]
------ TEST ACCURACY:  weights.46-0.49.hdf5  ------
0.779569892473
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  4  0  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 39  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 50  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  0  4  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3 15  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  5 10  6  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 13  2  0  0  5]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  8  7  0  0  3  0  2]
 [ 0  0  0  0  0  0  0  0  0  0 13  1  0  0  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0  2  0  6]]

>>>>>>>>>>>>>> 15 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/15/weights.43-0.50.hdf5
------ TRAIN ACCURACY:  weights.43-0.50.hdf5  ------
0.928797468354
[[ 144    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  207    0    0    0    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1675    0    5    2    9    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1890    0    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0  866    0   31    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  713    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    1    2    6 1258    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  277    4    0    0    1    0    1
     1    0    0]
 [   0    0    0    0    0    0    0    4  187    0    0    0    0    0
     0    1    0]
 [   0    1    0    0    0    0    0    1    0  436    7    1    3   67
     0    0    1]
 [   0    0    0    0    0    2    0    3    1   19  413   11    4   13
     7   14    6]
 [   0    0    1    0    1    1    1    0    0   14   18  409    3   10
    34    7   13]
 [   0    3    0    0    0    0    0    2    0    1   15   12  596    4
     0    7    3]
 [   0    0    1    0    1    0    0    0    0   46    3    2    3  400
     0    6    7]
 [   0    0    0    0    0    0    0    8    1    2   12   52    1    3
   331    1    5]
 [   0    0    0    0    0    0    0    1    0    4   57   14   10    8
     5  342   59]
 [   0    0    1    0    0    3    0    0    2    5    4   34    3   14
    20   11  422]]
------ TEST ACCURACY:  weights.43-0.50.hdf5  ------
0.812658227848
[[ 4  0  0  0  0  0  0  1  4  0  0  0  0  0  0  0  0]
 [ 1  2  0  0  0  0  0  1  1  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 88  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 16  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  5 50  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  0  0  1  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  1  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  1  2  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0 14  0  0  0  0  3  0]
 [ 0  0  0  0  0  0  0  1  0  2  2  3  0  2  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  4  0  5  6  0  0  1  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  8  0  0  7  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  3  1  0  0  0  6]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  0  0  0  0 11]]

>>>>>>>>>>>>>> 16 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/16/weights.41-0.51.hdf5
------ TRAIN ACCURACY:  weights.41-0.51.hdf5  ------
0.91462443599
[[ 143    1    0    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  193    1    0    0    0    0    4    0    0    0    1    0    0
     0    0    0]
 [   0    0 1676    0    1    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6 1902    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   65    0  783    1   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  713    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   84   15    0    4 1162    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  268    3    0    0    1    0    0
     2    1    0]
 [   0    0    0    0    0    0    1    6  183    0    0    0    0    1
     0    1    1]
 [   0    1    0    0    0    0    0    0    0  418   17    0    2   68
     3    0    1]
 [   0    0    1    0    1    3    0    1    0   25  396   20   10    8
     4   21    2]
 [   0    0    1    1    1    2    1    1    0   14   15  408    2   13
    28    7   18]
 [   0    0    0    0    0    0    0    2    0    0   12   10  599    6
     0   10    1]
 [   0    0    0    0    0    0    0    0    1   35    4    4    3  415
     0    5    3]
 [   0    0    0    0    4    0    1    6    3    0   10   41    7    1
   333    4   13]
 [   0    0    0    0    1    0    3    2    0    6   55   13   13   10
     2  338   48]
 [   0    0    1    0    0    2    0    0    0    6    9   28    3   21
    12   18  408]]
------ TEST ACCURACY:  weights.41-0.51.hdf5  ------
0.666666666667
[[ 4  2  0  0  1  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 5  3  0  0  0  1  0  6  2  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 77  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 46  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  8 20  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 20  9  0  0 30  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  7  0  0 12  1  0  0  0  0  0  0  1  0]
 [ 0  2  0  0  1  0  0  1  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 16  0  0  2  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  3 10  0  0  0  0  6]
 [ 0  1  0  0  0  0  0  0  0  0  0  7  0  0  4  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  0  1  3  3  0]
 [ 0  0  0  0  0  0  0  1  0  2  3  3  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  8  0  2  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  4 10  0  0  4  4]]

>>>>>>>>>>>>>> 17 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/17/weights.20-0.50.hdf5
------ TRAIN ACCURACY:  weights.20-0.50.hdf5  ------
0.892781316348
[[ 136    7    0    0    1    0    0    2    3    0    0    0    0    0
     0    0    0]
 [   2  182    3    0    1    0    0   12    0    0    0    1    0    0
     0    0    0]
 [   0    0 1621    0    5    2    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1894    0    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    1   30    0  823    4   34    0    0    0    0    0    0    1
     0    0    0]
 [   0    0    0    2    0  721    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   57   13    1    9 1194    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    1    0    0    0    0  264   10    0    2    1    0    0
     2    1    0]
 [   1    1    0    0    0    0    0    9  178    0    1    0    0    0
     0    2    1]
 [   0    1    0    0    0    0    0    0    0  409    8    1    5   78
     0    7    8]
 [   0    0    1    0    5    1    0    1    3   24  372   16    6   14
     1   39   12]
 [   0    0    3    0    0    1    1    6    2   18   16  349    7    8
    36   10   48]
 [   0    6    2    0    0    0    0    2    0    6   11   15  576    6
     0    9    8]
 [   0    4    1    0    1    0    0    3    0   74    6    1    2  351
     1   11    9]
 [   0    0    1    0    6    0    0   16    4    2   14   51    0    1
   289    8   19]
 [   0    1    1    0    0    1    1    4    0   12   45   11   17   14
     8  315   65]
 [   0    0    1    1    1    2    0    1    1    8   21   19    2   17
     5   20  418]]
------ TEST ACCURACY:  weights.20-0.50.hdf5  ------
0.792291220557
[[  4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  1  11   0   0   0   0   0   3   0   0   0   0   0   0   0   0   0]
 [  0   0 103   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  81   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  23   0   5   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  19   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  50   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0  13   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   2   5   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   0   2   2   0   1   0]
 [  0   0   0   0   0   0   0   0   0   0   8   2   0   0   0   0   6]
 [  0   0   0   0   0   0   0   0   0   0   3  13   0   1   4   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  17   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   0   0   7   6   0   0]
 [  0   0   0   0   0   0   0   0   0   0   1   5   0   1  15   0   1]
 [  0   0   0   0   0   0   0   0   0   5   7   0   0   0   2   4   0]
 [  0   0   0   0   0   0   0   0   0   0   4   0   0   0   5   0   8]]

>>>>>>>>>>>>>> 18 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/18/weights.34-0.50.hdf5
------ TRAIN ACCURACY:  weights.34-0.50.hdf5  ------
0.913422175769
[[ 137    1    0    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  198    1    0    0    0    0    7    0    0    0    0    0    0
     0    0    1]
 [   0    0 1728    0    3    3    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1922    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   64    0  799    1   30    0    0    0    0    0    0    1
     0    0    0]
 [   0    0    0    1    0  726    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   56   13    0    8 1216    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  277    4    0    0    1    0    0
     0    1    0]
 [   0    0    0    0    0    0    0    5  183    0    0    0    0    0
     1    0    0]
 [   0    2    0    0    0    0    0    0    0  417    7    5    4   72
     7    0    1]
 [   0    0    1    0    1    6    0    3    0   18  384   30    4   15
     8   20    3]
 [   0    0    2    0    0    3    0    3    2    7   21  401    5   10
    26   14   15]
 [   0    3    0    0    0    0    0    2    1    0   12    7  608    3
     2    3    2]
 [   0    0    1    0    0    0    0    1    0   46    5    0    6  402
     1    9    0]
 [   0    0    1    0    0    0    2   13    4    1    9   51    1    2
   334    2    3]
 [   0    0    0    0    1    0    0    0    1    7   54   13    9   17
     8  350   43]
 [   0    0    1    0    0    2    0    0    1    4   10   54    4   14
     8   18  405]]
------ TEST ACCURACY:  weights.34-0.50.hdf5  ------
0.710344827586
[[ 1  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  0  4  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 56  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  5  0  4  7  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0 30  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  8  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  0  3  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0 11  3  0  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  7  0  5  0  2  3]
 [ 0  0  0  0  0  0  0  0  0  0  3  0 12  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 11  1  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  9  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  2  4  2]
 [ 0  0  0  0  0  0  0  0  0  0  8  1  0  0  0  0  4]]

>>>>>>>>>>>>>> 19 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/19/weights.44-0.50.hdf5
------ TRAIN ACCURACY:  weights.44-0.50.hdf5  ------
0.92603215993
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  199    0    0    2    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1724    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1913    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  888    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   38    4    3    7 1241    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  283    4    0    0    2    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    6  184    0    0    0    0    0
     0    0    1]
 [   0    0    0    0    0    0    0    0    1  439   16    8    4   49
     0    0    4]
 [   0    0    1    0    1    0    0    1    1   12  427   17    1   13
     4   10    8]
 [   0    0    1    0    1    1    1    3    0    8   22  421    0   14
    16    7   22]
 [   0    2    0    0    0    0    0    3    0    3    9   15  600    8
     0    3    1]
 [   0    1    0    0    0    0    0    0    1   53    7    2    1  398
     1    6    4]
 [   0    0    0    0    3    0    0    4    1    3   10   62    0    2
   320    1   13]
 [   0    0    0    0    0    0    2    0    0    6   76   18    9    8
     9  317   59]
 [   0    0    0    0    0    0    0    1    0    8   13   40    3   10
     3   14  430]]
------ TEST ACCURACY:  weights.44-0.50.hdf5  ------
0.81954887218
[[ 4  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 14  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  2  0 29  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  7  0  1  0]
 [ 0  0  0  0  0  0  0  3  0  1  7  0  0  1  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0  2  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  3  1  0  0  6  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  8  0]
 [ 0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  7  3]]

>>>>>>>>>>>>>> 20 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/20/weights.49-0.50.hdf5
------ TRAIN ACCURACY:  weights.49-0.50.hdf5  ------
0.926878868258
[[ 139    3    0    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  197    1    0    0    0    0    4    0    0    0    0    0    0
     0    1    0]
 [   0    0 1568    0    3    2    9    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1909    0    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  843    0   43    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716   12    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    5    0    4 1265    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  284    2    0    1    1    0    0
     0    0    0]
 [   0    1    0    0    0    0    1    4  185    0    0    0    0    0
     0    0    1]
 [   0    2    0    0    0    0    0    0    2  441   11    2    1   49
     5    0    0]
 [   0    0    0    0    0    2    0    1    0   26  409   10    6    9
    11   20    7]
 [   0    1    0    1    0    1    1    2    0   16    8  386    2   14
    49   20   18]
 [   0    3    0    0    0    0    0    0    0    5    9   11  594    7
     0   12    2]
 [   0    0    0    0    0    0    0    0    0   45    2    1    1  403
     4    8    5]
 [   0    0    0    0    0    0    1   14    1    2   10   34    1    0
   346    9    7]
 [   0    0    0    0    0    0    0    0    0    8   48    5   14    1
     7  370   46]
 [   0    0    2    0    0    0    0    0    1   12    2   25    2   11
    20   22  428]]
------ TEST ACCURACY:  weights.49-0.50.hdf5  ------
0.665943600868
[[  7   3   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  6   3   0   0   1   0   0   2   0   0   0   0   0   0   0   0   1]
 [  0   0 111   0   0   0  45   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  71   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   3  15   0  10   0   0   0   0   0   0   0   0   1   0]
 [  0   0   0   0   0  18   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  35   0   0  15   0   0   0   0   0   0   0   0   0   0]
 [  1   0   0   0   0   0   0   4   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   8   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  13   0   0   0   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   7   0   0   2   1   0]
 [  0   0   0   0   0   0   0   0   0   0   1   3   0   0   0   3   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  18   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   4   0   0   2   9   0   0   0]
 [  0   0   0   0   0   0   0   1   0   0   2   0   0   0   6   0   0]
 [  0   0   0   0   0   0   0   0   0   2   0   0   2   3   1   6   0]
 [  0   0   0   0   0   0   0   0   0   0   1   2   0   0   0   6   0]]

>>>>>>>>>>>>>> 21 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/21/weights.50-0.50.hdf5
------ TRAIN ACCURACY:  weights.50-0.50.hdf5  ------
0.9318597163
[[ 146    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  202    0    0    0    0    0    2    0    0    0    1    0    0
     0    0    0]
 [   0    0 1735    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1924    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    0  880    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  724    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11    7    0    7 1253    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  273    9    0    0    1    0    0
     0    2    0]
 [   0    0    0    0    0    0    1    0  184    0    0    0    0    0
     0    0    1]
 [   0    2    0    0    0    0    0    0    0  462   15    2    6   27
     2    0    0]
 [   0    0    1    0    0    1    0    0    0   30  409   16   16    3
     5   14    7]
 [   0    0    1    0    0    1    1    0    0   23   13  394   11    4
    24   17   20]
 [   0    0    0    0    0    0    0    3    0    0    8    8  613    5
     1    4    0]
 [   0    0    0    0    1    0    0    0    0   66    2    4    4  386
     3    3    4]
 [   0    0    2    0    0    0    0    6    2    8   10   46    1    3
   339    2    6]
 [   0    0    0    0    0    0    0    0    0   12   48    8   16    3
     9  357   48]
 [   0    0    1    0    0    2    0    0    0   13   14   27    5   14
    13   11  427]]
------ TEST ACCURACY:  weights.50-0.50.hdf5  ------
0.592857142857
[[ 6  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  6 19  0  0 36  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  7  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  1  0 17  4  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  7  0  1  0 37  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  0  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  4  0  0  0  0  3  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  9  6  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1 18  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  8  0  0  2]
 [ 0  1  0  0  0  0  0  0  0  0  0  5  3  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  1  2  0  5  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  1  2  3]]

>>>>>>>>>>>>>> 22 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/22/weights.49-0.49.hdf5
------ TRAIN ACCURACY:  weights.49-0.49.hdf5  ------
0.926021086205
[[ 134    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  202    1    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1658    0    3    0   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1920    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    0  809    0   53    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    6    4    2 1257    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  276    3    0    1    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    3  180    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    2  440   10    0   10   41
     1    1    0]
 [   0    0    0    0    2    1    0    0    0   27  389   13    9    8
    11   24    6]
 [   0    0    1    0    2    1    0    1    0   21   26  367    6    5
    24   19   25]
 [   0    2    0    0    0    0    0    3    0    2   10    6  601    7
     0    6    1]
 [   0    0    0    0    0    0    0    0    0   52    5    0    8  382
     2    9    5]
 [   0    0    0    0    0    0    1   10    1    2   17   35    4    0
   332    7    8]
 [   0    0    0    0    0    0    1    0    0    9   54    6    6    2
     2  370   40]
 [   0    0    0    1    0    3    0    1    1    6    6   25    3   13
    10   22  421]]
------ TEST ACCURACY:  weights.49-0.49.hdf5  ------
0.663223140496
[[ 1  8  0  0  3  0  0  4  1  0  0  0  0  0  0  0  0]
 [ 1  6  0  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  3  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 60  0  0  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 36  8  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  7  1  7 35  0  0  0  0  0  0  0  1  0  0]
 [ 0  6  0  0  2  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  0  0  0  0  5  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 14  0  0  4  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  7  3  0  0  0  8  3]
 [ 0  0  0  0  0  0  0  0  0  0  3  5  8  0  8  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  2]
 [ 0  4  0  0  0  0  0  2  0  8  0  0  2  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0  6  5  3]
 [ 0  0  0  6  0  0  0  0  0  0  0  0  0  0  0 17  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0  3  5 11]]

>>>>>>>>>>>>>> 23 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/23/weights.15-0.49.hdf5
------ TRAIN ACCURACY:  weights.15-0.49.hdf5  ------
0.879161205767
[[ 135    6    0    0    1    0    0    1    4    0    0    0    0    0
     0    0    0]
 [   8  184    3    0    2    0    0    9    1    0    0    1    1    0
     0    0    0]
 [   0    0 1692    0    6    5   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1902    0    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    1   40    0  816    2   36    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0  720    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   40   13    1   11 1214    0    0    0    0    0    0    0
     0    0    0]
 [   0   13    1    0    0    0    0  239   22    0    1    2    1    0
     0    2    0]
 [   2    3    0    0    0    0    0   10  178    0    0    0    0    0
     0    0    1]
 [   0    1    0    0    0    1    0    0    1  408    8    2    7   57
     0    6   16]
 [   0    0    1    0    1    8    0    2    3   37  378   16    9    9
     3   30    5]
 [   0    0    1    0    3    3    0    7    2   19   24  380   10    9
    19    9   31]
 [   0    3    3    0    0    0    0    2    0    4   12   12  587    9
     0    8    6]
 [   0    5    0    0    0    0    0    2    0  125   11    1    2  292
     2   16   13]
 [   0    1    2    0    0    2    3   17    5    3   18   54    2    0
   290   15   13]
 [   0    0    0    0    0    0    2    3    2   12   59   19   24   10
    11  319   37]
 [   0    0    1    0    0    4    0    2    1   20   14   68    3   14
    12   53  328]]
------ TEST ACCURACY:  weights.15-0.49.hdf5  ------
0.71472392638
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  3  0  0  0  0  0  0  0  0]
 [ 0  0  4  2  0  0  9  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 74  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 10  0 12  4  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0  0  9 33  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0 13  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  9  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  4  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  4  3  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  6  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  1  0  0  0  8  4]
 [ 0  0  0  0  0  0  0  0  0  0  2  3  0  0  0  0  9]]

>>>>>>>>>>>>>> 24 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/24/weights.41-0.51.hdf5
------ TRAIN ACCURACY:  weights.41-0.51.hdf5  ------
0.924731182796
[[ 132    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  193    1    0    0    0    0    2    0    0    0    0    0    0
     0    0    1]
 [   0    0 1552    0    0    2    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1908    0    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0  818    0   32    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    0    1    6 1254    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    0    0  269    5    0    1    0    0    0
     2    0    0]
 [   0    0    0    0    0    0    1    2  184    0    0    1    0    0
     0    1    1]
 [   0    0    0    0    0    0    0    0    0  437    6    1    3   57
     1    0    1]
 [   0    0    1    0    1    3    0    0    1   22  412   12    4   14
     4    9   13]
 [   0    0    1    1    0    2    0    0    0   15   33  387    5    5
    28   12   23]
 [   0    1    0    0    0    0    0    0    0   11    9   10  595    6
     0    4    4]
 [   0    0    1    0    1    0    0    0    0   61    5    3    1  387
     0    3    7]
 [   0    0    0    0    1    0    2    5    2    2   10   44    1    2
   324    2   14]
 [   0    0    0    0    0    0    3    0    0    9   59    6   10    9
     7  341   50]
 [   0    0    1    0    0    1    1    0    0   14   12   30    3   13
     9   25  408]]
------ TEST ACCURACY:  weights.41-0.51.hdf5  ------
0.746317512275
[[  7  11   0   0   0   0   0   1   2   0   0   0   0   0   0   0   0]
 [  0   9   0   0   0   0   0   3   0   0   0   0   0   0   0   6   1]
 [  0   0 177   0   1   0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  69   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   3   0  57   0   3   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  27   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   3  10   0   0  43   0   0   0   0   0   0   0   0   0   0]
 [  0   8   0   0   0   0   0   7   0   0   0   0   1   0   0   2   0]
 [  0   1   0   0   0   0   0   1   6   0   1   0   0   1   0   0   0]
 [  0   0   0   0   0   0   0   0   0  12   0   0   2   9   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   5   4   0   0   0   6   0]
 [  0   0   0   0   0   0   0   0   0   0   0   1   2   7   4   0   0]
 [  0   0   0   0   0   0   0   0   0   1   1   0  19   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  10   0   0   0   5   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0  15   1   0   4   5   0]
 [  0   0   0   0   0   0   0   0   0   0   1   0   9   0   0   8   1]
 [  0   0   0   0   0   0   0   0   0   0   0  15   2   0   0   0   0]]

>>>>>>>>>>>>>> 25 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/25/weights.43-0.48.hdf5
------ TRAIN ACCURACY:  weights.43-0.48.hdf5  ------
0.926359317262
[[ 150    0    0    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  208    0    0    1    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1682    0    3    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1912    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  867    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  725    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    6    6    7 1248    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  286    1    0    0    1    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    3  189    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  427   10    7    5   60
     0    0    1]
 [   0    1    1    0    1    2    0    1    1   29  399   22    2    5
     5   20    3]
 [   0    0    1    0    0    1    0    3    1   16   18  406    9    7
    16   14   20]
 [   0    0    0    0    0    0    0    1    1    8   12    8  585    5
     0    7    6]
 [   2    4    1    0    0    0    0    2    0   58    4    2    4  370
     0   10    6]
 [   0    0    1    0    1    0    0   10    2    0   10   49    3    2
   323    5   13]
 [   0    0    0    6    0    0    1    0    0    6   35    8   12    3
     2  363   49]
 [   0    0    0    0    1    0    0    0    0    7   17   59    2   12
     4   22  389]]
------ TEST ACCURACY:  weights.43-0.48.hdf5  ------
0.750617283951
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0]
 [ 0  0 41  5  4  3  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 21  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 52  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  7  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  3  0  0  5  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  9  1  2  0  0  7  0]
 [ 0  0  0  0  0  0  0  1  0  1  5  2  0  1  0  1  3]
 [ 0  0  0  0  0  0  0  1  0  0  0  0 27  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  0  0  0 12  0  2  1]
 [ 0  0  0  0  2  0  0  0  0  0  5  5  0  0  1  1  1]
 [ 0  0  0  0  0  0  0  0  0  4 14  0  0  8  0  2  0]
 [ 0  0  0  0  1  0  0  0  2  0  0  0  0  0  0  0 18]]

>>>>>>>>>>>>>> 26 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/26/weights.31-0.50.hdf5
------ TRAIN ACCURACY:  weights.31-0.50.hdf5  ------
0.914035854832
[[ 151    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  200    1    0    2    0    0    6    0    0    0    1    0    0
     0    0    0]
 [   0    0 1696    0    6    1    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1920    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10    0  859    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14   14   18    8 1222    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    1    0    0    0    0  281    9    0    0    1    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    5  192    0    0    0    0    0
     1    0    1]
 [   0    0    0    0    0    0    0    1    0  403    8    1    8   89
     2    0    0]
 [   0    0    1    0    1    0    0    1    1   19  379   26   15   14
     6   19    8]
 [   0    0    1    0    1    1    0    5    0   13   17  396   12    9
    24    8   20]
 [   0    0    0    0    0    0    0    0    0    9    4    6  601    9
     0    4    3]
 [   1    2    1    0    1    0    0    0    0   56    3    3    3  394
     2    9    2]
 [   0    0    2    0    2    0    0    2    1    1   10   39    3    0
   338    4   19]
 [   0    1    0    0    0    0    1    0    0   11   67   11   32   13
    12  305   41]
 [   0    0    1    0    0    1    1    1    0   11   18   42    6   14
    14   17  392]]
------ TEST ACCURACY:  weights.31-0.50.hdf5  ------
0.747023809524
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  2  0  0  0  0  0  1  0  0]
 [ 0  0 31  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 48  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 11  5  0  0  1  0  0  0]
 [ 0  0  0  0  0  1  0  0  8  9  1  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  6  0  0  6  1  2]
 [ 0  2  0  0  0  0  0  2  1  5  1 13  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  4  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  2  0  0  2  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  2 16]
 [ 0  0  0  0  0  0  0  0  0  0  7  0  0  1  0  8]]

>>>>>>>>>>>>>> 27 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/27/weights.18-0.49.hdf5
------ TRAIN ACCURACY:  weights.18-0.49.hdf5  ------
0.881208935611
[[ 135   10    0    0    1    0    0    2    5    0    0    0    0    0
     0    0    0]
 [   7  188    0    0    4    0    0   10    3    0    0    1    1    0
     1    0    0]
 [   0    0 1658    3   10    2   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6 1906    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   26    2  822    3   43    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  712    2    0    0    0    0    0    0    0
     0    0    0]
 [   1    0   18   29    6   11 1214    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    1    0    0    0    0  255   27    0    0    0    0    0
     1    1    0]
 [   1    0    0    0    0    0    0    7  191    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    1  390    6    6   12   88
     5    3    0]
 [   0    0    0    0    1    2    1    1    1   28  364   23   19   11
     8   31    7]
 [   0    1    0    1    0    1    2    4    5   16   22  357    7    9
    39   17   23]
 [   0    3    0    0    0    0    0    1    0   13    4   10  594    7
     2    4    2]
 [   0    4    1    0    0    0    0    3    0   83    9    2    4  339
     4   10    7]
 [   0    1    0    0    0    0    0    6    5    1   15   64   10    1
   308    7    5]
 [   0    0    0    6    0    0    1    0    1    7   51   16   35   15
    11  302   52]
 [   0    0    1    0    0    5    0    0    3   19   19   54    8   11
    18   56  324]]
------ TEST ACCURACY:  weights.18-0.49.hdf5  ------
0.803370786517
[[ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 39  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 31  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  2  3  0 38  0  0  0  0  0  0  0  0  0  0]
 [ 2  1  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 17  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 11  2  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  5  0  0 15  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0 11  0  3  2]
 [ 0  0  0  0  1  0  2  3  3  0  0  1  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 13  0  1  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  2  2  0 10]]

>>>>>>>>>>>>>> 28 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/28/weights.29-0.47.hdf5
------ TRAIN ACCURACY:  weights.29-0.47.hdf5  ------
0.904146660847
[[ 150    1    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   5  198    2    0    1    0    0    7    1    0    0    0    0    0
     1    0    0]
 [   0    0 1693    1    2    2    8    0    0    0    0    0    0    1
     0    0    1]
 [   0    0    2 1921    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   41    0  808    3   38    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   17   19    0    8 1239    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0  277    5    0    0    1    0    2
     1    1    0]
 [   0    0    1    0    0    0    0   10  186    0    0    0    0    1
     0    1    1]
 [   0    2    0    0    0    0    0    0    0  394   12    0    5   97
     0    1    1]
 [   0    0    1    0    0    1    0    3    1   26  396   13   10   13
     6   22    3]
 [   0    0    1    0    0    1    2    2    0    8   23  371    5   23
    34   20   19]
 [   0    3    1    0    0    0    0    2    0    7    9    9  581   13
     0   10    3]
 [   1    2    1    0    0    0    0    0    0   52    9    1    1  396
     0    5    6]
 [   0    0    3    0    0    0    0   10    2    2   15   45    1    4
   323    6   15]
 [   0    0    0    6    0    0    0    0    0    7   63   13   11   20
     5  337   35]
 [   0    0    0    0    0    2    0    1    1   10   19   52    3   14
     6   45  365]]
------ TEST ACCURACY:  weights.29-0.47.hdf5  ------
0.882911392405
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 30  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2 56  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 30  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 24  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 41  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 15  0  0  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0 13  3  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5 11  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 23  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  8  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  7  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0  5  8]
 [ 0  0  0  0  0  0  0  0  0  2  0  1  2  4  7]]

>>>>>>>>>>>>>> 29 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/29/weights.42-0.50.hdf5
------ TRAIN ACCURACY:  weights.42-0.50.hdf5  ------
0.924218194741
[[ 149    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    1 1625    2    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1909    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    8    0  849    0   33    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  711    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    5    0    8 1268    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  275    4    0    0    0    0    0
     1    0    1]
 [   0    0    0    0    0    0    0    6  185    0    0    0    0    0
     0    0    1]
 [   0    2    0    0    0    0    0    0    0  446   10    3    0   29
     3    0    7]
 [   0    0    1    0    0    1    0    1    0   24  390   16   10    4
     6   22    8]
 [   0    0    0    0    0    0    1    1    0   17   15  382    2    4
    52    6   24]
 [   0    5    1    0    0    0    0    1    0    5   10    3  587    5
     1    5    7]
 [   0    6    0    0    0    0    0    1    0   73    3    1    1  346
     2   11   14]
 [   0    0    0    0    0    0    0    5    2    2    7   43    6    0
   334    2   13]
 [   0    1    0    6    0    0    1    0    1    7   49   12   12    1
    13  320   70]
 [   0    0    0    1    0    0    0    0    0    4    8   41    1    3
    12    9  423]]
------ TEST ACCURACY:  weights.42-0.50.hdf5  ------
0.702912621359
[[  0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   8   0   0   1   0   0   1   0   0   0   0   0   0   0   0   0]
 [  0   0 104   0   0   0   2   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  68   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   5  11   0  14   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  32   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   5   1   0   0  33   0   0   0   0   0   0   0   0   0   0]
 [  0   1   0   0   0   0   0  10   0   0   2   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   5   0   2   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  27   0   0   2   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   6  19   1   2   0   0   0   0]
 [  0   0   0   0   0   1   1   0   0   7   0   0   6   0   0   3   4]
 [  0   0   0   0   0   0   0   0   0   0   1  10  16   0   1   2   1]
 [  0   0   0   0   0   0   0   0   0  16   1   2   1   2   1   0   3]
 [  0   0   0   0   0   0   0   0   0   2   1   7   2   1   2   0   5]
 [  0   0   0   0   0   0   0   0   0   4   9   5   2   0   0   0   0]
 [  0   0   1   0   0   1   0   0   0   2   0   0   3   2   0   1  22]]

>>>>>>>>>>>>>> 30 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_spca_conv1d_10/30/weights.19-0.51.hdf5
------ TRAIN ACCURACY:  weights.19-0.51.hdf5  ------
0.895802164921
[[ 137   10    0    0    2    0    0    2    2    0    0    0    0    0
     0    0    0]
 [   2  197    1    0    1    0    0    9    1    0    0    1    0    0
     0    0    0]
 [   0    1 1651    0    8    2   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1915    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    2   15    0  850    1   28    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    1  716    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    1   17   14   11   13 1226    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    1    0    0    0    0  274   10    0    1    1    0    0
     0    0    0]
 [   1    0    0    0    0    0    0   12  183    0    0    0    0    0
     0    0    1]
 [   0    2    0    0    0    0    0    0    0  390   10    1   14   66
     0    3   12]
 [   0    0    0    0    1    2    1    1    1   21  385   21   14    5
     7   19    9]
 [   0    1    0    1    1    1    1    4    2   16   13  364   17    6
    27   10   36]
 [   0    2    0    0    0    0    0    1    0    6    9   10  595    9
     0    2    0]
 [   0    5    1    0    0    1    0    1    0   74    7    5    8  325
     7   20   11]
 [   0    0    2    0    3    1    0   16    2    1   12   64    8    1
   283    3   18]
 [   0    2    0    0    0    0    0    0    0   12   62   14   28    3
    11  308   55]
 [   0    2    1    0    0    1    0    0    2    7   15   34    8    6
    18   36  380]]
------ TEST ACCURACY:  weights.19-0.51.hdf5  ------
0.713235294118
[[ 1  0  0  0  0  0  2  1  0  0  0  0  0  0  0  0]
 [ 0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 26  0  0  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0 42  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 17  1  0  0 13  0  0  0]
 [ 0  0  0  0  0  0  1  0  9  4  2  5  3  0  0  0]
 [ 0  0  0  1  0  0  0  0  1  0  6  5  0  7  3  3]
 [ 0  0  0  0  0  0  0  0  0  3  0 24  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 10  2  0  0  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0 18  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  1  0  1 15]
 [ 0  0  0  0  0  0  0  0  6  0 11  0  2  1  3  1]]
[0.7291666666666666, 0.692967409948542, 0.8453947368421053, 0.5369774919614148, 0.7348993288590604, 0.7864077669902912, 0.7333333333333333, 0.818639798488665, 0.6545893719806763, 0.7156549520766773, 0.7397959183673469, 0.716, 0.7480106100795756, 0.7795698924731183, 0.8126582278481013, 0.6666666666666666, 0.7922912205567452, 0.7103448275862069, 0.8195488721804511, 0.665943600867679, 0.5928571428571429, 0.6632231404958677, 0.7147239263803681, 0.7463175122749591, 0.7506172839506173, 0.7470238095238095, 0.8033707865168539, 0.8829113924050633, 0.7029126213592233, 0.7132352941176471]
0.733868453455
0.0714214761732

Process finished with exit code 0

'''