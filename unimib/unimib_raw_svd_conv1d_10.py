import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import numpy as np
import cPickle as pickle
from keras.models import Model, load_model
from keras.initializers import Constant, TruncatedNormal
from keras.layers import Input, Dense, Conv1D, Flatten, Dropout, Activation, BatchNormalization
from keras.layers.merge import concatenate
from keras.optimizers import Adam
from keras.callbacks import ModelCheckpoint
import keras.backend as K
from keras import losses
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix

# Load SVD data + Signal Magnitude Vector

X_svd = pickle.load(open("data/X_unimib_svd.p", "rb"))
X_raw = pickle.load(open("data/X_unimib_raw.p", "rb"))
X = np.concatenate((X_svd, X_raw), axis=1)

y = pickle.load(open("data/y_unimib_raw.p", "rb"))

n_classes = 17


# Below builds 1D CNN.

for i in range(30):
    test = y.loc[y[1] == i+1]
    # print y_sub
    test_index = test.index.values
    # print len(test_index)

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index], y_values[test_index]
    y_train = np.eye(n_classes)[y_train - 1]
    print X_train.shape # (11188, 604)

    # input layer
    input_signal = Input(shape=(604, 1))
    print K.int_shape(input_signal)

    # define initial parameters
    b_init = Constant(value=0.0)
    k_init = TruncatedNormal(mean=0.0, stddev=0.01, seed=2018)

    # first feature extractor
    conv11 = Conv1D(16, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn11 = BatchNormalization()(conv11)
    actv11 = Activation('relu')(bn11)
    conv12 = Conv1D(32, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv11)
    bn12 = BatchNormalization()(conv12)
    actv12 = Activation('relu')(bn12)
    flat1 = Flatten()(actv12)

    # second feature extractor
    conv21 = Conv1D(16, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn21 = BatchNormalization()(conv21)
    actv21 = Activation('relu')(bn21)
    conv22 = Conv1D(32, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv21)
    bn22 = BatchNormalization()(conv22)
    actv22 = Activation('relu')(bn22)
    flat2 = Flatten()(actv22)

    # third feature extractor
    conv31 = Conv1D(16, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn31 = BatchNormalization()(conv31)
    actv31 = Activation('relu')(bn31)
    conv32 = Conv1D(32, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv31)
    bn32 = BatchNormalization()(conv32)
    actv32 = Activation('relu')(bn32)
    flat3 = Flatten()(actv32)

    # merge feature extractors
    merge = concatenate([flat1, flat2, flat3])

    # dropout & fully-connected layer
    do = Dropout(0.9, seed=2018)(merge)
    output = Dense(n_classes, activation='softmax', bias_initializer=b_init, kernel_initializer=k_init)(do)

    # result
    model = Model(inputs=input_signal, outputs=output)

    # summarize layers
    print(model.summary())

    new_dir = 'model/unimib_raw_svd_conv1d_10/' + str(i+1) + '/'
    if not os.path.exists(new_dir):
        os.makedirs(new_dir)

    fpath = new_dir + 'weights.{epoch:02d}-{val_acc:.2f}.hdf5'
    cp_cb = ModelCheckpoint(fpath, monitor='val_acc', verbose=1, save_best_only=True, mode='auto', period=1)

    adam = Adam(lr=0.001)
    model.compile(loss=losses.categorical_crossentropy, optimizer=adam, metrics=['accuracy'])
    model.fit(np.expand_dims(X_train, axis=2), y_train, batch_size=64, epochs=50, verbose=2, validation_split=0.10,
              callbacks=[cp_cb], shuffle=True)

    del model
    K.clear_session()


# Below calculates average test data accuracy (LOSO CV).

acc = []

for i in range(30):
    test = y.loc[y[1] == i+1]
    test_index = test.index.values

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index] - 1, y_values[test_index] - 1

    print "\n>>>>>>>>>>>>>>", str(i+1), "-fold <<<<<<<<<<<<<<<<"
    path_str = 'model/unimib_raw_svd_conv1d_10/' + str(i+1) + '/'
    for path, dirs, files in os.walk(path_str):
        dirs.sort()
        files.sort()
        top_acc = []
        top_acc.append(files[-1])
        files = top_acc
        for file in files:
            print "========================================"
            print os.path.join(path, file)
            model = load_model(os.path.join(path, file))
            pred = model.predict(np.expand_dims(X_train, axis=2), batch_size=32)
            print "------ TRAIN ACCURACY: ", file, " ------"
            print accuracy_score(y_train, np.argmax(pred, axis=1))
            print confusion_matrix(y_train, np.argmax(pred, axis=1))
            pred = model.predict(np.expand_dims(X_test, axis=2), batch_size=32)
            print "------ TEST ACCURACY: ", file, " ------"
            print accuracy_score(y_test, np.argmax(pred, axis=1))
            print confusion_matrix(y_test, np.argmax(pred, axis=1))

            del model
            K.clear_session()

    acc.append(accuracy_score(y_test, np.argmax(pred, axis=1)))

print acc
print np.mean(acc)
print np.std(acc)

'''
-----
[0.6822916666666666, 0.7787307032590052, 0.8552631578947368, 0.4630225080385852, 0.785234899328859, 0.8009708737864077, 0.7787878787878788, 0.8337531486146096, 0.6811594202898551, 0.7380191693290735, 0.7040816326530612, 0.572, 0.7294429708222812, 0.7526881720430108, 0.7924050632911392, 0.7371794871794872, 0.7901498929336188, 0.7689655172413793, 0.7669172932330827, 0.7570498915401301, 0.6, 0.5971074380165289, 0.8282208588957055, 0.7495908346972177, 0.7604938271604939, 0.7797619047619048, 0.8117977528089888, 0.8829113924050633, 0.6757281553398058, 0.7524509803921569]
0.740205883047
0.0877541737508
-----

/usr/bin/python2.7 /mnt/0cdd1a7e-3686-4cf7-9055-145eb5fe70f3/hcilab/OSS/electronicsletters2018/unimib/unimib_raw_svd_conv1d_10.py
/home/hcilab/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.

>>>>>>>>>>>>>> 1 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/1/weights.29-0.53.hdf5
------ TRAIN ACCURACY:  weights.29-0.53.hdf5  ------
0.940985334153
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  205    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1672    0    8    1    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1913    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  885    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  718    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    1    3    7 1268    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  286    2    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1  196    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    1  478    5    5    4   24
     0    0    1]
 [   0    0    0    0    0    3    0    4    0   25  413   19    9    9
     3    2    7]
 [   0    0    0    1    1   14    0    8    0   13   14  415    7    4
    16    3   15]
 [   0    0    0    0    3    0    0    4    0    1    2    8  612    8
     0    3    1]
 [   0    0    0    0    0    0    0    0    0   64    5    1    0  392
     1    2    5]
 [   0    0    0    0    2    0    0   14    0    1    7   53    5    0
   320    6   11]
 [   0    0    0    0    0    0    0    1    0   15   40    5   13    8
     4  331   76]
 [   0    0    0    1    0    2    0    0    0    9    1   14    5    5
     5   10  464]]
------ TEST ACCURACY:  weights.29-0.53.hdf5  ------
0.682291666667
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 10  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 28  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 28  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 25  0  0  0 17  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  6  1  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  1  0  1  4  1  2  0  1  1  6]
 [ 0  0  0  0  0  3  0  0  0  0  0  1  0  0  0  3  8]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  2  3]
 [ 0  0  0  0  0  0  0  0  0  1  2  2  0  0  1  2  6]
 [ 0  0  0  0  0  1  0  0  0  0  2  3  0  0  1  7  1]
 [ 0  0  0  0  0  4  0  0  0  3  0  2  0  5  5  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  2  1  0  0  0  0 14]]

>>>>>>>>>>>>>> 2 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/2/weights.50-0.51.hdf5
------ TRAIN ACCURACY:  weights.50-0.51.hdf5  ------
0.946818019306
[[ 146    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1595    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1911    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  871    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    2 1273    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  286    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  196    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    2  474    4    4    0   22
     0    0    0]
 [   0    0    0    3    0    0    0    2    0   18  428    7   10    5
     6    8    1]
 [   0    0    0    1    0    2    1    6    0    8   21  417    2    8
    16    8   12]
 [   0    0    0    0    3    0    0    4    0    0    4    7  584    8
     1   10    0]
 [   0    0    0    0    0    0    0    0    0   45    6    1    0  395
     1    0    4]
 [   0    0    0    0    0    2    0    5    0    1   10   45    9    1
   329    2    5]
 [   0    0    0    0    1    0    0    0    1    9   43   12   15   13
     1  355   36]
 [   0    0    0    0    0    1    0    2    0    6    3   34    7   14
    10   18  412]]
------ TEST ACCURACY:  weights.50-0.51.hdf5  ------
0.778730703259
[[  7   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  1  10   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0 140   0   3   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  37   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  29   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   1   2  46   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   4   0   0   5   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  19   0   0   0   2   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0  13   0   9   0   0   0   1]
 [  0   0   0   0   2   0   0   1   0   0   0   7   7   1   4   2   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  37   0   0   3   0]
 [  0   0   0   0   0   1   0   0   0  11   0   0   7   8   0   5   0]
 [  0   0   0   0   0   5   0   0   0   0   0   5   0   0   9   6   0]
 [  0   0   0   2   0   0   0   0   0   4   5   2   7   0   0   3   4]
 [  0   0   0   0   0   0   0   0   0   0   0   2  12   0   0   6   7]]

>>>>>>>>>>>>>> 3 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/3/weights.46-0.53.hdf5
------ TRAIN ACCURACY:  weights.46-0.53.hdf5  ------
0.948373593791
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  215    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1716    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1912    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  873    0   15    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    7 1278    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  284    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  197    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  485    3    2    2   21
     0    1    1]
 [   0    0    0    0    0    6    0    0    0   24  432    6    8    4
     5   13    1]
 [   0    0    0    1    0   12    1    4    1   12   12  423    6    9
    18    7   10]
 [   0    0    0    0    3    0    0    0    0    1    5   13  616    7
     0    1    1]
 [   0    0    0    0    0    0    0    0    0   53    2    1    1  408
     1    3    2]
 [   0    0    0    0    2    2    1    4    0    1   11   37    6    1
   348    7    7]
 [   0    0    0    0    0    0    0    0    2   17   44    3   19    7
     5  371   35]
 [   0    0    0    0    0    2    0    0    0    9    7   26    2   12
     7    8  454]]
------ TEST ACCURACY:  weights.46-0.53.hdf5  ------
0.855263157895
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 73  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 39  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  0  5  0  2  0]
 [ 0  0  0  0  0  0  0  2  0  0  5  0  0  0  0  0  5]
 [ 0  0  0  0  0  0  0  0  0  0  2  4  0  0  1  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0  1  0  8  0]
 [ 2  0  0  0  0  0  0  0  0  0  0  0  0  1  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0  0  4  0]]

>>>>>>>>>>>>>> 4 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/4/weights.46-0.52.hdf5
------ TRAIN ACCURACY:  weights.46-0.52.hdf5  ------
0.945986038394
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1722    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1931    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  876    0   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    3    3    0 1285    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  285    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  191    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0    0  474    7   10    0   18
     3    5    4]
 [   0    0    0    0    0    0    0    0    1   14  431   11   11    9
     5    6    4]
 [   0    0    0    0    0    7    0    4    1   11   23  412    4    8
    14    7   12]
 [   0    0    0    0    3    0    0    1    0    1    6   10  606    9
     0    5    2]
 [   0    0    0    0    0    0    0    0    0   45    3    1    0  411
     1    3    3]
 [   0    0    1    0    4    2    0    4    1    0   12   39    5    0
   338    6    9]
 [   0    0    0    0    1    0    0    0    2   10   45    7   19   10
     6  353   44]
 [   0    0    0    1    0    2    0    0    0    5    3   20    3   11
    12   13  442]]
------ TEST ACCURACY:  weights.46-0.52.hdf5  ------
0.463022508039
[[ 2  1  0  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  1  0  4  0  1  0  4  0  0  0  0  0  0]
 [ 0  0 54  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  6  0 14  0  0  7  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0 11  0  0  0  0  0  0  4  0  3  9  0]
 [ 2  1  0  0  0 14  4  0  0  0  1  0  0  4  1  0]
 [ 0  0  0  0  0  1  3  1  0  1  0  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  8  0  1]
 [ 0  0  0  0  0  0  0  0  7  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  1  1  0  3  0 11  0]
 [ 0  0  0  0  0  0  0  0  0  1 14  1  0  0  7  0]
 [ 0  0  0  0  0  0  0  0  0  1  0 12  0  0  5  0]
 [ 0  0  0  0  0  0  0  0  8  4  0  0  2  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  2  7  2  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  4  1  0  1  6  3  1  0]
 [ 0  0  0  0  0  0  0  0  2  1  3  1  4  0 10  1]]

>>>>>>>>>>>>>> 5 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/5/weights.40-0.54.hdf5
------ TRAIN ACCURACY:  weights.40-0.54.hdf5  ------
0.948051948052
[[ 146    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  203    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1716    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1919    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10    0  886    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0    2    6 1280    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  290    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  199    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    0  474    5    9    1   20
     2    0    1]
 [   0    0    0    0    0    0    1    3    0   14  442    9   17    6
     1    7    2]
 [   0    0    0    1    1    5    0    6    0   14   14  407    5   11
    18    5   18]
 [   0    0    0    0    2    0    0    2    0    0    3    9  617    7
     0    4    2]
 [   0    0    0    0    0    0    0    0    0   52    7    2    0  409
     0    2    2]
 [   0    0    0    0    1    1    0    7    0    2   12   28    5    3
   344    5   17]
 [   0    0    0    0    0    0    0    0    0    6   47    2   13   11
     0  368   51]
 [   0    0    0    1    0    2    0    0    0    2    7   14    2   15
     4   18  451]]
------ TEST ACCURACY:  weights.40-0.54.hdf5  ------
0.785234899329
[[ 6  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 66  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 19  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  8  5  2  0]
 [ 0  0  0  0  0  0  0  1  1  0  1  1  0  0  0  3  2]
 [ 0  0  0  0  0  0  0  0  0  0  0 10  0  0  7  2  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  9  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  3  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  4  0  0  1  0  0  2  0  6  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  4  9  5]]

>>>>>>>>>>>>>> 6 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/6/weights.26-0.51.hdf5
------ TRAIN ACCURACY:  weights.26-0.51.hdf5  ------
0.932300378554
[[ 151    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  209    0    0    1    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1683    0    3    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1924    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  845    0   27    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0    0    7 1263    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  276    4    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    0    1    0  194    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    0  430    6   18   10   37
     0    0    8]
 [   0    0    0    0    1    3    0    0    0   14  411   24   12    9
     5    2   15]
 [   0    0    1    0    0    0    1    6    1    7   13  420   17    7
     7    8   19]
 [   0    0    0    0    3    0    0    0    0    0    4    9  607   10
     0    2    3]
 [   0    0    0    0    0    0    0    0    0   46   10    6    4  389
     0    0    9]
 [   0    0    1    0    0    0    1    6    0    2    7   54    9    0
   321    5   10]
 [   0    0    0    0    1    0    0    0    0    7   44   17   24   16
     7  322   55]
 [   0    0    0    0    0    2    0    0    0    1    8   34    7   10
    12   14  428]]
------ TEST ACCURACY:  weights.26-0.51.hdf5  ------
0.800970873786
[[ 2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0 39  0  4  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 29  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 11  0  0 39  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  4 11  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 10  0  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 11  4  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 16  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 23  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  1  0  0 15  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 11  0  0  5  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  1  5  2  0  6  5]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  2  0  0  1 12]]

>>>>>>>>>>>>>> 7 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/7/weights.34-0.53.hdf5
------ TRAIN ACCURACY:  weights.34-0.53.hdf5  ------
0.940652040906
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1687    1    0    1    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1925    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  859    3   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    9    0    8 1272    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  286    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  191    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    3    1  488    4    0    1   19
     0    0    0]
 [   0    0    0    0    0    0    0    0    0   25  431   12   14    4
     5    5    0]
 [   0    0    0    1    0    3    1    6    1   10   18  399    9    9
    15    9   27]
 [   0    0    0    0    0    0    0    3    2    2    6    3  607    8
     0    6    6]
 [   0    0    0    0    0    0    0    0    0   57    5    0    4  387
     2    5    2]
 [   0    0    0    0    0    0    1   18    0    1   11   41    8    2
   331    8    5]
 [   0    0    0    0    0    0    0    0    2   14   43    3   26   12
     3  365   32]
 [   0    0    0    0    0    3    0    4    0    5    8   11    8   11
     5   22  445]]
------ TEST ACCURACY:  weights.34-0.53.hdf5  ------
0.778787878788
[[ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 44  0  0  0  5  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 35  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  1  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  8  0  0  0  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  0  0  5  0  9]
 [ 0  0  1  0  0  0  0  0  0  0  0  0 14  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0 11  0  0  0 10  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  0  7  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  5  7]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  6  6]]

>>>>>>>>>>>>>> 8 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/8/weights.26-0.49.hdf5
------ TRAIN ACCURACY:  weights.26-0.49.hdf5  ------
0.931246703007
[[ 151    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  214    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1667    0    4    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1921    0    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   16    0  849    0   29    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    0    2    7 1256    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  282    1    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    6  180    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    3    0  462    4    9    0   21
     0    2    2]
 [   0    0    0    0    2    0    2    7    0   22  401   26    9    2
     3   15    5]
 [   0    0    1    1    0    1    1    7    0   15   20  406    5    6
    17    8   21]
 [   0    0    0    0    0    0    0    5    0    5    2   12  584   16
     1    7    4]
 [   0    2    0    0    0    1    0    0    0   53    7    1    0  389
     0    5    7]
 [   0    0    0    0    0    0    2   17    0    0    9   47    5    0
   326    4   10]
 [   0    0    0    0    1    0    0    1    0   20   40   14   21    8
     3  348   47]
 [   0    0    0    0    0    2    0    2    0    3    1   41    2   12
     3   12  435]]
------ TEST ACCURACY:  weights.26-0.49.hdf5  ------
0.833753148615
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 53  0  1  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  9  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 12  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 25  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  4  0  0 12  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  1  0  6  2  0  0  0  0  7]
 [ 0  0  0  0  0  0  0  0  0  0  1  0 24  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  0 12  0  0  0]
 [ 0  1  0  0  0  0  0  7  0  0  3  0  0  0  2  1  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  1  0  0  0  2  6]
 [ 0  0  0  0  0  0  0  1  0  0  0  6  0  1  0  1 12]]

>>>>>>>>>>>>>> 9 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/9/weights.23-0.48.hdf5
------ TRAIN ACCURACY:  weights.23-0.48.hdf5  ------
0.927797833935
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1684    0    3    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1925    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  869    0   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8   12    2    8 1247    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0  282    5    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    1  187    0    0    0    0    0
     0    0    1]
 [   0    0    0    0    0    1    0    0    1  426    3   12    8   56
     0    1    1]
 [   0    0    0    1    1    4    1    1    1    5  388    8    3   24
     6   26   13]
 [   0    0    0    0    2   12    1    7    0   13   17  374    8   12
    22    9   29]
 [   0    0    0    0    3    1    0    2    0    4    2    7  578   17
     1    9    0]
 [   0    0    0    0    1    4    0    0    0   33    6    0    3  418
     0    4    4]
 [   0    0    1    0    2    4    1    3    0    0   11   52    6    0
   315   10   16]
 [   0    0    0    0    1    0    1    0    1    6   38    5   20   21
     3  347   39]
 [   0    0    2    0    0    3    0    3    1    3    7   14    5   22
     7   26  412]]
------ TEST ACCURACY:  weights.23-0.48.hdf5  ------
0.68115942029
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  1  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0 50  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 60  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  4  0 12  0  4  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  7  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  8  0  2  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0 13  0  6  0]
 [ 0  0  0  0  0  0  0  2  0  4 12  1  0  2  0  8  0]
 [ 0  0  0  0  1  0  0  0  0  0  7  0  0  0 12  0  0]
 [ 0  0  1  0  0  0  1  0  0  0  0  0 35  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  4  0  0  5]
 [ 0  0  0  0  0  0  0  0  0  0  2  2  0  0  9  0  0]
 [ 0  0  0  0  0  1  0  1  0  2  0  0  4  8  0  7  8]
 [ 0  0  0  0  1  3  0  0  0  9  0  1  0  1  0 11  3]]

>>>>>>>>>>>>>> 10 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/10/weights.27-0.49.hdf5
------ TRAIN ACCURACY:  weights.27-0.49.hdf5  ------
0.936289055682
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  216    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1705    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1928    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    0  878    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  729    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    3    0    0 1291    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  288    5    0    0    0    0    0
     0    0    1]
 [   0    0    0    0    0    0    1    0  186    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  477    4    0    3   22
     0    0    1]
 [   0    0    1    0    0    0    0    1    1   31  421   12   11    4
     4    7    6]
 [   0    0    1    1    0    2    2    7    0   17   15  401   12    8
    12    3   23]
 [   0    0    0    0    1    0    0    3    0    5   12    7  584   12
     0   10    9]
 [   0    0    0    0    0    0    0    0    0   71    6    3    0  378
     1    1    7]
 [   0    0    0    0    1    0    2    6    0    2    8   61    5    0
   311    3   21]
 [   0    0    0    0    0    0    0    0    1   28   46    8   16    7
     2  348   45]
 [   0    0    0    0    0    0    0    0    0   13    3   21    2   13
     6   25  434]]
------ TEST ACCURACY:  weights.27-0.49.hdf5  ------
0.738019169329
[[ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 32  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 51  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 13  0 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 17  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  7 22  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 12  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0 22  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  4  1  0  0  0 12]
 [ 0  0  0  0  0  0  0  0  0  0  0 17  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  9  0  0  0  7  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  0  8  1  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  0  2  3  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  0  0  0 13]]

>>>>>>>>>>>>>> 11 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/11/weights.18-0.51.hdf5
------ TRAIN ACCURACY:  weights.18-0.51.hdf5  ------
0.908427805607
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    7    0    0    0    0    0    0
     0    0    0]
 [   0    0 1703    0    8    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1883    0    0   17    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    0  832    1   33    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  725    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    4    5    7 1239    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    0    0    1    0    1  277    3    0    0    0    0    0
     0    1    1]
 [   0    1    0    0    0    0    1    3  188    0    0    0    0    1
     0    1    0]
 [   0    0    0    0    0    0    0    0    1  448    7    5    6   38
     0    2    4]
 [   0    0    0    0    1    0    1    4    1   25  388   28   10    8
     5   15    5]
 [   0    0    1    0    0    3    3    8    0   13   12  418   12    7
     8    9   18]
 [   0    0    0    0    2    0    0    3    0    3    7   13  592   12
     1    2    2]
 [   0    0    0    0    0    1    1    1    0   81   11    3    3  357
     2    3    2]
 [   1    1    0    0    1    1    2    7    0    0   16   98    7    2
   264    9    7]
 [   0    0    1    0    1    0    1    0    1   18   56   19   22   20
     7  308   45]
 [   0    0    2    0    0    1    0    0    0    9   17   62    3   16
     8   35  365]]
------ TEST ACCURACY:  weights.18-0.51.hdf5  ------
0.704081632653
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 23  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 82  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 35  0  6  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 24  0  0  2 31  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  3  3  8  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 12  0  0  6  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  1  9  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 14  0  0 10  0]
 [ 0  0  0  0  0  0  0  1  0  1  0  1  0 10  0  3  3]
 [ 0  0  0  0  4  0  0  5  0  0  0  0  0  0  9  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  2  2  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  8  0  2  0  0  0  6]]

>>>>>>>>>>>>>> 12 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/12/weights.50-0.52.hdf5
------ TRAIN ACCURACY:  weights.50-0.52.hdf5  ------
0.948363055629
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1555    0    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1910    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  882    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    1 1286    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  296    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1  196    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  475    5   11    4   15
     1    0    1]
 [   0    0    0    0    1    0    0    0    0   21  448    9    3    3
     6    5    0]
 [   0    0    0    1    0    4    1    4    1   12   20  430    2    3
    17    4   15]
 [   0    0    0    0    5    0    0    2    0    2    2    8  609    5
     0    7    1]
 [   0    0    0    0    0    0    0    0    0   56    4    4    2  394
     1    1    2]
 [   0    0    0    0    2    3    0    4    0    2    7   47    4    0
   348    5    2]
 [   0    0    0    0    1    0    0    0    1   13   43    9   13   10
     2  372   32]
 [   0    0    0    1    0    2    0    3    0    8    5   33    5   14
    13   15  416]]
------ TEST ACCURACY:  weights.50-0.52.hdf5  ------
0.572
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 3  1  0  0  0  0  0  0  0  0  0  0  0  1  0  0]
 [ 0  0 57  0 33  0 92  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 49  0  0 25  0  0  0  0  0  0  0  0  0]
 [ 0  1  1  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0  0 29  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 36  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 10  2  0  0  3  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  6  2  0  1  0  5  1]
 [ 0  0  0  0  0  0  0  0  2  1  7  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0 10  0 10  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 20  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  3  6  0  0  0  0  6  2]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  1  4  3  6]]

>>>>>>>>>>>>>> 13 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/13/weights.40-0.52.hdf5
------ TRAIN ACCURACY:  weights.40-0.52.hdf5  ------
0.944093382482
[[ 150    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  209    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1714    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1913    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11    0  857    0   17    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    1    0    2 1274    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  276    2    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    0    1    2  193    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  461    9    7    7   20
     1    0    2]
 [   0    0    0    0    0    3    0    0    0   18  442    7   11    7
     4    1    0]
 [   0    0    0    0    0    5    0    6    0   14   16  419    9    6
    13    6   14]
 [   0    0    0    0    3    0    0    0    0    1    8    5  609    3
     0    1    6]
 [   0    0    0    0    0    0    0    0    0   52    9    0    0  410
     0    1    2]
 [   0    0    0    0    0    2    0    6    0    2   18   47    6    0
   330    4    3]
 [   0    0    0    0    0    0    0    0    1    9   54    6   19   10
     6  335   55]
 [   0    0    0    0    0    2    0    1    0    5    6   21    7    7
    11    8  444]]
------ TEST ACCURACY:  weights.40-0.52.hdf5  ------
0.729442970822
[[ 3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 3  2  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  9  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  1  0  0 12  0  0  1  0  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  3  0  5  4  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  0  1  0  9  3]
 [ 0  0  1  0  0  0  0  0  0  5  6  5  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 20  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  2  0  0  5  0  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  3  0  6  9]
 [ 0  0  0  0  0  0  0  0  0  0 11  0  2  0  0  0  9]]

>>>>>>>>>>>>>> 14 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/14/weights.21-0.51.hdf5
------ TRAIN ACCURACY:  weights.21-0.51.hdf5  ------
0.927888411264
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  199    0    0    0    0    0    9    0    0    0    0    0    0
     0    0    0]
 [   0    0 1679    0    5    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1927    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    0  844    0   25    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    8    3    7 1243    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  289    2    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    1  193    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    2  475    5    0    2   31
     0    0    1]
 [   0    0    0    0    0    1    0    1    1   26  421   11    6    8
     6   10    2]
 [   0    0    1    0    0    4    1    6    0   20   25  384    7    8
    17   17   13]
 [   0    0    0    0    1    0    0    5    0    4    4   12  606    6
     0    2    1]
 [   0    0    0    0    0    0    0    0    0   68   12    1    4  385
     0    3    1]
 [   0    0    0    0    3    0    0    9    0    1   13   48   14    1
   311    9    5]
 [   0    0    0    0    0    0    0    1    1   22   49    9   29   13
     2  334   35]
 [   0    0    0    0    2    2    0    0    0    9   19   24    7   14
     9   24  413]]
------ TEST ACCURACY:  weights.21-0.51.hdf5  ------
0.752688172043
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  3  0  0  1  0  0  0  0  0  0]
 [ 0  0 47  0  2  0  5  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 33  0  7  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0 49  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  1  0  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3 15  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  8  0  0 11  1  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  3  9  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  6  0  0  0  0  7  1]
 [ 0  0  0  0  0  1  0  0  0  2  2  4  0  0  1  0  1]]

>>>>>>>>>>>>>> 15 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/15/weights.44-0.52.hdf5
------ TRAIN ACCURACY:  weights.44-0.52.hdf5  ------
0.946290436006
[[ 144    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1686    0    3    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1897    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  905    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    9    6 1253    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  284    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  192    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  463    3    7    7   37
     0    0    0]
 [   0    0    0    0    0    0    0    0    0   19  446    6   12    9
     1    0    0]
 [   0    0    0    0    0    5    0    6    1    8   13  427   11   10
    16    4   11]
 [   0    0    0    0    3    0    0    3    0    0    5    4  615    7
     1    2    3]
 [   0    0    0    0    0    0    0    0    0   32    6    2    5  421
     0    2    1]
 [   0    0    1    0    4    0    0    3    0    1   10   47    6    1
   329    5    9]
 [   0    0    0    0    0    0    0    0    0   12   45   12   24   15
     6  351   35]
 [   0    0    0    0    1    2    0    2    0    7    7   35    6   13
     8   11  427]]
------ TEST ACCURACY:  weights.44-0.52.hdf5  ------
0.792405063291
[[ 4  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 88  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 16  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 55  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 12  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  6  0  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  2  2  3  0  0  2]
 [ 0  0  0  0  3  0  0  0  0  0 12  0  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  1  0  3  5  1  0  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  2  2  0 14  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  3 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  1  7  0  0  5  0  2]
 [ 0  0  2  0  0  0  0  0  0  0  0  0  4  0  0  0  7]
 [ 0  0  0  0  0  0  0  0  0  0  8  1  0  0  0  0  6]]

>>>>>>>>>>>>>> 16 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/16/weights.39-0.53.hdf5
------ TRAIN ACCURACY:  weights.39-0.53.hdf5  ------
0.94620897107
[[ 145    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  199    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1681    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1908    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  858    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0    0    2 1259    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  274    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  193    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  480    6    0    1   20
     0    1    0]
 [   0    0    0    2    2    0    0    0    0   21  438    4    4    4
     7   10    0]
 [   0    0    0    1    2    1    0    6    0   10   19  404    8    8
    25    9   19]
 [   0    0    0    0    3    0    0    0    0    2    5    9  594    8
     0   18    1]
 [   0    0    0    0    0    0    0    0    0   46    5    1    0  412
     0    4    2]
 [   0    0    0    0    5    0    0    3    0    1   16   35    5    2
   352    4    0]
 [   0    0    0    0    1    0    0    0    1   11   45    6   16   13
     4  370   24]
 [   0    0    1    0    0    1    0    2    0    5   10   26    5   16
     7   23  412]]
------ TEST ACCURACY:  weights.39-0.53.hdf5  ------
0.737179487179
[[ 8  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 3 11  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 77  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 46  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  2 28  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  4  0  0  0 55  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 13  0  0  0  5  2  0  0  0  1]
 [ 0  0  0  0  0  0  0  7  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 16  0  1  2  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  8  0  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  5  0  5  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  3  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  2  4  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 20  0  0  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  4  0  0  0  0 14  4]]

>>>>>>>>>>>>>> 17 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/17/weights.48-0.53.hdf5
------ TRAIN ACCURACY:  weights.48-0.53.hdf5  ------
0.94966383581
[[ 149    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  201    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1629    0    6    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1901    1    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  889    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  727    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    3 1270    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  283    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  193    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  485    5    6    2   18
     0    0    1]
 [   0    0    0    0    0    0    0    0    0   17  446    8    2   12
     5    3    2]
 [   0    0    0    0    0    9    1    6    1   10   17  413    5    9
    18    3   13]
 [   0    0    0    0    3    0    0    1    0    0    7    9  609    6
     0    1    5]
 [   0    0    0    0    0    0    0    0    0   44    5    1    0  408
     0    1    5]
 [   0    0    1    0    0    0    1    6    0    1   14   43    5    2
   331    3    4]
 [   0    0    0    0    1    0    0    0    1   14   42    5   15   11
     3  363   40]
 [   0    0    0    0    0    2    0    0    0    4   16   22    5   11
     9   10  438]]
------ TEST ACCURACY:  weights.48-0.53.hdf5  ------
0.790149892934
[[  4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0  14   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0]
 [  0   0 103   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  81   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  22   0   6   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  19   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  50   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0  13   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   7   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   0   3   2   0   0   0]
 [  0   0   0   0   0   0   0   0   0   6   6   2   0   0   0   0   2]
 [  0   0   0   0   0   0   0   0   0   0   6   9   0   1   0   0   5]
 [  0   0   0   0   0   0   0   0   0   0   0   0  17   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   9   0   0   0   5   6   0   0]
 [  0   0   0   0   0   0   0   0   0   0   2   5   0   0  13   0   3]
 [  0   0   0   0   0   0   0   0   0   0   3   1   0   2   1   8   3]
 [  0   0   0   0   0   0   0   0   0   0   4   1   0   0   3   2   7]]

>>>>>>>>>>>>>> 18 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/18/weights.43-0.54.hdf5
------ TRAIN ACCURACY:  weights.43-0.54.hdf5  ------
0.948262346485
[[ 139    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  207    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1738    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1929    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  891    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  730    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0    0    2 1289    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  283    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2  187    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    0  460    6    6    7   34
     0    1    0]
 [   0    0    0    0    0    0    0    1    0   10  458    2    9    2
     0   11    0]
 [   0    0    0    1    0    0    1    5    1    4   22  415   13    7
    13    8   19]
 [   0    0    0    0    3    0    0    1    1    0    3    4  613    7
     0    9    2]
 [   0    0    0    0    0    0    0    0    0   41    8    0    1  412
     1    6    2]
 [   0    0    1    0    1    0    0    6    0    1   11   53    7    0
   330    9    4]
 [   0    0    0    0    1    0    0    0    1    8   45    6   21   13
     0  362   46]
 [   0    0    0    1    0    1    0    5    0    3    5   22    8   12
     2   18  444]]
------ TEST ACCURACY:  weights.43-0.54.hdf5  ------
0.768965517241
[[10  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  7  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0 56  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 16  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 31  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0 10  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  4  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  7  0  0  3  4  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  2  0  0  4  0  1]
 [ 0  0  0  0  0  0  0  0  1  0  7  1  1  0  4  3]
 [ 0  0  0  0  0  0  0  0  0  0  0 15  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0 11  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  7  0  2]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  2  1  5]
 [ 0  0  0  0  0  0  0  0  0 10  0  1  0  0  0  2]]

>>>>>>>>>>>>>> 19 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/19/weights.33-0.52.hdf5
------ TRAIN ACCURACY:  weights.33-0.52.hdf5  ------
0.943328987397
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  203    0    0    0    0    0    0    0    0    1    0    0    0
     0    0    0]
 [   0    0 1720    1    2    1    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1918    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  898    0   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    4    1    7 1280    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  287    2    0    1    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2  190    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0    0  495    4    0    3   18
     0    0    0]
 [   0    0    0    0    0    4    0    0    0   19  434   12    1    5
     2   19    0]
 [   0    0    0    1    0   11    1    5    0   17   17  408    5    8
    17   14   13]
 [   0    0    0    0    2    0    0    3    0    0    4    4  611   11
     0    5    4]
 [   0    0    0    0    0    0    0    0    0   64    6    1    5  393
     0    3    2]
 [   0    0    1    0    2    1    0    7    0    1   11   42    7    1
   335    8    3]
 [   0    0    0    0    0    0    0    0    0   12   45    2   13    9
     1  385   37]
 [   0    0    0    0    0    3    0    3    0    4   13   17    6   16
     6   28  426]]
------ TEST ACCURACY:  weights.33-0.52.hdf5  ------
0.766917293233
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 14  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  3  0 28  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  5  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  5  0  0  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  4  5  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  4  4  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  1  0  0  6  5  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  2  0  5  0]
 [ 0  0  2  0  0  0  0  0  0  0  0  0  0  0  0 10  0]]

>>>>>>>>>>>>>> 20 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/20/weights.42-0.50.hdf5
------ TRAIN ACCURACY:  weights.42-0.50.hdf5  ------
0.939610963749
[[ 143    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  200    0    0    0    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1579    0    2    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1910    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  863    0   25    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  728    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    3 1270    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  287    1    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0  191    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    1  464    5    4    2   35
     0    0    2]
 [   0    0    0    0    0    2    2    1    0   18  441    9    9    6
     4    6    3]
 [   0    0    0    0    0    7    1    6    0   14   22  421    4    8
    11    8   17]
 [   0    0    0    0    3    0    0    2    0    1    7    9  601   12
     0    3    5]
 [   0    0    0    0    0    1    0    0    0   50    7    0    0  404
     0    4    3]
 [   0    0    0    0    3    3    0    7    2    0   12   50    5    2
   335    3    3]
 [   0    0    0    0    0    0    1    1    1   13   46   16   12   10
     2  355   42]
 [   0    0    0    0    0    2    0    1    0   10    2   38    2   13
     3   19  435]]
------ TEST ACCURACY:  weights.42-0.50.hdf5  ------
0.75704989154
[[  9   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  9   0   0   0   0   0   0   3   0   0   0   0   0   0   1   0   0]
 [  0   0 134   0   2   0  20   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  71   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   1  26   0   2   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  18   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   4  19   0   0  27   0   0   0   0   0   0   0   0   0   0]
 [  2   0   0   0   0   0   0   6   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   4   4   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  14   0   0   0   2   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   9   0   0   1   0   0]
 [  0   0   0   0   0   0   0   0   0   0   1   3   0   0   0   2   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0  18   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   4   0   0   1  10   0   0   0]
 [  0   0   0   0   0   0   0   1   0   0   1   1   0   0   4   2   0]
 [  0   0   0   0   0   0   0   0   0   0   9   0   0   0   1   4   0]
 [  0   0   0   0   0   0   0   0   0   0   4   3   0   0   0   1   1]]

>>>>>>>>>>>>>> 21 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/21/weights.50-0.52.hdf5
------ TRAIN ACCURACY:  weights.50-0.52.hdf5  ------
0.949090592638
[[ 146    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  205    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1733    0    1    2    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1924    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  910    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  724    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0    7 1270    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  285    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  186    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  484    2    4    4   21
     0    0    1]
 [   0    0    0    0    0    0    0    0    0   16  444    4   17   13
     4    3    1]
 [   0    0    0    0    0   11    1    4    1   12   17  420    8    7
    14    4   10]
 [   0    0    0    0    1    0    0    3    0    0    4    5  614    9
     0    5    1]
 [   0    0    0    0    0    0    0    0    0   47   11    0    0  414
     0    0    1]
 [   0    0    0    0    0    2    0    4    0    1   10   47   10    1
   342    3    5]
 [   0    0    0    0    0    0    0    0    2   13   44    4   21   12
     2  357   46]
 [   0    0    0    0    0    2    0    0    0   10    8   21    7   14
     5   12  448]]
------ TEST ACCURACY:  weights.50-0.52.hdf5  ------
0.6
[[ 7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 11  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 11  0  0 50  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  8  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 22  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  2  0 44  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  4  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 10  0  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  1  6]
 [ 0  0  0  0  0  0  0  0  0  0  5  5  3  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  1  1 16  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0  6  0  0  2]
 [ 1  0  0  0  0  0  0  0  0  0  0  4  4  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  0  2  0  2  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  2  0  4]]

>>>>>>>>>>>>>> 22 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/22/weights.40-0.51.hdf5
------ TRAIN ACCURACY:  weights.40-0.51.hdf5  ------
0.941348453974
[[ 136    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  205    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1677    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1923    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  851    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  720    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0    8    3 1254    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  278    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  183    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  459    5    2    1   31
     5    0    2]
 [   0    0    0    0    0    2    0    1    0   22  438    5    5    7
     6    1    3]
 [   0    0    1    2    2    8    0    7    0   14   21  385    3    5
    23    7   20]
 [   0    1    0    0    0    0    0    5    0    2   13   12  591   11
     0    2    1]
 [   0    0    0    0    0    0    0    0    0   47    9    0    0  406
     0    0    1]
 [   0    0    0    0    5    1    1    4    0    0   12   40    6    0
   342    2    4]
 [   0    0    0    0    0    0    0    0    1   13   51    5   15   18
     3  352   32]
 [   0    0    0    1    0    2    0    0    0    6   22   17    6   12
     7   14  425]]
------ TEST ACCURACY:  weights.40-0.51.hdf5  ------
0.597107438017
[[ 9  6  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 2  5  0  0  1  0  0  0  0  0  1  0  0  0  0  0  2]
 [ 0  0 60  0  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 57  0  0  5  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  6 38  1  0  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  6  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 1  3  0  0  0  0  0  6  4  0  0  0  0  0  0  0  2]
 [ 0  1  0  0  0  0  0  6  9  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0 14  0  0  0  4  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  8 13  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  3  2  0  0  8  0 11]
 [ 0  0  0  0  0  0  0  0  0  2  3  0 18  0  0  0  0]
 [ 0  2  0  0  0  0  0  1  0 12  0  1  3  1  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0  3 11  0]
 [ 0  0  0  0  0  0  0  0  0  0  8  0  0  5 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  3  0  0  0 15]]

>>>>>>>>>>>>>> 23 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/23/weights.46-0.53.hdf5
------ TRAIN ACCURACY:  weights.46-0.53.hdf5  ------
0.946701616426
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  209    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1723    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1911    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  870    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    2 1277    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  281    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    3  190    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  482    6    1    0   14
     0    0    2]
 [   0    0    0    0    1    0    0    1    0   20  461    3    8    3
     0    5    0]
 [   0    0    1    0    0    9    2    5    1   15   39  394    9    5
    16    4   17]
 [   0    0    0    0    3    0    0    1    0    0   14    6  608    6
     0    1    7]
 [   0    0    0    0    0    0    0    0    0   51   13    0    1  399
     0    3    2]
 [   0    0    0    0    0    0    0    6    0    1   12   37    6    1
   353    5    4]
 [   0    0    0    0    0    0    0    1    0   12   51    3   22    6
     3  358   42]
 [   0    0    0    0    0    1    0    0    0    4    6   20    5   13
     3   18  450]]
------ TEST ACCURACY:  weights.46-0.53.hdf5  ------
0.828220858896
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 15  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 74  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 24  0  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 15  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  0  0  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  0  3  0  0  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  8  0  1]
 [ 0  0  0  0  0  0  0  0  0  4  0  0 11  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  1  7  6]
 [ 0  0  0  0  0  0  0  4  0  0  2  1  0  0  2  0  5]]

>>>>>>>>>>>>>> 24 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/24/weights.34-0.54.hdf5
------ TRAIN ACCURACY:  weights.34-0.54.hdf5  ------
0.945967741935
[[ 132    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  196    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1559    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1916    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  853    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0    2    6 1257    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  277    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  190    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  466    5    1    1   33
     0    0    0]
 [   0    0    0    0    0    0    0    1    0   18  454    4    4    5
     6    3    1]
 [   0    0    0    0    0    1    2    4    1    9   23  409    3    4
    35    7   14]
 [   0    0    0    0    3    0    0    2    0    5    8    8  594   13
     0    5    2]
 [   0    0    0    0    0    0    0    0    0   41   11    0    0  415
     0    1    1]
 [   0    0    0    0    1    0    0    4    0    2    8   28    1    1
   358    4    2]
 [   0    0    0    0    0    0    0    0    2   13   74    6    0   12
     9  336   42]
 [   0    0    0    0    0    1    0    0    0   17   14   14    5   13
    10   17  426]]
------ TEST ACCURACY:  weights.34-0.54.hdf5  ------
0.749590834697
[[  7   9   0   0   0   0   0   2   0   0   0   0   0   3   0   0   0]
 [  1   5   0   0   0   0   0   3   0   0   0   0   2   0   5   3   0]
 [  0   0 171   0   8   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  69   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  57   6   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  27   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  12   0   1  43   0   0   0   0   0   0   0   0   0   0]
 [  0   2   0   0   0   0   0   8   0   0   0   0   0   0   1   7   0]
 [  0   0   0   0   0   0   0   3   4   0   0   0   0   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0  21   0   0   2   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   9   0   0   0   0   2   4]
 [  0   0   0   0   0   0   0   0   0   3   0   5   2   3   1   0   0]
 [  0   0   0   0   0   0   0   0   0   1   0   1  19   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   0   0   8   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   6   8   5   0   4   0   2]
 [  0   0   0   0   0   0   0   0   0   0   4   0  14   0   0   1   0]
 [  0   0   0   0   0   0   0   0   0   0   0  10   3   0   0   4   0]]

>>>>>>>>>>>>>> 25 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/25/weights.23-0.52.hdf5
------ TRAIN ACCURACY:  weights.23-0.52.hdf5  ------
0.935861340841
[[ 151    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1684    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1915    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  865    1   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  724    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    2    1    7 1257    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  286    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    1  190    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  467    0    0    6   34
     0    0    3]
 [   0    0    0    0    0    1    0    4    0   25  417    9    9    2
     8   10    7]
 [   0    0    1    0    0    0    1    4    0   11   17  407    8    8
    21   13   21]
 [   0    0    0    0    0    0    0    8    0   10    5   11  580   14
     0    2    3]
 [   0    4    0    0    0    0    0    2    0   62   13    0    2  374
     0    4    2]
 [   0    0    0    0    1    0    0    4    0    1    7   42    5    1
   331   10   17]
 [   0    1    0    0    1    0    0    0    0    1   43    9   14    4
     3  361   48]
 [   0    0    2    0    0    0    0    2    0    3    6   17   14   15
     3   34  417]]
------ TEST ACCURACY:  weights.23-0.52.hdf5  ------
0.76049382716
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  5  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 25  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 21  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 52  0  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  0  0  0  3  1  0  0  0  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  3  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  6  5  0  0  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 11  1  0  1  0  3  3]
 [ 0  0  0  0  0  0  0  3  0  0  5  0  0  2  0  1  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 28  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 16  2  3  0]
 [ 0  0  0  0  2  0  0  2  0  0  5  0  0  0  3  1  2]
 [ 0  0  0  0  0  0  0  0  0  9 11  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0 20]]

>>>>>>>>>>>>>> 26 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/26/weights.36-0.51.hdf5
------ TRAIN ACCURACY:  weights.36-0.51.hdf5  ------
0.942020113686
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1706    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1923    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  867    0   15    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0    1    2 1270    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  290    3    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  199    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    1  470    3    0    1   31
     0    0    4]
 [   0    0    0    0    0    0    0    0    1   25  430    0    9    5
     4    6   10]
 [   0    0    0    0    0    8    2    4    1   14   17  393    8    8
    24    6   22]
 [   0    0    0    0    0    0    0    0    0    7    1    3  603    8
     0   12    2]
 [   0    1    0    0    0    0    0    0    0   62    6    0    0  405
     0    1    2]
 [   0    0    0    0    1    0    1    2    0    2   11   26    5    0
   343   10   20]
 [   0    0    0    6    0    0    0    0    1   14   49    0   19   10
     5  350   40]
 [   0    0    2    0    0    2    0    0    0    8    0   10   15   11
     6   28  436]]
------ TEST ACCURACY:  weights.36-0.51.hdf5  ------
0.779761904762
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0 29  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 48  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 16  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  4 14  0  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  2  0  0  5  4  3]
 [ 0  0  0  0  2  0  0  5  0  0  0 14  1  0  2  1]
 [ 0  0  0  0  0  0  0  0  2  0  0  0  5  0  0  0]
 [ 0  0  1  0  0  0  0  3  0  0  4  0  0  3  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  4 14]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  1  4  1  9]]

>>>>>>>>>>>>>> 27 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/27/weights.20-0.52.hdf5
------ TRAIN ACCURACY:  weights.20-0.52.hdf5  ------
0.925010950504
[[ 150    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  215    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1693    0    6    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1914    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  868    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    7    1  704    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    9    2    1 1266    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    2  279    3    0    1    0    0    0
     0    1    1]
 [   0    1    0    0    0    0    0    1  197    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    1  414    4    4   12   51
     0   10   15]
 [   0    0    1    1    0    0    1    1    0   15  403   20   12    9
     2   29    3]
 [   0    0    2    1    0    1    2    5    1    9   17  389    7   12
    18   16   24]
 [   0    0    0    0    3    0    0    2    0    5    2   11  599    8
     0    9    1]
 [   0    0    0    0    0    0    0    0    0   41   10    2    7  383
     2   16    5]
 [   1    1    1    0    1    0    1    3    0    1    8   57    8    1
   321    9   10]
 [   0    1    0    0    0    0    0    0    1   10   37   11   15   14
     8  351   49]
 [   0    2    1    0    0    0    0    0    0    4    9   24    7    9
     9   40  413]]
------ TEST ACCURACY:  weights.20-0.52.hdf5  ------
0.811797752809
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 39  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 31  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  7  0  0 36  0  0  0  0  0  0  0  0  0  0]
 [ 4  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 17  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  6  3  0  1  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  2  5  0  0 12  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0 13  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  2  1  0  0  2  4  1]
 [ 0  0  0  0  0  0  0  0  0 10  0  0  1  0  5  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  2 13]]

>>>>>>>>>>>>>> 28 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/28/weights.36-0.51.hdf5
------ TRAIN ACCURACY:  weights.36-0.51.hdf5  ------
0.940724574422
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  215    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1707    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1926    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  872    0   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    1    3    2 1272    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  286    2    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0  199    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    2  458    4    7    8   25
     1    6    0]
 [   0    0    0    0    0    0    0    0    0   21  442    9    4    9
     3    7    0]
 [   0    0    1    1    1    6    0    6    0   11   21  411    7    3
    16   14   11]
 [   0    0    0    0    3    0    0    1    0    0    2    7  616    6
     0    2    1]
 [   0    0    0    0    0    0    0    0    0   62    7    0    1  398
     0    3    3]
 [   0    0    0    0    1    0    0    6    1    1    9   51    6    0
   333   10    8]
 [   0    0    0    0    0    0    0    0    2   11   53    8   24    9
     5  360   25]
 [   0    0    0    0    0    2    0    2    0    8   15   27   12    7
    11   28  406]]
------ TEST ACCURACY:  weights.36-0.51.hdf5  ------
0.882911392405
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 30  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1 56  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 31  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 41  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 17  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 16  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  2  1  0  2  9  0  0  1  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  1 22  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  3 13]
 [ 0  0  0  0  0  0  1  0  0  0  7  0  0  0  2  6]]

>>>>>>>>>>>>>> 29 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/29/weights.33-0.54.hdf5
------ TRAIN ACCURACY:  weights.33-0.54.hdf5  ------
0.943052594172
[[ 151    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  206    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1627    0    5    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1917    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  886    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    4    6    4 1267    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  282    1    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1  190    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    3  427    4    1    1   56
     4    1    1]
 [   0    0    0    0    0    0    0    1    0   14  422   18    5   14
     4    4    1]
 [   0    0    0    0    0    1    0    9    0    6   15  418    6    7
    30    2   10]
 [   0    2    0    0    1    0    0    4    0    3    6    3  592   17
     0    2    0]
 [   0    5    0    0    0    0    0    1    0   28    4    0    2  409
     6    3    0]
 [   0    0    0    0    1    0    0    7    1    0    6   48    4    0
   332   13    2]
 [   0    2    0    0    0    0    0    1    1    8   37   10   13   15
    15  360   31]
 [   0    0    0    0    0    0    0    1    0    3    7   31    3    9
    16   17  415]]
------ TEST ACCURACY:  weights.33-0.54.hdf5  ------
0.67572815534
[[  1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   6   0   0   0   0   0   4   0   0   0   0   0   0   0   0   0]
 [  0   0 100   3   0   0   3   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  68   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   7   7   0  16   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   1  31   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   4   8   0   0  27   0   0   0   0   0   0   0   0   0   0]
 [  0   3   0   0   0   0   0   9   0   0   0   0   0   0   0   1   0]
 [  0   0   0   0   0   0   0   3   4   0   0   0   0   0   0   1   0]
 [  0   0   0   0   0   0   0   0   0  25   0   0   1   3   0   0   0]
 [  0   0   0   0   0   0   0   1   0   0  19   4   3   0   0   0   1]
 [  0   0   0   1   0   2   0   0   0   3   2   4   0   1   0   5   4]
 [  0   0   0   0   0   0   0   0   0   0   2   9  19   0   0   0   1]
 [  0   0   0   0   0   0   0   0   0  11   8   1   0   4   0   0   2]
 [  0   0   0   0   0   0   0   0   0   2   0  17   0   0   1   0   0]
 [  0   0   0   0   0   0   0   1   0   1  15   2   1   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   1   0   1   1   3   0  12  14]]

>>>>>>>>>>>>>> 30 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_svd_conv1d_10/30/weights.38-0.52.hdf5
------ TRAIN ACCURACY:  weights.38-0.52.hdf5  ------
0.943412831119
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1686    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1924    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  887    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    2    4    7 1263    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  287    4    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  197    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    1  420    6    0    7   61
     0    0    3]
 [   0    0    0    0    0    0    0    3    0    4  447   13    4    9
     1    5    1]
 [   0    0    0    0    0    4    0    4    0    7   13  421    7    7
    23    3   11]
 [   0    0    0    0    3    0    0    1    0    9    0    8  599   12
     0    1    1]
 [   0    3    0    0    0    0    0    0    0   34    6    2    2  414
     2    0    2]
 [   0    0    0    0    3    1    0    3    1    0    7   58    5    1
   326    6    3]
 [   0    0    0    0    0    0    0    0    0    4   49   15   29   10
    14  332   42]
 [   0    0    0    0    0    2    0    0    0    0    4   38    6    7
     6   13  434]]
------ TEST ACCURACY:  weights.38-0.52.hdf5  ------
0.752450980392
[[ 1  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 42  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0 22  0  3  2  0  0]
 [ 0  0  0  0  1  0  0  0  7  7  3  3  3  0  0  0]
 [ 0  0  0  0  3  0  0  0  0  1 13  5  0  1  0  3]
 [ 0  0  0  0  0  0  0  0  0  1  2 23  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  8  0  1  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0 19  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  1  0  9  0  6  1]
 [ 0  0  0  0  0  0  0  0  0  0  6  2  6  0  0 10]]
[0.6822916666666666, 0.7787307032590052, 0.8552631578947368, 0.4630225080385852, 0.785234899328859, 0.8009708737864077, 0.7787878787878788, 0.8337531486146096, 0.6811594202898551, 0.7380191693290735, 0.7040816326530612, 0.572, 0.7294429708222812, 0.7526881720430108, 0.7924050632911392, 0.7371794871794872, 0.7901498929336188, 0.7689655172413793, 0.7669172932330827, 0.7570498915401301, 0.6, 0.5971074380165289, 0.8282208588957055, 0.7495908346972177, 0.7604938271604939, 0.7797619047619048, 0.8117977528089888, 0.8829113924050633, 0.6757281553398058, 0.7524509803921569]
0.740205883047
0.0877541737508

Process finished with exit code 0

'''
