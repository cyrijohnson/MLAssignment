import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import numpy as np
import cPickle as pickle
from keras.models import Model, load_model
from keras.initializers import Constant, TruncatedNormal
from keras.layers import Input, Dense, Conv1D, Flatten, Dropout, Activation, BatchNormalization
from keras.layers.merge import concatenate
from keras.optimizers import Adam
from keras.callbacks import ModelCheckpoint
import keras.backend as K
from keras import losses
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix

# Load SMV data (Signal Magnitude Vector)

X = pickle.load(open("data/X_unimib_smv.p", "rb"))
y = pickle.load(open("data/y_unimib_smv.p", "rb"))

n_classes = 17


# Below builds 1D CNN.

for i in range(30):
    test = y.loc[y[1] == i+1]
    # print y_sub
    test_index = test.index.values
    # print len(test_index)

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index], y_values[test_index]
    y_train = np.eye(n_classes)[y_train - 1]
    print X_train.shape # (11188, 151)

    # input layer
    input_signal = Input(shape=(151, 1))
    print K.int_shape(input_signal)

    # define initial parameters
    b_init = Constant(value=0.0)
    k_init = TruncatedNormal(mean=0.0, stddev=0.01, seed=2018)

    # first feature extractor
    conv11 = Conv1D(16, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn11 = BatchNormalization()(conv11)
    actv11 = Activation('relu')(bn11)
    conv12 = Conv1D(32, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv11)
    bn12 = BatchNormalization()(conv12)
    actv12 = Activation('relu')(bn12)
    flat1 = Flatten()(actv12)

    # second feature extractor
    conv21 = Conv1D(16, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn21 = BatchNormalization()(conv21)
    actv21 = Activation('relu')(bn21)
    conv22 = Conv1D(32, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv21)
    bn22 = BatchNormalization()(conv22)
    actv22 = Activation('relu')(bn22)
    flat2 = Flatten()(actv22)

    # third feature extractor
    conv31 = Conv1D(16, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn31 = BatchNormalization()(conv31)
    actv31 = Activation('relu')(bn31)
    conv32 = Conv1D(32, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv31)
    bn32 = BatchNormalization()(conv32)
    actv32 = Activation('relu')(bn32)
    flat3 = Flatten()(actv32)

    # merge feature extractors
    merge = concatenate([flat1, flat2, flat3])

    # dropout & fully-connected layer
    do = Dropout(0.9, seed=2018)(merge)
    output = Dense(n_classes, activation='softmax', bias_initializer=b_init, kernel_initializer=k_init)(do)

    # result
    model = Model(inputs=input_signal, outputs=output)

    # summarize layers
    print(model.summary())

    new_dir = 'model/unimib_smv_conv1d_10/' + str(i+1) + '/'
    if not os.path.exists(new_dir):
        os.makedirs(new_dir)

    fpath = new_dir + 'weights.{epoch:02d}-{val_acc:.2f}.hdf5'
    cp_cb = ModelCheckpoint(fpath, monitor='val_acc', verbose=1, save_best_only=True, mode='auto', period=1)

    adam = Adam(lr=0.001)
    model.compile(loss=losses.categorical_crossentropy, optimizer=adam, metrics=['accuracy'])
    model.fit(np.expand_dims(X_train, axis=2), y_train, batch_size=64, epochs=50, verbose=2, validation_split=0.10,
              callbacks=[cp_cb], shuffle=True)

    del model
    K.clear_session()


# Below calculates average test data accuracy (LOSO CV).

acc = []

for i in range(30):
    test = y.loc[y[1] == i+1]
    test_index = test.index.values

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index] - 1, y_values[test_index] - 1

    print "\n>>>>>>>>>>>>>>", str(i+1), "-fold <<<<<<<<<<<<<<<<"
    path_str = 'model/unimib_smv_conv1d_10/' + str(i+1) + '/'
    for path, dirs, files in os.walk(path_str):
        dirs.sort()
        files.sort()
        top_acc = []
        top_acc.append(files[-1])
        files = top_acc

        for file in files:
            print "========================================"
            print os.path.join(path, file)
            model = load_model(os.path.join(path, file))
            pred = model.predict(np.expand_dims(X_train, axis=2), batch_size=32)
            print "------ TRAIN ACCURACY: ", file, " ------"
            print accuracy_score(y_train, np.argmax(pred, axis=1))
            print confusion_matrix(y_train, np.argmax(pred, axis=1))
            pred = model.predict(np.expand_dims(X_test, axis=2), batch_size=32)
            print "------ TEST ACCURACY: ", file, " ------"
            print accuracy_score(y_test, np.argmax(pred, axis=1))
            print confusion_matrix(y_test, np.argmax(pred, axis=1))

            del model
            K.clear_session()

    acc.append(accuracy_score(y_test, np.argmax(pred, axis=1)))

print acc
print np.mean(acc)
print np.std(acc)

'''
-----
[0.640625, 0.7238421955403087, 0.8092105263157895, 0.45016077170418006, 0.785234899328859, 0.8131067961165048, 0.793939393939394, 0.7732997481108312, 0.644927536231884, 0.6964856230031949, 0.7704081632653061, 0.86, 0.7161803713527851, 0.6854838709677419, 0.7569620253164557, 0.7158119658119658, 0.7794432548179872, 0.7206896551724138, 0.8045112781954887, 0.702819956616052, 0.6107142857142858, 0.5991735537190083, 0.7177914110429447, 0.7643207855973814, 0.7308641975308642, 0.7232142857142857, 0.7443820224719101, 0.8449367088607594, 0.629126213592233, 0.7156862745098039]
0.724111759019
0.0822238993862
-----

/usr/bin/python2.7 /mnt/0cdd1a7e-3686-4cf7-9055-145eb5fe70f3/hcilab/OSS/electronicsletters2018/unimib/unimib_smv_conv1d_10.py
/home/hcilab/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.

>>>>>>>>>>>>>> 1 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/1/weights.50-0.44.hdf5
------ TRAIN ACCURACY:  weights.50-0.44.hdf5  ------
0.902256959691
[[ 144    2    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   1  202    0    0    0    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1681    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1912    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   99    0  750    1   40    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    2    6    7 1258    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    2    0    0    0    0  263   17    0    0    1    1    0
     1    0    0]
 [   1    0    0    0    0    0    1    3  193    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  484    3    2    4   14
     0    4    5]
 [   0    0    0    0    0    0    0    0    0   28  320   26   17    1
     4   12   86]
 [   0    0    2    0    1    3    1    0    1    8   21  403   22    4
    12    4   29]
 [   0    3    1    0    0    0    0    1    0    8    2    4  552    9
     4   17   41]
 [   0    0    0    0    0    0    0    0    0   83    0    7   12  363
     1    3    1]
 [   0    0    0    0    3    0   20    0    0    0    4   48    2    0
   316    4   22]
 [   0    0    0    0    0    0    0    0    0   23   46   10    3    6
     4  322   79]
 [   0    0    0    0    0    0    0    0    0   29   31   15   14    5
     5   22  395]]
------ TEST ACCURACY:  weights.50-0.44.hdf5  ------
0.640625
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  7  0 19  0  5  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 28  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 20  0  0  0 22  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  7  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  6  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  3  0  0  2  0 11]
 [ 0  0  0  0  0  0  0  0  0  0  4  2  0  0  0  0  9]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  2  2]
 [ 0  0  0  0  0  0  0  0  0  0  4  1  5  0  0  3  1]
 [ 0  0  0  0  0  0  0  0  0  0  5  2  2  0  0  2  4]
 [ 0  0  0  0  0  0  0  0  0  8  0  2  0  4  3  3  0]
 [ 0  1  0  0  0  0  0  2  0  1  4  0  2  0  4  0  4]]

>>>>>>>>>>>>>> 2 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/2/weights.50-0.46.hdf5
------ TRAIN ACCURACY:  weights.50-0.46.hdf5  ------
0.893814801573
[[ 145    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   6  190    4    0    0    0    0    4    0    0    0    0    0    0
     0    0    0]
 [   0    0 1593    1    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1908    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   67    0  791    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    2    0  714    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   18   18    1    6 1232    0    0    0    0    0    0    0
     0    0    0]
 [   1    4    3    0    0    0    1  261    9    0    0    0    2    1
     1    4    0]
 [   0    0    1    0    0    0    0    3  181    0    0    5    0    3
     0    3    0]
 [   0    0    0    0    0    0    0    2    0  393    0    4    9   96
     0    3    1]
 [   0    0    0    7    0    3    0    0    0   24  267   30   25   22
     4   60   46]
 [   0    0    0    5    0    3    3    0    0   16   12  407    9   17
     6   22    2]
 [   0    0    3    0    0    1    0    0    0    6    1    3  564   18
     2   22    1]
 [   0    0    0    0    0    0    0    0    0   33    0    3    7  405
     0    4    0]
 [   0    0    6    4    1    1   14    0    0    0    5   62    3    7
   263   29   14]
 [   0    0    0    2    0    0    0    0    0   23    9   15   14   24
     2  384   13]
 [   0    0    0    2    0    1    0    0    0   31    9   30   19   28
     2   83  302]]
------ TEST ACCURACY:  weights.50-0.46.hdf5  ------
0.72384219554
[[  6   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0]
 [  4   7   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 143   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  37   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  29   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   4  45   0   0   0   0   0   0   0   0   0   0]
 [  0   1   0   2   0   0   1   5   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   2   2   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  16   0   0   0   3   0   2   0]
 [  0   0   0   2   0   0   0   0   0   0   0   0  10   0   2   7   2]
 [  0   0   0   0   0  12   0   2   0   0   0   9   0   1   0   0   0]
 [  0   0   0   0   0   0   0   0   0   1   0   0  33   1   0   5   0]
 [  0   0   0   1   0   0   0   0   0   6   0   3   3   9   0  10   0]
 [  3   0   0   2   0   9   0   0   0   1   0   0   6   1   1   2   0]
 [  0   0   0   2   0   2   2   0   0   0   1   5   6   0   1   6   2]
 [  0   0   0   2   0   0   0   0   0   0   1   1  21   0   0   2   0]]

>>>>>>>>>>>>>> 3 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/3/weights.44-0.44.hdf5
------ TRAIN ACCURACY:  weights.44-0.44.hdf5  ------
0.884712653702
[[ 143    3    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   1  201    0    0    0    0    0   13    0    0    0    0    0    0
     0    0    0]
 [   0    0 1716    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14 1898    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   25    0  860    0    3    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0  190    8   59    9 1019    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    1    0    0    0    0  281    1    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0   29  163    0    0    0    0    3
     1    0    0]
 [   0    2    0    0    0    0    0    0    0  443    6    1    5   52
     0    3    3]
 [   0    0    0    0    0    0    0    1    0   19  385   20   23   12
     3    5   31]
 [   0    0    0    0    4    2    0    2    0   15   42  389   17   12
    16    9    8]
 [   1    2    2    0    0    0    0    2    0    2   14    1  584   18
     6    8    7]
 [   1    0    0    1    0    0    0    1    0   51    1    1   11  396
     0    8    0]
 [   0    1    2    0    9    0    3    6    1    0   23   47    2    6
   320    2    5]
 [   0    0    1    0    0    0    0    5    0   18   80   11   42   24
    11  276   35]
 [   0    0    2    0    0    0    0   13    0   18   63   20   14   18
     4   20  355]]
------ TEST ACCURACY:  weights.44-0.44.hdf5  ------
0.809210526316
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 73  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  5  0 34  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  0  5  3  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  9  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  9  0  2  1  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0  6  0  3  0]
 [ 1  6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  4  0  0  2  0  3  0  0  1  0]
 [ 0  0  0  0  0  0  0  1  0  0  2  2  0  0  2  0  0]]

>>>>>>>>>>>>>> 4 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/4/weights.45-0.45.hdf5
------ TRAIN ACCURACY:  weights.45-0.45.hdf5  ------
0.915794066318
[[ 151    0    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   2  203    0    0    0    0    0    7    0    0    0    0    0    0
     0    0    0]
 [   0    0 1714    0    6    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1926    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  862    0   23    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  718    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    6 1291    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  279    5    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0   14  176    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  466    1    2   10   25
     0    2   14]
 [   0    0    0    0    0    0    0    2    0   22  314   23   26    1
     6   16   82]
 [   0    1    0    1    1    1    2    5    0   21   14  398   21    8
    16    2   12]
 [   0    3    1    0    0    0    0    2    0    6    0    3  576    8
     4   31    9]
 [   1    1    0    0    0    0    0    1    0   81    0    4    9  364
     1    2    3]
 [   0    1    1    4   10    0   12    3    1    0    9   38    1    0
   330    3    8]
 [   0    0    0    0    0    0    1    4    2   24   24    9   21    6
     7  329   70]
 [   0    0    0    0    0    1    0    7    0   19   22   18   14    7
     7   19  398]]
------ TEST ACCURACY:  weights.45-0.45.hdf5  ------
0.450160771704
[[ 2  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  0  0  0 10  0  0  0  0  0  0  0  0  0]
 [ 0  0 36  0  0  0  0  0  0  0  0 15  0  3  0  0]
 [ 0  1  0 15  0  0 13  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 11  0  1  0  1  0  0 14  0  0  0  0]
 [ 0  0  0  0  0 15 12  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  1  0  0  7  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  2  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  1  0  0  0  0]
 [ 0  0  5  0  0  0  0  0  5  0  4  2  0  0  2  1]
 [ 0  0  1  0  0  0  0  0  0  0 13  3  0  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 10  3  2  2  1]
 [ 0  0  0  0  0  0  0  0  8  0  0  0  6  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  1  6  3  0  0  1  2]
 [ 0  0  0  0  0  0  0  0  4  0  0  2  5  0  3  2]
 [ 0  0  0  0  0  0  0  0  3  4  2  5  3  0  2  3]]

>>>>>>>>>>>>>> 5 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/5/weights.41-0.45.hdf5
------ TRAIN ACCURACY:  weights.41-0.45.hdf5  ------
0.909352392574
[[ 142    2    0    0    0    0    0    1    1    0    0    0    0    0
     0    0    0]
 [   0  195    0    0    0    0    0    8    1    0    0    0    0    0
     0    0    0]
 [   0    0 1705    4    6    0    0    0    0    0    1    0    0    0
     0    0    0]
 [   0    0    0 1919    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    2    0  881    0   16    0    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  725    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3   15    4   11 1258    0    0    0    0    0    0    0
     1    0    0]
 [   0    1    0    0    0    0    0  286    2    0    0    0    0    0
     1    0    0]
 [   0    1    0    0    0    0    0    7  190    0    0    0    0    1
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  429    0    5    3   64
     0    8    2]
 [   0    0    0    0    0    0    0    1    1   24  338   35   26   14
    11   18   34]
 [   0    1    0    0    0    1    0    1    0   20   19  413   11   15
    16    7    1]
 [   1    6    0    0    0    0    0    0    1    8    3   10  573    9
    13   17    5]
 [   0    0    0    0    0    0    0    0    0   48    0    7   11  399
     2    7    0]
 [   0    0    0    0    2    0    6    3    2    0   12   50    1    4
   336    4    5]
 [   0    0    0    0    0    0    0    8    2   19   41   11   15   14
    19  332   37]
 [   0    0    0    0    0    1    0    7    1   23   46   32   17   21
    16   40  312]]
------ TEST ACCURACY:  weights.41-0.45.hdf5  ------
0.785234899329
[[ 7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 11  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 66  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 19  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  5  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  1  0  0  4  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 10  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 13  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  1  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  9  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  2  0 13  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  0 13  3]]

>>>>>>>>>>>>>> 6 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/6/weights.39-0.43.hdf5
------ TRAIN ACCURACY:  weights.39-0.43.hdf5  ------
0.890219209437
[[ 140    4    0    0    0    0    0    2    5    0    0    0    0    0
     0    0    0]
 [   2  190    0    0    1    0    0   18    0    0    0    0    0    0
     1    0    0]
 [   0    0 1658    0    1    4   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1922    0    1    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0  810   13   46    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2   19    0   15 1238    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    1    0    1  271    5    0    1    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    8  185    0    0    0    0    1
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  480    0    4    3   17
     0    3    1]
 [   0    0    0    1    0    2    0    2    1   34  288   42   44    7
     4   19   52]
 [   0    0    1    1    0    8    3    1    0   18   14  420   21    4
     3   10    3]
 [   0    1    1    0    0    1    1    0    0   12    1    9  586    7
     1    7   11]
 [   0    0    0    0    0    0    0    1    0  112    0    9   17  319
     1    4    1]
 [   0    1    0    4    7    2   17    1    0    1    5   91    3    0
   255    7   22]
 [   0    0    1    0    0    2    1    1    0   35   17   29   61    7
     5  290   44]
 [   0    0    0    0    0    2    1    3    0   40   29   39   22    7
     9   21  343]]
------ TEST ACCURACY:  weights.39-0.43.hdf5  ------
0.813106796117
[[ 2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 41  3  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 29  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 50  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  6  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 19  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  1  2  5  3  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  8  2  9  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 23  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  0 15  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  1  6  0  2  0  7  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  2  0  0 10  7]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  6 10]]

>>>>>>>>>>>>>> 7 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/7/weights.41-0.46.hdf5
------ TRAIN ACCURACY:  weights.41-0.46.hdf5  ------
0.895551088192
[[ 151    0    0    0    0    0    0    1    1    0    0    0    0    0
     0    0    0]
 [   3  199    1    0    1    0    0    5    1    0    0    0    0    0
     1    0    0]
 [   0    0 1672   10    2    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1933    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   33    0  812    0   40    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0   15    0  688   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    5    2    5 1277    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    3    0    3    0    0  265   10    0    1    0    0    0
     2    0    0]
 [   0    0    0    0    0    0    1    5  183    0    0    0    0    2
     0    1    0]
 [   0    1    0    0    0    0    0    1    0  409    0    3    1   94
     1    6    0]
 [   0    0    2    7    0    0    0    1    0   21  242   26   36   14
    16   55   76]
 [   0    0    0    6    1    1    5    0    0    8    5  390   16   22
    25   17   12]
 [   0    0    1    2    0    0    0    0    0    4    0    5  580   19
     5   25    2]
 [   0    0    0    0    0    0    0    0    0   31    0    4    6  416
     2    3    0]
 [   0    0    0    5    1    0   22    0    0    0    3   38    4    6
   323   13   11]
 [   0    0    2    5    0    0    0    0    0   20   10    7   18   36
    11  366   25]
 [   0    0    0    1    0    0    0    2    0   22   12   27   18   24
    16   60  340]]
------ TEST ACCURACY:  weights.41-0.46.hdf5  ------
0.793939393939
[[ 4  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0 49  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 33  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  2  1  2  2  6  1]
 [ 0  0  0  0  0  0  0  0  0  0  4  1  0  7  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 13  0  0  5  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 22  0  0  0]
 [ 0  0  1  0  0  0  0  0  0  0  0  0  1  4  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  7  5]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  4  5  2]]

>>>>>>>>>>>>>> 8 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/8/weights.48-0.44.hdf5
------ TRAIN ACCURACY:  weights.48-0.44.hdf5  ------
0.896518375242
[[ 148    2    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   1  211    0    0    1    0    0    2    0    0    0    0    1    0
     0    0    0]
 [   0    0 1665    0    6    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1929    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  889    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  720    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   20   32  100   12 1113    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    2    0    2    0    0  274    2    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    1    0    0    7  175    0    0    0    0    1
     0    1    1]
 [   0    1    0    0    0    0    0    1    0  455    0    3    4   29
     0    6    4]
 [   0    0    0    1    3    1    0    2    0   29  251   37   29    3
    10   33   95]
 [   0    0    1    0    5    5    0    1    0   12    8  417   19    7
     9   13   12]
 [   1    1    0    0    4    0    0    0    0    8    1    5  577    9
     4   17    9]
 [   1    1    0    0    0    0    0    0    0   74    0    6   11  364
     1    5    2]
 [   0    1    5    1   14    0    4    0    0    1    3   75    2    1
   296    6   11]
 [   0    0    0    0    0    0    0    0    0   24    9   14   29   15
    10  360   42]
 [   0    0    0    1    0    1    0    0    0   19   14   34   21   12
     8   50  353]]
------ TEST ACCURACY:  weights.48-0.44.hdf5  ------
0.773299748111
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 63  4  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 52  0  3  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 11  0  0  0 36  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  6  1  0  2  0  1  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  4  0  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0 17  2  0  0  1  0  0  6]
 [ 0  0  0  0  0  0  0  1  0  0  1  0  2  0  0  3 10]
 [ 0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 25  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0 18  0  0  0]
 [ 0  3  0  0  0  0  0  0  0  0  0  6  0  3  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  3  1  0  3  1]
 [ 0  0  0  0  0  0  0  1  0  0  1  0  0  0  0  9 10]]

>>>>>>>>>>>>>> 9 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/9/weights.38-0.44.hdf5
------ TRAIN ACCURACY:  weights.38-0.44.hdf5  ------
0.905080567051
[[ 149    1    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   3  197    0    0    1    0    0   11    0    0    0    0    0    0
     1    0    0]
 [   0    0 1679    0    9    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1925    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  885    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  719    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   18   15   27    5 1212    0    0    0    0    0    0    0
     0    0    0]
 [   1    2    0    0    0    0    0  282    3    0    0    0    0    0
     0    0    0]
 [   1    0    0    0    0    0    1    9  178    0    0    0    0    1
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  464    5    2    2   25
     0    7    2]
 [   0    0    0    0    0    1    0    3    0   21  349    9   25   10
    10    5   49]
 [   0    0    3    0    3    0    0    0    0   14   52  369   24    7
    20    6    8]
 [   1    2    0    0    0    0    0    4    0    2    7    3  573   14
     7    6    5]
 [   1    1    0    0    0    0    0    0    1   67    3    4   11  377
     2    4    2]
 [   0    1    2    3    5    0   16    3    1    0   24   37    4    0
   306    2   17]
 [   0    0    0    0    0    1    1    2    3   23   57    7   45    9
     9  291   34]
 [   0    0    1    0    0    1    0    8    3   19   80   10   19   11
    10   19  324]]
------ TEST ACCURACY:  weights.38-0.44.hdf5  ------
0.644927536232
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0 50  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 60  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 19  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  0  1  0  6  0  7  0]
 [ 0  0  0  0  0  0  0  2  0  1  3  0  7  0  0 10  6]
 [ 0  0  3  0  2  0  0  0  0  0  5  3  0  0  3  4  0]
 [ 0  0  1  0  0  0  0  2  0  0  3  0 31  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  3  0  0  0  5  0  1  0]
 [ 0  0  0  0  1  0  0  1  0  0  8  1  0  0  2  0  0]
 [ 0  0  3  0  0  0  0  1  0  5  3  0  7  7  1  3  1]
 [ 0  0  2  0  0  0  0  0  0  8  2  4  4  0  0  8  1]]

>>>>>>>>>>>>>> 10 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/10/weights.48-0.42.hdf5
------ TRAIN ACCURACY:  weights.48-0.42.hdf5  ------
0.907575493105
[[ 149    2    0    0    0    0    0    1    1    0    0    0    0    0
     0    0    0]
 [   1  205    2    0    0    0    0    7    1    0    0    0    0    0
     0    0    0]
 [   0    0 1701    0    5    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9 1925    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   37    0  843    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  727    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   16    0    0    0 1279    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    4    0    0    0    0  282    7    0    0    0    0    0
     0    0    0]
 [   0    1    1    0    0    0    0    7  178    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  458    1    1    8   32
     0    5    0]
 [   0    0    0    2    0    1    4    6    1   32  356   12   28    3
     0   16   38]
 [   0    1    8    0    5    1    3    3    1   13   32  364   27   11
     6   22    7]
 [   0    3    2    0    0    0    0    1    0    9    2    2  573   11
     3   25   12]
 [   0    0    0    0    0    0    0    0    0   75    0    4   11  371
     0    5    1]
 [   0    0    5    3    5    0   18    0    1    1   16   36    5    2
   309   10    9]
 [   0    1    0    1    0    0    1    2    1   27   40    9   30    9
     4  351   25]
 [   0    0    0    0    0    0    1    4    3   28   47   14   23   10
     6   53  328]]
------ TEST ACCURACY:  weights.48-0.42.hdf5  ------
0.696485623003
[[32  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 51  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0 13  0 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 17  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  7 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  3  7  0  0  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0 16  0  0  5  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  3  5  0  0  3  0  1]
 [ 0  0  0  0  0  0  0  0  0 20  1  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0 12  0  0  6  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  3  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1 11  2  0]
 [ 0  0  0  0  0  1  0  0  1  0  0  0  2  7  1]
 [ 0  0  0  0  0  0  0  3  0 11  0  0  0  0  3]]

>>>>>>>>>>>>>> 11 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/11/weights.41-0.44.hdf5
------ TRAIN ACCURACY:  weights.41-0.44.hdf5  ------
0.892784954741
[[ 144    1    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   1  200    0    0    0    0    0    8    2    0    0    0    0    0
     0    0    0]
 [   0    0 1695    0    6    0   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1899    0    1    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  842    0   30    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    1    2    9 1249    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    2    0    0    0    0  274    7    0    0    0    0    0
     1    0    0]
 [   0    1    1    0    0    0    0    2  190    0    0    0    0    1
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  449    2    1    9   34
     0   11    3]
 [   0    0    0    0    0    0    1    1    0   25  233   45   28    6
    12   68   72]
 [   0    0    0    0    0    1    4    0    1   18   20  408   25    6
     9    9   11]
 [   2    2    3    0    0    0    0    1    0    5    3    3  564   12
     6   31    5]
 [   2    1    0    0    0    0    0    0    0   84    0   10   19  335
     3   11    0]
 [   1    0    0    0    4    0   18    2    2    0    6   65    4    4
   276   16   18]
 [   0    0    0    0    0    0    0    0    0   21   21   20   25   15
     9  352   36]
 [   0    0    0    0    0    0    0    6    2   20   31   32   18   11
     9   66  323]]
------ TEST ACCURACY:  weights.41-0.44.hdf5  ------
0.770408163265
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 23  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 82  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0 39  0  1  1  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  5  0  2  0 50  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  3  6  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  9  0  0  0  5  2  4]
 [ 0  0  0  0  0  0  0  0  0  0  3  7  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 10  2  9  3  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  6  0  0  0  9  0  3  0]
 [ 0  2  0  0  0  0  0  3  0  0  0  0  0  0  9  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  2  0  0  8  3]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  3  0  2  3  5]]

>>>>>>>>>>>>>> 12 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/12/weights.49-0.47.hdf5
------ TRAIN ACCURACY:  weights.49-0.47.hdf5  ------
0.915535444947
[[ 142    3    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0  200    0    0    0    0    0   10    0    0    0    0    0    0
     0    1    0]
 [   0    0 1542    1   11    1    0    0    0    0    0    1    0    0
     0    0    0]
 [   0    0    1 1910    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  867    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3   26   12   12 1231    0    0    0    0    0    0    0
     4    0    0]
 [   0    2    0    0    0    0    0  292    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0   10  186    0    0    0    0    1
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  458    2    3    7   24
     0   12    4]
 [   0    0    0    0    0    0    0    2    0   14  350   19   29    5
     6   21   50]
 [   0    0    1    0    1    0    0    0    0   11   23  404   27    5
    17   15   10]
 [   0    0    0    0    0    0    0    4    0    2    1    1  587   11
     5   16   14]
 [   0    0    0    0    0    0    0    0    0   65    0    4   21  367
     1    4    2]
 [   0    0    0    0    5    0    8    1    0    0   12   39    4    3
   336   10    6]
 [   0    0    0    0    0    0    0    1    0   15   24   11   30    3
     3  362   47]
 [   0    0    0    0    0    0    0    4    0   12   49   20   21    6
     3   29  371]]
------ TEST ACCURACY:  weights.49-0.47.hdf5  ------
0.86
[[  6   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   5   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 182   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  32   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  32   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  36   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   2   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  15   0   0   0   0   0   2   0]
 [  0   0   0   0   0   0   0   0   0   0   8   1   1   1   1   0   3]
 [  0   0   0   0   0   0   0   0   0   0   2   6   0   0   2   2   0]
 [  0   0   0   0   0   0   0   0   0   0  10   0  10   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   4   0   0   0  11   0   5   0]
 [  0   0   0   0   0   0   0   0   0   0   1   2   0   0   7   0   0]
 [  0   0   0   0   0   0   0   0   0   0   6   3   4   0   0   2   2]
 [  0   0   0   0   0   0   0   0   0   5   4   3   3   0   1   1   2]]

>>>>>>>>>>>>>> 13 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/13/weights.38-0.47.hdf5
------ TRAIN ACCURACY:  weights.38-0.47.hdf5  ------
0.906880814464
[[ 145    3    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   2  204    0    0    0    0    0    4    0    0    0    0    0    0
     0    0    0]
 [   0    0 1697    0    2    0   15    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1913    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   26    0  809    0   49    0    0    0    1    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0    1    7 1265    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  274    2    0    0    0    0    0
     1    1    0]
 [   0    0    1    0    0    0    0    8  186    0    0    0    0    1
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  424    2    2    4   69
     0    2    2]
 [   0    0    0    1    0    1    1    0    0   24  327   17   27   12
     8   31   44]
 [   0    0    0    0    0    2    2    0    0    5   29  404   22    8
    21   10    5]
 [   0    1    0    0    0    1    0    3    0    4    2    1  586   14
     9   12    3]
 [   1    0    0    0    0    0    0    0    0   42    0    5   11  409
     2    4    0]
 [   1    0    2    0    1    0   15    2    0    0   15   56    2    1
   314    4    5]
 [   0    0    0    1    0    1    0    0    1   23   39   20   27   19
    11  321   32]
 [   0    0    0    0    0    2    0    0    0   20   41   30   19   15
    13   36  336]]
------ TEST ACCURACY:  weights.38-0.47.hdf5  ------
0.716180371353
[[ 3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 35  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  1  0  0 14  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  0 14  0  3  0]
 [ 0  0  0  0  0  0  0  1  0  0  8  0  0  0  0  9  0]
 [ 0  0  1  0  0  0  0  0  0  0  7  3  2  0  0  0  5]
 [ 0  0  0  0  0  0  0  0  0  0  6  0 14  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  1  0  0 13  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  7  3  0  2  2]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  8  0  0  9  0]]

>>>>>>>>>>>>>> 14 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/14/weights.45-0.46.hdf5
------ TRAIN ACCURACY:  weights.45-0.46.hdf5  ------
0.906833932801
[[ 151    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  201    0    0    1    0    0    7    0    0    0    0    0    0
     0    0    0]
 [   0    0 1598    0    7    1   78    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1912    0    2   15    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  846    0   34    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    3 1270    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  285    5    0    0    0    1    0
     0    0    0]
 [   0    0    0    0    0    0    1    6  184    0    0    1    0    1
     0    0    2]
 [   0    2    0    0    0    0    0    0    0  495    1    1    3   12
     0    2    0]
 [   0    0    0    0    0    0    0    1    0   28  324   27   33    4
     2   12   62]
 [   0    0    1    0    1    1    3    1    0   20   15  412   17   10
     3    8   11]
 [   1    1    0    0    0    0    2    1    0    9    3    3  592    9
     4    8    8]
 [   1    0    0    0    0    0    0    0    0   99    0    6    9  353
     1    5    0]
 [   0    0    0    0    1    0   22    1    0    0   14   67    3    1
   287    7   11]
 [   0    0    0    0    0    0    0    0    0   27   26   12   36   10
     5  318   61]
 [   0    0    0    0    0    0    0    2    0   34   32   14   21   10
     6   16  388]]
------ TEST ACCURACY:  weights.45-0.46.hdf5  ------
0.685483870968
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0 30  0  1  0 23  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 38  0  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 50  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  4  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  7  0  0  1  4  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  4  3  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0 10  0  0  2  6  5]
 [ 0  0  0  0  0  0  0  0  0  0  2  0 16  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 20  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  1  6  0  0  2  6]
 [ 0  0  0  0  0  1  0  0  0  0  1  2  3  0  1  2  1]]

>>>>>>>>>>>>>> 15 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/15/weights.31-0.46.hdf5
------ TRAIN ACCURACY:  weights.31-0.46.hdf5  ------
0.881592827004
[[ 140    2    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   5  198    0    0    0    0    0    7    1    0    0    0    0    0
     0    0    0]
 [   0    0 1687    0    3    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1892    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    1   87    0  788    0   29    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  712    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   98    0    1    7 1162    0    0    0    0    0    0    0
     0    1    0]
 [   0    3    3    0    0    0    0  257   19    0    1    0    0    0
     0    1    0]
 [   0    1    0    0    0    0    0    4  185    0    0    0    0    1
     0    1    0]
 [   0    1    0    0    0    0    0    1    0  430    0    3    7   69
     0    5    1]
 [   0    0    0    0    0    0    0    1    1   31  291   33   31   10
     3   33   59]
 [   0    0    5    0    0    2    3    0    0   18   28  382   16   10
    11   25   12]
 [   1    1    0    0    0    0    0    3    0    9   10    3  554   16
     6   30   10]
 [   2    0    0    0    0    0    0    1    0   46    0    6   12  393
     3    5    1]
 [   1    0    5    0    1    0   13    1    1    0   13   55    2    8
   282   15   19]
 [   0    0    0    0    0    0    0    0    1   23   44   11   10   33
     6  331   41]
 [   0    0    0    0    0    0    0    2    0   22   36   26   19   12
     5   52  345]]
------ TEST ACCURACY:  weights.31-0.46.hdf5  ------
0.756962025316
[[ 4  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  2  1  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 88  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 11  0  5  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 55  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  0  0  0  0  0  0  1  0  0]
 [ 0  0  1  0  0  0  0  0  6  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  0  0  3  3  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0 13  0  0  0  0  3  1]
 [ 0  0  0  0  0  0  0  0  0  3  0  9  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  1  3  0  6  7  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  9  0  0  2  3  4]
 [ 0  0  0  0  0  0  0  0  0  0  4  1  0  1  1  3  3]
 [ 0  0  0  0  0  0  0  0  0  0  8  1  0  2  4  0  0]]

>>>>>>>>>>>>>> 16 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/16/weights.47-0.45.hdf5
------ TRAIN ACCURACY:  weights.47-0.45.hdf5  ------
0.91462443599
[[ 144    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  195    0    0    1    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1648    0   18    0   15    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1904    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  851    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    2    4 1258    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    1  269    2    0    1    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    9  181    0    0    0    0    1
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  473    0    3    3   26
     0    2    1]
 [   0    0    0    1    1    2    3    2    0   35  329   28   22    3
     3    7   56]
 [   0    0    1    0    1    5    6    0    0   15   25  409   13    8
     8   10   11]
 [   0    1    0    0    1    0    0    3    0    6    1    2  571    9
     5   23   18]
 [   0    0    0    0    0    0    0    0    0   82    0    5    9  367
     1    5    1]
 [   0    0    0    1   11    0   18    1    0    0    6   43    2    0
   306    5   30]
 [   0    0    0    0    0    1    2    0    0   26   38    7   14   13
     3  343   44]
 [   0    0    0    0    0    1    1    0    0   28   37   19   14   10
     7   17  374]]
------ TEST ACCURACY:  weights.47-0.45.hdf5  ------
0.715811965812
[[ 8  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 6  4  0  0  0  0  0  7  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 77  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 46  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1 20  9  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 59  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  4  7  0  7  0  0  0  1  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  3  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 19  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  4  0  0  0  8  4]
 [ 0  0  0  0  0  0  0  0  0  1  0  8  2  0  2  0  1]
 [ 0  0  0  0  0  0  0  0  0  8  0  0 11  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  3  0  0  0  0  0  0]
 [ 0  0  0  0  2  0  0  0  0  0  0  2  0  0  5  0  2]
 [ 0  0  0  0  0  0  0  0  0  4  4  0  5  4  2  3  0]
 [ 0  0  0  0  0  0  0  0  0  0 22  0  0  0  0  0  4]]

>>>>>>>>>>>>>> 17 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/17/weights.45-0.45.hdf5
------ TRAIN ACCURACY:  weights.45-0.45.hdf5  ------
0.904104741684
[[ 147    1    0    0    0    0    0    0    1    0    0    0    0    0
     0    0    0]
 [   2  189    1    0    1    0    0    8    0    0    0    0    0    0
     0    0    0]
 [   0    0 1630    0    5    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1900    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    0  865    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10    3    3    7 1251    0    0    0    0    0    0    0
     0    0    0]
 [   1    3    4    0    3    1    0  262    9    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    4  187    0    0    0    0    1
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  442    1    6   13   39
     0   14    0]
 [   0    0    1    1    1    1    0    0    0   22  287   34   40    3
     5   55   45]
 [   0    0    0    0    4    1    2    0    0   10   18  408   31    4
     6   17    4]
 [   0    2    3    0    0    0    0    0    1    4    1    4  589    7
     4   24    2]
 [   0    1    0    0    0    0    0    0    0   45    0    8   22  368
     2   16    2]
 [   1    0    2    1   10    0   12    0    0    0    7   56    3    1
   281   18   19]
 [   0    0    0    0    0    1    0    1    0   21   29   19   20    6
     8  376   14]
 [   0    2    0    0    0    2    1    4    0   23   29   33   26    4
     6   75  312]]
------ TEST ACCURACY:  weights.45-0.45.hdf5  ------
0.779443254818
[[  4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0  11   0   0   0   0   0   4   0   0   0   0   0   0   0   0   0]
 [  0   0 103   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  81   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  19   0   9   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  19   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  50   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0  13   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   7   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   9   0   0   1   2   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   2   5   3   0   0   3   3]
 [  0   0   0   0   0   0   0   0   0   0   3  17   0   1   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   5  12   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   4   0   6   3   7   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   4   5   0   0   9   0   5]
 [  0   0   0   0   0   0   0   0   0   0   0   0   4   0   2   4   8]
 [  0   0   0   0   0   0   0   0   0   0   4   0   0   0   2   4   7]]

>>>>>>>>>>>>>> 18 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/18/weights.48-0.44.hdf5
------ TRAIN ACCURACY:  weights.48-0.44.hdf5  ------
0.899834509189
[[ 138    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  192    0    0    1    0    0   12    0    0    0    1    0    0
     0    0    0]
 [   0    0 1733    0    5    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6 1923    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   35    0  839    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  730    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   77    0    8    7 1201    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    2    0    4    0    1  265    7    0    2    0    1    0
     0    0    0]
 [   0    0    1    0    0    0    0    9  178    0    0    0    0    0
     0    1    0]
 [   0    1    0    0    0    0    0    1    0  459   10   12    3   23
     0    3    3]
 [   0    0    0    0    1    0    0    1    0   26  360   39   27    3
     4    9   23]
 [   0    0    1    0    1    1    1    0    0    5   28  432   19    8
     7    3    3]
 [   0    2    1    0    0    0    0    2    0    4   10    4  589    8
     3   12    8]
 [   0    0    0    0    0    0    0    0    0   80    2   10   22  354
     0    3    0]
 [   0    0    3    0    9    0    7    0    0    0   11   97    4    3
   284    2    3]
 [   0    0    1    0    0    0    0    0    0   23   54   26   35    5
     5  321   33]
 [   0    0    0    0    0    0    0    0    0   21   49   65   19    4
     6   24  333]]
------ TEST ACCURACY:  weights.48-0.44.hdf5  ------
0.720689655172
[[12  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  8  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 56  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  8  0  8  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0 29  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  1  9  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  2  3  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  3  0  0  3  1  4]
 [ 0  0  0  0  0  0  0  0  0  1  3 12  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  8  3  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0  7  1  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  5  0  0  4  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  6  2]
 [ 0  0  0  0  0  0  0  0  0  0  7  3  0  0  0  2  1]]

>>>>>>>>>>>>>> 19 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/19/weights.42-0.47.hdf5
------ TRAIN ACCURACY:  weights.42-0.47.hdf5  ------
0.901086484137
[[ 142    4    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  201    0    0    0    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1675    0    2    0   47    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1913    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  855    0   55    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  710   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    2 1291    0    0    0    0    0    0    0
     0    0    0]
 [   0    5    1    0    0    0    1  274    9    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    6  183    0    0    0    0    1
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  426    0    3    4   84
     0    0    2]
 [   0    0    0    1    0    0    2    3    0   13  282   16   27   11
    20   24   97]
 [   0    1    1    0    0    2   12    1    0    6   15  366   24   24
    32   14   19]
 [   1    3    1    0    0    0    1    0    0    2    2    0  573   20
    10   23    8]
 [   0    1    0    0    0    0    0    0    2   32    0    5    3  422
     2    4    3]
 [   1    2    0    3    1    0   28    0    1    0    0   39    1    5
   314   10   14]
 [   0    0    0    1    0    0    1    2    5   14   17    3   18   23
    12  359   49]
 [   0    0    0    0    0    1    1    7    2   17   17   14   15   23
    16   28  381]]
------ TEST ACCURACY:  weights.42-0.47.hdf5  ------
0.804511278195
[[ 4  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 11  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 14  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 31  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  7  0  1  0]
 [ 0  0  0  0  3  0  3  0  0  0  1  0  0  2  0  5  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  7  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  0  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  3  7  0  3]
 [ 0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  8  0]
 [ 0  0  0  0  0  0  2  0  0  0  0  1  0  1  0  7  1]]

>>>>>>>>>>>>>> 20 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/20/weights.48-0.45.hdf5
------ TRAIN ACCURACY:  weights.48-0.45.hdf5  ------
0.898054818744
[[ 141    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  195    1    0    0    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1581    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1913    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   67    0  791    0   34    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  727    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   17    1    3    7 1246    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    1    0    1    0    0  281    2    0    0    0    0    0
     0    0    0]
 [   0    1    1    0    0    0    0    8  178    0    0    0    0    1
     0    3    0]
 [   0    1    0    0    0    0    0    1    0  433    0    3    4   65
     0    2    4]
 [   0    0    1    0    0    2    0    0    0   21  300   19   36   12
    11   21   78]
 [   0    0    1    3    0    0    5    0    0    8   14  371   27   15
    21   16   38]
 [   0    1    0    1    0    2    1    2    0    5    1    2  576   14
     4   11   23]
 [   0    0    0    1    0    0    0    0    0   49    0    2   15  399
     1    2    0]
 [   1    0    5    2    3    1   16    0    0    0    5   23    2    4
   328    8   27]
 [   0    0    0    0    0    0    0    0    0   21   26    7   28   28
     7  317   65]
 [   0    0    2    0    0    1    0    2    0   23   15   10   20   18
    16   38  380]]
------ TEST ACCURACY:  weights.48-0.45.hdf5  ------
0.702819956616
[[  5   4   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0]
 [  1   9   0   0   0   0   0   3   0   0   0   0   0   0   0   0   0]
 [  0   0 143   0   0   0  13   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  71   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   7  16   3   3   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  18   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   4  39   0   0   7   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   6   2   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   5   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   5   0   0   3   8   0   0   0]
 [  0   0   0   0   0   3   0   0   0   0   0   5   0   0   2   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   3   0   0   1   0   3]
 [  0   0   0   0   0   0   0   0   0   7   0   0  11   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   1   0   0   0  13   0   0   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   6   0   3]
 [  0   0   0   0   0   0   0   0   0   0   5   0   0   0   0   7   2]
 [  0   0   0   0   0   0   0   0   0   0   3   3   0   0   0   2   1]]

>>>>>>>>>>>>>> 21 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/21/weights.46-0.46.hdf5
------ TRAIN ACCURACY:  weights.46-0.46.hdf5  ------
0.907492820468
[[ 141    2    0    0    0    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0  189    0    0    4    0    0   11    0    0    0    0    1    0
     0    0    0]
 [   0    0 1727    0    9    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1923    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  901    0    8    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  724    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14    3   41    7 1213    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    1    0    0  282    1    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0   15  168    0    0    0    0    2
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  447    0    3    8   53
     0    0    3]
 [   0    0    0    1    1    0    0    2    0   26  319   26   26   18
     7    4   72]
 [   0    0    0    1    4    0    1    4    0   24   15  418   16    8
    11    0    7]
 [   1    1    0    0    1    0    0    2    0    9    4    5  578   14
     8    4   15]
 [   0    0    0    0    0    0    0    1    0   50    0    5    6  408
     1    0    2]
 [   0    0    0    0   17    0    4    3    0    0    2   45    2    3
   331    3   15]
 [   0    0    0    2    0    0    0    2    0   23   24   19   37   33
    19  269   73]
 [   0    0    0    0    0    0    1    8    0   24   20   33   13   18
    13    7  390]]
------ TEST ACCURACY:  weights.46-0.46.hdf5  ------
0.610714285714
[[ 7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  7  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 16 42  1  0  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  8  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  2 13  7  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0 23  0 20  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  3  0  0  0  1  1]
 [ 0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  3 12  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  4  7  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  8  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  4  0  0  0  0  5]
 [ 0  0  0  0  0  0  0  2  0  0  0  0  3  0  0  0  2]]

>>>>>>>>>>>>>> 22 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/22/weights.37-0.45.hdf5
------ TRAIN ACCURACY:  weights.37-0.45.hdf5  ------
0.797111721449
[[ 132    2    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   3  183    3    0    6    0    0    9    1    0    0    0    0    0
     0    0    0]
 [   0    0 1669    0    8    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10 1913    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   65    0  810    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    6    8  704    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0  747   72  202   17  234    0    0    0    0    1    0    0
     0    0    0]
 [   0    2    2    0    1    0    0  257   14    0    1    0    1    0
     1    1    0]
 [   0    0    1    0    0    0    0    3  173    0    0    2    0    1
     0    3    0]
 [   0    0    0    0    0    0    0    2    0  434    5    6   24   21
     0   14    1]
 [   0    0    2    0    0    0    0    1    0   24  319   37   39    6
     3   18   41]
 [   0    0    1    0    4    1    0    0    0    8   25  396   26    7
     6   15    9]
 [   0    1    0    0    0    0    0    3    0    3    4    2  593    8
     2   20    2]
 [   0    0    0    0    0    0    0    0    0   69    1    7   29  337
     1   19    0]
 [   0    1    8    0    9    0    0    1    0    0   24   77    7    0
   254   17   19]
 [   0    0    0    0    0    0    0    0    0   26   54   21   48    6
     6  297   32]
 [   0    0    2    0    0    0    0    0    0   24   64   47   34    5
     7   37  292]]
------ TEST ACCURACY:  weights.37-0.45.hdf5  ------
0.599173553719
[[ 0 15  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0]
 [ 0  5  0  0  0  0  0  0  0  0  0  0  6  0  0  0  0]
 [ 0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 62  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 41  0  0  0  0  0  1  0  0  0  0  2  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  3 21  1  9  0  0  0  0  6  6  0  1  4  0]
 [ 0  0  0  0  1  0  0  7  1  0  0  1  1  0  0  4  1]
 [ 0  0  0  0  3  0  0 11  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 13  0  0  6  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  3  7  3  0  0  0  8]
 [ 0  0  0  0  0  0  0  0  0  4  0 24  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  2 14  0  0  0  5]
 [ 3  0  0  0  0  0  0  1  0  4  0  3  5  1  2  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  7  0  3  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 12  0  0 11  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  6  4  0  0  0  8]]

>>>>>>>>>>>>>> 23 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/23/weights.49-0.45.hdf5
------ TRAIN ACCURACY:  weights.49-0.45.hdf5  ------
0.911577107907
[[ 145    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1685    0    2    2   34    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1908    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  849    6   35    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    7 1272    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    1    0    2    0    1  274    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    2    3  188    0    0    0    0    1
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  464    0    2    2   30
     0    6    1]
 [   0    0    1    1    0    1    0    0    0   24  346   22   51    6
     4   16   30]
 [   0    0    0    3    1    3    6    0    0   23   23  415   18    7
     7    8    3]
 [   2    0    1    0    0    0    0    2    0    3    2    2  606    9
     2   16    1]
 [   0    0    0    0    0    1    0    0    0   70    0    3   14  375
     0    6    0]
 [   0    0    0    3    2    0   23    0    0    0   15   36    8    3
   308   18    9]
 [   0    0    1    0    0    0    0    0    0   21   28   12   64    9
     2  336   25]
 [   0    0    0    0    0    3    0    0    0   28   47   16   22   13
     4   51  336]]
------ TEST ACCURACY:  weights.49-0.45.hdf5  ------
0.717791411043
[[ 5  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 13  0  0  0  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 74  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0 23  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0  1  9  0  0  0  1  2  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  7 10  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  6  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  6  0  1]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  4  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  3  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  5  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  8  0  0  6  0]
 [ 0  2  0  0  0  0  0  0  0  0  2  0  6  0  2  0  2]]

>>>>>>>>>>>>>> 24 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/24/weights.46-0.44.hdf5
------ TRAIN ACCURACY:  weights.46-0.44.hdf5  ------
0.91146953405
[[ 129    2    0    0    0    0    0    0    1    0    0    0    0    0
     0    0    0]
 [   2  191    0    0    0    0    0    4    0    0    0    0    0    0
     0    0    0]
 [   0    0 1545    0    3    1    9    0    0    0    1    0    0    0
     0    0    0]
 [   0    0    3 1891    0    5   17    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  813    0   36    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  718    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0    1    5 1259    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  272    4    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    1  185    0    0    2    0    1
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  449    1    4    1   41
     0    8    2]
 [   1    0    0    1    0    0    0    2    0   19  369   25   25   10
     2    3   39]
 [   0    1    0    0    0    2    4    1    0   15   20  427   14    7
    16    2    3]
 [   0    1    2    0    0    0    0    1    0   10    4    5  565   21
     7   12   12]
 [   0    0    0    0    0    0    0    1    0   54    0    4    3  397
     1    7    2]
 [   0    1    0    0    3    1   18    3    0    3   21   49    3    2
   296    2    7]
 [   0    0    0    0    0    0    0    1    0   21   55   15   26   15
     3  326   32]
 [   0    0    0    0    0    2    0    3    0   23   65   19   18   16
     6   25  340]]
------ TEST ACCURACY:  weights.46-0.44.hdf5  ------
0.764320785597
[[  7   6   0   0   0   0   0   0   0   0   0   0   0   5   3   0   0]
 [  0  11   0   1   0   0   0   0   0   0   0   0   3   1   3   0   0]
 [  0   0 163   0   0   0  16   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  69   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  53   2   8   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  27   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   5   0   0  51   0   0   0   0   0   0   0   0   0   0]
 [  0   2   0   0   0   0   0  13   2   0   0   0   0   0   0   1   0]
 [  1   0   0   0   0   0   0   1   8   0   0   0   0   0   0   0   0]
 [  0   2   0   0   0   0   0   0   0  21   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0  11   0   0   0   0   0   4]
 [  0   0   0   0   0   0   0   0   0   0   4   6   3   1   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   1  18   0   0   0   2]
 [  0   0   0   0   0   0   0   0   0  15   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0  17   4   0   4   0   0]
 [  0   0   0   0   0   0   0   0   0   0   7   3   5   0   0   4   0]
 [  0   0   0   0   0   0   0   0   0   0   7   8   0   0   0   1   1]]

>>>>>>>>>>>>>> 25 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/25/weights.37-0.43.hdf5
------ TRAIN ACCURACY:  weights.37-0.43.hdf5  ------
0.890022875242
[[ 148    2    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   4  189    0    0    0    0    0   16    2    0    0    0    0    0
     1    0    0]
 [   0    0 1684    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7 1910    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   44    0  829    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    4    1  719    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   96   16    4    7 1149    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    1    0    0    0    0  282    3    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    9  180    0    0    1    0    1
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  429    1    0    3   59
     0   15    3]
 [   0    0    0    0    1    0    0    4    1   16  364   17   30   15
    10    5   29]
 [   0    1    0    0    1    0    1    3    0    8   26  388   26   14
    32    5    7]
 [   1    1    0    0    0    0    0    4    0    9    9    1  561   18
    10   15    4]
 [   1    1    0    1    0    0    0    4    0   52    4    6   10  373
     2    6    3]
 [   1    0    2    3   10    0    7    2    0    0   22   41    6    2
   318    0    5]
 [   0    0    1    0    0    0    0    2    1    2   48   11   60   14
    26  290   30]
 [   0    0    2    0    0    3    0    4    0   15   70   14   28   14
    24   36  303]]
------ TEST ACCURACY:  weights.37-0.43.hdf5  ------
0.730864197531
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  6  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  4  0 22  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 21  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0  0  0 49  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  4  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  0  3  0  7  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  2  1  4  3  2  0  2  5]
 [ 0  0  0  0  0  0  0  0  0  2  8  1  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 28  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  1  0 18  0  1  0]
 [ 0  0  1  0  0  0  2  0  0  0  2  2  2  1  4  1  0]
 [ 0  0  0  0  0  0  0  0  0 17  6  0  0  0  1  3  1]
 [ 0  0  0  0  0  0  0  0  0  1  5  0  0  0  1  2 12]]

>>>>>>>>>>>>>> 26 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/26/weights.22-0.43.hdf5
------ TRAIN ACCURACY:  weights.22-0.43.hdf5  ------
0.866200262352
[[ 142    6    0    0    0    0    0    3    1    0    0    0    0    0
     0    0    0]
 [   3  187    0    0    1    0    0   21    0    0    0    0    0    0
     0    0    0]
 [   0    0 1698    0    9    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8 1917    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  880    0    6    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    4  718    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   97    1  101    8 1069    0    0    0    0    0    0    0
     0    0    0]
 [   4    4    2    0    0    0    0  270   11    0    1    0    0    0
     0    0    1]
 [   1    0    1    0    1    0    0   13  180    0    0    0    0    3
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  393    9    1   15   80
     0    8    4]
 [   0    0    0    0    1    0    0    2    0   18  358   10   28   16
     8   12   37]
 [   0    2    1    0    1    0    0    3    0   14   54  344   28   22
    20   11    7]
 [   0    0    0    0    0    0    0    0    0   10    8    1  574   13
     7   16    7]
 [   1    5    0    0    0    0    0    0    0   55    6    5   16  378
     2    9    0]
 [   1    1    0    0   14    0    4    2    0    0   39   49    9    9
   261   20   12]
 [   0    0    0    0    0    0    0    2    1   19   99    6   40   26
    11  260   30]
 [   0    0    0    0    0    0    0    3    1   14  115   20   28   20
    12   29  276]]
------ TEST ACCURACY:  weights.22-0.43.hdf5  ------
0.723214285714
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0 31  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  1  0 46  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 17  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  3  5  0  0  0  0 11]
 [ 0  0  0  0  3  0  0  2  0  3  3  0  0  4  2  2]
 [ 1  3  0  0  1  0  0  2  0  0  0 15  1  0  2  0]
 [ 0  0  0  0  0  0  0  0  2  0  0  0  5  0  0  0]
 [ 0  0  0  0 11  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  7  0  0  0  9]
 [ 0  0  0  0  0  0  0  1  0  6  0  0  1  0  2  6]]

>>>>>>>>>>>>>> 27 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/27/weights.48-0.42.hdf5
------ TRAIN ACCURACY:  weights.48-0.42.hdf5  ------
0.91038107753
[[ 147    3    0    0    0    0    0    2    1    0    0    0    0    0
     0    0    0]
 [   1  211    0    0    0    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1696    0    3    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1913    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   24    0  848    0   23    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    0    3    7 1262    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  278    9    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    9  188    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  456    6    1    6   31
     0    8    1]
 [   0    0    0    1    0    2    1    0    0   29  375    3   25    2
    10   15   34]
 [   0    0    0    0    3    3    2    1    0   15   30  386   24    3
    30    4    3]
 [   0    2    0    0    0    0    0    3    0   12    8    2  565   10
    16   14    8]
 [   0    1    0    0    0    2    0    0    0   96    0    3   14  338
     3    8    1]
 [   1    0    0    0    7    0   14    2    0    0   14   29    6    1
   339    2    8]
 [   0    0    0    2    0    0    3    1    0   22   50    2   35    7
    15  321   39]
 [   0    0    2    0    0    2    0    4    0   22   68    8   17    5
    20   15  355]]
------ TEST ACCURACY:  weights.48-0.42.hdf5  ------
0.744382022472
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 39  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 31  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  6  6  5  0 28  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  7  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  2  2  0  0  2  0  6]
 [ 0  0  0  0  0  0  0  0  2  4  7  0  1  6  0  2]
 [ 0  0  0  0  0  0  0  0  1  0  0 20  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 12  0  0  0  6  0  0  0]
 [ 0  0  0  0  0  8  1  0  0  2  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  1  0  0  0  0  6]
 [ 0  0  0  0  0  0  0  0  2  2  0  0  0  2  1  9]]

>>>>>>>>>>>>>> 28 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/28/weights.45-0.42.hdf5
------ TRAIN ACCURACY:  weights.45-0.42.hdf5  ------
0.897599301615
[[ 150    2    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   3  207    0    0    0    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1706    0    2    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6 1921    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  883    0    2    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    2  718    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    1   82    4   44    8 1142    2    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  282    4    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    9  190    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  416    1    2    1   73
     0    8    9]
 [   0    0    0    0    0    0    0    2    1   33  352   12   23   15
     7   11   39]
 [   0    1    0    0    2    0    1    1    0   22   23  373   26    8
    43    3    6]
 [   0    3    3    0    0    0    0    0    0    8    3    4  560   16
     9   16   16]
 [   0    1    0    0    0    0    0    0    0   52    4    4    3  402
     4    3    1]
 [   0    3    3    0    7    0    9    5    0    0   20   27    1    7
   333    5    6]
 [   0    1    1    0    0    0    1    4    1   28   40   10   31   21
    22  298   39]
 [   0    2    0    0    0    1    0    5    1   28   44   18   18   23
     9   20  349]]
------ TEST ACCURACY:  weights.45-0.42.hdf5  ------
0.844936708861
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 30  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2 53  3  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 31  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 24  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0 39  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 13  0  0  0  4  0  0  0]
 [ 0  0  0  0  0  0  0  0 15  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  1 15  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  1  0  0 19  2  0  1  0]
 [ 0  0  0  0  0  0  0  4  0  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  1  3  0  0]
 [ 0  0  0  0  0  0  0  0  7  0  1  0  0  3  5]
 [ 0  0  0  0  0  0  2  0  5  0  0  0  0  1  8]]

>>>>>>>>>>>>>> 29 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/29/weights.32-0.46.hdf5
------ TRAIN ACCURACY:  weights.32-0.46.hdf5  ------
0.891702203269
[[ 143    5    0    0    0    0    0    2    2    0    0    0    0    0
     0    0    0]
 [   1  196    0    0    0    0    0    9    0    0    0    0    0    0
     0    0    0]
 [   0    0 1591    0    0    0   39    0    0    0    1    0    0    0
     1    0    0]
 [   0    0    0 1903    0    0   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14    0  762    1  112    0    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  704   10    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    2 1283    0    0    0    0    0    0    0
     0    0    0]
 [   0    7    0    0    0    0    0  265   11    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    1    5  184    0    0    0    0    1
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  408    4    1    9   66
     0    9    1]
 [   0    0    0    0    0    0    0    1    0   22  335   10   16   12
     7   14   66]
 [   0    3    0    0    0    0    1    3    1   18   32  339    9   15
    45   10   28]
 [   1    1    1    0    0    0    0    2    0   15    1    1  559   12
     6   23    8]
 [   2    4    0    0    0    0    0    1    1   62    0    0    3  382
     0    2    1]
 [   0    5    1    0    0    0   22    4    4    1   15   12   10    1
   310    9   20]
 [   0    1    0    0    0    0    0    1    2   19   58    8   19   23
     5  315   42]
 [   0    2    0    0    0    3    0    2    4   21   52    7   10    8
     5   30  358]]
------ TEST ACCURACY:  weights.32-0.46.hdf5  ------
0.629126213592
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  6  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0 80  0  0  0 26  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  4  0 10  0 14  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 39  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  1  0  0  0  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 29  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  8  0 12  0  2  0  5]
 [ 0  0  0  0  0  0  1  0  0  7  0  4 10  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 17  1  3  6  4]
 [ 0  0  0  0  0  1  0  0  0 12  0  2  4  2  0  5  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 15  0  3  0  1  1]
 [ 0  0  0  0  0  0  0  0  0  1  6  0  8  0  1  0  4]
 [ 0  0  0  0  0  0  0  0  0  1  4  3 10  0  0  5  9]]

>>>>>>>>>>>>>> 30 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_smv_conv1d_10/30/weights.39-0.45.hdf5
------ TRAIN ACCURACY:  weights.39-0.45.hdf5  ------
0.865968494236
[[ 150    1    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   1  191    4    0    0    0    0   14    0    0    0    0    0    0
     1    1    0]
 [   0    0 1684    0    1    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    7 1917    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0  120    0  758    0   18    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0  239   54    4    7  978    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    2    0    0    0    0  284    1    0    0    0    0    0
     0    0    0]
 [   0    1    2    0    0    0    0   16  174    0    0    1    0    2
     0    0    1]
 [   0    1    0    0    0    0    0    1    0  442    1    3    3   38
     0    8    1]
 [   0    0    4    1    0    0    0    1    0   23  348   17   13    6
    11   18   45]
 [   0    0   10    2    1    0    2    1    1   26   35  309   14   15
    57   11   16]
 [   0    1    1    0    0    0    0    2    0   15    5    0  559   13
    14   17    7]
 [   2    1    1    0    0    0    0    1    0   80    0    2   10  359
     5    0    4]
 [   0    1   16    4    1    0    3    0    0    0   12   30    8    4
   321    7    7]
 [   0    0    0    0    0    0    0    0    1   29   59    5   28   20
    16  301   36]
 [   0    0    8    1    0    0    0    2    0   25   46    9   15    3
    22   31  348]]
------ TEST ACCURACY:  weights.39-0.45.hdf5  ------
0.71568627451
[[ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 23  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  5  0  0  0 37  0  0  0  0  0  0  0  0  0  0]
 [ 1  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 30  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 13  0  1  9  1  0  0  0]
 [ 0  0  1  0  0  0  1  0  0  4  0 14  3  0  1  1  1]
 [ 0  0  0  0  0  0  0  0  0  3  4  1 10  0  0  5  4]
 [ 0  0  0  0  0  0  0  0  0 15  0  0  0  4  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0 20  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  3  0  0  2  9  3]
 [ 0  0  0  0  0  2  0  0  0 16  0  2  0  4  0  0  0]]
[0.640625, 0.7238421955403087, 0.8092105263157895, 0.45016077170418006, 0.785234899328859, 0.8131067961165048, 0.793939393939394, 0.7732997481108312, 0.644927536231884, 0.6964856230031949, 0.7704081632653061, 0.86, 0.7161803713527851, 0.6854838709677419, 0.7569620253164557, 0.7158119658119658, 0.7794432548179872, 0.7206896551724138, 0.8045112781954887, 0.702819956616052, 0.6107142857142858, 0.5991735537190083, 0.7177914110429447, 0.7643207855973814, 0.7308641975308642, 0.7232142857142857, 0.7443820224719101, 0.8449367088607594, 0.629126213592233, 0.7156862745098039]
0.724111759019
0.0822238993862

Process finished with exit code 0

'''
