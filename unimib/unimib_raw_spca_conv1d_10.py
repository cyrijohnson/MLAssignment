import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import numpy as np
import cPickle as pickle
from keras.models import Model, load_model
from keras.initializers import Constant, TruncatedNormal
from keras.layers import Input, Dense, Conv1D, Flatten, Dropout, Activation, BatchNormalization
from keras.layers.merge import concatenate
from keras.optimizers import Adam
from keras.callbacks import ModelCheckpoint
import keras.backend as K
from keras import losses
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix

# Load SVD data + Signal Magnitude Vector

X_spca = pickle.load(open("data/X_unimib_spca.p", "rb"))
X_raw = pickle.load(open("data/X_unimib_raw.p", "rb"))
X = np.concatenate((X_spca, X_raw), axis=1)

y = pickle.load(open("data/y_unimib_raw.p", "rb"))

n_classes = 17


# Below builds 1D CNN.

for i in range(30):
    test = y.loc[y[1] == i+1]
    # print y_sub
    test_index = test.index.values
    # print len(test_index)

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index], y_values[test_index]
    y_train = np.eye(n_classes)[y_train - 1]
    print X_train.shape # (11188, 604)

    # input layer
    input_signal = Input(shape=(604, 1))
    print K.int_shape(input_signal)

    # define initial parameters
    b_init = Constant(value=0.0)
    k_init = TruncatedNormal(mean=0.0, stddev=0.01, seed=2018)

    # first feature extractor
    conv11 = Conv1D(16, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn11 = BatchNormalization()(conv11)
    actv11 = Activation('relu')(bn11)
    conv12 = Conv1D(32, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv11)
    bn12 = BatchNormalization()(conv12)
    actv12 = Activation('relu')(bn12)
    flat1 = Flatten()(actv12)

    # second feature extractor
    conv21 = Conv1D(16, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn21 = BatchNormalization()(conv21)
    actv21 = Activation('relu')(bn21)
    conv22 = Conv1D(32, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv21)
    bn22 = BatchNormalization()(conv22)
    actv22 = Activation('relu')(bn22)
    flat2 = Flatten()(actv22)

    # third feature extractor
    conv31 = Conv1D(16, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn31 = BatchNormalization()(conv31)
    actv31 = Activation('relu')(bn31)
    conv32 = Conv1D(32, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv31)
    bn32 = BatchNormalization()(conv32)
    actv32 = Activation('relu')(bn32)
    flat3 = Flatten()(actv32)

    # merge feature extractors
    merge = concatenate([flat1, flat2, flat3])

    # dropout & fully-connected layer
    do = Dropout(0.9, seed=2018)(merge)
    output = Dense(n_classes, activation='softmax', bias_initializer=b_init, kernel_initializer=k_init)(do)

    # result
    model = Model(inputs=input_signal, outputs=output)

    # summarize layers
    print(model.summary())

    new_dir = 'model/unimib_raw_spca_conv1d_10/' + str(i+1) + '/'
    if not os.path.exists(new_dir):
        os.makedirs(new_dir)

    fpath = new_dir + 'weights.{epoch:02d}-{val_acc:.2f}.hdf5'
    cp_cb = ModelCheckpoint(fpath, monitor='val_acc', verbose=1, save_best_only=True, mode='auto', period=1)

    adam = Adam(lr=0.001)
    model.compile(loss=losses.categorical_crossentropy, optimizer=adam, metrics=['accuracy'])
    model.fit(np.expand_dims(X_train, axis=2), y_train, batch_size=64, epochs=50, verbose=2, validation_split=0.10,
              callbacks=[cp_cb], shuffle=True)

    del model
    K.clear_session()


# Below calculates average test data accuracy (LOSO CV).

acc = []

for i in range(30):
    test = y.loc[y[1] == i+1]
    test_index = test.index.values

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index] - 1, y_values[test_index] - 1

    print "\n>>>>>>>>>>>>>>", str(i+1), "-fold <<<<<<<<<<<<<<<<"
    path_str = 'model/unimib_raw_spca_conv1d_10/' + str(i+1) + '/'
    for path, dirs, files in os.walk(path_str):
        dirs.sort()
        files.sort()
        top_acc = []
        top_acc.append(files[-1])
        files = top_acc
        for file in files:
            print "========================================"
            print os.path.join(path, file)
            model = load_model(os.path.join(path, file))
            pred = model.predict(np.expand_dims(X_train, axis=2), batch_size=32)
            print "------ TRAIN ACCURACY: ", file, " ------"
            print accuracy_score(y_train, np.argmax(pred, axis=1))
            print confusion_matrix(y_train, np.argmax(pred, axis=1))
            pred = model.predict(np.expand_dims(X_test, axis=2), batch_size=32)
            print "------ TEST ACCURACY: ", file, " ------"
            print accuracy_score(y_test, np.argmax(pred, axis=1))
            print confusion_matrix(y_test, np.argmax(pred, axis=1))

            del model
            K.clear_session()

    acc.append(accuracy_score(y_test, np.argmax(pred, axis=1)))

print acc
print np.mean(acc)
print np.std(acc)

'''
-----
[0.6875, 0.7598627787307033, 0.8388157894736842, 0.4533762057877814, 0.7348993288590604, 0.7864077669902912, 0.7818181818181819, 0.8765743073047859, 0.6932367149758454, 0.744408945686901, 0.7066326530612245, 0.794, 0.7586206896551724, 0.7043010752688172, 0.7746835443037975, 0.7051282051282052, 0.7944325481798715, 0.7517241379310344, 0.7819548872180451, 0.7917570498915402, 0.5392857142857143, 0.6818181818181818, 0.7791411042944786, 0.7397708674304418, 0.7333333333333333, 0.8035714285714286, 0.8370786516853933, 0.8765822784810127, 0.6776699029126214, 0.8088235294117647]
0.746573660083
0.0856656619345
-----

/usr/bin/python2.7 /mnt/0cdd1a7e-3686-4cf7-9055-145eb5fe70f3/hcilab/OSS/electronicsletters2018/unimib/unimib_raw_spca_conv1d_10.py
/home/hcilab/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.

>>>>>>>>>>>>>> 1 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/1/weights.46-0.52.hdf5
------ TRAIN ACCURACY:  weights.46-0.52.hdf5  ------
0.945025028541
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  206    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1681    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1911    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  871    0   10    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  718    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    7 1274    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  288    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  197    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    3  498    3    1    2   10
     0    0    0]
 [   0    0    0    0    1    2    0    1    0   30  435    8    2    4
     2    2    7]
 [   0    0    0    0    0   11    1    8    0   14   17  415    4    6
     9   11   15]
 [   0    0    0    0    3    0    0    3    0    3    9    7  601   10
     0    4    2]
 [   0    0    0    0    0    3    0    0    0   61    2    1    2  396
     1    1    3]
 [   0    0    2    0    3    7    0    6    0    0    9   44    4    1
   333    8    2]
 [   0    0    0    0    1    0    0    0    1   26   46    5   14    7
     2  358   33]
 [   0    0    1    0    0    3    0    0    0   12    9   18    7   13
     2   19  432]]
------ TEST ACCURACY:  weights.46-0.52.hdf5  ------
0.6875
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 30  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 28  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 20  0  0  0 22  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  2  0  0  0  2  2  1  0  0  0  2  2]
 [ 0  0  0  0  0  0  0  0  0  2  4  1  3  1  0  1  5]
 [ 0  0  0  0  0  3  0  0  0  0  0  0  0  0  0  6  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  4]
 [ 0  0  0  0  0  1  0  0  0  0  0  1  0  0  2  8  2]
 [ 0  0  0  0  0  2  0  0  0  0  3  1  0  1  2  5  1]
 [ 0  0  0  0  0  2  0  0  0  2  0  0  0  9  7  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  2  1  0  1  1  1 10]]

>>>>>>>>>>>>>> 2 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/2/weights.50-0.51.hdf5
------ TRAIN ACCURACY:  weights.50-0.51.hdf5  ------
0.948248122989
[[ 146    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1595    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1911    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  878    1    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    5 1270    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  286    1    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0  195    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    2  473    3    7    4   19
     0    0    0]
 [   0    0    0    1    0    1    0    0    0   16  438    6   10    8
     4    4    0]
 [   0    0    0    1    0    8    1    6    1   15   22  413    3    7
     8    5   12]
 [   0    0    0    0    3    0    0    2    0    2    9   11  584    5
     0    3    2]
 [   0    0    0    0    0    0    0    0    0   46    3    3    0  396
     0    3    1]
 [   0    0    0    0    2    1    1    7    0    1   10   48   11    0
   322    2    4]
 [   0    0    0    0    0    0    0    0    1   19   42    5   16   11
     0  359   33]
 [   0    0    1    1    0    3    0    0    0    7   10   17    6   16
     4   20  422]]
------ TEST ACCURACY:  weights.50-0.51.hdf5  ------
0.759862778731
[[  7   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  1   9   0   0   0   0   0   1   0   0   0   0   0   0   0   1   0]
 [  0   0 140   0   3   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  37   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  29   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   1   1  47   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   1   8   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  18   0   0   0   3   0   0   0]
 [  0   0   0   0   0   2   0   0   0   0   3   1  17   0   0   0   0]
 [  0   0   0   0   0   0   0   3   0   0   1  12   3   1   1   3   0]
 [  0   0   0   0   0   1   0   0   0   0   0   1  36   1   0   1   0]
 [  0   0   0   0   0   0   2   0   0  15   0   0   9   6   0   0   0]
 [  0   0   0   0   0   5   0   0   0   0   1   3   0   1  10   5   0]
 [  0   0   0   0   0   0   0   0   0   3   4   2  12   2   0   2   2]
 [  0   0   0   0   0   1   0   0   0   0   0   4  15   0   0   5   2]]

>>>>>>>>>>>>>> 3 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/3/weights.33-0.53.hdf5
------ TRAIN ACCURACY:  weights.33-0.53.hdf5  ------
0.938693642627
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    2    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1710    0    5    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1912    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  866    0   17    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    7    4    3 1264    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  284    1    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    1  195    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    1  473    1    5    5   22
     0    6    2]
 [   0    0    0    0    0    0    0    1    0   16  419    4   26    4
     2   27    0]
 [   0    0    1    0    0    0    0    8    0   11   23  417    7    6
    14   13   16]
 [   0    0    0    0    3    0    0    2    0    0    6    9  612    9
     0    5    1]
 [   0    0    0    0    0    0    0    0    0   61    9    1    1  380
     2   14    3]
 [   0    0    0    0    5    1    0    7    0    1    5   33    6    0
   345   20    4]
 [   0    1    0    0    0    0    0    0    1   17   33    5   23    5
     3  387   28]
 [   0    0    4    0    0    0    0    2    0    5   10   19    7    8
     9   37  426]]
------ TEST ACCURACY:  weights.33-0.53.hdf5  ------
0.838815789474
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 73  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  2  0 37  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  0  5  0  4  0]
 [ 0  0  0  0  0  0  0  4  0  0  6  0  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  8  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 13  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  0 12  0]
 [ 0  2  0  0  0  0  0  0  0  0  0  0  1  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  4  0]]

>>>>>>>>>>>>>> 4 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/4/weights.41-0.55.hdf5
------ TRAIN ACCURACY:  weights.41-0.55.hdf5  ------
0.942670157068
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1716    6    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1931    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    1  879    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11   32    0    7 1247    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  284    1    0    0    0    0    0
     0    0    1]
 [   0    0    0    0    0    0    1    0  190    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    3    1  485    4    1    0   25
     0    1    2]
 [   0    0    0    0    0    0    0    0    0   18  425   10   16    8
     4    7    4]
 [   0    0    0    1    0    1    0    6    0    8   18  415    7    8
    19    5   15]
 [   0    0    0    0    3    0    0    2    0    3    6    8  606   10
     0    1    4]
 [   0    0    0    0    0    0    0    0    0   40    8    2    1  407
     1    3    5]
 [   0    0    0    0    1    0    1    5    0    0    7   52    5    0
   337   10    3]
 [   0    0    0    0    0    0    0    1    0   10   41    8   24   12
     2  358   41]
 [   0    0    0    0    0    0    0    0    0    2    4   22    7   13
     5   20  439]]
------ TEST ACCURACY:  weights.41-0.55.hdf5  ------
0.453376205788
[[ 1  2  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  0  0  7  0  0  0  3  0  0  0  0  0  0]
 [ 0  0 54  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  6  0 10  0  5  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 10  0  0  0  0 11  0  4  0  1  1  0]
 [ 0  1  0  0  0 14  5  0  0  2  1  0  0  4  0  0]
 [ 0  0  0  2  0  0  3  1  0  0  1  0  1  2  0  0]
 [ 0  0  0  0  0  0  1  0  0  1  3  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  1  4  0  3  0  8  0]
 [ 0  0  0  0  1  0  0  0  0  0 13  3  0  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 18  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  8  7  0  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  6  2  0  2  1  0]
 [ 0  0  0  0  0  0  0  0  3  1  1  1  7  2  1  0]
 [ 0  0  0  0  0  0  0  0  3  4  2  8  3  0  2  0]]

>>>>>>>>>>>>>> 5 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/5/weights.15-0.51.hdf5
------ TRAIN ACCURACY:  weights.15-0.51.hdf5  ------
0.901246404602
[[ 145    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  189    2    0    0    0    1    8    0    0    0    0    0    0
     2    0    0]
 [   0    0 1708    0    3    1    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1913    0    1    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   40    0  801    2   59    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    0  724    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   20    5    1    7 1259    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    1    0    0    0    1  272   11    1    0    1    0    0
     0    1    1]
 [   0    0    0    0    0    0    1    6  190    1    0    1    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    3  448    4    1    7   38
     0    3    7]
 [   0    0    1    1    1    1    1    3    0   32  350   40   28   12
     8   12   12]
 [   0    0    0    1    1    2    3    7    4    9   13  387   17    9
    23    3   26]
 [   0    0    0    0    3    0    0    4    0    3    4   16  594   13
     0    3    6]
 [   0    0    0    0    0    1    0    1    1   87    1    3    8  347
     4   15    6]
 [   1    0    4    0    3    1    3   16    0    0    8   51    5    2
   311    6   14]
 [   0    0    0    1    1    0    0    2    1   19   38   24   18   19
    18  307   50]
 [   0    2    2    0    0    3    3    1    0   13    7   36   10   15
     9   20  395]]
------ TEST ACCURACY:  weights.15-0.51.hdf5  ------
0.734899328859
[[ 6  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 10  0  0  0  0  1  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 66  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 19  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  6  7  2  0]
 [ 0  0  0  0  0  0  0  1  1  0  0  3  0  0  0  2  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  5  0  2  5  0  9]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0  3  3  0  0]
 [ 0  0  0  0  0  0  0  1  1  0  0  1  0  0  4  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  0  0  2  7  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  3  0  0  9  4]]

>>>>>>>>>>>>>> 6 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/6/weights.10-0.50.hdf5
------ TRAIN ACCURACY:  weights.10-0.50.hdf5  ------
0.88414473105
[[ 136   15    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  202    1    0    2    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1672    0   10    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1904    0    0   17    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   15    0  826    1   35    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    1    0
     0    0    0]
 [   0    0   13    7    3    7 1243    0    0    0    0    0    0    0
     1    0    0]
 [   0   11    0    0    3    0    1  233   24    1    1    2    0    0
     1    1    3]
 [   0    1    1    0    0    0    0    3  187    1    1    0    0    1
     0    0    0]
 [   0    2    0    0    0    0    0    1    3  424    2    5    6   51
     1    0   15]
 [   0    0    1    0    2    0    1    3    2   34  348   39   26    9
     6   18    7]
 [   0    0    1    0    0    1    2   11    3   15   14  370    6   10
    14   16   44]
 [   0    0    1    0    3    0    0    4    0    6    4   18  582   14
     2    3    1]
 [   0    5    0    0    3    0    1    1    1   85    2   10    4  338
     0    9    5]
 [   1    4    3    0   12    0    1    5    0    8   18   69    6    0
   274    5   10]
 [   0    0    1    1    0    0    0    1    6   26   56   27   25   20
    21  242   67]
 [   0    0    3    0    0    0    0    2    2   21   23   61    9   13
     8   28  346]]
------ TEST ACCURACY:  weights.10-0.50.hdf5  ------
0.78640776699
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 38  0  6  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 29  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  1  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3 12  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0 11  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 10  5  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  0  4]
 [ 0  0  0  0  1  0  0  0  0  0  0  0 22  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  7  0  0  6  0  4]
 [ 0  0  0  0  0  0  0  0  0  1  0  3  1  0  0  1 14]
 [ 0  0  0  0  0  0  0  0  0  0  0  6  0  0  0  1 11]]

>>>>>>>>>>>>>> 7 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/7/weights.34-0.52.hdf5
------ TRAIN ACCURACY:  weights.34-0.52.hdf5  ------
0.940040206276
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  210    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1686    0    3    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1933    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  877    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5   14    3    7 1262    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    2    0    2  282    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    0    0    0  191    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    3  451    3    1    6   49
     0    0    3]
 [   0    0    0    0    1    0    0    1    0   20  432    9    4   10
    10    6    3]
 [   0    0    0    0    1    3    1    6    0    6   14  410    2   16
    21   11   17]
 [   0    0    0    0    3    0    0    2    1    5   14   13  587   15
     0    3    0]
 [   0    0    0    0    0    1    0    0    0   27    5    0    0  419
     2    6    2]
 [   0    0    1    0    2    0    2    2    0    0    6   47    5    0
   350    9    2]
 [   0    0    0    0    1    0    0    0    1   19   37    8   18   14
     8  373   21]
 [   0    0    0    0    0    2    0    0    0    8   13   21    6   14
    14   31  413]]
------ TEST ACCURACY:  weights.34-0.52.hdf5  ------
0.781818181818
[[ 4  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0 45  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 13  0  0  0]
 [ 0  0  0  0  0  0  2  0  0  7  0  0  0  1  5  0]
 [ 0  0  0  0  0  0  0  0  0  8  3  0  0  5  0  2]
 [ 0  0  0  1  0  0  0  0  0  2  0 10  0  0  2  3]
 [ 0  0  0  0  0  0  0  0  6  0  0  0 15  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  8  5]
 [ 0  0  0  0  0  0  1  0  0  0  0  0  0  0  7  4]]

>>>>>>>>>>>>>> 8 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/8/weights.29-0.51.hdf5
------ TRAIN ACCURACY:  weights.29-0.51.hdf5  ------
0.93511517496
[[ 151    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  213    0    0    3    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1657    0   12    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1921    1    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  883    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    6    5    6 1251    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    2    0    0  277    2    0    0    0    0    0
     0    2    0]
 [   0    0    0    0    0    0    1    2  184    0    0    0    0    0
     0    0    1]
 [   0    0    0    0    0    0    0    0    3  454    3    5    7   28
     0    1    2]
 [   0    0    0    0    0    0    0    0    0   18  424    9   21    2
     1   15    4]
 [   0    0    0    0    0    3    1    6    0   10   18  409   11    6
    10   16   19]
 [   0    0    0    0    3    0    0    1    0    0    5    7  608   11
     0    1    0]
 [   0    0    0    0    0    0    0    0    0   49    5    0    1  388
     1   16    5]
 [   0    0    1    0    5    0    1    4    0    1   15   43    6    0
   325    8   11]
 [   0    0    0    1    0    0    0    0    0   19   36    6   29   10
     7  367   28]
 [   0    0    1    0    0    2    0    0    0   11    9   29    8   13
    10   27  403]]
------ TEST ACCURACY:  weights.29-0.51.hdf5  ------
0.876574307305
[[ 1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 54  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 10  2  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0 12  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 24  1  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0 16  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  3  8  0  0  1  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 25  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0 15  0  0  0]
 [ 0  1  0  0  0  0  0  2  2  0  1  2  0  0  6  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  1  0  0  0  4  4]
 [ 0  0  0  0  0  0  0  0  0  1  0  5  2  4  1  1  7]]

>>>>>>>>>>>>>> 9 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/9/weights.16-0.49.hdf5
------ TRAIN ACCURACY:  weights.16-0.49.hdf5  ------
0.90675354407
[[ 151    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  204    0    0    0    0    0    6    0    0    0    0    0    0
     0    0    1]
 [   0    0 1679    4    4    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1923    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   18    1  851    1   30    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5   21    0    7 1244    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    1    0    1  269    8    1    2    1    0    0
     0    1    1]
 [   0    1    0    0    0    0    1    2  181    1    0    0    0    0
     0    3    1]
 [   0    0    0    0    0    0    0    1    1  483    2    1    6    7
     0    1    7]
 [   0    0    1    3    0    1    1    0    0   38  360   11   27    8
     7   11   14]
 [   0    0    1    0    2    5    0    5    1   18   31  363    9    4
    26    3   38]
 [   0    0    1    0    3    0    0    2    0    5    7   11  583   10
     0    1    1]
 [   0    0    0    0    0    1    0    0    0  124    5    0   12  307
     1    5   18]
 [   0    1    3    0    1    6    2    2    0    4   20   56   10    0
   296    5   15]
 [   0    1    2    1    1    0    0    0    1   25   40    7   30   14
    10  279   71]
 [   0    0    2    1    0    3    0    0    0   13    6   37    7   13
     8   11  404]]
------ TEST ACCURACY:  weights.16-0.49.hdf5  ------
0.693236714976
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  1  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 50  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 60  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0 17  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  1  0  0 46  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0  0  7  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  7  0  3  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  0  6  0  3  2]
 [ 0  0  0  0  0  0  0  3  0 13 11  0  0  0  0  2  0]
 [ 0  0  0  0  1  0  0  0  0  0  7  0  0  0 12  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0  0 36  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  1  0  0  3  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  5  8  5  1  1  7]
 [ 0  0  0  0  0  0  0  0  0 14  0  7  1  0  0  6  1]]

>>>>>>>>>>>>>> 10 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/10/weights.37-0.48.hdf5
------ TRAIN ACCURACY:  weights.37-0.48.hdf5  ------
0.938820038401
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  215    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1701    0    4    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1931    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  879    5    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  729    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0    1    0 1291    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  293    1    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    2  184    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    3  423    4   23   20   26
     3    0    5]
 [   0    0    0    0    0    0    0    2    0    9  439    5   33    3
     3    3    2]
 [   0    0    0    0    0    1    0    8    0    8   26  395   23    4
    18    6   15]
 [   0    0    0    0    3    0    0    2    0    1   12    8  606    6
     0    2    3]
 [   0    0    0    0    0    1    0    0    0   40   12    6    5  397
     0    2    4]
 [   0    0    0    0    1    1    1    7    1    0   13   52    4    2
   327    3    8]
 [   0    2    0    0    0    0    0    0    2   12   43    8   27    5
     0  363   39]
 [   0    0    0    0    0    2    0    2    0    2   10   23    7   13
     4   23  431]]
------ TEST ACCURACY:  weights.37-0.48.hdf5  ------
0.744408945687
[[32  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 51  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0 13  0 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 17  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  7 22  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  3  9  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0 14  0  0  7  1  0  0  0]
 [ 0  0  0  0  0  0  0  0 10  0  0  0  2  0  0]
 [ 0  0  0  1  0  0  0  0  5  1  1  1  0  0 13]
 [ 0  0  0  0  0  0  0  0  0  0 18  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  1  0  0 11  0  0  2]
 [ 0  1  0  0  0  0  0  0  0  0  0  0 13  0  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0  3  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0 17]]

>>>>>>>>>>>>>> 11 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/11/weights.40-0.53.hdf5
------ TRAIN ACCURACY:  weights.40-0.53.hdf5  ------
0.93558309166
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1713    0    2    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1902    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11    0  842    0   25    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7   12    4    7 1237    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  280    7    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0  194    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    2  459    6    4    4   35
     0    0    1]
 [   0    0    0    0    0    0    0    1    0   11  436    7   17    7
     3    4    5]
 [   0    0    0    0    1    5    0    6    0   13   24  401    7   10
    25    4   16]
 [   0    0    0    0    3    0    0    2    0    2   12   12  589   11
     1    4    1]
 [   0    0    0    0    0    0    0    0    0   35    9    0    1  411
     2    2    5]
 [   1    0    0    0    3    1    0    8    0    0   13   47    5    0
   331    4    3]
 [   0    0    0    0    1    0    0    0    1   12   50   10   19    8
     8  338   52]
 [   0    0    0    1    0    2    0    0    0    5   13   28    3   14
     8   14  430]]
------ TEST ACCURACY:  weights.40-0.53.hdf5  ------
0.706632653061
[[ 5  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 23  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 82  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 37  0  6  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 20  0  0  0 37  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  0  4  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  4  0  2  0  0 12]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  0 19  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  5  0  0  0  8  0  3  1]
 [ 0  0  0  0  0  0  0  2  0  0  3  0  0  0 13  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  0  2  0  2  0  3]
 [ 0  0  0  0  3  0  0  0  0  0  5  0  0  5  0  0  3]]

>>>>>>>>>>>>>> 12 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/12/weights.26-0.52.hdf5
------ TRAIN ACCURACY:  weights.26-0.52.hdf5  ------
0.932659036465
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  206    0    0    1    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1554    0    1    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1911    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11    0  860    0   18    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14    3    1    7 1263    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    0    0  289    5    0    0    0    0    0
     1    0    0]
 [   0    0    1    0    0    0    0    0  196    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    2  460    3    1    5   36
     1    1    3]
 [   0    0    0    1    1    0    0    0    0   15  436   10    6    6
     7    1   13]
 [   0    0    0    0    0    1    0    8    0   11   32  405    4    7
    19    3   24]
 [   0    0    0    0    3    0    0    0    0    3   11   10  596   14
     0    0    4]
 [   0    0    0    0    0    0    0    0    0   53    3    0    3  395
     2    4    4]
 [   0    0    0    0    5    0    0    8    0    0   14   39   10    2
   331    4   11]
 [   0    0    0    0    0    0    0    0    1   12   57    9   14   13
     7  319   64]
 [   0    0    0    1    0    2    0    0    0    5   18   16   10   16
    11    6  430]]
------ TEST ACCURACY:  weights.26-0.52.hdf5  ------
0.794
[[  6   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  2   3   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 165   0  17   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  61   0   0  13   0   0   0   0   0   0   0   0   0]
 [  0   1   1   0  29   0   1   0   0   0   0   0   0   0   0   0]
 [  0   0   1   0   0  31   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  36   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   8   0   2   0   5   0   0   2]
 [  0   0   0   0   0   0   0   0   2   6   1   0   2   0   3   1]
 [  0   0   0   0   0   0   0   0   0   0   7   0   0   0   1   4]
 [  0   0   0   0   0   0   0   0   0  10   0  10   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  16   0   0   4]
 [  0   0   0   0   0   0   0   0   0   0   1   0   0   8   1   0]
 [  0   0   0   0   0   0   0   0   3   6   0   4   0   0   2   2]
 [  0   0   0   0   0   0   0   0   3   1   0   0   5   1   3   6]]

>>>>>>>>>>>>>> 13 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/13/weights.39-0.51.hdf5
------ TRAIN ACCURACY:  weights.39-0.51.hdf5  ------
0.93944181148
[[ 149    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  208    1    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1714    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1914    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  863    0   19    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    4   12    5 1249    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  279    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  195    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    3  488    2    6    2    2
     0    1    1]
 [   0    0    0    1    1    0    0    2    0   23  434    4   10    2
     1    9    6]
 [   0    0    0    0    0    3    0    9    0   17   22  404   11    0
     4   15   23]
 [   0    0    0    0    3    0    0    5    0    2   10    8  595    4
     0    5    4]
 [   0    0    0    0    0    0    0    0    0   84    6    1    4  373
     0    3    3]
 [   0    0    4    0    4    0    0   11    0    0   11   56    6    0
   316    3    7]
 [   0    1    0    0    1    0    0    0    0   26   39    2   21    3
     0  366   36]
 [   0    0    1    0    0    2    0    0    0   11   13   15    8    8
     1   17  436]]
------ TEST ACCURACY:  weights.39-0.51.hdf5  ------
0.758620689655
[[ 3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  1  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 57  0  0 11  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  1  0 42  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0  0 16  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  3  0  0  0  0  0  8]
 [ 0  0  1  0  0  0  0  0  0  0  3  0  0  0  0 11  3]
 [ 0  0  1  0  0  0  0  0  0  0  3 10  2  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  4  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  3  2  0  4  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  7  0  8  3]
 [ 0  0  0  0  0  0  0  0  0  0  7  0  2  0  0  0 13]]

>>>>>>>>>>>>>> 14 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/14/weights.46-0.53.hdf5
------ TRAIN ACCURACY:  weights.46-0.53.hdf5  ------
0.946223352926
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1683    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1930    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  871    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    1    3    4 1262    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  292    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0  194    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    3    1  480    3    4    1   23
     0    0    1]
 [   0    0    0    0    0    0    0    0    0   15  443    4   14    2
     1    9    5]
 [   0    0    0    1    0    0    0    7    0    5   25  425   10    2
     9    8   11]
 [   0    0    0    0    0    0    0    7    0    2   13    8  600    7
     0    2    2]
 [   0    0    0    0    0    0    0    0    0   41    6    2    3  416
     0    3    3]
 [   0    0    0    0    1    0    0    7    0    1   13   60    4    0
   320    7    1]
 [   0    0    0    0    0    0    0    0    1   14   47   14   16    9
     1  358   35]
 [   0    0    1    1    0    1    0    2    0    3   11   37    3   11
     6   19  428]]
------ TEST ACCURACY:  weights.46-0.53.hdf5  ------
0.704301075269
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  5  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 30  0 24  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 40  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0 48  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  3  1  5  0  0  0]
 [ 0  0  1  0  0  0  0  0  0  0 10  0  0  0  0  3  4]
 [ 0  0  0  0  0  0  0  0  0  0  2 12  0  0  0  6  3]
 [ 0  0  0  0  0  0  0  0  0  5  0  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  5  0  0 11  4  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4 10  1  0  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  7  0  0  0  1  3]]

>>>>>>>>>>>>>> 15 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/15/weights.49-0.53.hdf5
------ TRAIN ACCURACY:  weights.49-0.53.hdf5  ------
0.947872714487
[[ 144    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1689    1    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1896    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  901    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    5    0    7 1256    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  284    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    3  189    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    3    1  490    0    2    2   16
     0    2    1]
 [   0    0    0    0    0    0    0    0    0   17  436    6   11   13
     0    4    6]
 [   0    0    0    0    0    5    0    7    0   14   17  425    6    5
    12    7   14]
 [   0    0    0    0    2    0    0    2    0    4    7    7  608    9
     0    0    4]
 [   0    0    0    0    0    0    0    0    0   52    4    0    0  405
     0    5    3]
 [   0    0    0    0    2    0    0    5    0    2    9   32   11    1
   343    4    7]
 [   0    0    0    0    0    0    0    1    0   12   39    6   15   21
     2  366   38]
 [   0    0    0    1    0    2    0    5    0    3    2   20    5   30
     3   22  426]]
------ TEST ACCURACY:  weights.49-0.53.hdf5  ------
0.774683544304
[[ 4  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 88  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  6  0 10  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 55  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0 10  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  5  1  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  0  3  0  0  0]
 [ 0  0  0  0  0  3  1  0  0  0 11  0  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  3  5  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  6  0  0 10  1  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  6  0  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  6  8  0  0  2  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  1  2  4  0  0  1  5]
 [ 0  0  0  0  0  0  0  0  0  1  4  0  0  1  0  3  6]]

>>>>>>>>>>>>>> 16 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/16/weights.16-0.53.hdf5
------ TRAIN ACCURACY:  weights.16-0.53.hdf5  ------
0.909316110767
[[ 143    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  186    1    0    2    0    1    8    0    0    0    0    0    0
     0    0    0]
 [   0    0 1675    0    2    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7 1897    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   34    0  812    0   29    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   35    3    3    7 1217    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    1    0    0    0    0  257    9    1    1    0    0    0
     2    1    1]
 [   0    1    0    0    0    0    1    1  186    1    0    0    0    0
     1    1    1]
 [   0    0    0    0    0    0    0    0    3  431    2    4    8   57
     0    0    5]
 [   0    0    1    0    2    0    0    0    1   28  379   18   23   14
     5    7   14]
 [   0    0    0    0    1   10    0    7    1   12   20  386   12    9
    23    7   24]
 [   0    0    0    0    3    0    0    1    0    1    1   11  604   14
     0    1    4]
 [   0    1    1    0    0    1    0    0    0   53    4    3    3  385
     4    7    8]
 [   1    1    4    0    6    1    1    4    0    0   14   53    9    2
   311    4   12]
 [   0    0    0    0    0    0    0    1    1   13   42   17   30   16
    10  301   60]
 [   0    0    1    0    0    3    0    2    0    2   23   26    6   24
     7   22  392]]
------ TEST ACCURACY:  weights.16-0.53.hdf5  ------
0.705128205128
[[ 8  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 7  6  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 77  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 45  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 16  0  0  0 43  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 12  0  0  1  7  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  5  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 14  0  0  3  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  4  0  0  0 10  2]
 [ 0  0  0  0  0  0  0  0  0  2  0  3  0  1  4  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 10  0  0  0  1  0  0  3]
 [ 0  1  0  0  0  0  0  0  0  0  0  1  5  0  2  0  2]
 [ 0  0  0  0  0  0  0  0  0 12  0  0  8  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  4 10  0  0  0  0  4  8]]

>>>>>>>>>>>>>> 17 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/17/weights.49-0.51.hdf5
------ TRAIN ACCURACY:  weights.49-0.51.hdf5  ------
0.945682944091
[[ 149    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  201    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1635    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1903    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  885    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  727    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0    4    6 1258    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  282    1    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0  192    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    3  464    1    5    0   40
     0    1    1]
 [   0    0    0    0    0    1    0    1    0   16  437   11    1   18
     2    3    5]
 [   0    0    0    0    0    8    0    7    0   10   23  418    6    4
    10    6   13]
 [   0    0    0    0    3    0    0    0    0    1   15   13  578   20
     0    5    6]
 [   0    0    0    0    0    0    0    0    0   30    6    0    0  424
     0    2    2]
 [   0    0    2    0    2    0    1    7    0    1    6   36    4    2
   337    6    7]
 [   0    0    0    0    0    0    0    0    2    9   40   13    9   14
     0  370   38]
 [   0    0    1    0    0    2    0    0    0    4   17   26    4   13
     6   14  430]]
------ TEST ACCURACY:  weights.49-0.51.hdf5  ------
0.79443254818
[[  4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  1  12   0   0   0   0   0   2   0   0   0   0   0   0   0   0   0]
 [  0   0 103   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  81   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  28   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  19   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  50   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0  13   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   6   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   0   3   2   0   0   0]
 [  0   0   0   0   0   0   0   0   0   6   7   1   0   0   0   0   2]
 [  0   0   0   0   0   0   0   0   0   0   6  14   0   1   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  17   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   4   0   0   6   7   0   3   0]
 [  0   0   0   0   0   0   0   0   0   0   0   5   0   0  13   0   5]
 [  0   0   0   0   0   0   0   0   0   3   0   0   0   2   2  11   0]
 [  0   0   0   0   0   0   0   0   0   0   5   1   0   0   2   2   7]]

>>>>>>>>>>>>>> 18 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/18/weights.17-0.52.hdf5
------ TRAIN ACCURACY:  weights.17-0.52.hdf5  ------
0.906976744186
[[ 136    2    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  200    0    0    1    0    1    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1720    1   11    1    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1918    1    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   34    0  798   12   51    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    3  727    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8   31   17    7 1230    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    1    0    0    0    1  269    6    0    0    2    0    0
     1    1    0]
 [   0    0    0    0    0    0    1    4  182    0    1    0    0    0
     0    0    1]
 [   0    0    0    0    0    0    0    0    2  442    9    0   15   41
     0    0    6]
 [   0    0    0    1    0    0    0    1    0   27  405   12   19    7
     6   11    4]
 [   0    0    1    0    0    3    1    6    0    5   29  404   11   10
    10    6   23]
 [   0    0    0    0    3    1    0    0    0    1    6   12  605   13
     0    1    1]
 [   0    1    0    0    0    0    0    0    0   73   11    0    5  375
     2    2    2]
 [   0    0    1    0    1    0    4    4    0    1   21   75    5    2
   294    7    8]
 [   0    0    0    0    1    0    0    0    1   23   61    6   23   17
     6  310   55]
 [   0    0    0    0    0    4    0    0    0    8   19   37   10   19
     4   22  398]]
------ TEST ACCURACY:  weights.17-0.52.hdf5  ------
0.751724137931
[[12  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  8  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 56  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  5  0 11  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  2  0 29  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 11  2  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  1  9  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  7  0  0  1  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  3  0  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  1  0 10  0  1  0  2  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  9  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0 11  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  2  3  0  2]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  2  3  3]
 [ 0  0  0  0  0  0  0  0  0  8  1  0  2  0  0  2]]

>>>>>>>>>>>>>> 19 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/19/weights.48-0.52.hdf5
------ TRAIN ACCURACY:  weights.48-0.52.hdf5  ------
0.94715341156
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1724    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1914    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  904    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    2    1 1290    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  288    1    0    0    0    0    0
     1    0    0]
 [   0    1    0    0    0    0    0    0  191    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    3  495    2    1    1   16
     0    1    1]
 [   0    0    0    1    0    1    0    0    0   18  438    3   18    6
     0    2    9]
 [   0    0    0    0    0    3    1    6    0   18   21  421    6    7
    16    3   15]
 [   0    0    0    0    3    0    0    2    0    5   10    7  601    6
     0    7    3]
 [   0    0    0    0    0    0    0    0    0   55    5    0    0  405
     1    7    1]
 [   0    0    0    0    7    2    1    4    0    2    9   39   11    0
   327   10    7]
 [   0    0    0    0    1    0    0    0    1   15   39    2   25    9
     3  364   45]
 [   0    0    0    0    0    2    0    0    0    5    5   14    7   15
     5    8  461]]
------ TEST ACCURACY:  weights.48-0.52.hdf5  ------
0.781954887218
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  9  0  5  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0 30  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  5  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  0  1  0  9  3]
 [ 0  0  0  0  0  0  0  2  0  0  0  0  0  0  3  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  6  0  0  0  9  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  0  0  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  6  4]]

>>>>>>>>>>>>>> 20 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/20/weights.31-0.53.hdf5
------ TRAIN ACCURACY:  weights.31-0.53.hdf5  ------
0.938373121132
[[ 142    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  198    0    0    0    0    0    4    0    0    0    0    0    0
     0    0    0]
 [   0    0 1576    0    4    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1912    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  863    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  728    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    7 1266    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  287    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    2  189    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    3  469    3    3    2   31
     0    1    1]
 [   0    0    0    0    1    0    0    0    0   22  434   10    8    6
     7   11    2]
 [   0    0    0    0    0    7    2    9    0   16   20  406    3    9
    20   15   12]
 [   0    0    0    0    3    0    0    0    0    3   11   11  597   12
     0    5    1]
 [   0    0    0    0    0    0    0    0    0   48    4    0    0  408
     2    5    2]
 [   0    0    0    0    2    1    3    7    0    1    7   37    5    0
   347   10    5]
 [   0    0    0    0    1    0    0    0    0   17   38   10   12   12
     4  380   25]
 [   0    0    0    0    0    2    0    0    0   10   12   30    5   13
     3   39  411]]
------ TEST ACCURACY:  weights.31-0.53.hdf5  ------
0.791757049892
[[  6   4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  5   3   0   0   0   0   0   2   0   0   0   0   0   0   3   0   0]
 [  0   0 147   0   2   0   7   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  69   0   0   2   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  25   0   4   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  18   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   2  11   1   0  36   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   8   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   4   4   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  11   0   0   0   5   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   2   8   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   1   3   0   0   0   2   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0  18   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   5   0   0   1   9   0   0   0]
 [  0   0   0   0   0   0   0   1   0   0   2   0   0   0   4   2   0]
 [  0   0   0   0   0   0   0   0   0   0   8   3   0   0   0   1   2]
 [  0   0   0   0   0   0   0   0   0   0   4   3   0   0   0   1   1]]

>>>>>>>>>>>>>> 21 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/21/weights.14-0.52.hdf5
------ TRAIN ACCURACY:  weights.14-0.52.hdf5  ------
0.902184318162
[[ 144    1    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   3  186    1    0    3    0    0   11    0    0    0    0    0    0
     0    0    1]
 [   0    0 1719    0   15    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1920    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  882    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  724    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   28   10   23    7 1210    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    1    0    0  276    5    0    0    0    0    0
     0    2    0]
 [   0    1    1    0    0    0    0    7  174    0    0    0    0    0
     0    2    1]
 [   0    0    0    0    0    0    0    2    3  437   10    1    6   37
     0    9   11]
 [   0    0    1    1    2    0    0    2    1   17  421    6    6    1
     2   30   12]
 [   0    0    1    0    0    2    2   13    1    8   62  293    9    7
    29   35   47]
 [   0    0    0    0    1    0    0    6    0    0   21   13  582    5
     0    8    6]
 [   0    2    1    0    1    1    0    2    0   62   16    0    3  351
     1   19   14]
 [   0    0    0    0    7    0    0   13    0    0   21   32    6    0
   305   23   18]
 [   0    2    0    0    1    0    0    2    1   16   55    1   19    8
     6  346   44]
 [   0    0    2    0    4    2    0    0    0    9   29    6    9    4
     5   60  397]]
------ TEST ACCURACY:  weights.14-0.52.hdf5  ------
0.539285714286
[[ 7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  3  0  0  1  0  0  5  1  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 10  3  0 48  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  8  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 22  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  9  0 36  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  4  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  0  0  0  5  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  6  0  0  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0 14  3  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  2 16  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  1  0  0  4  0  3  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  3  1  0  0  2  2]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  7  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  1  2  3]]

>>>>>>>>>>>>>> 22 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/22/weights.45-0.54.hdf5
------ TRAIN ACCURACY:  weights.45-0.54.hdf5  ------
0.94515814654
[[ 135    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  205    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1674    0    2    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1923    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  862    0   12    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  720    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0    0    4 1266    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  279    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  182    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    3  465    4    0    3   30
     0    1    1]
 [   0    0    0    0    0    0    0    1    0   16  432    0   14    6
     4   10    7]
 [   0    0    0    0    0    3    0    6    1   11   31  374    7    5
    18   17   25]
 [   0    0    0    0    3    0    0    2    0    1   14   10  591   10
     0    5    2]
 [   0    0    0    0    0    0    0    0    0   42    6    0    1  405
     0    6    3]
 [   0    0    0    0    2    1    1    5    2    0    9   31    5    0
   348    7    6]
 [   0    0    0    0    1    0    0    0    1   17   42    2   12    8
     1  364   42]
 [   0    0    0    1    0    1    0    0    0    3    9    8    6   10
     6   25  443]]
------ TEST ACCURACY:  weights.45-0.54.hdf5  ------
0.681818181818
[[ 5  6  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 2  6  0  0  1  0  0  0  0  0  0  0  0  0  0  0  2]
 [ 0  0 59  0  2  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 62  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 36  3  5  0  0  0  0  0  0  0  0  0  2]
 [ 0  0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  7  0  0 41  0  0  0  0  0  0  0  0  0  0]
 [ 1  2  0  0  0  0  0 10  0  0  0  0  1  0  0  0  2]
 [ 0  2  0  0  0  0  0 14  0  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  8]
 [ 0  0  0  0  0  0  0  0  0  8  7  0  0  0  3  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  2  0  0  8 12  3]
 [ 0  0  0  0  0  0  0  0  0  2  0  0 21  0  0  0  0]
 [ 0  3  0  0  0  0  0  2  0  9  0  0  2  1  0  1  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  6  5  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  4 19  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  4 15]]

>>>>>>>>>>>>>> 23 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/23/weights.48-0.53.hdf5
------ TRAIN ACCURACY:  weights.48-0.53.hdf5  ------
0.94495412844
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  208    1    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1721    0    2    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1910    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  873    0   19    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    1    3    6 1265    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  281    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0  193    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    1  486    3    1    3   13
     0    0    0]
 [   0    0    0    0    0    0    0    0    0   20  442   11   16    3
     3    3    4]
 [   0    0    0    1    0    2    0    4    0   18   31  435    2    0
     8    6   10]
 [   0    0    0    0    3    0    0    2    0    0   16   11  609    4
     0    1    0]
 [   0    0    0    0    0    0    0    0    0   55    5    2    1  402
     0    2    2]
 [   0    0    0    0    2    5    0    8    0    0   11   48    0    0
   342    8    1]
 [   0    0    0    0    0    0    0    0    1   14   48   21   10   12
     9  360   23]
 [   0    0    0    0    0    3    0    0    0   11    6   43    6   11
     1   20  419]]
------ TEST ACCURACY:  weights.48-0.53.hdf5  ------
0.779141104294
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 15  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 74  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 25  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0 14  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  0 17  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  7  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  2  0  0  6  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  0  0  4  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  3  1  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  6  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  0  0  0  1  7  0]
 [ 0  0  0  0  0  0  0  0  0  0 10  1  0  1  2  0  0]]

>>>>>>>>>>>>>> 24 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/24/weights.42-0.53.hdf5
------ TRAIN ACCURACY:  weights.42-0.53.hdf5  ------
0.943727598566
[[ 131    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  197    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1559    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1916    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  840    0   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    0    0    7 1249    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  277    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    1  188    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    1  461    2    6    2   22
     0   11    0]
 [   0    0    0    1    0    0    0    0    2   22  428   14    9    5
     3    5    7]
 [   0    0    0    0    0    5    0    5    1    7   15  433    5    3
    16    9   13]
 [   0    0    0    0    3    0    0    0    0    5    4    8  611    8
     0    1    0]
 [   0    0    0    0    0    0    0    0    0   53    2    3    1  404
     0    4    2]
 [   0    0    0    0    1    1    0    5    0    0    7   41    0    0
   336    9    9]
 [   0    0    0    0    0    0    0    0    2   16   41   10    9    9
    10  359   38]
 [   0    0    0    1    1    2    0    0    0    9   10   27    4   14
     2   23  424]]
------ TEST ACCURACY:  weights.42-0.53.hdf5  ------
0.73977086743
[[  4   8   0   0   0   0   0   2   0   0   0   1   0   4   2   0   0]
 [  1  10   0   0   0   0   0   2   0   0   0   0   2   0   1   3   0]
 [  0   0 179   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  69   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  60   2   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  27   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  12   0   0  44   0   0   0   0   0   0   0   0   0   0]
 [  0   7   0   0   0   0   0   1   1   0   0   1   2   2   0   4   0]
 [  0   0   0   0   0   0   0   5   2   0   0   0   0   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0  16   0   0   2   5   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   6   0   9   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   3   0   8   2   1   0   0   0]
 [  0   0   0   0   0   0   0   0   0   2   0   0  18   1   0   0   0]
 [  0   0   0   0   0   0   0   0   0  12   0   0   0   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0  15   5   0   4   0   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0  14   0   0   1   4]
 [  0   0   0   0   0   0   0   0   0   0   3  10   3   0   0   1   0]]

>>>>>>>>>>>>>> 25 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/25/weights.46-0.50.hdf5
------ TRAIN ACCURACY:  weights.46-0.50.hdf5  ------
0.943427767024
[[ 151    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1683    0    2    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1917    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  885    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  725    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    5    3    6 1257    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  288    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0  191    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  470    0    8    5   28
     0    0    1]
 [   0    0    0    1    0    0    0    1    1   21  432    6   10    1
     4    5   10]
 [   0    1    0    1    1    3    1    3    1    5   13  416    6    5
    36    4   16]
 [   0    0    0    0    2    0    0    1    0   13    7   11  587    4
     0    4    4]
 [   0    4    0    0    0    0    0    0    1   62    2    2    4  379
     1    2    6]
 [   0    1    0    0    0    0    0   10    0    1    1   32   13    0
   341    7   13]
 [   0    0    0    0    0    0    0    0    1    1   36    6   32    1
     2  363   43]
 [   0    0    2    0    0    0    0    2    0   11    3   32    4   10
    12   11  426]]
------ TEST ACCURACY:  weights.46-0.50.hdf5  ------
0.733333333333
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  1 46  0  4  0  1  0  0  0  0  0  0  0  0  1  0]
 [ 0  0  5 62  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0 52  0  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  0  0  0  4  1  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  5  3  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  3  2  3  0  4  0]
 [ 0  0  0  0  0  0  0  3  0  0  6  0  0  2  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 28  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  0 13  0  2  1]
 [ 0  0  0  0  2  0  0  2  0  0  5  1  0  0  3  2  0]
 [ 0  0  0  0  0  0  0  0  0 11 11  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1 20]]

>>>>>>>>>>>>>> 26 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/26/weights.45-0.53.hdf5
------ TRAIN ACCURACY:  weights.45-0.53.hdf5  ------
0.94735461303
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1707    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1926    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  880    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    0    1    5 1263    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  290    2    0    0    1    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0  199    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    1  479    2    2    4   16
     0    8    0]
 [   0    0    0    0    0    0    0    0    0   19  421   12   19    2
     3   11    3]
 [   0    0    0    0    0    5    0    4    0    6    7  430   15    3
    18   13    6]
 [   0    0    0    0    0    0    0    0    0    5    9    9  606    4
     0    1    2]
 [   0    0    0    0    0    0    0    0    0   54    0    1    0  407
     2    6    7]
 [   0    0    0    0    2    0    0    2    0    0   10   42   13    1
   334    7   10]
 [   0    0    0    0    0    0    0    0    1   19   42    3   23    6
     2  365   33]
 [   0    0    0    0    0    1    0    1    0    6   10   19    9    9
     1   23  439]]
------ TEST ACCURACY:  weights.45-0.53.hdf5  ------
0.803571428571
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0 31  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 48  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0 16  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  3 14  2  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  1  0  3 13  0  0  0  1  1]
 [ 0  0  0  0  3  0  0  2  1  5  0 12  1  0  1  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  1 10  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  3 15]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  0  0 13]]

>>>>>>>>>>>>>> 27 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/27/weights.37-0.51.hdf5
------ TRAIN ACCURACY:  weights.37-0.51.hdf5  ------
0.941217696014
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  215    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1693    0    6    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1913    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  884    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  715    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    1    7 1270    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  287    2    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0  198    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    2  442    2    3    8   49
     0    3    2]
 [   0    0    0    0    0    0    0    0    0   21  431    5   20    8
     0    3    9]
 [   0    0    0    0    0    8    0    9    0    9   16  409    8   10
    10   10   15]
 [   0    0    0    0    3    0    0    2    0    6    6    6  606    7
     0    3    1]
 [   0    0    0    0    0    0    0    0    0   37    3    0    2  419
     0    3    2]
 [   0    1    0    0    2    0    0    9    0    1   11   57    5    0
   326    2    9]
 [   0    2    0   10    0    0    0    0    2   15   30    7   21    6
     4  359   41]
 [   0    2    0    0    0    2    0    0    0    2    9   28   10   22
     4   15  424]]
------ TEST ACCURACY:  weights.37-0.51.hdf5  ------
0.837078651685
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 39  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1 70  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 31  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  1  0  0 43  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 17  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 12  0  0  1  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  5  0  0  9  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0 14  0  0  0]
 [ 0  0  0  0  0  0  4  0  0  2  0  0  0  2  2  1]
 [ 0  0  0  0  0  0  0  0  0 14  0  0  1  0  1  0]
 [ 0  0  0  0  0  0  0  0  1  1  2  0  1  0  1 10]]

>>>>>>>>>>>>>> 28 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/28/weights.46-0.48.hdf5
------ TRAIN ACCURACY:  weights.46-0.48.hdf5  ------
0.941946748145
[[ 152    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  215    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1707    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1927    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  881    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    3    2    2 1276    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  285    2    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1  198    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    2  457    7    3    0   34
     0    5    2]
 [   0    0    0    0    0    1    0    0    0   18  429    9   12    6
     8    7    5]
 [   0    0    0    0    0    1    0    3    0    9   16  417    4    3
    28    9   19]
 [   0    0    0    0    2    0    0    1    0    4   17   11  581   20
     0    1    1]
 [   0    0    0    0    0    0    0    0    0   41    9    0    0  414
     2    3    5]
 [   0    0    1    0    2    1    0    4    0    0    8   52    1    1
   344    5    7]
 [   0    8    0    0    0    0    0    0    1    9   59    5   17   10
    13  355   20]
 [   0    2    0    1    0    2    0    0    0    4    7   26    5    9
     9   23  430]]
------ TEST ACCURACY:  weights.46-0.48.hdf5  ------
0.876582278481
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 30  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1 57  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 31  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  1 23  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0 38  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 17  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  2  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0 12  0  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  1 20  2  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  3 13]
 [ 0  2  0  0  0  0  0  0  0  5  0  0  0  0  9]]

>>>>>>>>>>>>>> 29 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/29/weights.50-0.53.hdf5
------ TRAIN ACCURACY:  weights.50-0.53.hdf5  ------
0.947583511016
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  206    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1632    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1917    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  878    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    4    1    7 1268    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  283    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  191    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    1  459    5    3    2   23
     1    5    1]
 [   0    0    0    1    0    0    0    0    0   25  425    8   13    1
     1    5    4]
 [   0    0    0    0    0    1    0    5    0    4   15  420    3    9
    24    3   20]
 [   0    0    0    0    3    0    0    2    0   15    4    3  594    7
     0    2    0]
 [   0    3    0    0    0    0    0    2    0   63    2    0    3  382
     0    2    1]
 [   0    0    0    0    2    0    0    6    0    0   10   47    1    0
   338    5    5]
 [   0    0    0    0    0    0    0    0    1   18   38    4   11    3
     1  365   52]
 [   0    0    0    0    0    0    1    0    0    7    6   29    3    6
     5    3  442]]
------ TEST ACCURACY:  weights.50-0.53.hdf5  ------
0.677669902913
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  8  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 94  6  0  0  6  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  7  5 16  0  0  0  0  0  2  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  7  0  0 29  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0 10  0  0  0  1  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  1  6  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 26  0  0  0  3  0  0  0]
 [ 0  0  0  1  0  0  0  1  0  0 15  4  7  0  0  0  0]
 [ 0  0  0  1  0  1  0  0  0  2  4  0  2  1  0  5  6]
 [ 0  0  0  0  0  0  0  0  0  0  1  6 21  0  0  1  2]
 [ 0  0  0  0  0  0  0  0  0 14  5  0  0  3  0  1  3]
 [ 0  0  0  0  0  0  0  0  0  2  2 14  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  1  9  4  5  0  0  0  1]
 [ 0  0  0  1  0  1  0  0  0  2  0  0  0  1  0  7 20]]

>>>>>>>>>>>>>> 30 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_spca_conv1d_10/30/weights.48-0.52.hdf5
------ TRAIN ACCURACY:  weights.48-0.52.hdf5  ------
0.94182874241
[[ 152    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1686    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1886    0    0   35    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  880    0   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    4 1278    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  289    2    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0  196    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    3  447    3    0    3   21
     0   18    2]
 [   0    0    0    0    0    0    0    1    0    4  445    9   13    6
     1    5    3]
 [   0    0    0    0    0    3    1    8    0   11   13  407    3   10
    17    9   18]
 [   0    1    0    0    3    0    0    2    0   13    7    3  587    6
     0    5    7]
 [   0    4    0    0    0    0    1    1    0   44    7    0    6  397
     0    3    2]
 [   0    0    2    0    1    0    5   11    1    0    7   49    4    0
   312   11   11]
 [   0    0    0    0    1    0    6    1    0   12   40    6   24    8
     6  362   29]
 [   0    0    0    1    0    2    0    0    0    1    9    5    9    8
    10   18  447]]
------ TEST ACCURACY:  weights.48-0.52.hdf5  ------
0.808823529412
[[ 1  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 22  0  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  1  0 41  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 27  0  4  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0 13  6  0  2  2  0  0  0]
 [ 0  0  0  0  2  0  0  0  0  0 16  2  0  2  3  1]
 [ 0  0  0  0  0  0  0  0  0  0  0 27  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 10  0  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 20  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  7  0  7  3]
 [ 0  0  0  0  0  0  0  0  2  0  4  1  8  1  0  8]]
[0.6875, 0.7598627787307033, 0.8388157894736842, 0.4533762057877814, 0.7348993288590604, 0.7864077669902912, 0.7818181818181819, 0.8765743073047859, 0.6932367149758454, 0.744408945686901, 0.7066326530612245, 0.794, 0.7586206896551724, 0.7043010752688172, 0.7746835443037975, 0.7051282051282052, 0.7944325481798715, 0.7517241379310344, 0.7819548872180451, 0.7917570498915402, 0.5392857142857143, 0.6818181818181818, 0.7791411042944786, 0.7397708674304418, 0.7333333333333333, 0.8035714285714286, 0.8370786516853933, 0.8765822784810127, 0.6776699029126214, 0.8088235294117647]
0.746573660083
0.0856656619345

Process finished with exit code 0

'''
