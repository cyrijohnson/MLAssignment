import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import numpy as np
import cPickle as pickle
from keras.models import Model, load_model
from keras.initializers import Constant, TruncatedNormal
from keras.layers import Input, Dense, Conv1D, Flatten, Dropout, Activation, BatchNormalization
from keras.layers.merge import concatenate
from keras.optimizers import Adam
from keras.callbacks import ModelCheckpoint
import keras.backend as K
from keras import losses
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix

# Load SVD + Kernel PCA data

X_svd = pickle.load(open("data/X_unimib_svd.p", "rb"))
X_kpca = pickle.load(open("data/X_unimib_kpca.p", "rb"))
X = np.concatenate((X_svd, X_kpca), axis=1)

y = pickle.load(open("data/y_unimib_svd.p", "rb"))

n_classes = 17


# Below builds 1D CNN.

for i in range(30):
    test = y.loc[y[1] == i+1]
    # print y_sub
    test_index = test.index.values
    # print len(test_index)

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index], y_values[test_index]
    y_train = np.eye(n_classes)[y_train - 1]
    print X_train.shape # (11188, 302)

    # input layer
    input_signal = Input(shape=(302, 1))
    print K.int_shape(input_signal)

    # define initial parameters
    b_init = Constant(value=0.0)
    k_init = TruncatedNormal(mean=0.0, stddev=0.01, seed=2018)

    # first feature extractor
    conv11 = Conv1D(16, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn11 = BatchNormalization()(conv11)
    actv11 = Activation('relu')(bn11)
    conv12 = Conv1D(32, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv11)
    bn12 = BatchNormalization()(conv12)
    actv12 = Activation('relu')(bn12)
    flat1 = Flatten()(actv12)

    # second feature extractor
    conv21 = Conv1D(16, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn21 = BatchNormalization()(conv21)
    actv21 = Activation('relu')(bn21)
    conv22 = Conv1D(32, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv21)
    bn22 = BatchNormalization()(conv22)
    actv22 = Activation('relu')(bn22)
    flat2 = Flatten()(actv22)

    # third feature extractor
    conv31 = Conv1D(16, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn31 = BatchNormalization()(conv31)
    actv31 = Activation('relu')(bn31)
    conv32 = Conv1D(32, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv31)
    bn32 = BatchNormalization()(conv32)
    actv32 = Activation('relu')(bn32)
    flat3 = Flatten()(actv32)

    # merge feature extractors
    merge = concatenate([flat1, flat2, flat3])

    # dropout & fully-connected layer
    do = Dropout(0.9, seed=2018)(merge)
    output = Dense(n_classes, activation='softmax', bias_initializer=b_init, kernel_initializer=k_init)(do)

    # result
    model = Model(inputs=input_signal, outputs=output)

    # summarize layers
    print(model.summary())

    new_dir = 'model/unimib_svd_kpca_conv1d_10/' + str(i+1) + '/'
    if not os.path.exists(new_dir):
        os.makedirs(new_dir)

    fpath = new_dir + 'weights.{epoch:02d}-{val_acc:.2f}.hdf5'
    cp_cb = ModelCheckpoint(fpath, monitor='val_acc', verbose=1, save_best_only=True, mode='auto', period=1)

    adam = Adam(lr=0.001)
    model.compile(loss=losses.categorical_crossentropy, optimizer=adam, metrics=['accuracy'])
    model.fit(np.expand_dims(X_train, axis=2), y_train, batch_size=64, epochs=50, verbose=2, validation_split=0.10,
              callbacks=[cp_cb], shuffle=True)

    del model
    K.clear_session()


# Below calculates average test data accuracy (LOSO CV).

acc = []

for i in range(30):
    test = y.loc[y[1] == i+1]
    test_index = test.index.values

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index] - 1, y_values[test_index] - 1

    print "\n>>>>>>>>>>>>>>", str(i+1), "-fold <<<<<<<<<<<<<<<<"
    path_str = 'model/unimib_svd_kpca_conv1d_10/' + str(i+1) + '/'
    for path, dirs, files in os.walk(path_str):
        dirs.sort()
        files.sort()
        top_acc = []
        top_acc.append(files[-1])
        files = top_acc
        for file in files:
            print "========================================"
            print os.path.join(path, file)
            model = load_model(os.path.join(path, file))
            pred = model.predict(np.expand_dims(X_train, axis=2), batch_size=32)
            print "------ TRAIN ACCURACY: ", file, " ------"
            print accuracy_score(y_train, np.argmax(pred, axis=1))
            print confusion_matrix(y_train, np.argmax(pred, axis=1))
            pred = model.predict(np.expand_dims(X_test, axis=2), batch_size=32)
            print "------ TEST ACCURACY: ", file, " ------"
            print accuracy_score(y_test, np.argmax(pred, axis=1))
            print confusion_matrix(y_test, np.argmax(pred, axis=1))

            del model
            K.clear_session()

    acc.append(accuracy_score(y_test, np.argmax(pred, axis=1)))

print acc
print np.mean(acc)
print np.std(acc)

'''
-----
[0.7421875, 0.6775300171526587, 0.8092105263157895, 0.5594855305466238, 0.785234899328859, 0.8155339805825242, 0.796969696969697, 0.7858942065491183, 0.6545893719806763, 0.7092651757188498, 0.7857142857142857, 0.718, 0.8328912466843501, 0.7580645161290323, 0.7949367088607595, 0.6944444444444444, 0.8072805139186295, 0.803448275862069, 0.8082706766917294, 0.7266811279826464, 0.5, 0.6570247933884298, 0.7852760736196319, 0.7594108019639935, 0.7802469135802469, 0.7886904761904762, 0.8202247191011236, 0.8291139240506329, 0.6970873786407767, 0.7034313725490197]
0.746204638484
0.0774471949381
-----

/usr/bin/python2.7 /mnt/0cdd1a7e-3686-4cf7-9055-145eb5fe70f3/hcilab/OSS/electronicsletters2018/unimib/unimib_svd_kpca_conv1d_10.py
/home/hcilab/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.

>>>>>>>>>>>>>> 1 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/1/weights.28-0.52.hdf5
------ TRAIN ACCURACY:  weights.28-0.52.hdf5  ------
0.934574514798
[[ 144    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  202    0    0    0    0    0    4    0    0    0    0    0    0
     0    0    0]
 [   0    0 1678    0    1    1    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1908    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    7    0  857    0   23    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    5    0    4 1260    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  283    4    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  197    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  438   14   12    5   46
     3    0    0]
 [   0    0    0    1    0    3    1    5    2   16  432   15    0   11
     0    4    4]
 [   0    0    0    1    1    4    0    3    3    9   29  410    6   11
    18    7    9]
 [   1    1    0    0    0    0    0    3    1    0    5   10  605    8
     1    6    1]
 [   0    0    0    0    1    1    0    0    0   26    4    3    0  423
     0    6    6]
 [   1    0    0    0    1    1    0   10    3    0   21   39   13    1
   320    1    8]
 [   0    0    0    0    0    0    0    5    0    4   70    5   11    8
     3  334   53]
 [   0    0    0    0    0    3    1    3    0    3    6   24    1   11
     8   21  435]]
------ TEST ACCURACY:  weights.28-0.52.hdf5  ------
0.7421875
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  9  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  6  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 28  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0  0  0 39  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  5  0  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  1  0  0  0  2  8  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  1  6  0  0  0  0  5  2]
 [ 0  0  0  0  0  4  0  0  0  0  1  3  0  0  1  0  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  0  3  1  0  0  3  5  0]
 [ 0  0  0  0  0  1  0  0  0  0  4  6  0  0  2  1  1]
 [ 0  0  0  0  0  1  0  0  0  0  4  0  1  7  0  7  0]
 [ 0  0  0  0  0  0  0  1  0  2  2  6  0  0  1  1  5]]

>>>>>>>>>>>>>> 2 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/2/weights.39-0.52.hdf5
------ TRAIN ACCURACY:  weights.39-0.52.hdf5  ------
0.940471934215
[[ 146    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  202    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1573    0    8    0   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1908    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  875    0    9    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    7    8 1259    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  284    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  195    0    0    0    0    0
     0    0    0]
 [   0    1    0    1    0    0    0    0    0  450   15    4    2   33
     1    1    0]
 [   0    0    0    0    0    5    1    2    1   24  421    7    6   10
     3    7    1]
 [   0    0    0    0    0    4    0    1    1   16   24  405    5   10
    15    4   17]
 [   0    1    0    0    0    0    0    3    0    0    2    6  588    8
     2   11    0]
 [   0    0    0    0    0    0    0    0    0   33    0    5    1  408
     0    4    1]
 [   0    0    0    0    3    0    0    7    0    2   11   30   13    5
   333    1    4]
 [   0    0    0    0    0    0    1    2    0    7   54    4   14   15
     4  352   33]
 [   0    0    0    0    0    3    0    0    1    7    4   24   11   22
     6   23  406]]
------ TEST ACCURACY:  weights.39-0.52.hdf5  ------
0.677530017153
[[  6   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0  10   0   0   2   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 106   0  37   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  37   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  29   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   2   3  44   0   0   0   0   0   0   0   0   0   0]
 [  0   3   0   0   1   0   0   5   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  11   3   0   3   0   0   4   0]
 [  0   0   0   0   0   0   0   0   0   0   5   0  18   0   0   0   0]
 [  0   0   0   0   5   0   0   1   0   0   0   9   9   0   0   0   0]
 [  0   0   0   0   0   0   0   3   0   1   0   0  36   0   0   0   0]
 [  0   0   0   0   0   0   0   0   3   7   2   0   4  14   0   2   0]
 [  2   2   5   3   1   4   0   0   0   0   0   2   1   0   0   3   2]
 [  0   0   0   0   1   0   3   0   0   1   3   1  14   0   0   2   2]
 [  0   0   0   0   0   0   0   2   0   0   0   4  14   0   0   3   4]]

>>>>>>>>>>>>>> 3 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/3/weights.44-0.52.hdf5
------ TRAIN ACCURACY:  weights.44-0.52.hdf5  ------
0.945670184006
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  215    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1706    0    6    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1912    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  885    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    6    4    7 1268    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1  281    3    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  197    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  468    9    6    0   25
     3    1    1]
 [   0    0    1    0    0    1    0    0    1   20  431    9    2   12
     3    4   15]
 [   0    0    0    1    0    0    1    2    0   11   13  423   11   11
    21    7   15]
 [   0    3    0    0    0    0    0    3    0    0    4    6  607    8
     5    9    2]
 [   0    0    0    0    1    0    0    0    0   44    1    3    0  412
     1    6    3]
 [   0    0    0    0    2    0    0    8    1    0    9   34   15    1
   350    4    3]
 [   0    0    0    0    0    0    1    0    0   12   55    4   15    4
     2  374   36]
 [   0    0    0    0    0    0    0    1    0    5    1   33    2    8
    13   12  452]]
------ TEST ACCURACY:  weights.44-0.52.hdf5  ------
0.809210526316
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 73  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 12  2 25  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 11  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  0  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  5  0  0  7  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  7  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  1  0  0  0  0  6  0]
 [ 0  2  0  0  0  0  0  1  0  0  0  1  0  3  0  0  0]
 [ 0  1  0  0  0  0  0  1  0  0  0  1  0  0  0  3  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  5  0  0  0  1  1]]

>>>>>>>>>>>>>> 4 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/4/weights.45-0.52.hdf5
------ TRAIN ACCURACY:  weights.45-0.52.hdf5  ------
0.94589877836
[[ 151    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  211    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1721    0    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1926    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  883    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    6 1291    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  284    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  191    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  473   12    8    3   20
     5    1    0]
 [   0    0    0    0    0    1    0    1    0   31  435    9    0    3
     2    5    5]
 [   0    0    0    1    0    2    1    2    1   12   18  413    5   12
    19    2   15]
 [   0    3    0    0    0    0    0    1    0    1    5    5  604    3
     5   12    4]
 [   0    0    0    0    1    0    0    0    0   38    3    2    2  413
     2    1    5]
 [   0    0    0    0    0    0    0    4    0    0   12   44   12    2
   337    0   10]
 [   0    0    0    0    0    0    0    1    0   10   56   13   10    2
     5  348   52]
 [   0    0    0    0    0    2    0    0    0    3    4   23    4   10
     8   18  440]]
------ TEST ACCURACY:  weights.45-0.52.hdf5  ------
0.559485530547
[[ 2  1  0  0  0  0  0  0  0  0  0  0  1  0  0  0]
 [ 0  6  0  0  0 10  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 48  0  0  6  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 23  0  4  0  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0 12  0  0  0 15  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 26  1  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  6  1  0  0  1  0  0  1  0  0]
 [ 1  0  0  0  0  0  7  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  7  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 10  1  0  1  3  0  4  0]
 [ 0  0  0  0  0  0  0  0  2  2 11  4  2  0  0  2]
 [ 0  0  0  0  0  0  0  0  1  1  0 15  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0 12  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  5  6  1  1  0  0  0]
 [ 0  0  0  0  2  0  0  0  5  1  0  0  5  0  1  2]
 [ 0  0  0  0  5  0  0  0  6  0  0  2  3  0  2  4]]

>>>>>>>>>>>>>> 5 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/5/weights.31-0.54.hdf5
------ TRAIN ACCURACY:  weights.31-0.54.hdf5  ------
0.935675063192
[[ 144    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  201    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1706    0    4    1    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1915    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  873    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    4    1    7 1276    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  287    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    2  196    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    1    0  457   14    6    1   29
     3    0    1]
 [   0    1    1    0    0    0    0    2    1   28  443    9    0    6
     1    1    9]
 [   0    0    0    0    0    2    0    4    1   17   27  390   12    9
    16    1   26]
 [   0    2    0    0    0    0    0    4    0    1    4    6  611    8
     3    5    2]
 [   0    0    0    0    1    0    0    0    0   39    4    3    1  418
     0    0    8]
 [   0    1    0    0    3    0    0   11    1    1   20   40    9    2
   321    0   16]
 [   0    1    0    0    0    0    0    5    0   12   76    5   12   12
     3  322   50]
 [   0    0    0    0    0    0    0    2    0    7    5   32    3    7
     4    7  449]]
------ TEST ACCURACY:  weights.31-0.54.hdf5  ------
0.785234899329
[[ 7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  8  3  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 66  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 19  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  4  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  2  1  6  0  2  0]
 [ 0  0  0  0  0  0  0  1  0  0  3  0  0  0  2  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0 11  0  2  2  0  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  1  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  5  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  6  0  0  2  1  5  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  7 11]]

>>>>>>>>>>>>>> 6 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/6/weights.31-0.52.hdf5
------ TRAIN ACCURACY:  weights.31-0.52.hdf5  ------
0.934853420195
[[ 149    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  205    1    0    0    0    0    3    0    0    0    0    0    0
     0    0    1]
 [   0    0 1668    0    5    0   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1924    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    0  840    0   30    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    6    1    2 1262    0    0    0    0    0    0    0
     0    0    0]
 [   1    2    0    0    0    0    0  272    4    0    2    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  194    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    0    0    0    0  446    8    8    2   44
     1    1    0]
 [   0    0    0    1    0    1    0    3    1   19  420    3    1   18
     4   18    7]
 [   0    0    0    1    0    1    1    2    2   18   15  394    4   16
    10    5   38]
 [   0    4    0    0    0    0    0    1    2    0    6    2  593    5
     4   19    2]
 [   0    0    0    0    1    0    0    0    1   40    0    3    0  410
     1    2    6]
 [   0    0    0    0    1    0    0    2    2    3   11   42    6    6
   326    3   14]
 [   0    0    0    1    0    0    0    1    0    7   47    1    9   15
     1  356   55]
 [   0    0    0    1    0    2    0    0    1    4   11   13    1   11
     3   25  444]]
------ TEST ACCURACY:  weights.31-0.52.hdf5  ------
0.815533980583
[[ 2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 41  0  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 29  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  1  0  0 49  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  4 10  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 14  0  0  0  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  8  3  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  3  0 14  0  0  1  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  0  0  1  3]
 [ 0  0  0  0  0  0  0  0  0 14  0  0  0  5  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0 13  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  1 17]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0 17]]

>>>>>>>>>>>>>> 7 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/7/weights.48-0.52.hdf5
------ TRAIN ACCURACY:  weights.48-0.52.hdf5  ------
0.943623809108
[[ 152    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1683    0    2    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1910    0    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  872    0   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    1    0    1 1288    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  287    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  192    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  482    5    2    2   21
     1    1    2]
 [   0    1    0    0    0    0    1    0    0   33  414   12    3    6
     3    9   14]
 [   0    0    0    2    0    2    1    0    0   18   10  425   11   10
    14    3   12]
 [   0    1    0    0    0    0    0    2    0    0    1    8  608    3
     3    7   10]
 [   0    0    0    0    0    0    0    0    0   49    0    2    1  394
     2    2   12]
 [   0    0    0    1    1    0    0    4    1    3    4   53   14    1
   332    1   11]
 [   0    0    0    0    0    0    0    4    0   15   40    7    6    7
     6  363   52]
 [   0    0    0    0    0    0    0    0    0   11    2   30    2    2
     8   10  457]]
------ TEST ACCURACY:  weights.48-0.52.hdf5  ------
0.79696969697
[[ 4  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0 45  0  0  0  4  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 35  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 33  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  6  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 13  0  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  1  4  5  0  0  4  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0 18  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 16  0  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0  0  0  7  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  2  9]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  6  6]]

>>>>>>>>>>>>>> 8 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/8/weights.34-0.50.hdf5
------ TRAIN ACCURACY:  weights.34-0.50.hdf5  ------
0.934499736241
[[ 151    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  208    3    0    0    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1669    0    2    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1925    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   18    0  853    0   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  720    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   19    3    0    2 1253    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  281    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    2  184    0    0    0    0    0
     0    1    0]
 [   0    1    0    0    0    0    0    0    0  444    8    6    2   26
    10    3    3]
 [   0    0    1    0    0    0    0    1    0   27  406   16    0    7
     5   23    8]
 [   0    0    0    1    1    1    0    3    0   17   11  428    6    9
    10   12   10]
 [   0    3    0    0    0    0    0    0    0    0    5    8  580    7
     1   31    1]
 [   0    0    0    0    0    0    0    0    0   37    2    4    0  412
     5    3    2]
 [   0    1    0    0    1    0    0    6    0    1    8   56    9    2
   318   15    3]
 [   0    0    0    0    0    0    0    4    0   10   36   21    5    9
     2  390   26]
 [   0    0    0    0    0    1    0    0    1    6    2   43    3    5
     2   43  407]]
------ TEST ACCURACY:  weights.34-0.50.hdf5  ------
0.785894206549
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 52  0  0  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 13  0  0  0 34  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  7  0  3  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 20  0  0  0  2  0  0  4]
 [ 0  1  0  0  0  0  0  0  0  0 12  2  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  1  0  0  5  6  0  0  4  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  1  0 24  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  2  0  9  0  3  0]
 [ 0  0  0  0  0  0  0  1  0  0  3  4  0  1  5  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  7  2]
 [ 0  0  0  0  0  0  0  0  0  2  0  5  0  2  0  3  9]]

>>>>>>>>>>>>>> 9 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/9/weights.41-0.53.hdf5
------ TRAIN ACCURACY:  weights.41-0.53.hdf5  ------
0.942942678524
[[ 151    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1681    0    4    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1925    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  878    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    7    2    2 1266    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  287    0    0    1    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1  189    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  463    3   15    8    9
     5    4    0]
 [   0    0    0    0    3    1    0    2    2   19  404    7    2   12
     3   21    6]
 [   0    0    0    2    1    3    0    1    1   10   15  411    9    5
    20    9   19]
 [   0    0    0    0    0    0    0    3    1    0    1    8  592    3
     2    7    7]
 [   0    0    0    0    1    0    0    0    0   44    6    5    8  393
     1    7    8]
 [   0    0    0    0    3    0    0    8    4    2   11   39    7    0
   336    3    8]
 [   0    3    0    0    0    0    1    5    0    2   34    8   11    6
     5  375   32]
 [   0    0    0    1    0    1    0    0    1    2    6   36    2    3
     9   19  425]]
------ TEST ACCURACY:  weights.41-0.53.hdf5  ------
0.654589371981
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 50  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 60  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 16  0  4  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  7  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  9  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  1  0 10  0  6  1]
 [ 0  0  0  0  0  0  0  3  0  3  6  0  0  0  0 17  0]
 [ 1  0  0  0  0  0  0  0  7  0  0  0  0  0 12  0  0]
 [ 0  0  2  0  0  0  0  0  0  5  0  0 28  2  0  0  0]
 [ 0  0  0  0  0  0  0  2  1  2  0  1  0  0  0  2  3]
 [ 0  0  0  0  1  0  0  0  3  0  0  0  0  0  9  0  0]
 [ 0  0  0  0  0  0  0  4  0  5  0  0  6  0  0  7  9]
 [ 0  0  0  0  0  0  0  2  0 10  0  0  0  0  0 14  3]]

>>>>>>>>>>>>>> 10 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/10/weights.43-0.49.hdf5
------ TRAIN ACCURACY:  weights.43-0.49.hdf5  ------
0.941351021121
[[ 151    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  213    0    0    0    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1698    0    8    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1926    0    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  885    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  728    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    6    0 1288    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  294    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1  186    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  455    7    3    4   21
    12    1    2]
 [   0    0    1    0    0    2    0    1    0   16  432    9    6   10
     5   10    7]
 [   0    0    0    0    2    3    0    3    0   13   12  396   14   10
    30    6   15]
 [   0    2    0    0    0    0    0    1    0    0    5    7  599    6
     7   16    0]
 [   0    0    0    0    1    0    0    0    0   41    1    4    0  410
     2    6    2]
 [   0    0    0    0    4    0    0    7    3    1   10   28    4    2
   341    0   20]
 [   0    0    0    0    0    0    2    2    0    5   50    5   14    8
     7  360   48]
 [   0    0    0    0    0    1    0    2    0   14    6   33    3    7
     9   18  424]]
------ TEST ACCURACY:  weights.43-0.49.hdf5  ------
0.709265175719
[[32  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 51  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 14  0 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 17  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  7 22  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  1  9  0  0  0  0  0  0  3  0]
 [ 0  0  0  0  0  0  0 21  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  6  1  0  0  4  0  0]
 [ 0  0  2  1  0  0  0  1  2  1  2  0  8  0  5]
 [ 0  0  0  0  0  0  0  0  0  0 18  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0 11  0  0  0]
 [ 0  2  0  0  0  0  0  0  0  0  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  1  3  2  2]
 [ 0  0  0  0  0  0  0  5  0  0  3  4  0  1  4]]

>>>>>>>>>>>>>> 11 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/11/weights.50-0.51.hdf5
------ TRAIN ACCURACY:  weights.50-0.51.hdf5  ------
0.939010457861
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    0    0    0    0    0    0    0
     0    1    0]
 [   0    0 1708    0    0    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1901    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  849    0   27    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    7    2    7 1249    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    0    0    1  279    5    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  195    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0    0  455    7    6    3   31
     4    2    2]
 [   0    1    1    0    0    0    0    0    1   25  405   13    6    8
     4   16   11]
 [   0    0    0    0    0    5    1    1    0   23   10  414   10   12
    14    2   20]
 [   0    2    0    0    0    0    0    1    0    0    3    8  605    7
     2    5    4]
 [   0    0    0    0    1    0    0    0    0   46    1    2    0  403
     1    2    9]
 [   0    0    0    0    2    0    0    4    1    2    4   42   12    0
   328    8   13]
 [   0    0    0    0    0    0    0    1    0    9   42    3   19    5
     4  373   43]
 [   0    0    1    0    0    1    0    0    0    8    2   31    1    9
     5   21  439]]
------ TEST ACCURACY:  weights.50-0.51.hdf5  ------
0.785714285714
[[ 5  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0]
 [ 1  3  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0]
 [ 0  0 23  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 82  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  5  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 15  0  0  0 42  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  7  0  0  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 15  0  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4 14  0  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0  1  3  7]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 24  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 10  0  0  0  3  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  0 11  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  3  0  0  7  0]
 [ 0  0  0  0  0  0  3  0  0  0  5  0  0  0  0  0  8]]

>>>>>>>>>>>>>> 12 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/12/weights.47-0.52.hdf5
------ TRAIN ACCURACY:  weights.47-0.52.hdf5  ------
0.94250731967
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    0    0    0    0    0    0    0
     0    1    0]
 [   0    0 1549    0    1    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1893    0    0   18    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  865    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    3 1284    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  293    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  197    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  461    7    3    2   26
    12    1    0]
 [   0    0    1    0    0    1    0    0    1   33  426    2    1    9
     1   13    8]
 [   0    0    0    0    1    5    1    1    0   13    9  412    7   11
    24    3   27]
 [   0    5    0    0    0    0    0    3    0    0    5    9  600    7
     0   11    1]
 [   0    0    0    0    0    0    0    0    0   37    1    6    0  414
     1    1    4]
 [   0    0    0    0    1    0    1   11    1    2    3   25   19    3
   349    3    6]
 [   0    0    0    0    0    0    0    9    1    8   42    7   13   12
     4  366   34]
 [   0    0    0    0    0    1    0    0    0    3    1   26    2   10
     6   22  444]]
------ TEST ACCURACY:  weights.47-0.52.hdf5  ------
0.718
[[  4   2   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   4   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 117   0  25   0  40   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  73   0   0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   1   0  31   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  27   5   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  36   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   2   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  11   0   0   0   4   0   0   2]
 [  0   0   0   0   0   0   0   0   0   0   5   0   0   2   0   5   3]
 [  0   0   1   0   0   0   0   0   0   0   0   7   0   0   2   0   2]
 [  0   0   0   0   0   0   0   3   0   0   4   0   7   0   0   0   6]
 [  0   0   0   0   0   0   0   0   0   7   0   0   0  13   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0  10   0   0]
 [  0   0   0   0   0   0   0   0   0   0   9   0   0   0   0   3   5]
 [  0   0   0   0   0   0   0   0   0   0   2   1   0   2   1   4   9]]

>>>>>>>>>>>>>> 13 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/13/weights.45-0.53.hdf5
------ TRAIN ACCURACY:  weights.45-0.53.hdf5  ------
0.946550816219
[[ 150    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1709    0    0    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1916    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  870    0   15    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    1    1    4 1273    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  276    2    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    0    1  195    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  462   13    2    0   22
     5    1    0]
 [   0    0    0    0    0    0    0    0    1   27  431    7    2    5
     2   17    1]
 [   0    0    0    1    0    2    1    1    0   17   17  421    4   11
    16    2   15]
 [   1    2    0    0    0    0    0    2    0    0    2    7  593    9
     5   14    1]
 [   0    0    0    0    1    0    0    1    0   32    1    3    2  423
     4    5    2]
 [   0    1    0    0    1    0    1    6    4    0    6   42   13    3
   327    5    9]
 [   0    0    0    0    0    0    0    4    0   11   49    4   10    4
     7  367   39]
 [   0    0    0    0    0    1    0    0    0    4   11   25    2    7
     4   17  441]]
------ TEST ACCURACY:  weights.45-0.53.hdf5  ------
0.832891246684
[[ 3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  3  0  0  2  0]
 [ 0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0 14  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  0  0  5  0  0  3  3]
 [ 0  0  0  0  0  0  1  0  0  0  5  0  0  0  0  7  5]
 [ 0  0  0  0  0  0  0  0  0  0  8  5  2  1  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 25  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0 16  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 18  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 16  6]]

>>>>>>>>>>>>>> 14 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/14/weights.50-0.54.hdf5
------ TRAIN ACCURACY:  weights.50-0.54.hdf5  ------
0.947012895868
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  209    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1682    0    0    1    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1928    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  861    0   19    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    2    0    7 1264    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  292    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  195    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  477   12    3    3   19
     0    1    1]
 [   0    0    0    0    0    1    0    2    0   25  427    7    1    8
     0   10   12]
 [   0    0    0    1    1    6    0    0    0   21    6  416    5    8
    13   11   15]
 [   0    4    0    0    0    0    0    0    0    1    2   11  598    9
     3   13    0]
 [   0    0    0    0    1    0    0    0    0   37    3    3    0  426
     0    2    2]
 [   0    0    0    0    1    1    0    6    1    0    7   26   17    2
   336    3   14]
 [   0    0    0    0    0    0    1    1    0   12   42    4   12   13
     2  359   49]
 [   0    0    0    0    0    1    0    0    0    4    3   26    5   19
     1   13  451]]
------ TEST ACCURACY:  weights.50-0.54.hdf5  ------
0.758064516129
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 3  1  0  0  0  0  0  1  0  0  0  0  0  0  0  1  0]
 [ 0  0 36  0  5  0 13  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 39  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 50  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  1  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  1  0  4  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  3 12  0  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  5 13  0  0  2  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  5]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 11  0  0  7  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  8  0  0  0  0  0 10]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  2  7]]

>>>>>>>>>>>>>> 15 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/15/weights.41-0.52.hdf5
------ TRAIN ACCURACY:  weights.41-0.52.hdf5  ------
0.944268635724
[[ 144    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1691    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1893    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  893    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   21    3    0    2 1243    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  280    3    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1  190    0    0    0    0    0
     0    1    0]
 [   0    1    0    0    0    0    0    0    0  467    7    5    1   29
     7    0    0]
 [   0    0    0    0    0    1    1    1    0   16  442    8    0    8
     1   13    2]
 [   0    0    1    0    1    3    0    1    0   13   18  421    7    6
    20    3   18]
 [   0    4    0    0    0    0    0    0    0    0    8   10  597    9
     5    7    3]
 [   0    0    0    0    1    0    0    0    0   34    2    4    1  418
     1    1    7]
 [   0    0    0    0    1    0    0    4    0    1   10   42   10    0
   334    0   14]
 [   0    0    0    0    1    0    0    0    0    3   61    5   11    6
     2  360   51]
 [   0    0    1    0    0    2    0    0    0    5    5   32    5    8
     6   11  444]]
------ TEST ACCURACY:  weights.41-0.52.hdf5  ------
0.794936708861
[[ 4  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 1  2  0  0  0  0  0  1  1  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 88  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0 15  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  7 48  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 12  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  6  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  2  2  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0 15  0  0  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  3  4  3  0  1  2  0  1]
 [ 0  0  0  0  0  0  0  0  0  4  0  5  5  0  0  2  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  6  0  3  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  3  0  0  0  9]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0 13]]

>>>>>>>>>>>>>> 16 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/16/weights.50-0.53.hdf5
------ TRAIN ACCURACY:  weights.50-0.53.hdf5  ------
0.947536052375
[[ 145    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  199    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1679    1    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1908    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  871    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    4    3    7 1250    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  275    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1  192    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0    0  446    9   11    2   34
     4    0    3]
 [   0    0    0    0    0    0    0    2    0   17  435    8    3   10
     2    2   13]
 [   0    0    0    0    0    3    0    0    0    7   19  425   11   13
    10    3   21]
 [   0    5    0    0    0    0    0    0    0    0    4    9  604    8
     0   10    0]
 [   0    0    0    0    0    0    0    0    0   30    1    7    0  429
     0    0    3]
 [   0    0    0    0    0    0    0    4    2    0    9   48    7    1
   337    5   10]
 [   0    0    0    0    0    0    0    4    0    5   47   12   14   12
     1  358   38]
 [   0    0    0    0    0    0    0    2    1    0    4   26    1   13
     5   15  441]]
------ TEST ACCURACY:  weights.50-0.53.hdf5  ------
0.694444444444
[[ 1  7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 5  5  0  0  1  0  0  3  2  0  0  1  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 77  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 46  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 10 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 14  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  1  0  0 16  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  4  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 15  0  1  3  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3 10  0  0  0  2  4]
 [ 0  0  0  0  0  0  0  0  0  0  3  5  0  2  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  3  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  2  3  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  3  0  2  0  8]
 [ 0  0  0  0  0  0  0  0  0  0  8  0  0  0  0 18  0]]

>>>>>>>>>>>>>> 17 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/17/weights.37-0.53.hdf5
------ TRAIN ACCURACY:  weights.37-0.53.hdf5  ------
0.939136588818
[[ 145    3    0    0    0    0    0    0    1    0    0    0    0    0
     0    0    0]
 [   0  199    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1633    0    2    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1901    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  875    0   17    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  727    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   19   17    2    5 1231    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  282    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  193    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  458   11    7    2   29
     7    1    2]
 [   0    0    0    0    1    2    0    6    0   20  435    3    2    5
     4    8    9]
 [   0    0    0    0    1    3    0    6    2   14   22  394   11    9
    26    6   11]
 [   0    1    0    0    0    0    0    3    0    0    4    7  606    2
     3   14    1]
 [   0    2    0    0    1    0    0    0    0   32    4    3    0  410
     1    6    5]
 [   0    0    0    0    3    0    0    7    3    0   14   24   10    3
   340    0    7]
 [   0    0    0    0    0    0    0    9    0    3   62    6    6    4
     6  347   52]
 [   0    0    0    0    0    0    0    0    0    1    7   41    3   10
     5   10  440]]
------ TEST ACCURACY:  weights.37-0.53.hdf5  ------
0.807280513919
[[  4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  1  10   0   0   0   0   0   4   0   0   0   0   0   0   0   0   0]
 [  0   0 103   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  81   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   8   0  20   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  19   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  50   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0  13   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   2   5   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   0   3   2   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   9   3   0   0   0   4   0]
 [  0   0   0   0   0   0   0   0   0   0   3  10   0   1   4   0   3]
 [  0   0   0   0   0   0   0   0   0   0   0   0  17   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   8   0   0   1   5   6   0   0]
 [  0   0   0   0   0   0   0   0   0   0   1   0   0   7  11   0   4]
 [  0   0   0   0   0   0   0   0   0   1   3   0   3   3   0   4   4]
 [  0   0   0   0   0   0   0   0   0   0   4   0   0   0   4   0   9]]

>>>>>>>>>>>>>> 18 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/18/weights.48-0.55.hdf5
------ TRAIN ACCURACY:  weights.48-0.55.hdf5  ------
0.94704294051
[[ 137    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  206    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1734    0    4    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1927    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  879    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  730    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    3    0    5 1278    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  282    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  189    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  471   12    3    0   23
     1    2    1]
 [   0    0    0    0    0    2    0    1    0   16  443    9    1    7
     1   10    3]
 [   0    0    0    2    1    3    0    1    1   18   16  424    3    8
    17    6    9]
 [   1    6    0    0    0    0    0    1    0    1    4   10  603    4
     4    9    0]
 [   0    0    0    0    0    0    0    0    0   40    1    2    0  422
     2    0    4]
 [   0    0    0    0    2    0    0    5    3    1    9   49   12    1
   335    0    6]
 [   0    0    0    0    0    0    0    1    0    6   56    3    6   11
     3  358   59]
 [   0    0    0    0    0    2    0    0    0    6    5   23    1    9
     7   13  455]]
------ TEST ACCURACY:  weights.48-0.55.hdf5  ------
0.803448275862
[[12  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  4  0  0  0  0  0  0  0  0  1]
 [ 0  0 56  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 15  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 31  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 13  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1 10  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 11  0  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 12  2  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  2  0  8  0  2  0  2  3]
 [ 0  0  0  0  0  0  0  0  0  3  0 12  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 11  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  0  7  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  2  0  3  2  2]
 [ 0  0  0  0  0  0  0  0  0  8  2  0  0  0  0  3]]

>>>>>>>>>>>>>> 19 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/19/weights.39-0.52.hdf5
------ TRAIN ACCURACY:  weights.39-0.52.hdf5  ------
0.94185136897
[[ 145    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    1 1713    0    6    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1917    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    1    0  897    0   17    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3   10    2    5 1273    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  286    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  191    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0    0  471   13    5    7   20
     2    2    0]
 [   0    1    0    0    0    0    0    3    0   24  421   16    1    8
     3   12    7]
 [   0    1    0    1    0    2    1    0    0   15   11  435    6    8
    16    5   16]
 [   0    4    0    0    0    0    0    1    0    0    3    9  610    5
     4    8    0]
 [   0    0    0    0    1    0    0    0    0   50    2    2    2  409
     1    2    5]
 [   0    2    0    0    2    0    0    8    0    2    5   41   18    0
   330    2    9]
 [   0    1    0    0    0    0    1    4    0   11   35   14   16    8
     5  362   47]
 [   0    0    0    0    0    0    0    1    0    5    3   32    2   15
     5   10  449]]
------ TEST ACCURACY:  weights.39-0.52.hdf5  ------
0.808270676692
[[ 5  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 14  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0 30  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  5  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  2  0  0  1  0  8  3]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0  2  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  1  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  7  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  9  1]]

>>>>>>>>>>>>>> 20 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/20/weights.20-0.52.hdf5
------ TRAIN ACCURACY:  weights.20-0.52.hdf5  ------
0.89566755084
[[ 134    5    3    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  189    3    0    0    0    0    8    1    0    1    0    0    0
     0    0    1]
 [   0    0 1572    0    4    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   20 1894    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   62    0  816    0   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    1   10  710    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0  221   25    5    2 1021    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    1    0    0    0    0  277    3    0    2    0    1    0
     2    0    0]
 [   0    0    0    0    0    0    1    6  180    0    1    0    0    1
     0    2    1]
 [   0    1    0    0    0    0    0    0    0  435   12    5    4   47
     3    5    1]
 [   0    0    1    0    0    3    0    1    1   26  412   10    4   12
     3   12   16]
 [   0    0    1    0    0    3    0    3    1   16   18  412    9    9
    25    4   18]
 [   0    2    0    0    0    0    0    2    0    1    3    6  594   11
     2   21    1]
 [   0    2    0    0    0    0    0    0    0   39    2    3    0  411
     0    6    6]
 [   0    0    0    0    2    0    0    8    0    2   17   55    9    2
   313    2   15]
 [   0    0    0    0    1    0    0    0    0   14   67   10    9    9
     0  342   47]
 [   0    0    1    0    0    1    0    4    0   10    8   32    3   14
     5   29  418]]
------ TEST ACCURACY:  weights.20-0.52.hdf5  ------
0.726681127983
[[  6   2   0   0   2   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   9   0   0   2   0   0   2   0   0   0   0   0   0   0   0   0]
 [  0   0 153   0   0   0   3   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  71   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   5  22   0   1   0   0   0   0   0   0   0   0   1   0]
 [  0   0   0   0   0  18   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  12  34   0   2   2   0   0   0   0   0   0   0   0   0   0]
 [  3   0   0   0   0   0   0   2   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   8   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  11   0   0   0   5   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   7   0   0   2   0   1]
 [  0   0   0   0   0   0   0   0   0   0   0   1   0   0   2   0   4]
 [  0   0   0   0   0   0   0   0   0   0   0   0  18   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   5   0   0   0  10   0   0   0]
 [  0   0   1   0   0   0   0   0   0   1   0   2   0   0   2   0   3]
 [  0   0   0   0   0   0   0   0   0   0   2   0   2   3   0   1   6]
 [  0   0   0   0   0   0   0   0   0   0   3   4   0   0   0   1   1]]

>>>>>>>>>>>>>> 21 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/21/weights.39-0.52.hdf5
------ TRAIN ACCURACY:  weights.39-0.52.hdf5  ------
0.940910277609
[[ 145    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  202    0    0    1    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1732    0    4    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1923    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  903    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  724    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    1   40    2 1231    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  283    0    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    0    3  183    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  468   17    1    5   18
     4    1    2]
 [   0    0    0    2    0    1    1    1    0   28  444    8    2    4
     1    5    5]
 [   0    0    0    2    1    1    0    2    0    6   20  425   10   11
    12    1   18]
 [   1    1    0    0    0    0    0    3    0    0    6    8  609    4
     3    6    1]
 [   0    0    0    0    0    0    0    0    0   54    5    2    2  402
     0    1    7]
 [   0    0    0    0    0    1    0    8    1    0   16   37   19    1
   334    0    8]
 [   0    0    0    1    0    0    0    1    0    8   54   14   13    3
     5  348   54]
 [   0    0    0    0    0    0    0    0    0    5    4   30    5    9
     5   13  456]]
------ TEST ACCURACY:  weights.39-0.52.hdf5  ------
0.5
[[ 4  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1]
 [ 0  2  0  0  0  0  0  9  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  6  9  1  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0  6  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 15  7  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  4  0 19  0 23  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  9  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  2  0  0  0  2  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  9  3  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1 17  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  9  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  6  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  1  2  0  0  1  0  5  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  1  0  1  4  0]]

>>>>>>>>>>>>>> 22 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/22/weights.50-0.53.hdf5
------ TRAIN ACCURACY:  weights.50-0.53.hdf5  ------
0.945778329051
[[ 136    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1677    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1923    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0  854    0   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  720    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    9    0    4 1259    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  280    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1  182    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  442   11    5    2   41
     6    0    0]
 [   0    0    0    0    0    0    0    1    0   22  439    8    1    5
     2    8    4]
 [   0    0    0    0    1    2    0    1    0   17   25  403    8    8
    22    3    8]
 [   1    4    0    0    0    0    0    2    0    0    5    8  597    9
     6    6    0]
 [   0    0    0    0    0    0    0    0    0   27    4    0    0  429
     1    0    2]
 [   0    0    0    0    2    0    0    6    0    0   10   36   11    2
   347    0    3]
 [   0    0    0    0    0    0    0    0    0    5   63    2   11    6
     8  359   36]
 [   0    0    0    1    0    0    0    0    0    5    7   20    6   13
    16   20  424]]
------ TEST ACCURACY:  weights.50-0.53.hdf5  ------
0.657024793388
[[ 1  8  0  0  1  0  0  6  1  0  0  0  0  0  0  0  0]
 [ 0  5  0  0  2  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0 59  0  2  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  1  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 42  3  0  0  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  4  4  3 36  0  0  0  0  4  0  0  0  0  0]
 [ 0  4  0  0  0  0  0 11  1  0  0  0  0  0  0  0  0]
 [ 0  5  0  0  0  0  0  7  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  3  1]
 [ 0  0  0  0  0  0  0  0  0  3  7  3  0  0  0  0  8]
 [ 0  0  0  0  0  0  0  0  0  0  3  7  0  0 10  0  8]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 23  0  0  0  0]
 [ 1  5  0  0  0  0  0  1  0  5  0  3  0  1  4  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0 13  0  0]
 [ 0  0  0  6  0  0  0  0  0  2  6  0  0  0  0  0  9]
 [ 0  0  0  0  0  0  0  0  0  0  3  7  0  0  7  0  5]]

>>>>>>>>>>>>>> 23 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/23/weights.35-0.52.hdf5
------ TRAIN ACCURACY:  weights.35-0.52.hdf5  ------
0.939799038882
[[ 144    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  207    0    0    1    0    0    0    0    0    0    0    0    0
     0    0    1]
 [   0    0 1713    0    2    1    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1909    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  875    0   19    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    4    1    4 1268    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  279    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    1  191    0    0    0    0    0
     0    0    1]
 [   0    2    0    0    0    0    0    0    0  443    8    7    0   41
     3    0    3]
 [   0    0    0    0    0    3    0    1    0   28  434    4    1   14
     2    5   10]
 [   0    0    0    0    0    2    1    1    1   18   18  409    7   12
    17    8   23]
 [   1    3    0    0    0    0    0    1    1    2    4    9  608    9
     0    8    0]
 [   0    0    0    0    0    0    0    0    0   35    4    2    1  416
     0    2    9]
 [   0    0    0    0    2    0    0    7    0    0    9   28   16    2
   347    2   12]
 [   0    0    0    6    0    0    1    0    0    6   65    2    7    7
     0  358   46]
 [   0    0    0    0    0    2    0    0    0    5    4   34    1   12
     7   22  433]]
------ TEST ACCURACY:  weights.35-0.52.hdf5  ------
0.78527607362
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 11  4  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 74  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 20  3  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  2 43  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 15  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 22  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  0  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  9  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  2  5  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  0  8  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  0  0  0  9  2]
 [ 0  0  0  0  0  0  0  2  0  0  0  0  0  0  1  4  7]]

>>>>>>>>>>>>>> 24 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/24/weights.33-0.51.hdf5
------ TRAIN ACCURACY:  weights.33-0.51.hdf5  ------
0.932258064516
[[ 129    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  192    1    0    0    0    0    4    0    0    0    0    0    0
     0    0    0]
 [   0    0 1544    0    0    0   15    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1892    0    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  820    0   36    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0    0    2 1262    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  274    1    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    0  187    0    0    0    0    0
     0    1    1]
 [   0    0    0    0    0    0    0    0    0  434   14    1    0   42
     9    4    2]
 [   0    0    0    0    1    1    1    0    0   32  421   12    1   11
     3    6    7]
 [   0    0    0    0    1    2    1    2    1   20   17  427    1    4
    18    3   15]
 [   0    3    0    0    0    0    0    3    0   10    8   11  585    7
     4    8    1]
 [   0    0    0    0    1    0    0    0    0   49    0    2    0  404
     4    4    5]
 [   0    0    0    0    2    0    1    7    0    0   14   35    2    3
   340    0    5]
 [   0    0    0    0    1    0    1    0    0   11   66    6   12    9
     3  345   40]
 [   0    0    1    0    0    1    0    0    0   10    7   35    4    7
     6   14  432]]
------ TEST ACCURACY:  weights.33-0.51.hdf5  ------
0.759410801964
[[  7   9   0   0   0   0   0   3   1   0   0   0   0   0   0   0   1]
 [  0   7   0   0   0   0   0   2   0   0   0   1   5   0   0   4   0]
 [  0   0 175   0   2   0   2   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  69   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   1   0  57   2   3   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  27   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   2   8   0   0  46   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   6   0   0   0   0  11   0   0   1   0]
 [  0   1   0   0   0   0   0   1   8   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  21   0   0   2   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   8   0   5   0   0   0   2]
 [  0   0   0   0   0   0   0   0   0   3   0   1   2   8   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  18   2   0   1   0]
 [  0   0   0   0   0   0   0   0   0  10   0   0   0   5   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0  14   3   0   4   4   0]
 [  0   0   0   0   0   0   0   0   0   0   0   4  10   0   0   5   0]
 [  0   0   0   0   0   0   0   0   0   0   0  14   1   0   0   2   0]]

>>>>>>>>>>>>>> 25 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/25/weights.41-0.49.hdf5
------ TRAIN ACCURACY:  weights.41-0.49.hdf5  ------
0.940260425831
[[ 149    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1684    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1912    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  890    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  725    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    3    9    5 1248    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  286    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  192    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  442   10    2    5   45
     4    1    1]
 [   0    1    0    0    0    2    0    0    1   20  427    8    3   11
     2   11    6]
 [   0    0    0    2    0    3    1    1    2   15   12  426    7    9
    26    0    8]
 [   1    2    0    0    0    0    0    1    0    6    4   14  581    6
     4   12    2]
 [   1    6    0    0    1    1    0    0    1   44    0    3    3  392
     1    6    4]
 [   0    0    0    0    0    0    0    5    0    0    1   41   15    2
   343    5    7]
 [   0    0    0    6    0    0    0    4    0    2   35    6   15    4
     3  362   48]
 [   0    2    0    1    1    1    0    0    0    5    4   48    2    8
    13   12  416]]
------ TEST ACCURACY:  weights.41-0.49.hdf5  ------
0.78024691358
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 43  1  6  0  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 21  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0 51  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  7  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  2  0  0  6  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  1  8  4  0  0  0  4  2]
 [ 0  0  0  0  0  0  0  0  0  0  4  4  0  2  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 27  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 19  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  6  5  0  0  3  1  0]
 [ 0  0  0  0  0  0  0  0  0  3 18  3  0  3  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21]]

>>>>>>>>>>>>>> 26 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/26/weights.35-0.51.hdf5
------ TRAIN ACCURACY:  weights.35-0.51.hdf5  ------
0.938259728902
[[ 150    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1705    0    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1922    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  881    0    9    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11    4    5    7 1249    0    0    0    0    0    0    0
     0    0    0]
 [   1    0    0    0    0    0    0  287    2    0    2    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    0  199    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0    0  454   11    5    1   39
     0    0    1]
 [   0    0    0    0    0    4    0    1    0   19  436    4    4    8
     0   10    4]
 [   0    0    0    1    1    3    0    1    1   21   18  416    6    9
    13    0   17]
 [   0    0    0    0    0    0    0    0    0    8    8    7  585   17
     5    3    3]
 [   0    1    0    0    0    0    0    0    0   49    2    3    0  412
     0    2    8]
 [   0    0    0    0    1    0    0    2    1    4   15   38   12    4
   325    2   17]
 [   0    0    0    6    0    0    0    4    0    5   76    2    8    9
     4  348   32]
 [   0    0    0    0    0    1    0    0    0    4   17   34    2    9
     4   20  427]]
------ TEST ACCURACY:  weights.35-0.51.hdf5  ------
0.78869047619
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  2  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0 31  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 48  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  2  0  0  1  0  0  0]
 [ 0  0  0  0  0  1  0  0  3 14  1  0  0  1  0  1]
 [ 0  0  0  0  0  0  0  0  0  4  7  0  0  5  0  3]
 [ 1  3  0  0  0  0  0  3  0  0  0 15  2  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  6  0  0  1]
 [ 0  0  0  0  0  0  0  4  0  0  5  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  1  1  0  0  0  1  1 15]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  0  2  2  8]]

>>>>>>>>>>>>>> 27 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/27/weights.49-0.49.hdf5
------ TRAIN ACCURACY:  weights.49-0.49.hdf5  ------
0.941042487954
[[ 151    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  213    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1698    0    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1913    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  871    0   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0    0    2 1273    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  286    1    0    1    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    0    2  197    0    0    0    0    0
     0    0    0]
 [   1    0    0    0    0    0    0    1    0  448   13    8    0   34
     3    2    1]
 [   0    0    0    0    0    2    0    1    0   31  439    4    1    4
     3    6    6]
 [   0    0    0    2    0    1    1    1    0   21    9  415    9   11
    12    2   20]
 [   2    2    0    0    0    0    0    2    0    5    9    5  587    7
     6   12    3]
 [   0    0    0    0    1    0    0    0    0   61    3    1    0  397
     2    0    1]
 [   0    0    0    0    2    0    0    6    2    2   22   31    9    1
   342    4    2]
 [   0    0    0    6    0    0    0    1    0    7   50    8   11    8
     6  359   41]
 [   0    0    0    1    0    1    0    0    0    5   10   27    6    3
    13   13  439]]
------ TEST ACCURACY:  weights.49-0.49.hdf5  ------
0.820224719101
[[ 0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0 39  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  1 26  4  0  0  0  0  0  0  0  0  0  0]
 [ 0 15  1  0  0 29  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  7  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 17  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  1 13  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1 17  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 19  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  2  0  0  0 12  0  4  0]
 [ 0  0  0  0  0  0  0  2  0  1  2  3  0  1  1  1]
 [ 0  0  0  0  0  0  0  0  1 14  0  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  1 14]]

>>>>>>>>>>>>>> 28 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/28/weights.26-0.48.hdf5
------ TRAIN ACCURACY:  weights.26-0.48.hdf5  ------
0.926320384112
[[ 151    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  205    1    0    1    0    1    6    0    0    0    0    0    0
     0    1    0]
 [   0    0 1686    0    4    1   17    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1903    0    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  866    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    1    2    7 1271    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  281    7    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    3  196    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  452   13    8    2   29
     5    0    1]
 [   0    0    0    0    1    0    1    1    1   39  422    9    1    6
     3    7    4]
 [   0    0    0    0    1    3    0    2    0   17   18  420    7   10
    15    0   16]
 [   1    2    0    0    0    0    0    2    1    8    7   11  593    2
     2    7    2]
 [   1    1    0    0    1    0    0    0    0   64    3    0    3  389
     4    5    3]
 [   0    0    0    0    2    0    0    5    1    1   13   60   17    3
   312    4    8]
 [   0    0    0    0    1    0    1    3    0   13   72    8   19    4
     3  330   43]
 [   0    0    1    0    0    1    0    1    0    9   10   57    4    5
     7   11  412]]
------ TEST ACCURACY:  weights.26-0.48.hdf5  ------
0.829113924051
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 30  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 45  0  0 13  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 30  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 41  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 16  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  1  0  0 14  0  0  0  0  1  0]
 [ 0  0  0  0  0  0  1  1  0  0 12  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 23  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  7  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  1  3  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  2  0 13]
 [ 0  0  0  0  0  0  0  0  0  0  7  0  0  1  1  7]]

>>>>>>>>>>>>>> 29 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/29/weights.49-0.53.hdf5
------ TRAIN ACCURACY:  weights.49-0.53.hdf5  ------
0.943674484719
[[ 151    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  205    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1615    0    8    2    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1914    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  880    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    1    3    6 1272    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  277    5    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    0  191    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0    0  449   11    1    1   28
     7    1    1]
 [   0    0    0    2    0    0    0    0    0   29  423    9    0    3
     1    8    8]
 [   0    0    0    2    1    2    0    1    0   11   15  412    7    6
    26    3   18]
 [   0    3    0    0    0    0    0    1    0    5    3    1  599    9
     0    6    3]
 [   2    5    0    0    0    0    0    0    1   46    1    0    0  393
     2    1    7]
 [   0    0    0    0    1    0    0    4    0    3    6   33   15    0
   334    5   13]
 [   0    0    0    6    0    0    0    3    0    5   42    2   12    3
     2  370   48]
 [   0    0    0    5    0    0    0    0    0    5    3   40    2    2
    10   12  423]]
------ TEST ACCURACY:  weights.49-0.53.hdf5  ------
0.697087378641
[[  1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  1   6   0   0   0   0   0   2   1   0   0   0   0   0   0   0   0]
 [  0   0 104   0   0   0   2   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  68   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   5   0  18   0   7   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  32   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  15   0   0   0  24   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   1   0   0   9   0   0   2   0   0   0   0   1   0]
 [  0   0   0   0   0   0   0   2   5   0   0   0   0   0   0   1   0]
 [  0   0   0   0   0   0   0   0   0  29   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   0   3  18   2   2   0   0   2   0]
 [  0   0   0   0   0   2   1   0   0   8   0   1   5   0   0   1   4]
 [  0   0   0   0   0   0   0   0   0   0   1   4  18   0   0   7   1]
 [  0   0   0   0   1   0   0   0   0  17   3   0   1   1   2   0   1]
 [  0   0   0   0   0   0   0   0   0   0   2  13   2   1   0   0   2]
 [  0   0   0   0   0   0   0   1   0   3  12   0   1   0   0   1   2]
 [  0   0   0   0   0   1   0   0   0   0   0   1   3   0   1   2  24]]

>>>>>>>>>>>>>> 30 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_kpca_conv1d_10/30/weights.30-0.54.hdf5
------ TRAIN ACCURACY:  weights.30-0.54.hdf5  ------
0.934788348147
[[ 150    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  206    2    0    0    0    0    3    0    0    0    0    0    0
     0    0    1]
 [   0    0 1683    0    2    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1918    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0  867    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   33    5    0    7 1237    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  289    0    0    0    1    0    0
     1    0    0]
 [   1    0    0    0    0    0    0    2  192    0    0    1    0    0
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  449    6    2    0   36
     1    0    2]
 [   0    0    1    0    0    0    0    1    1   13  431    9    4    2
     3   13    9]
 [   0    0    0    1    0    2    1    0    0   18   17  422    2    8
    20    2    7]
 [   1    5    0    0    0    0    0    0    0    5    0   11  589    8
     0   14    1]
 [   2    5    0    0    0    0    0    0    0   57    0    8    1  381
     1    2    8]
 [   0    0    0    0    0    1    0    3    0    1    9   66   10    4
   316    3    1]
 [   0    0    0    6    0    0    0    4    0    9   55   14    8    3
     6  347   43]
 [   0    0    0    0    0    2    0    1    0    0    3   53    5    2
     6   12  426]]
------ TEST ACCURACY:  weights.30-0.54.hdf5  ------
0.703431372549
[[ 0  0  0  0  0  0  3  1  0  0  0  0  0  0  0  0]
 [ 0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 42  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  2  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 15  3  5  0  0  8  0  0]
 [ 0  0  0  0  0  0  0  0 17  1  1  0  4  0  1  0]
 [ 0  0  0  0  0  0  0  0  2  3 11  2  0  7  0  1]
 [ 0  0  0  0  0  0  0  0  0  3  1 21  0  0  2  0]
 [ 0  0  0  0  0  0  0  0 12  1  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0 18  0  0]
 [ 0  0  0  0  0  1  0  0  0  0  3  1  6  1  3  3]
 [ 0  0  0  0  0  0  0  0  8  0 14  0  2  0  0  0]]
[0.7421875, 0.6775300171526587, 0.8092105263157895, 0.5594855305466238, 0.785234899328859, 0.8155339805825242, 0.796969696969697, 0.7858942065491183, 0.6545893719806763, 0.7092651757188498, 0.7857142857142857, 0.718, 0.8328912466843501, 0.7580645161290323, 0.7949367088607595, 0.6944444444444444, 0.8072805139186295, 0.803448275862069, 0.8082706766917294, 0.7266811279826464, 0.5, 0.6570247933884298, 0.7852760736196319, 0.7594108019639935, 0.7802469135802469, 0.7886904761904762, 0.8202247191011236, 0.8291139240506329, 0.6970873786407767, 0.7034313725490197]
0.746204638484
0.0774471949381

Process finished with exit code 0

'''
