import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import numpy as np
import cPickle as pickle
from keras.models import Model, load_model
from keras.initializers import Constant, TruncatedNormal
from keras.layers import Input, Dense, Conv1D, Flatten, Dropout, Activation, BatchNormalization
from keras.layers.merge import concatenate
from keras.optimizers import Adam
from keras.callbacks import ModelCheckpoint
import keras.backend as K
from keras import losses
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix

# Load Kernel PCA data

X = pickle.load(open("data/X_unimib_kpca.p", "rb"))
y = pickle.load(open("data/y_unimib_kpca.p", "rb"))

n_classes = 17


# Below builds 1D CNN.

for i in range(30):
    test = y.loc[y[1] == i+1]
    # print y_sub
    test_index = test.index.values
    # print len(test_index)

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index], y_values[test_index]
    y_train = np.eye(n_classes)[y_train - 1]
    print X_train.shape # (11188, 151)

    # input layer
    input_signal = Input(shape=(151, 1))
    print K.int_shape(input_signal)

    # define initial parameters
    b_init = Constant(value=0.0)
    k_init = TruncatedNormal(mean=0.0, stddev=0.01, seed=2018)

    # first feature extractor
    conv11 = Conv1D(16, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn11 = BatchNormalization()(conv11)
    actv11 = Activation('relu')(bn11)
    conv12 = Conv1D(32, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv11)
    bn12 = BatchNormalization()(conv12)
    actv12 = Activation('relu')(bn12)
    flat1 = Flatten()(actv12)

    # second feature extractor
    conv21 = Conv1D(16, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn21 = BatchNormalization()(conv21)
    actv21 = Activation('relu')(bn21)
    conv22 = Conv1D(32, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv21)
    bn22 = BatchNormalization()(conv22)
    actv22 = Activation('relu')(bn22)
    flat2 = Flatten()(actv22)

    # third feature extractor
    conv31 = Conv1D(16, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn31 = BatchNormalization()(conv31)
    actv31 = Activation('relu')(bn31)
    conv32 = Conv1D(32, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv31)
    bn32 = BatchNormalization()(conv32)
    actv32 = Activation('relu')(bn32)
    flat3 = Flatten()(actv32)

    # merge feature extractors
    merge = concatenate([flat1, flat2, flat3])

    # dropout & fully-connected layer
    do = Dropout(0.9, seed=2018)(merge)
    output = Dense(n_classes, activation='softmax', bias_initializer=b_init, kernel_initializer=k_init)(do)

    # result
    model = Model(inputs=input_signal, outputs=output)

    # summarize layers
    print(model.summary())

    new_dir = 'model/unimib_kpca_conv1d_10/' + str(i+1) + '/'
    if not os.path.exists(new_dir):
        os.makedirs(new_dir)

    fpath = new_dir + 'weights.{epoch:02d}-{val_acc:.2f}.hdf5'
    cp_cb = ModelCheckpoint(fpath, monitor='val_acc', verbose=1, save_best_only=True, mode='auto', period=1)

    adam = Adam(lr=0.001)
    model.compile(loss=losses.categorical_crossentropy, optimizer=adam, metrics=['accuracy'])
    model.fit(np.expand_dims(X_train, axis=2), y_train, batch_size=64, epochs=50, verbose=2, validation_split=0.10,
              callbacks=[cp_cb], shuffle=True)

    del model
    K.clear_session()


# Below calculates average test data accuracy (LOSO CV).

acc = []

for i in range(30):
    test = y.loc[y[1] == i+1]
    test_index = test.index.values

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index] - 1, y_values[test_index] - 1

    print "\n>>>>>>>>>>>>>>", str(i+1), "-fold <<<<<<<<<<<<<<<<"
    path_str = 'model/unimib_kpca_conv1d_10/' + str(i+1) + '/'
    for path, dirs, files in os.walk(path_str):
        dirs.sort()
        files.sort()
        top_acc = []
        top_acc.append(files[-1])
        files = top_acc
        for file in files:
            print "========================================"
            print os.path.join(path, file)
            model = load_model(os.path.join(path, file))
            pred = model.predict(np.expand_dims(X_train, axis=2), batch_size=32)
            print "------ TRAIN ACCURACY: ", file, " ------"
            print accuracy_score(y_train, np.argmax(pred, axis=1))
            print confusion_matrix(y_train, np.argmax(pred, axis=1))
            pred = model.predict(np.expand_dims(X_test, axis=2), batch_size=32)
            print "------ TEST ACCURACY: ", file, " ------"
            print accuracy_score(y_test, np.argmax(pred, axis=1))
            print confusion_matrix(y_test, np.argmax(pred, axis=1))

            del model
            K.clear_session()

    acc.append(accuracy_score(y_test, np.argmax(pred, axis=1)))

print acc
print np.mean(acc)
print np.std(acc)

'''
-----
[0.6770833333333334, 0.7324185248713551, 0.8421052631578947, 0.5016077170418006, 0.714765100671141, 0.7961165048543689, 0.7575757575757576, 0.7707808564231738, 0.6376811594202898, 0.7284345047923323, 0.7678571428571429, 0.758, 0.7771883289124668, 0.7634408602150538, 0.7924050632911392, 0.7286324786324786, 0.7944325481798715, 0.7241379310344828, 0.8270676691729323, 0.7223427331887202, 0.575, 0.6714876033057852, 0.754601226993865, 0.7299509001636661, 0.691358024691358, 0.7559523809523809, 0.8146067415730337, 0.8227848101265823, 0.6932038834951456, 0.7450980392156863]
0.735603902938
0.071377346206
-----

/usr/bin/python2.7 /mnt/0cdd1a7e-3686-4cf7-9055-145eb5fe70f3/hcilab/OSS/electronicsletters2018/unimib/unimib_kpca_conv1d_10.py
/home/hcilab/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.

>>>>>>>>>>>>>> 1 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/1/weights.45-0.49.hdf5
------ TRAIN ACCURACY:  weights.45-0.49.hdf5  ------
0.914551681742
[[ 144    1    0    0    0    0    0    0    2    0    0    0    0    0
     0    0    0]
 [   0  196    2    0    0    0    0    7    1    0    0    0    0    0
     0    0    0]
 [   0    0 1676    0    4    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1906    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   28    0  842    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   80   16    1    3 1182    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    1    0    0  270   10    0    3    0    0    0
     1    2    0]
 [   0    0    0    0    0    0    1    2  194    0    0    0    0    0
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  437   19   14    1   43
     1    0    1]
 [   1    0    0    0    0    0    0    5    0   20  418   16    5   10
     3    7    9]
 [   0    0    0    0    1    1    1    2    0   12   20  408    9   17
    20    5   15]
 [   0    5    0    0    0    0    0    3    1    3   11   12  588   10
     0    4    5]
 [   0    1    0    0    2    0    0    0    0   53    8    4    2  394
     0    3    3]
 [   0    0    0    0    3    0    0    7    2    2   15   75    8    1
   293    2   11]
 [   0    0    0    0    1    0    0    0    0   15   55   12    8    4
     1  323   74]
 [   0    0    0    0    0    0    0    1    0    7   14   32    7    7
    12   10  426]]
------ TEST ACCURACY:  weights.45-0.49.hdf5  ------
0.677083333333
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  9  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  5  1  0 24  0  0  0  0  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0 28  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 20  0  0  0 22  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  3  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0  3  3  0  0  0  8  2]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0 14]
 [ 0  0  0  0  0  0  0  0  0  1  0  0 18  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  4  1  0  2  3  2  1]
 [ 0  0  0  0  0  1  0  0  0  0  3  4  0  0  3  1  3]
 [ 0  0  0  0  0  1  0  0  0  1  4  0  0  6  0  5  3]
 [ 0  0  0  0  0  0  0  2  0  2  2  6  0  0  1  0  5]]

>>>>>>>>>>>>>> 2 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/2/weights.26-0.50.hdf5
------ TRAIN ACCURACY:  weights.26-0.50.hdf5  ------
0.905076868073
[[ 137    8    0    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  179    3    0    6    0    0   11    2    0    0    0    1    0
     0    0    0]
 [   0    0 1576    0    3    3   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1901    0    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    0  843    0   28    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   15   11    1   12 1236    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    1    0    1  267    9    0    2    1    2    0
     1    0    0]
 [   0    0    1    0    0    0    0    8  182    0    2    0    0    0
     0    2    1]
 [   0    2    0    0    0    0    0    0    0  398   27    5    9   61
     1    3    2]
 [   0    0    1    0    2    0    2    3    1   27  384   23    4   11
     2   19    9]
 [   0    0    0    0    0    1    1    1    0    9   31  392   12   16
    22    6   11]
 [   0    1    1    0    0    0    0    2    0    7   16   12  565    9
     0    7    1]
 [   1    2    0    0    0    0    0    0    0   38    8    5    4  375
     1   14    4]
 [   0    0    2    0    4    1    0    7    2    1   30   61    3    6
   279    7    6]
 [   0    0    0    0    1    0    0    1    0   10   72    8   11   12
     3  326   42]
 [   0    0    0    0    0    1    0    1    0    8   19   40    8   10
     4   47  369]]
------ TEST ACCURACY:  weights.26-0.50.hdf5  ------
0.732418524871
[[  6   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0]
 [  0   7   0   0   4   0   0   0   0   0   0   0   0   0   0   0   1]
 [  0   0 133   0  10   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  37   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  29   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  49   0   0   0   0   0   0   0   0   0   0]
 [  1   0   0   0   0   0   0   7   0   0   0   0   0   0   0   0   1]
 [  0   0   0   0   0   0   0   1   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  11   0   0   3   5   0   2   0]
 [  0   0   0   0   0   0   0   0   0   0  10   2  10   0   0   1   0]
 [  0   0   0   0   2   0   0   3   0   0   0   5   2   1   1   6   4]
 [  0   0   0   0   0   0   0   0   0   0   3   0  34   0   0   3   0]
 [  0   0   0   0   0   0   0   0   0   8   3   0   4  16   0   1   0]
 [  0   0   0   6   0   0   1   0   0   1   0   3   0   4   2   8   0]
 [  0   0   0   0   1   0   0   0   0   0   4   4  11   2   0   3   2]
 [  0   0   0   0   0   0   0   1   0   0   0  18   2   0   0   5   1]]

>>>>>>>>>>>>>> 3 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/3/weights.35-0.52.hdf5
------ TRAIN ACCURACY:  weights.35-0.52.hdf5  ------
0.916804744048
[[ 140    5    0    0    0    0    0    1    1    0    0    0    0    0
     0    0    0]
 [   5  194    2    0    4    0    0    7    1    0    0    0    1    0
     0    0    1]
 [   0    0 1703    0    5    1    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1904    0    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  866    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    7    2    9 1261    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    0    0    0  270    8    0    1    1    0    0
     2    0    0]
 [   0    1    1    0    0    0    0    7  187    0    0    0    0    0
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  454    9    8    3   32
     5    1    1]
 [   1    0    0    0    1    0    2    3    0   37  391   18    3    9
     3   17   14]
 [   0    0    0    0    1    1    1    4    0   12   22  407   12   10
    26    6   14]
 [   0    3    0    0    0    0    0    1    0    0    8   14  609    9
     0    3    0]
 [   0    2    0    0    2    0    0    0    0   85    4    1    1  368
     2    4    2]
 [   0    0    0    0    1    1    2    5    1    1   17   75   13    2
   295    4   10]
 [   0    0    0    0    1    0    0    0    1   16   60   21   10    6
     8  318   62]
 [   0    0    0    0    0    1    0    0    0   11    9   37    4   23
     7    5  430]]
------ TEST ACCURACY:  weights.35-0.52.hdf5  ------
0.842105263158
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 73  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  2 36  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 10  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  5  0  0  7  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  8  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 12  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  0  0  0  5  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  5  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  2  0  0  0  1  0  0  0  6  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  1  0  0  1  1]]

>>>>>>>>>>>>>> 4 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/4/weights.36-0.51.hdf5
------ TRAIN ACCURACY:  weights.36-0.51.hdf5  ------
0.913438045375
[[ 145    8    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  203    0    0    1    0    0    5    1    0    0    0    0    0
     0    0    1]
 [   0    0 1712    0    4    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1924    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    0  854    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   19   19    1    8 1250    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    1    0    0  271    4    0    3    3    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    6  182    0    1    0    0    0
     0    0    1]
 [   0    2    0    0    0    0    0    0    0  443   18    5    3   50
     1    0    0]
 [   0    0    0    0    3    0    0    5    0   29  385   18    3   11
     6   21   11]
 [   0    1    0    0    0    0    2    4    0   19   20  399   11    8
    22    7   10]
 [   0    6    1    0    0    0    0    0    0    5   10   14  587    9
     0    8    3]
 [   0    4    0    0    1    0    0    0    0   55    3    0    2  388
     2    5    7]
 [   0    0    0    0    1    1    1    7    3    2   14   92    1    1
   283    1   14]
 [   0    0    0    0    1    0    0    0    0   15   62   11   10    9
     7  306   76]
 [   0    0    0    0    0    1    0    1    0   12    6   48    2    8
     6    9  419]]
------ TEST ACCURACY:  weights.36-0.51.hdf5  ------
0.501607717042
[[ 2  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  2  0  8  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 54  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0 27  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 11  0  2  0  0  0  0  6  0  0  5  3]
 [ 0  0  0  9  0 18  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  1  0  0  6  0  0  0  0  0  0  2  0  0]
 [ 0  0  0  0  0  0  8  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  1  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  8  1  0  0  1  0  9  0]
 [ 0  0  0  0  0  0  0  0  3  7  7  0  1  5  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  8  1  0  5  0]
 [ 0  0  0  0  0  0  0  0  7  0  3  0  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  6  0  0  1  1  0]
 [ 0  0  0  0  0  0  0  0  6  1  1  0  4  0  1  3]
 [ 0  0  0  0  1  0  0  0  8  0  0  3  3  0  3  4]]

>>>>>>>>>>>>>> 5 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/5/weights.45-0.51.hdf5
------ TRAIN ACCURACY:  weights.45-0.51.hdf5  ------
0.924169789942
[[ 139    6    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  194    1    0    2    0    0    5    1    0    0    0    0    0
     0    0    1]
 [   0    0 1709    0    2    1    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1911    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  883    0   18    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10    3   13    4 1262    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    1    0    0    0    0  281    3    0    1    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    9  188    0    0    0    0    0
     0    0    1]
 [   0    2    0    0    0    0    0    0    0  438   13   10    4   39
     6    0    1]
 [   0    0    1    0    2    0    1    4    0   34  394   18    6   10
     6    9   17]
 [   0    1    0    1    1    0    2    7    1   12   14  392   10    9
    35    7   13]
 [   0    4    0    0    0    0    0    2    0    1    9   16  592    8
     2   12    0]
 [   1    2    0    0    1    0    0    0    0   53    2    3    2  395
     4    5    6]
 [   0    2    0    0    2    0    0    7    0    0   11   46    7    0
   333    1   16]
 [   0    0    0    0    1    0    0    0    0   11   50   13    9    7
     8  343   56]
 [   0    0    0    0    0    0    0    1    1   13    7   22    3   15
     7   21  426]]
------ TEST ACCURACY:  weights.45-0.51.hdf5  ------
0.714765100671
[[ 5  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  6  5  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 66  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 18  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  4  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  1  6  0  2  0]
 [ 0  0  0  0  0  0  0  0  1  0  2  0  0  0  2  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  8  0  0  8  0  5]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  1  0  0  2  0  1  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  5  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  1  0  0  2  0 11]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  6  0  4  3  3]]

>>>>>>>>>>>>>> 6 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/6/weights.48-0.50.hdf5
------ TRAIN ACCURACY:  weights.48-0.50.hdf5  ------
0.919271062594
[[ 150    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  200    0    0    0    0    0   12    0    0    0    0    0    0
     0    0    0]
 [   0    0 1680    0    1    2    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1921    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    0  840    1   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14   18    1   11 1230    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    0    0    0  272    3    0    2    0    0    0
     0    1    0]
 [   1    0    0    0    0    0    0    7  186    0    0    0    0    0
     0    0    1]
 [   0    2    0    0    0    0    0    0    0  405    6   13    3   73
     0    5    3]
 [   0    0    0    0    1    0    1    7    0   25  377   13    6   15
     5   34   12]
 [   0    0    0    0    0    2    1    1    0   10   18  381   12   20
    31    6   25]
 [   0    1    0    0    0    0    0    2    1    0    6   13  590   11
     2   12    0]
 [   0    3    0    0    1    0    0    0    0   28    1    2    4  412
     3    7    3]
 [   0    1    1    0    0    0    0   11    2    1    9   57   12    2
   304    8    8]
 [   0    0    0    0    1    0    0    2    0   12   33    7   13   10
     6  351   58]
 [   0    2    0    0    0    1    0    2    0    5    7   21    7   18
     5   22  426]]
------ TEST ACCURACY:  weights.48-0.50.hdf5  ------
0.796116504854
[[ 2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0 43  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 29  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  4  0  0 44  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0  0  1 13  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 17  0  0  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  4  7  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  5  0 10  0  0  4  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  1  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 12  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  3  0  0 12  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  3  3 13]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  3 15]]

>>>>>>>>>>>>>> 7 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/7/weights.30-0.49.hdf5
------ TRAIN ACCURACY:  weights.30-0.49.hdf5  ------
0.90621449174
[[ 146    0    0    0    0    0    0    1    6    0    0    0    0    0
     0    0    0]
 [   3  184    2    0    3    0    0   16    1    0    0    0    0    0
     1    0    1]
 [   0    0 1669    0    6    1   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1926    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  855    0   25    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  724    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11   19    3    8 1250    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    1    0    1  271    8    0    2    1    0    0
     1    1    0]
 [   0    0    1    0    0    0    0    9  180    0    0    0    0    0
     0    1    1]
 [   0    2    0    0    0    0    0    0    0  435   13    8    3   47
     3    0    5]
 [   0    0    1    0    0    0    2    7    1   41  372   18    2   12
     7   19   14]
 [   1    0    0    1    1    1    1    2    0   19   14  405   12   12
    20    3   16]
 [   0    7    0    0    0    0    0    0    1   14    8   11  574    9
     0   18    1]
 [   0    2    0    0    1    0    0    0    0   68    1    3    1  356
     6    7   17]
 [   0    0    0    1    2    1    0    6    0    7   19   98    1    1
   274    5   11]
 [   0    0    0    0    1    0    0    0    2   17   57   16   10   10
     5  318   64]
 [   0    1    0    0    0    0    0    1    1   10    6   32    2    8
     8   24  429]]
------ TEST ACCURACY:  weights.30-0.49.hdf5  ------
0.757575757576
[[ 4  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0 44  0  0  0  5  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  1  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  2  5  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 13  0  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  4  5  0  0  5  0  4]
 [ 0  1  0  0  0  0  0  0  2  0  0 13  0  0  2  0]
 [ 0  0  0  0  0  0  0  0 13  0  0  0  7  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  0  2  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  4  7]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  6  6]]

>>>>>>>>>>>>>> 8 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/8/weights.46-0.47.hdf5
------ TRAIN ACCURACY:  weights.46-0.47.hdf5  ------
0.923949358185
[[ 147    3    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  207    0    0    0    0    0    8    1    0    0    0    0    0
     0    0    0]
 [   0    0 1668    0    0    1    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1924    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  872    0   18    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    5    1    7 1258    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  267   13    0    0    0    0    0
     0    1    0]
 [   0    1    0    0    0    0    0    2  185    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  409   11   20    2   54
     0    3    2]
 [   1    0    0    0    1    0    0    1    2   23  402   20   11    5
     1   15   12]
 [   0    0    0    0    1    2    1    3    0    9   16  402    8   10
    26    9   22]
 [   0    2    1    0    0    0    0    1    0    3   13   13  584   10
     0    4    5]
 [   0    4    0    0    0    0    0    0    0   46    6    4    8  379
     6    5    7]
 [   0    0    0    0    3    0    0    9    2    1   20   53   12    0
   310    2    8]
 [   0    0    0    0    1    0    0    0    0    8   55    8   10    9
     3  345   64]
 [   0    0    0    0    0    0    0    0    1    5    5   32    5   13
     3   20  429]]
------ TEST ACCURACY:  weights.46-0.47.hdf5  ------
0.770780856423
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 52  0  0  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  5  0  0  0 42  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  7  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  9  0  2  0  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0 11  7  0  0  0  0  0  8]
 [ 0  0  0  0  0  0  0  1  0  0 15  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  0  7  6  0  0  1  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  1  0 24  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  1  1  8  0  8  0]
 [ 0  0  0  0  0  0  0  1  3  0  3  4  0  0  2  1  0]
 [ 0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  4  4]
 [ 0  0  0  0  0  0  0  1  0  0  0  3  0  4  1  3  9]]

>>>>>>>>>>>>>> 9 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/9/weights.40-0.50.hdf5
------ TRAIN ACCURACY:  weights.40-0.50.hdf5  ------
0.918640486044
[[ 147    3    0    0    0    0    0    1    1    0    0    0    0    0
     0    0    0]
 [   0  207    1    0    0    0    0    4    0    0    0    0    0    0
     0    0    1]
 [   0    1 1681    0    2    1    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1919    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   15    0  856    2   28    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  719    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   29    7    2    8 1231    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    1    0    0  273    5    0    2    1    0    0
     1    2    0]
 [   1    0    0    0    0    0    0    4  181    0    3    1    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  452    4   12    2   28
     1    7    1]
 [   1    0    0    1    5    0    0    1    1   37  375   15    4    5
     3   21   13]
 [   0    0    1    1    3    1    0    2    0   19   20  398    4   11
    28    6   12]
 [   0    4    0    0    0    0    0    1    1   13    9   15  563    7
     3    8    0]
 [   1    1    1    0    1    0    0    0    0   71    5    7    1  370
     1    6    8]
 [   0    0    0    0    2    2    0    4    1    0   17   53   11    0
   319    7    5]
 [   0    0    0    0    1    0    0    0    2   10   46   10    5    9
    14  336   49]
 [   0    1    0    0    0    0    0    0    0   10   20   30    2    7
    14   15  406]]
------ TEST ACCURACY:  weights.40-0.50.hdf5  ------
0.63768115942
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  1  0  0  0  0  0  0  1  0  0]
 [ 0  0 49  0  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 60  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 15  0  5  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  1  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0 15  0  1  0]
 [ 0  0  0  0  1  0  0  3  0  3 11  0  0  0  0 10  1]
 [ 0  0  0  0  3  0  0  2  1  0  0  0  0  0 14  0  0]
 [ 0  0  5  0  0  0  0  0  0 11  1  0 20  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  1  1  0  1  0  0  4]
 [ 0  0  0  0  1  0  0  1  1  0  0  0  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  4  3  1  8 10]
 [ 0  0  0  0  1  1  0  0  0 12  0  1  1  0  0 13  0]]

>>>>>>>>>>>>>> 10 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/10/weights.39-0.48.hdf5
------ TRAIN ACCURACY:  weights.39-0.48.hdf5  ------
0.914819340199
[[ 146    6    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   1  205    1    0    0    0    0    8    0    0    0    0    0    0
     0    0    1]
 [   0    0 1695    0    3    2    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1925    0    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  882    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  727    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   52   12   10    2 1219    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    0    0    0    0    0  280    4    0    1    3    1    0
     1    0    0]
 [   0    0    0    0    0    0    1    5  177    0    0    0    1    0
     1    1    1]
 [   0    2    0    0    0    0    0    0    0  411   14    2    7   66
     3    2    0]
 [   0    0    1    1    2    0    0    3    0   32  398   19    8   11
     1   12   11]
 [   0    0    0    0    0    0    1    3    0    9   17  410    9   17
    18    5   15]
 [   0    4    0    0    0    0    0    0    0    4   15    9  597    8
     0    3    3]
 [   2    3    0    0    0    0    0    0    0   53    2    7    0  388
     2    3    7]
 [   0    1    0    0    1    1    0   10    3    3   14   78    7    4
   284    1   13]
 [   0    0    0    0    1    0    0    0    0   15   60   25    8    9
     2  331   50]
 [   0    0    0    0    0    2    0    0    0   10   10   32    3   19
    16   18  407]]
------ TEST ACCURACY:  weights.39-0.48.hdf5  ------
0.728434504792
[[32  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 51  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0 13  0 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 17  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  7 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  7  3  0  0  0  0  1  0  2  0]
 [ 0  0  0  0  0  0  0 21  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  8  4  0  0  0  0  0]
 [ 0  0  0  1  0  0  0  1  5 12  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0 18  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  0  0  1 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  9  0  0]
 [ 0  0  0  0  0  0  0  0  8  1  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  3  0  0  3  1  0  0 10]]

>>>>>>>>>>>>>> 11 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/11/weights.21-0.49.hdf5
------ TRAIN ACCURACY:  weights.21-0.49.hdf5  ------
0.867650935935
[[ 117   20    1    0    0    0    0    5    4    0    0    0    0    0
     0    0    0]
 [   6  179   12    0    2    0    0    9    1    0    0    0    1    0
     0    0    1]
 [   0    0 1681    0   23    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8 1886    0    1    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    5    3    0  839    8   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  725    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    1   41   25   30   23 1147    0    0    0    0    0    0    0
     0    0    0]
 [   0    9    0    0    1    0    0  250   20    0    3    2    0    1
     2    0    0]
 [   1    0    1    0    0    0    0   12  176    0    2    0    1    0
     0    1    1]
 [   0    2    0    0    0    0    0    0    0  401   15    9   11   69
     0    1    3]
 [   0    0    1    0    2    0    1   12    2   34  336   35   13   14
     5   29    7]
 [   0    3    0    0    2    0    1    8    6   12   33  353   19   14
    29   10   22]
 [   0    7    0    0    0    0    0    0    1    4    7   11  581    9
     0   15    2]
 [   0    6    0    0    0    0    0    0    1   81    5    5    9  343
     4    7    4]
 [   0    0    1    0    5    1    0   15    6    2   32   73    4   12
   249    7    9]
 [   0    0    0    0    1    0    1    2    2   19   63   15   30   29
     4  290   43]
 [   0    0    1    0    0    1    0    1    2   24   28   53   15   13
     9   51  320]]
------ TEST ACCURACY:  weights.21-0.49.hdf5  ------
0.767857142857
[[ 3  0  0  0  0  0  0  0  0  0  0  0  3  0  0  0  0]
 [ 3  1  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0]
 [ 0  0 23  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 82  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  2  0 36  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  9  0  0  0 48  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  6  0  0  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  2  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0  4  0  7]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  3  9  0  3  0]
 [ 0  0  0  0  0  0  0  2  0  0  0  0  0  0  9  0  7]
 [ 0  0  0  0  0  1  0  0  0  0  4  0  6  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  3  3  2  0  0  5]]

>>>>>>>>>>>>>> 12 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/12/weights.48-0.51.hdf5
------ TRAIN ACCURACY:  weights.48-0.51.hdf5  ------
0.926448407417
[[ 143    2    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   2  197    1    0    0    0    0   10    1    0    0    0    0    0
     0    0    0]
 [   0    0 1550    0    0    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1904    0    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  855    0   28    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    4    0    7 1270    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  284    7    0    2    0    0    0
     1    0    0]
 [   0    1    0    0    0    0    0    5  190    0    0    0    0    0
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  434   18    4    2   48
     3    0    1]
 [   1    0    0    0    2    0    1    4    0   35  415    2    4    7
     6    8   11]
 [   0    0    0    0    0    1    1    0    0   12   18  416   10   10
    24    5   17]
 [   1    7    0    0    0    0    0    0    0    0   13   11  587    9
     0    8    5]
 [   2    1    0    0    1    0    0    0    0   43    5    2    2  399
     2    6    1]
 [   0    0    0    0    0    1    0    8    2    0   20   56   13    2
   308    1   13]
 [   0    0    0    0    1    0    0    0    0   13   55   15    7   13
     1  346   45]
 [   0    0    0    0    0    0    0    4    0    9    6   27    6   12
     7   14  430]]
------ TEST ACCURACY:  weights.48-0.51.hdf5  ------
0.758
[[  6   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  3   2   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 139   0   0   0  43   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  26   0   6   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  24   8   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  36   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   2   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  11   0   0   2   2   0   0   2]
 [  0   0   0   0   0   0   0   0   0   0   5   2   1   0   0   5   2]
 [  0   0   0   0   0   0   0   0   0   0   0   8   0   0   2   2   0]
 [  0   0   0   0   0   0   0   0   0   2  10   0   2   0   0   6   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0  20   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   1   0   0   0   8   0   1]
 [  0   0   0   0   0   0   0   0   0   0   8   0   0   0   4   5   0]
 [  0   0   0   0   0   0   0   0   0   0   5   1   1   0   0   1  11]]

>>>>>>>>>>>>>> 13 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/13/weights.45-0.50.hdf5
------ TRAIN ACCURACY:  weights.45-0.50.hdf5  ------
0.918553624715
[[ 147    1    0    0    0    0    0    1    1    0    0    0    0    0
     0    0    0]
 [   0  195    3    0    2    0    0    9    0    0    0    1    0    0
     0    0    0]
 [   0    0 1705    0    2    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1911    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  870    0   10    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   28   22   17    7 1205    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    1    0    0  271    4    0    0    0    1    0
     1    0    0]
 [   0    0    0    0    0    0    1    6  189    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    1  440   20    2    4   37
     0    0    1]
 [   0    0    1    0    1    0    0    5    1   36  416    7    3    2
     3   12    6]
 [   0    0    0    0    1    1    2    4    1   13   33  402    9   14
    17    2    9]
 [   0    3    0    0    0    0    0    5    0    5    7   10  584    5
     2   14    1]
 [   0    2    0    0    0    0    0    0    0   64    6    4    6  382
     2    5    3]
 [   0    0    0    0    0    0    0    9    1    1   20   67   15    3
   295    1    6]
 [   0    0    0    0    0    0    0    0    0   12   71   11   10   10
     7  333   41]
 [   0    0    0    0    0    0    0    1    0   11   10   28    7   15
    13   27  400]]
------ TEST ACCURACY:  weights.45-0.50.hdf5  ------
0.777188328912
[[ 1  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  0  0  0  0  0  4  0  0  0  0]
 [ 0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0 44  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0 14  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  3  0  0  4  0  0  8]
 [ 0  0  0  0  0  0  1  0  0  0  5  0  0  0  0  0 12]
 [ 0  0  0  0  0  0  1  0  0  0  9  3  2  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 25  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  6  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0 13  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  1 14  0]
 [ 0  0  0  0  0  0  0  0  0  1  3  0  1  0  0 15  2]]

>>>>>>>>>>>>>> 14 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/14/weights.29-0.51.hdf5
------ TRAIN ACCURACY:  weights.29-0.51.hdf5  ------
0.910167558558
[[ 148    3    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   3  200    0    0    1    0    0    4    1    0    0    0    0    0
     1    0    0]
 [   0    1 1664    1    1    2   15    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1921    0    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    0  835    1   33    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   16   11    2    8 1237    0    0    0    0    0    0    0
     0    0    0]
 [   1    6    0    0    0    0    0  267   10    0    2    4    2    0
     0    0    0]
 [   1    0    1    0    0    0    0    8  182    0    2    0    0    0
     0    0    1]
 [   0    2    0    0    0    0    0    0    0  439   17    3    5   43
     5    2    0]
 [   1    0    0    0    1    0    0    3    1   37  380   25    3    6
     7   12   17]
 [   0    2    0    0    0    0    1    1    0    7   24  385   17   15
    30    6   15]
 [   0    4    0    0    0    0    0    3    0    4    9   10  590    9
     3    9    0]
 [   2    3    0    0    1    0    0    0    0   59    7    1    3  378
     3   13    4]
 [   0    1    0    0    3    0    0    4    1    1   16   70    4    2
   297    5   10]
 [   0    0    0    0    0    0    0    0    0   15   58   12   16    7
     3  330   54]
 [   0    0    0    0    0    1    0    1    0   16   14   38    4   12
     9   28  400]]
------ TEST ACCURACY:  weights.29-0.51.hdf5  ------
0.763440860215
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 3  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0 42  0  3  0  9  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 38  0  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  2  1  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0  0  0  0  4  0  0  0  7  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 15  0  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  6 11  0  0  4  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 18  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  8  0  0 10  2  0]
 [ 0  0  0  0  0  0  0  0  0  0 13  0  0  0  2  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  4  1  0  0  1  1  4]]

>>>>>>>>>>>>>> 15 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/15/weights.44-0.53.hdf5
------ TRAIN ACCURACY:  weights.44-0.53.hdf5  ------
0.929676511955
[[ 138    6    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  205    1    0    0    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1678    0    6    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1890    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  894    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  713    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    5   16    9 1230    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  278    3    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    0    4  187    0    0    0    0    0
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  451   13    3    2   38
     2    5    1]
 [   0    1    0    0    2    0    0    3    0   25  391   13    9    7
     7   29    6]
 [   0    0    1    0    1    1    1    2    0   12   17  416   13   10
    19    7   12]
 [   0    5    0    0    0    0    0    1    0    0    5   13  600    6
     0   11    2]
 [   0    2    0    0    1    0    0    0    0   52    3    3    2  397
     1    5    3]
 [   0    1    0    0    4    0    0    9    1    2    9   52    6    1
   319    7    5]
 [   0    0    0    0    1    0    0    0    0   12   46   11   11   10
     2  367   40]
 [   0    0    0    0    0    0    0    0    0    9    4   37    7    7
     8   25  422]]
------ TEST ACCURACY:  weights.44-0.53.hdf5  ------
0.792405063291
[[ 4  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 88  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 14  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 13 42  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0 11  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0  0  0  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  2  2  0  0  0]
 [ 0  0  1  0  0  0  0  0  0  0 14  0  0  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  5  0  0  0  1  4]
 [ 0  0  0  0  0  0  0  0  0  3  0  2  5  2  2  2  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0]
 [ 0  0  0  0  1  0  0  0  0  0  3  7  0  0  4  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  3  0  0  1  5]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0 13]]

>>>>>>>>>>>>>> 16 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/16/weights.42-0.51.hdf5
------ TRAIN ACCURACY:  weights.42-0.51.hdf5  ------
0.918340263647
[[ 143    0    0    0    0    0    0    0    2    0    0    0    0    0
     0    0    0]
 [   2  188    0    0    0    0    0    7    1    0    0    1    0    0
     0    0    0]
 [   0    0 1666    0    2    2   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1904    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  824    0   45    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  715    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    6    1    7 1247    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  261    6    0    1    1    0    0
     3    1    0]
 [   0    0    0    0    0    0    1    6  185    0    0    0    0    0
     1    0    0]
 [   0    2    0    0    0    0    0    0    0  449   16   16    2   22
     0    0    3]
 [   0    0    0    0    1    2    1    6    0   42  398    8    2    4
     5   11   12]
 [   0    1    0    1    1    1    1    1    1   20   23  382   12    5
    39    8   16]
 [   0    2    0    0    0    0    0    1    0    0   10   14  594    5
     2    8    4]
 [   0    1    0    0    0    0    0    0    0   87    7    4    6  351
     1    2   11]
 [   0    0    0    0    2    0    1    3    1    3   18   38   10    5
   331    3    8]
 [   0    0    0    0    1    0    0    0    0   13   56    9   13   11
     6  321   61]
 [   0    0    0    0    0    1    0    0    1   12    6   31    4    8
    10   14  421]]
------ TEST ACCURACY:  weights.42-0.51.hdf5  ------
0.728632478632
[[ 3  5  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 8  5  0  0  0  0  0  2  2  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 77  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 46  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4 26  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 12  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 16  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 16  0  0  2  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  3 14  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  6  0  0  7  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0 19  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  0  4  0  3  0]
 [ 0  0  0  0  0  0  0  1  1  2  3  0  0  0  2  0  2]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  0  0  2  8  4]
 [ 0  0  0  0  0  0  0  0  0  0 12  0  0  0  0 14  0]]

>>>>>>>>>>>>>> 17 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/17/weights.44-0.52.hdf5
------ TRAIN ACCURACY:  weights.44-0.52.hdf5  ------
0.918524416136
[[ 148    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   3  187    1    0    0    0    0    8    2    0    0    0    0    0
     0    0    0]
 [   0    0 1610    5    6    1   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1900    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    1    0  862    4   25    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  727    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3   33    2   12 1224    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    1    0    0  271    4    0    3    1    1    0
     0    0    0]
 [   0    1    0    0    0    0    0    7  185    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  430   14    3    5   53
     6    1    3]
 [   1    0    0    0    2    1    0    3    0   29  404   18    9    7
     3    6   12]
 [   0    0    0    0    1    2    1    5    0    9   16  406   14   10
    22    9   10]
 [   0    5    0    0    0    0    0    2    0    0    9   13  595    6
     2    6    3]
 [   0    3    0    0    1    0    0    0    0   53    4    4    4  379
     3    9    4]
 [   0    1    0    0    3    0    0    5    1    1   17   65   11    1
   299    3    4]
 [   0    0    0    0    1    0    0    0    2   12   59   12   15    2
     4  334   54]
 [   0    0    0    0    0    0    0    0    0   10    7   22    6   14
    11   25  422]]
------ TEST ACCURACY:  weights.44-0.52.hdf5  ------
0.79443254818
[[  4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  3   9   0   0   0   0   0   3   0   0   0   0   0   0   0   0   0]
 [  0   0 103   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  81   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  12   0  16   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  19   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  50   0   0   0   0   0   0   0   0   0   0]
 [  2   0   0   0   0   0   0  11   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   2   5   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   0   3   2   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0  12   0   0   0   1   3   0]
 [  0   0   0   0   0   0   0   0   0   0   0  11   0   1   4   0   5]
 [  0   0   0   0   0   0   0   0   0   0   0   0  17   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   0   6   7   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   5   0   0   7   5   6]
 [  0   0   0   0   0   0   0   0   0   5   7   0   0   2   0   4   0]
 [  0   0   0   0   0   0   0   0   0   0   4   2   0   0   2   1   8]]

>>>>>>>>>>>>>> 18 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/18/weights.28-0.51.hdf5
------ TRAIN ACCURACY:  weights.28-0.51.hdf5  ------
0.905060534797
[[ 129    6    0    0    0    0    0    2    2    0    0    0    0    0
     0    0    0]
 [   2  195    3    0    0    0    0    6    1    0    0    0    0    0
     0    0    0]
 [   0    0 1721    0    6    3    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6 1920    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   16    0  850    1   28    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  728    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   28   18    2    7 1238    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    1    0    0    0    0  264    6    0    3    2    1    0
     0    3    0]
 [   0    1    0    0    0    0    1   15  170    0    0    0    0    0
     0    2    0]
 [   0    2    0    0    0    0    0    0    0  439   18    5    4   42
     1    4    0]
 [   0    0    1    0    1    0    1    5    0   37  390   12    1    8
     9   22    6]
 [   0    0    0    1    1    2    1    3    0    9   30  393    9    9
    22    7   22]
 [   1    2    0    0    0    0    0    4    0    5   10   13  588    6
     3    8    3]
 [   0    5    0    0    0    0    0    0    0   70    4    7    5  362
     2    5   11]
 [   1    0    0    0    0    1    1    4    0    1   27   81    2    1
   282    3   19]
 [   0    0    0    0    0    0    1    1    1   12   68   15   13    9
     5  305   73]
 [   0    0    0    0    0    1    0    0    1   13   14   47    4    8
     4   12  417]]
------ TEST ACCURACY:  weights.28-0.51.hdf5  ------
0.724137931034
[[ 6  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  4  0  0  0  0  0  0  0  0  1]
 [ 0  0 56  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  0  7  6  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 31  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 13  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  3  7  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  7  0  0  0  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  3  0  0  3  0  1]
 [ 0  0  0  0  0  0  0  0  1  0  4  0  1  0  6  5]
 [ 0  0  0  0  0  0  0  0  0  0  0 15  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 11  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  7  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  1  2  0  2  1  4]
 [ 0  0  0  0  0  0  0  0  0  8  1  0  0  0  0  4]]

>>>>>>>>>>>>>> 19 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/19/weights.46-0.50.hdf5
------ TRAIN ACCURACY:  weights.46-0.50.hdf5  ------
0.923424598001
[[ 145    0    0    0    0    0    0    1    1    0    0    0    0    0
     0    0    0]
 [   2  184    6    0    0    0    0   11    0    0    0    0    1    0
     0    0    0]
 [   0    0 1722    0    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6 1905    0    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   12    0  879    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   21    1    0    5 1266    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  286    1    0    1    1    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    8  181    0    0    0    0    0
     0    1    1]
 [   0    2    0    0    0    0    0    0    0  468   17    2    3   26
     2    1    0]
 [   0    0    1    0    0    0    0    5    0   32  403   10    1    6
     5   21   12]
 [   0    0    0    0    0    0    1    2    0   18   15  419   13   10
    23    4   12]
 [   0    3    0    0    0    0    0    2    0    1    9   12  596    6
     0   12    3]
 [   0    2    0    0    0    1    0    0    0   58    5    4    2  386
     1    5   10]
 [   0    0    0    0    1    0    0    5    3    1   13   81    3    3
   298    2    9]
 [   0    0    0    0    1    0    0    0    0    9   55    9    9    6
     8  343   64]
 [   0    0    0    0    0    0    0    0    0    9    6   46    7   11
     7   15  421]]
------ TEST ACCURACY:  weights.46-0.50.hdf5  ------
0.827067669173
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  7  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 14  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0 30  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  7  0  1  0]
 [ 0  0  0  0  0  0  0  3  0  2  4  0  0  0  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  7  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  2  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  7  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  7  5]]

>>>>>>>>>>>>>> 20 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/20/weights.47-0.51.hdf5
------ TRAIN ACCURACY:  weights.47-0.51.hdf5  ------
0.910167992927
[[ 141    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  190    5    0    1    0    0    4    0    0    0    1    0    0
     0    1    0]
 [   0    0 1573    3    4    1    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   15 1890    0    0    9    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   51    0  819    0   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  727    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   92    5    0   10 1167    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    1    0    1    0    0  271    8    0    2    1    1    0
     2    0    0]
 [   0    1    0    0    0    0    0    5  185    0    0    0    0    0
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  425   10   11    6   55
     0    3    1]
 [   0    0    1    0    1    1    0    1    0   30  390   20    5   11
     4   30    7]
 [   0    1    2    0    0    2    1    1    0   10   14  420    9   19
    22    4   14]
 [   0    8    0    0    0    0    0    0    0    1    4   11  592    8
     1   10    8]
 [   1    1    0    0    1    0    0    0    0   39    5    4    1  400
     1    8    8]
 [   0    1    0    1    1    0    0    2    1    0   17   59    2    1
   320    3   17]
 [   0    0    0    0    1    0    0    0    0   10   42   19   12   11
     5  347   52]
 [   0    0    0    0    0    0    0    1    0    4    6   39    6   10
     9   13  437]]
------ TEST ACCURACY:  weights.47-0.51.hdf5  ------
0.722342733189
[[  8   2   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  2   8   1   0   0   0   0   2   0   0   0   0   0   0   0   0   0]
 [  0   0 149   0   0   0   7   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  71   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   1  21   4   1   1   0   0   0   0   1   0   0   0   0]
 [  0   0   0   0   0  18   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  14  32   0   3   0   0   0   0   0   0   0   0   1   0   0]
 [  2   0   0   0   0   0   0   5   1   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   7   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   9   0   0   0   7   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   8   0   0   1   1   0]
 [  0   0   0   0   0   0   0   0   0   0   0   4   0   0   0   0   3]
 [  0   0   0   0   0   0   0   0   0   0   0   0  18   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   5   0   0   1   9   0   0   0]
 [  0   0   0   0   0   0   0   1   0   0   0   0   0   1   5   0   2]
 [  0   0   0   0   0   0   0   0   0   0   6   0   0   4   0   1   3]
 [  0   0   0   0   0   0   0   0   0   0   5   2   0   0   0   2   0]]

>>>>>>>>>>>>>> 21 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/21/weights.35-0.49.hdf5
------ TRAIN ACCURACY:  weights.35-0.49.hdf5  ------
0.911321904099
[[ 143    1    0    0    0    0    0    1    1    0    0    0    0    0
     0    0    0]
 [   3  191    1    0    1    0    0    7    1    0    0    0    0    0
     0    1    0]
 [   0    0 1692    0    3    2   39    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1922    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  879    0   27    0    0    0    0    0    0    1
     0    0    0]
 [   0    0    0    0    4  715    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    9    0    7 1259    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  274    7    0    2    0    0    0
     0    0    0]
 [   1    0    0    0    0    0    0    8  176    0    0    0    0    0
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  410   18    9    3   70
     0    4    0]
 [   0    1    0    0    1    0    0    4    1   23  392   15    9   14
     3   37    2]
 [   0    0    0    0    2    1    0    4    0   13   25  385   10   14
    18    7   30]
 [   1    6    0    0    0    0    0    0    0    4    9   14  583    7
     0   17    1]
 [   0    1    0    0    2    0    0    0    0   38    6    3    0  398
     2   16    7]
 [   1    0    0    0    1    1    0    5    2    1   27   73    4    1
   286    5   18]
 [   0    0    0    0    1    0    1    0    0    8   51    9   13    2
     2  358   56]
 [   0    1    0    0    0    0    0    1    0    5    8   36    5   20
     1   41  409]]
------ TEST ACCURACY:  weights.35-0.49.hdf5  ------
0.575
[[ 5  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  0  0  0  9  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  4 28  0  0 29  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  2  0  6  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  9 13  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  7  0  1  0 38  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  4  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  0  0  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  1  0  0  0  3  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  9  2  0  5  0  1]
 [ 0  0  0  0  0  2  0  0  0  0  0  0 17  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  7  0  2  1]
 [ 1  0  0  0  0  0  0  0  0  0  0  8  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  5  5]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  4  1]]

>>>>>>>>>>>>>> 22 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/22/weights.48-0.51.hdf5
------ TRAIN ACCURACY:  weights.48-0.51.hdf5  ------
0.924780721184
[[ 130    6    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  193    0    0    2    0    0   10    0    0    0    0    0    0
     0    0    0]
 [   0    0 1673    0    1    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8 1902    0    0   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  845    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    4  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    1    1    5 1253    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    1    0    0  274    2    0    1    1    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    4  178    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  428    9   10    2   46
     8    0    2]
 [   0    0    1    0    0    2    0    2    0   33  374   28    6    4
     7   30    3]
 [   0    0    1    0    1    1    1    2    1   13   10  402   10   12
    30    2   12]
 [   0    1    0    0    0    0    0    2    0    1    6    9  592    9
     1   13    4]
 [   0    0    0    0    0    0    0    0    0   33    5    9    2  404
     1    4    5]
 [   0    0    0    0    2    0    1    4    0    4    9   65    6    1
   316    2    7]
 [   0    0    0    0    0    0    0    0    0   10   55    3    9    6
     5  353   49]
 [   0    0    0    0    0    1    0    2    0   13   16   19    8   14
    15   19  405]]
------ TEST ACCURACY:  weights.48-0.51.hdf5  ------
0.671487603306
[[ 2  0  0  0  0  0  0 14  1  0  0  0  0  0  0  0  0]
 [ 0  5  0  0  3  1  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0 59  0  2  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 57  0  0  5  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 32 14  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  1  0 24  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  2  0  1 46  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  0 10  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  9  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 14  0  0  4  0  0  3  1]
 [ 0  0  0  0  0  0  0  0  0  3  7  3  0  0  0  0  8]
 [ 0  0  0  0  0  0  0  0  0  0  0  7  0  0 13  0  8]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  2]
 [ 1  4  0  0  0  0  0  2  0  5  0  3  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0  6  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  0  0 17  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  7  3  0  3  5  4]]

>>>>>>>>>>>>>> 23 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/23/weights.39-0.49.hdf5
------ TRAIN ACCURACY:  weights.39-0.49.hdf5  ------
0.917431192661
[[ 143    2    0    0    0    0    0    1    1    0    0    0    0    0
     0    0    0]
 [   2  200    0    0    0    0    0    7    0    0    0    0    0    0
     0    0    0]
 [   0    0 1708    0    2    3   10    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1910    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  862    1   28    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7   12    0    7 1253    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    1    0    1    0    0  261   10    0    4    1    0    0
     1    0    0]
 [   0    1    0    0    0    0    0    2  190    0    0    0    0    0
     0    0    1]
 [   0    2    0    0    0    0    0    0    0  424   14   16    3   39
     1    1    7]
 [   0    0    0    0    0    0    0    2    1   34  412   11    2    6
     7   12   15]
 [   0    0    0    0    0    1    1    3    0   12   13  380   13   10
    52    9   23]
 [   0    3    0    0    0    0    0    2    0    1   11   14  602    7
     2    4    0]
 [   1    1    0    0    0    0    0    0    0   49    5    2    4  386
     3   10    8]
 [   0    1    0    0    1    2    0    2    2    1   21   53    5    2
   318    5   12]
 [   0    0    0    0    1    0    0    0    0   11   58    7   15   12
     7  338   49]
 [   0    0    0    0    0    0    0    0    0    7   19   46    7    5
     8   34  394]]
------ TEST ACCURACY:  weights.39-0.49.hdf5  ------
0.754601226994
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 3  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  5  2  0  0  8  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 74  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 18  5  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  3 41  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 15  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  0 15  0  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  9  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  4  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  9  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  5  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  0  0  0  7  4]
 [ 0  0  0  0  0  0  0  0  0  0  6  0  0  0  0  4  4]]

>>>>>>>>>>>>>> 24 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/24/weights.44-0.52.hdf5
------ TRAIN ACCURACY:  weights.44-0.52.hdf5  ------
0.924462365591
[[ 131    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  189    1    0    1    0    0    4    0    0    0    0    0    0
     0    0    1]
 [   0    0 1550    0    4    1    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6 1906    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  833    0   19    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  718    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    0    6    7 1242    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    0    0    2    0    0  264    4    0    3    0    0    0
     0    1    0]
 [   0    1    1    0    0    0    0    8  180    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    0  434   11    0    3   55
     1    0    2]
 [   0    1    0    0    3    0    1    2    1   41  423    4    3    5
     4    5    3]
 [   0    1    2    0    1    1    0    2    1   22   25  385    3    8
    37    0   24]
 [   0    2    1    0    0    0    0    2    0   11   13   10  574    9
     1   12    5]
 [   0    1    0    0    1    0    0    0    0   52    6    0    0  395
     4    3    7]
 [   0    1    0    0    2    0    0    8    1    2   14   25    2    3
   332    5   14]
 [   0    0    0    0    1    0    0    0    1   13   61    9    4    8
     5  330   62]
 [   0    1    0    0    0    0    0    0    0   13   17   17    1   14
    12   11  431]]
------ TEST ACCURACY:  weights.44-0.52.hdf5  ------
0.729950900164
[[  5  13   0   0   0   0   0   3   0   0   0   0   0   0   0   0   0]
 [  0   7   0   0   0   0   0   5   0   0   0   0   4   0   0   2   1]
 [  0   0 178   0   0   0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  69   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   3   0  57   3   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  27   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   1  15   1   1  38   0   0   0   0   0   0   0   0   0   0]
 [  0   4   0   0   0   0   0   7   1   0   0   0   5   0   0   1   0]
 [  0   0   0   0   0   0   0   3   7   0   0   0   0   0   0   0   0]
 [  0   2   0   0   0   0   0   0   0  10   0   0   0  10   0   0   1]
 [  0   0   0   0   0   0   0   0   0   0   6   0   0   0   0   3   6]
 [  0   0   0   0   0   0   0   0   0   0   0   1   2  10   1   0   0]
 [  0   0   0   0   0   0   0   0   0   0   7   0  14   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   6   0   0   0   9   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0  14   3   4   4   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   5   0   0   7   7]
 [  0   0   0   0   0   0   0   0   0   0   3  11   2   0   1   0   0]]

>>>>>>>>>>>>>> 25 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/25/weights.28-0.48.hdf5
------ TRAIN ACCURACY:  weights.28-0.48.hdf5  ------
0.894333978532
[[ 139    4    0    0    2    0    0    4    2    0    0    0    0    0
     0    0    0]
 [   4  178    1    0   12    0    0   14    1    0    0    0    1    0
     0    0    1]
 [   0    0 1601    0   32    0   52    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1913    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   1    2    1    0  869    1   20    0    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  725    0    0    0    0    0    0    0    0
     0    0    0]
 [   2    0    2   21   12   14 1221    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    3    0    0  261   15    0    4    0    1    0
     1    0    0]
 [   1    0    0    0    0    0    0   10  181    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  412   13   18    3   56
     3    3    2]
 [   0    0    1    0    2    0    2    0    1   22  389   15    5   11
     4   30   10]
 [   0    0    0    0    2    1    1    3    0   11   17  391   12   12
    31    7   24]
 [   0    2    0    0    0    0    0    3    0   14   11   13  568   12
     2    6    2]
 [   1    5    0    0    1    0    0    0    0   71    5   12    3  341
     5   13    6]
 [   0    2    1    0    3    1    0    4    2    2   17   74    2    1
   279   13   18]
 [   0    0    0    6    0    0    0    2    0   12   47   11   12   13
     7  294   81]
 [   0    1    0    0    0    1    0    0    0   10   16   27    6   15
     5   29  403]]
------ TEST ACCURACY:  weights.28-0.48.hdf5  ------
0.691358024691
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  1 24 21  1  3  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 23  1  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 21  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  1 50  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  1  0  0  3  1  0  0  0  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  3  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 12  3  0  1  0  2  1]
 [ 0  0  0  0  0  0  0  1  0  0  6  2  0  2  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 27  0  0  1  0]
 [ 0  0  0  0  0  3  0  0  0  3  0  0  0 14  1  0  0]
 [ 0  0  0  0  2  0  0  0  0  0  7  6  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4 22  2  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21]]

>>>>>>>>>>>>>> 26 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/26/weights.34-0.50.hdf5
------ TRAIN ACCURACY:  weights.34-0.50.hdf5  ------
0.911587232182
[[ 147    4    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   1  201    3    0    1    0    0    3    1    0    0    0    1    0
     0    0    1]
 [   0    0 1695    0    4    1    6    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    4 1911    0    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    7    0  859    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   22    7    2    7 1238    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    0    0    1    0    0  262   18    0    4    2    0    0
     1    1    0]
 [   0    0    0    0    0    0    1    4  193    0    0    0    0    0
     0    1    1]
 [   0    2    0    0    0    0    0    0    0  411   13    5    6   63
     3    8    1]
 [   0    0    0    0    3    0    0    3    1   37  398    6    4    9
     4   21    4]
 [   0    0    0    0    0    1    2    3    2   14   25  396    6   17
    23    5   13]
 [   0    0    0    0    0    0    0    1    0   11    8    7  582    6
     2   19    0]
 [   1    3    0    0    0    0    0    0    1   67    6    3    3  378
     4    7    4]
 [   1    1    0    0    2    0    0    1    1    2   33   53    9    0
   292   11   15]
 [   0    0    0    6    1    0    0    0    0   15   60   10   10    4
     1  356   31]
 [   0    0    0    0    0    1    0    0    2    9   37   24    3   16
     4   38  384]]
------ TEST ACCURACY:  weights.34-0.50.hdf5  ------
0.755952380952
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0 31  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 48  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 12  3  0  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8 10  3  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  6  0  0  5  4  1]
 [ 0  7  0  0  0  0  0  0  0  5  4  0  6  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  3  1  0  0  5  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  6 13]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  3  0 11]]

>>>>>>>>>>>>>> 27 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/27/weights.42-0.48.hdf5
------ TRAIN ACCURACY:  weights.42-0.48.hdf5  ------
0.91844064827
[[ 148    5    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  203    1    0    3    0    0    6    0    0    0    0    0    0
     0    1    0]
 [   0    1 1681    0    5    1   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1881    0    0   31    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0  870    0   18    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    3    3    5 1262    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    1    0    0    0    0  280    3    0    1    0    0    0
     1    0    0]
 [   0    1    0    0    0    0    0    6  191    0    0    0    0    0
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  413   19    4    6   65
     1    1    0]
 [   0    0    0    0    2    0    1    3    2   36  406   14    3    7
     1   13    9]
 [   0    1    1    0    0    0    1    2    0   12   17  410   15   19
    11    2   13]
 [   0    4    0    0    0    0    0    1    0    9    9   14  587   10
     1    5    0]
 [   1    0    0    0    1    0    0    0    0   32    5    6    3  409
     1    3    5]
 [   0    0    0    0    1    0    0    6    1    0   30   65   14    3
   295    6    2]
 [   0    0    0    0    1    0    0    6    0   11   48   13   14   10
     2  344   48]
 [   0    1    0    0    0    0    0    1    0   10   24   51    7   19
     5   10  390]]
------ TEST ACCURACY:  weights.42-0.48.hdf5  ------
0.814606741573
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 39  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 70  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  2 28  1  0  0  0  0  0  0  0  0  0  0]
 [ 0 13  2  2  0 28  0  0  0  0  0  0  0  0  0  0]
 [ 3  0  0  1  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  4  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  3  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 17  0  2  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0 16  0  1  0]
 [ 0  0  0  0  0  0  2  1  0  1  2  2  1  0  0  2]
 [ 0  0  0  0  0  0  0  0  0 14  0  0  1  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  1 15]]

>>>>>>>>>>>>>> 28 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/28/weights.33-0.47.hdf5
------ TRAIN ACCURACY:  weights.33-0.47.hdf5  ------
0.903011785247
[[ 146    6    0    0    0    0    0    0    1    0    0    0    0    0
     0    0    0]
 [   4  200    1    0    0    0    0    7    2    0    0    0    0    0
     0    0    1]
 [   0    0 1694    0    7    2    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6 1915    0    1    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  855    2   27    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   28    8    3    9 1235    0    0    0    0    0    0    0
     0    0    0]
 [   0    5    0    0    1    0    0  265   14    0    1    1    0    0
     1    0    0]
 [   1    2    0    0    0    0    0    4  190    0    0    0    0    1
     0    1    1]
 [   0    2    0    0    0    0    0    0    0  457   15    2    2   30
     0    4    0]
 [   1    0    0    0    0    0    1    5    1   42  377   21    0    6
     5   22   14]
 [   0    2    1    0    2    1    2    4    3   18   17  400    7   14
    22    4   12]
 [   0    3    0    0    0    0    0    3    2    9   19   18  551   10
     0   18    5]
 [   1    4    0    0    0    0    0    0    0   94    5    6    1  348
     1   10    4]
 [   0    2    2    0    2    1    0   10    5    1   20   79    2    7
   280    1   14]
 [   0    1    0    0    1    0    0    0    2   21   68   12    6    6
     5  337   38]
 [   0    0    1    0    0    0    0    1    2   25   25   50    5   12
     5   19  373]]
------ TEST ACCURACY:  weights.33-0.47.hdf5  ------
0.822784810127
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 30  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  6 51  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 31  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0 40  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  7  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 17  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  3  0  0 13  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  1  0  3 11  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  6  1  0 16  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  4  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0  3  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  0  3 10]
 [ 0  0  0  0  0  0  1  1  0  0  5  0  0  0  1  8]]

>>>>>>>>>>>>>> 29 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/29/weights.44-0.51.hdf5
------ TRAIN ACCURACY:  weights.44-0.51.hdf5  ------
0.92341862118
[[ 149    0    0    0    0    0    0    1    2    0    0    0    0    0
     0    0    0]
 [   4  189    0    0    0    0    0   13    0    0    0    0    0    0
     0    0    0]
 [   0    0 1620    0    6    1    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1911    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    0  860    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  713    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4   11    2    7 1261    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  280    0    0    0    0    0    0
     1    0    0]
 [   1    0    0    0    0    0    0   18  172    0    1    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  397   14   17    4   60
     4    1    1]
 [   0    0    0    0    0    0    0    6    0   21  401   12    5   10
     6   18    4]
 [   0    0    0    1    0    0    1    2    0    9   16  411    5    7
    40    7    5]
 [   0    5    0    0    0    0    0    2    0   10    6    9  581    6
     0    9    2]
 [   1    5    0    0    0    0    0    1    0   41    4    2    0  396
     0    6    2]
 [   0    0    0    0    2    0    2    7    1    1    8   54    3    0
   322    5    9]
 [   0    0    0    6    0    0    0    1    0   11   49   11   10    4
     4  342   55]
 [   0    0    0    0    0    0    0    2    1   10    9   53    3   11
     7   17  389]]
------ TEST ACCURACY:  weights.44-0.51.hdf5  ------
0.693203883495
[[  1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   7   0   0   0   0   0   3   0   0   0   0   0   0   0   0   0]
 [  0   0 105   0   0   0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  68   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   1   8   0  16   0   5   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  32   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   9   1   0   0  29   0   0   0   0   0   0   0   0   0   0]
 [  0   1   0   0   0   0   0   8   2   0   2   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   5   0   2   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  28   0   0   1   0   0   0   0]
 [  0   0   0   0   1   0   0   0   0   2  18   0   3   0   0   1   3]
 [  0   0   0   0   0   1   1   0   0   3   3   3   8   0   0   0   3]
 [  0   0   0   0   0   0   0   0   0   2   2  12  10   0   0   3   2]
 [  0   0   0   0   1   0   0   0   0  11   1   2   1   6   3   0   1]
 [  0   0   0   0   0   0   0   0   0   1   0  18   0   1   0   0   0]
 [  0   0   0   0   1   0   0   0   0   3   9   4   3   0   0   0   0]
 [  0   0   0   0   0   1   0   0   0   0   0   2   2   1   0   5  21]]

>>>>>>>>>>>>>> 30 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_kpca_conv1d_10/30/weights.30-0.50.hdf5
------ TRAIN ACCURACY:  weights.30-0.50.hdf5  ------
0.907418815454
[[ 150    2    0    0    0    0    0    0    1    0    0    0    0    0
     0    0    0]
 [   3  200    0    0    3    0    0    5    0    0    0    0    0    0
     0    0    1]
 [   0    1 1657    0    1    2   25    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1896    0    0   25    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  856    0   35    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  718    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14    6    1   11 1250    0    0    0    0    0    0    0
     0    0    0]
 [   0    5    0    0    0    0    0  263   14    0    5    0    1    0
     3    0    0]
 [   2    0    0    0    0    0    0    6  186    0    0    1    0    0
     0    1    1]
 [   0    2    0    0    0    0    0    0    0  444    7    0    5   36
     1    2    1]
 [   0    1    0    0    1    1    0    3    1   25  404   17    1    3
     3   20    7]
 [   0    0    0    0    0    3    2    5    1   21   25  384   14    7
    24    4   10]
 [   0    4    0    0    0    0    0    3    0   10    8   10  586    3
     1    6    3]
 [   1    6    0    0    0    0    0    0    0  116    4    8    6  298
     5    7   14]
 [   0    0    0    0    4    2    0    4    2    2   22   66   11    0
   277    2   22]
 [   0    0    0    6    1    0    0    0    2   14   64    6   10    0
     3  320   69]
 [   0    0    0    0    0    1    0    1    0    7   17   29    4    2
    10   17  422]]
------ TEST ACCURACY:  weights.30-0.50.hdf5  ------
0.745098039216
[[ 2  0  0  0  0  0  1  1  0  0  0  0  0  0  0  0]
 [ 0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 42  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 20  4  1  0  0  6  0  0]
 [ 0  0  0  0  1  0  0  0 13  2  1  6  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  1  1 12  7  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  1 22  0  1  1  0]
 [ 0  0  0  0  0  0  0  0 11  2  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0 18  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  0  6 11]
 [ 0  0  0  0  0  0  0  0  8  0  9  0  5  0  0  2]]
[0.6770833333333334, 0.7324185248713551, 0.8421052631578947, 0.5016077170418006, 0.714765100671141, 0.7961165048543689, 0.7575757575757576, 0.7707808564231738, 0.6376811594202898, 0.7284345047923323, 0.7678571428571429, 0.758, 0.7771883289124668, 0.7634408602150538, 0.7924050632911392, 0.7286324786324786, 0.7944325481798715, 0.7241379310344828, 0.8270676691729323, 0.7223427331887202, 0.575, 0.6714876033057852, 0.754601226993865, 0.7299509001636661, 0.691358024691358, 0.7559523809523809, 0.8146067415730337, 0.8227848101265823, 0.6932038834951456, 0.7450980392156863]
0.735603902938
0.071377346206

Process finished with exit code 0

'''