import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import numpy as np
import cPickle as pickle
from keras.models import Model, load_model
from keras.initializers import Constant, TruncatedNormal
from keras.layers import Input, Dense, Conv1D, Flatten, Dropout, Activation, BatchNormalization
from keras.layers.merge import concatenate
from keras.optimizers import Adam
from keras.callbacks import ModelCheckpoint
import keras.backend as K
from keras import losses
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix

# Load SVD data + Signal Magnitude Vector

X_smv = pickle.load(open("data/X_unimib_smv.p", "rb"))
X_raw = pickle.load(open("data/X_unimib_raw.p", "rb"))
X = np.concatenate((X_smv, X_raw), axis=1)

y = pickle.load(open("data/y_unimib_raw.p", "rb"))

n_classes = 17


# Below builds 1D CNN.

for i in range(30):
    test = y.loc[y[1] == i+1]
    # print y_sub
    test_index = test.index.values
    # print len(test_index)

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index], y_values[test_index]
    y_train = np.eye(n_classes)[y_train - 1]
    print X_train.shape # (11188, 604)

    # input layer
    input_signal = Input(shape=(604, 1))
    print K.int_shape(input_signal)

    # define initial parameters
    b_init = Constant(value=0.0)
    k_init = TruncatedNormal(mean=0.0, stddev=0.01, seed=2018)

    # first feature extractor
    conv11 = Conv1D(16, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn11 = BatchNormalization()(conv11)
    actv11 = Activation('relu')(bn11)
    conv12 = Conv1D(32, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv11)
    bn12 = BatchNormalization()(conv12)
    actv12 = Activation('relu')(bn12)
    flat1 = Flatten()(actv12)

    # second feature extractor
    conv21 = Conv1D(16, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn21 = BatchNormalization()(conv21)
    actv21 = Activation('relu')(bn21)
    conv22 = Conv1D(32, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv21)
    bn22 = BatchNormalization()(conv22)
    actv22 = Activation('relu')(bn22)
    flat2 = Flatten()(actv22)

    # third feature extractor
    conv31 = Conv1D(16, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn31 = BatchNormalization()(conv31)
    actv31 = Activation('relu')(bn31)
    conv32 = Conv1D(32, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv31)
    bn32 = BatchNormalization()(conv32)
    actv32 = Activation('relu')(bn32)
    flat3 = Flatten()(actv32)

    # merge feature extractors
    merge = concatenate([flat1, flat2, flat3])

    # dropout & fully-connected layer
    do = Dropout(0.9, seed=2018)(merge)
    output = Dense(n_classes, activation='softmax', bias_initializer=b_init, kernel_initializer=k_init)(do)

    # result
    model = Model(inputs=input_signal, outputs=output)

    # summarize layers
    print(model.summary())

    new_dir = 'model/unimib_raw_smv_conv1d_10/' + str(i+1) + '/'
    if not os.path.exists(new_dir):
        os.makedirs(new_dir)

    fpath = new_dir + 'weights.{epoch:02d}-{val_acc:.2f}.hdf5'
    cp_cb = ModelCheckpoint(fpath, monitor='val_acc', verbose=1, save_best_only=True, mode='auto', period=1)

    adam = Adam(lr=0.001)
    model.compile(loss=losses.categorical_crossentropy, optimizer=adam, metrics=['accuracy'])
    model.fit(np.expand_dims(X_train, axis=2), y_train, batch_size=64, epochs=50, verbose=2, validation_split=0.10,
              callbacks=[cp_cb], shuffle=True)

    del model
    K.clear_session()


# Below calculates average test data accuracy (LOSO CV).

acc = []

for i in range(30):
    test = y.loc[y[1] == i+1]
    test_index = test.index.values

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index] - 1, y_values[test_index] - 1

    print "\n>>>>>>>>>>>>>>", str(i+1), "-fold <<<<<<<<<<<<<<<<"
    path_str = 'model/unimib_raw_smv_conv1d_10/' + str(i+1) + '/'
    for path, dirs, files in os.walk(path_str):
        dirs.sort()
        files.sort()
        top_acc = []
        top_acc.append(files[-1])
        files = top_acc
        for file in files:
            print "========================================"
            print os.path.join(path, file)
            model = load_model(os.path.join(path, file))
            pred = model.predict(np.expand_dims(X_train, axis=2), batch_size=32)
            print "------ TRAIN ACCURACY: ", file, " ------"
            print accuracy_score(y_train, np.argmax(pred, axis=1))
            print confusion_matrix(y_train, np.argmax(pred, axis=1))
            pred = model.predict(np.expand_dims(X_test, axis=2), batch_size=32)
            print "------ TEST ACCURACY: ", file, " ------"
            print accuracy_score(y_test, np.argmax(pred, axis=1))
            print confusion_matrix(y_test, np.argmax(pred, axis=1))

            del model
            K.clear_session()

    acc.append(accuracy_score(y_test, np.argmax(pred, axis=1)))

print acc
print np.mean(acc)
print np.std(acc)

'''
-----
[0.625, 0.7564322469982847, 0.8322368421052632, 0.4662379421221865, 0.7718120805369127, 0.8470873786407767, 0.806060606060606, 0.8463476070528967, 0.7222222222222222, 0.7507987220447284, 0.7448979591836735, 0.842, 0.6578249336870027, 0.7419354838709677, 0.8151898734177215, 0.7307692307692307, 0.7901498929336188, 0.7103448275862069, 0.7969924812030075, 0.720173535791757, 0.5642857142857143, 0.6239669421487604, 0.803680981595092, 0.7545008183306056, 0.7604938271604939, 0.7857142857142857, 0.8202247191011236, 0.9018987341772152, 0.6951456310679611, 0.7573529411764706]
0.748059282033
0.0893718048793
-----

/usr/bin/python2.7 /mnt/0cdd1a7e-3686-4cf7-9055-145eb5fe70f3/hcilab/OSS/electronicsletters2018/unimib/unimib_raw_smv_conv1d_10.py
/home/hcilab/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.

>>>>>>>>>>>>>> 1 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/1/weights.31-0.54.hdf5
------ TRAIN ACCURACY:  weights.31-0.54.hdf5  ------
0.941951348028
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1680    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1914    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   19    0  860    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  718    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    1    4    7 1266    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  285    3    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2  196    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    2  457    3   16    3   32
     0    1    2]
 [   0    0    0    0    0    0    0    0    0   16  434   16    7   10
     0   10    1]
 [   0    0    0    0    2    4    0    5    0    7   18  444    7    3
     4   11    6]
 [   0    0    0    0    0    0    0    4    0    0    2   11  610    6
     0    8    1]
 [   0    0    0    0    0    0    0    0    0   46    3    1    1  408
     0    6    5]
 [   0    0    3    0    3    0    3    8    1    4   10   63    0    1
   310    9    4]
 [   0    0    0    0    0    0    0    0    2   14   41    7   11    7
     2  378   31]
 [   0    0    0    0    0    1    0    0    0    3    9   30    7   14
     3   34  415]]
------ TEST ACCURACY:  weights.31-0.54.hdf5  ------
0.625
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 16  0 15  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 28  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 27  0  0  0 15  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  7  0  0  1  1  1  0]
 [ 0  0  0  0  0  0  0  0  0  2  3  3  3  0  0  6  0]
 [ 0  0  0  0  0  2  0  0  0  0  1  0  0  0  1  8  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  1 15  0  0  2  1]
 [ 0  0  0  0  0  0  0  0  0  0  3  2  0  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  3  0  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  1  8  4  5  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  5  3  2  0  1  5]]

>>>>>>>>>>>>>> 2 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/2/weights.36-0.52.hdf5
------ TRAIN ACCURACY:  weights.36-0.52.hdf5  ------
0.945209152664
[[ 146    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1595    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1911    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  875    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    2    2 1270    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  286    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  196    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    2  489    3    1    0    7
     0    0    4]
 [   0    0    0    2    0    0    0    0    1   18  430    2   17    2
     1    3   12]
 [   0    0    0    1    2    3    1    6    0   14   22  414    3    3
     9   11   13]
 [   0    0    0    0    2    0    0    2    0    1    9    6  578   14
     0    2    7]
 [   0    0    0    0    0    0    0    0    0   78    1    4    0  359
     2    2    6]
 [   0    0    0    0    8    1    7    3    0    2    7   41    4    0
   325    2    9]
 [   0    0    0    0    0    0    0    0    2   23   41    8   16    2
     5  335   54]
 [   0    0    0    0    0    2    0    1    0    4    1   18    4    9
     5   18  445]]
------ TEST ACCURACY:  weights.36-0.52.hdf5  ------
0.756432246998
[[  7   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  2  10   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 140   0   3   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  37   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  29   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  49   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   1   8   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  21   0   0   0   0   0   0   0]
 [  0   0   0   0   0   2   0   0   0   0   3   3   9   0   0   1   5]
 [  0   0   0   0   1   0   1   2   0   0   1  11   1   0   3   3   1]
 [  0   0   0   0   0   0   0   0   0   3   0   0  32   0   0   4   1]
 [  0   0   0   0   0   0   0   0   0   9   0   1  14   3   0   2   3]
 [  1   5   0   0   0   5   0   0   0   0   1   1   1   0   5   6   0]
 [  0   0   0   0   0   3   1   0   0   1   4   1   6   0   0   2   9]
 [  0   0   0   1   0   0   0   0   0   0   1   3  12   0   0   3   7]]

>>>>>>>>>>>>>> 3 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/3/weights.33-0.52.hdf5
------ TRAIN ACCURACY:  weights.33-0.52.hdf5  ------
0.945931804308
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  215    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1712    0    4    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1909    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  879    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    1    1    2 1278    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  282    1    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    0  196    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  471   11    2    1   18
     3    0    7]
 [   0    0    0    0    0    0    0    0    0   13  457    0   10    2
     3   10    4]
 [   0    0    0    0    1    2    0    6    0   10   30  406   14    8
    27    7    5]
 [   0    0    0    0    1    0    0    2    0    4    4    3  620    6
     1    4    2]
 [   0    0    0    0    0    0    0    0    0   71    7    0    1  387
     1    2    2]
 [   0    0    0    0    7    0    7    8    1    1    7   24    7    0
   356    2    7]
 [   0    1    0    0    0    0    0    0    3   21   42    3   17    2
     5  366   43]
 [   0    2    0    0    0    3    0    0    0    9   13   15    6    9
    10    9  451]]
------ TEST ACCURACY:  weights.33-0.52.hdf5  ------
0.832236842105
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 73  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0 35  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 10  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  4  0  0  7  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  2  3  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 13  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  4  3  0  0  2  0  2  2]
 [ 0  3  0  0  0  0  0  0  0  0  0  0  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  2  0  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0  1  3  0]]

>>>>>>>>>>>>>> 4 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/4/weights.29-0.54.hdf5
------ TRAIN ACCURACY:  weights.29-0.54.hdf5  ------
0.945462478185
[[ 152    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   0    0 1715    0    4    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1930    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  880    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0   10    6 1277    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  285    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    1  189    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  494    3    3    1   17
     1    0    1]
 [   0    0    0    0    0    0    0    0    0   14  448    4    9    5
     1    4    7]
 [   0    0    0    1    1    1    0    5    0    9   17  421   14    5
     6    9   14]
 [   0    0    0    0    3    0    0    1    0    0    9    6  601   12
     0    4    7]
 [   0    0    0    0    0    0    0    0    0   67    4    0    0  390
     0    3    3]
 [   0    0    0    0    9    0    3    3    0    2    6   50    4    0
   328    8    8]
 [   0    0    0    0    0    0    0    0    0   18   48    4   20    2
     4  360   41]
 [   0    0    0    0    0    0    0    0    0    5   14   16   10   17
     1   13  436]]
------ TEST ACCURACY:  weights.29-0.54.hdf5  ------
0.466237942122
[[ 1  0  0  0  0  1  2  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  0  0 10  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 53  0  0  0  0  0  0  0  0  1  0  0  0  0]
 [ 1  1  0 16  0  4  7  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 11  0  1  0  0  8  2  3  0  0  2  0]
 [ 0  0  0  1  0 15 11  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  1  0  1  4  1  0  1  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  3  1  0  3  0  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  7  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  1  3  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  2 11  2  0  0  5  3]
 [ 0  0  0  0  0  0  0  0  0  8  0 10  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  8  0  7  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  5  2  0  2  0  1]
 [ 0  0  0  0  0  0  0  0  4  4  0  1  2  0  5  0]
 [ 0  0  0  0  0  0  0  0  6  4  4  6  0  0  2  0]]

>>>>>>>>>>>>>> 5 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/5/weights.50-0.54.hdf5
------ TRAIN ACCURACY:  weights.50-0.54.hdf5  ------
0.94962084895
[[ 146    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1716    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1919    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0  886    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    5 1287    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  290    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  198    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  465    1   27    2   16
     0    0    0]
 [   0    0    0    0    0    0    0    0    0   21  423   19   21   13
     3    1    1]
 [   0    0    0    1    2    1    0    5    0    5   10  457    4    5
     4    4    7]
 [   0    0    0    0    3    0    0    0    0    0    2   14  620    5
     0    1    1]
 [   0    0    0    0    0    0    0    0    0   51    1    6    2  408
     0    3    3]
 [   0    0    0    0    7    0    7    8    0    1    8   48    0    1
   338    2    5]
 [   0    0    0    0    0    0    0    0    0   14   31   16   14    7
     6  374   36]
 [   0    0    0    0    0    3    0    0    0    3    6   27    6   10
     6   17  438]]
------ TEST ACCURACY:  weights.50-0.54.hdf5  ------
0.771812080537
[[ 6  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  0  0  0  0  2  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 66  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 19  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  2  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 11  0  5  0]
 [ 0  0  0  0  0  0  0  0  1  0  1  0  0  0  0  5  2]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  2  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  4  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  0  1  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  7  0  0  0  9  2]]

>>>>>>>>>>>>>> 6 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/6/weights.43-0.55.hdf5
------ TRAIN ACCURACY:  weights.43-0.55.hdf5  ------
0.948234879831
[[ 151    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1686    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1920    0    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  846    0   27    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  717    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    3 1271    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  279    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  195    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    1  454    6   10    1   29
     0    0    7]
 [   0    0    0    0    0    0    0    0    0    7  432   10   21   11
     3   10    2]
 [   0    0    0    1    0    2    3    2    0   14   14  423    4    5
     4   23   12]
 [   0    0    0    0    2    0    0    3    0    0    3    3  611    9
     0    2    5]
 [   0    0    0    0    0    0    0    0    0   29    2    2    1  422
     2    1    5]
 [   0    0    0    0    1    0   11    7    1    1    6   39    1    1
   342    5    1]
 [   0    0    0    0    0    0    0    0    1   12   38    6   18    8
    11  368   31]
 [   0    0    0    1    0    0    0    0    0    2    8   12    6   13
     7   25  442]]
------ TEST ACCURACY:  weights.43-0.55.hdf5  ------
0.847087378641
[[ 2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0 43  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 29  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0 49  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  9  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 16  0  0  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 14  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4 12  0  0  0  0  3]
 [ 0  1  0  0  0  0  0  0  0  0  0  0 22  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 10  0  0  0  9  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  7  0  1  6  2  2]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  0  0 10  9]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  4 12]]

>>>>>>>>>>>>>> 7 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/7/weights.41-0.50.hdf5
------ TRAIN ACCURACY:  weights.41-0.50.hdf5  ------
0.942487544795
[[ 151    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1689    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1933    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  863    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    3    3 1285    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1  284    3    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  191    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    0  455   12   15    2   24
     0    0    6]
 [   0    0    0    0    0    1    0    0    0   11  432   13   20    5
     3    2    9]
 [   0    0    0    0    2    2    2    4    0   12   17  423   12    4
    12    9    9]
 [   0    1    0    0    2    0    1    1    0    2   10   13  588   14
     0    4    7]
 [   0    0    0    0    0    0    0    0    0   40    4    1    1  400
     0    9    7]
 [   0    0    0    0    8    1    6    2    1    0    7   53    1    0
   332    5   10]
 [   0    0    0    0    0    0    0    0    2   17   41    7   12    0
     6  379   36]
 [   0    0    0    0    0    0    0    2    0    2   10   32    5    6
     7   17  441]]
------ TEST ACCURACY:  weights.41-0.50.hdf5  ------
0.806060606061
[[ 5  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 49  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 33  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  3  4  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  1  0  0 10  0  0  0  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  6  6  1  0  4  0  1]
 [ 0  1  0  0  0  0  0  0  0  0  0 13  0  0  1  3]
 [ 0  0  0  0  0  0  0  0  9  0  0  0 10  0  2  1]
 [ 1  0  0  0  0  0  0  0  0  0  2  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  7  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  6  6]]

>>>>>>>>>>>>>> 8 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/8/weights.48-0.52.hdf5
------ TRAIN ACCURACY:  weights.48-0.52.hdf5  ------
0.948215227712
[[ 151    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  216    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1671    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1930    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  870    0   18    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0 1277    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  283    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  188    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    1  430    7   23    0   34
     0    0    6]
 [   0    0    0    0    0    0    0    0    0    9  455   10    5    1
     0    7    7]
 [   0    0    0    0    0    1    2    2    0    8   23  440    8    3
     4   12    6]
 [   0    1    0    0    0    0    0    5    0    0   10   12  581   19
     0    2    6]
 [   0    0    0    0    0    0    0    0    0   39    4    1    0  413
     0    3    5]
 [   0    0    1    0    7    0   11    3    0    2   10   33    0    0
   343    7    3]
 [   0    0    0    0    0    0    0    0    0   11   50    4   15    5
     6  382   30]
 [   0    0    0    0    0    1    0    1    0    2   16   19    7   14
     2   17  434]]
------ TEST ACCURACY:  weights.48-0.52.hdf5  ------
0.846347607053
[[ 1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 54  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  4  0  0  0 43  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 12  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  4  0  0  1  0  0 10]
 [ 0  0  0  0  0  0  0  0  0  0 14  1  0  1  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0  5  9  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  1  0 24  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0 18  0  0  0]
 [ 0  1  0  0  0  0  0  2  0  0  2  0  0  2  5  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  4  5]
 [ 0  0  0  0  0  0  0  0  0  0  1  5  0  2  0  4  9]]

>>>>>>>>>>>>>> 9 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/9/weights.24-0.52.hdf5
------ TRAIN ACCURACY:  weights.24-0.52.hdf5  ------
0.928942502421
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  209    0    0    0    0    0    4    0    0    0    0    0    0
     0    0    0]
 [   0    0 1686    0    2    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6 1919    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   35    0  835    1   30    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   23    1    2    6 1245    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0  280    7    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    1  188    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    3  418    2   11    4   68
     0    0    2]
 [   0    0    0    1    0    0    0    1    0   15  413    7   10   18
     4   10    3]
 [   0    0    1    0    1    4    2    8    0   10   21  410   14   13
     8    3   11]
 [   0    0    3    0    0    0    0    0    0    1    6    6  586   18
     0    2    2]
 [   0    1    0    0    0    0    0    0    0   37    7    1    0  414
     0    9    4]
 [   1    1    4    0    1    1    3    4    0    1   16   48    0    2
   332    2    5]
 [   0    0    0    0    0    0    0    0    2   14   44    5   25    8
     7  348   29]
 [   0    0    0    1    0    1    0    2    0    2   21   24    9   25
     9   17  394]]
------ TEST ACCURACY:  weights.24-0.52.hdf5  ------
0.722222222222
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0 50  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 60  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  5  0 15  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 10  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 13  0  7  0]
 [ 0  0  0  0  0  0  0  2  0  1 16  1  0  0  0  9  0]
 [ 0  0  0  0  0  0  1  0  0  0  7  6  0  0  6  0  0]
 [ 0  0  1  0  0  0  0  0  0  0  0  0 36  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  7  0  1  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0 11  0  0]
 [ 0  1  0  0  0  0  0  0  0  2  0  3  7  8  0  6  4]
 [ 0  0  0  0  1  0  0  1  0  8  0  6  1  3  0  7  2]]

>>>>>>>>>>>>>> 10 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/10/weights.34-0.48.hdf5
------ TRAIN ACCURACY:  weights.34-0.48.hdf5  ------
0.935678128818
[[ 151    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  215    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1705    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1934    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14    0  871    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  729    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    1   23    2    1    0 1268    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    0    0    0    0    0  287    3    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  186    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  455    4   13    1   29
     0    1    2]
 [   0    0    1    0    0    0    1    0    0   13  442    6    5    9
     3   11    8]
 [   0    0    1    1    2    1    2    7    0   11   23  383    5   10
    26   15   17]
 [   0    0    1    0    1    0    0    1    0    0   20   12  580   16
     1    7    4]
 [   0    0    0    0    0    0    0    0    0   53    3    3    1  398
     0    5    4]
 [   1    1    3    0    5    0    6    6    2    2   26   27    1    2
   327    0   11]
 [   0    0    0    0    1    0    0    0    1   16   48    2    7    5
    12  369   40]
 [   0    2    1    0    2    1    0    0    0    5   12   10    2   20
     9   32  421]]
------ TEST ACCURACY:  weights.34-0.48.hdf5  ------
0.750798722045
[[ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 32  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 51  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 13  0 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 17  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  7 22  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  2 10  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0 18  0  0  1  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 10  0  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  5 13  0  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  2  0 16  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  8  0  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  2  0  0  7  2  2]
 [ 0  0  0  0  0  0  0  0  0  6  0  0  0  3  3  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  1  0  0 14]]

>>>>>>>>>>>>>> 11 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/11/weights.24-0.53.hdf5
------ TRAIN ACCURACY:  weights.24-0.53.hdf5  ------
0.930398101766
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  205    0    0    0    0    0    6    0    0    0    0    0    0
     0    0    0]
 [   0    0 1706    0    9    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1902    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0  852    0   18    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   15    1    9    7 1235    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  283    5    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    3  191    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    2  443    2   10    4   45
     0    0    3]
 [   0    0    1    0    0    0    0    0    1   22  408   10   11   10
     2   16   10]
 [   0    0    0    0    0    3    1    8    0    9   16  421   11   11
     6   13   13]
 [   0    0    0    0    0    0    0    3    0    1    5    7  592   17
     0    5    7]
 [   0    0    0    0    0    0    0    0    0   43    3    1    2  399
     3    9    5]
 [   1    0    0    0    8    1    1    5    1    1   11   66   11    0
   294    6   10]
 [   0    0    0    0    0    0    0    0    2   21   36    8   17    8
     6  364   37]
 [   0    0    0    0    0    2    0    0    0    8   14   25    7    9
     8   25  420]]
------ TEST ACCURACY:  weights.24-0.53.hdf5  ------
0.744897959184
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 23  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 82  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  5  0 32  0  5  0  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 20  0  0  0 37  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  7  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  0  0  4  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0 12  8  0  0  0  0  0]
 [ 0  0  0  0  0  1  0  0  0  0  2  8  0  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  0 11  0  0  5  3]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0 13  0  3  0]
 [ 0  5  0  0  0  0  0  0  0  0  4  0  0  0  9  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  0  0  0  0  4  3]
 [ 0  0  0  0  0  0  0  0  0  0  8  0  0  0  0  0  8]]

>>>>>>>>>>>>>> 12 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/12/weights.25-0.53.hdf5
------ TRAIN ACCURACY:  weights.25-0.53.hdf5  ------
0.934344778635
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  206    0    0    0    0    1    3    0    0    0    0    0    0
     0    0    1]
 [   0    0 1554    0    2    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1911    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    0  867    0    9    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    6    4    7 1268    0    0    0    0    0    0    0
     0    0    0]
 [   2    0    0    0    0    0    0  288    5    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    0  195    0    0    0    0    0
     0    1    0]
 [   0    0    0    0    0    0    0    2    2  474    2    4    1   25
     0    0    2]
 [   0    0    1    0    0    1    0    0    0   27  405   12   19    7
     2   14    8]
 [   0    0    1    0    1    4    0    4    0   10   12  438   11   11
     6    8    8]
 [   0    0    0    0    3    0    0    2    0    2    4    2  612   11
     0    1    4]
 [   0    0    0    0    0    0    0    0    0   72    2    1    3  380
     1    3    2]
 [   1    0    0    0    8    0    5    4    2    5   14   53   15    5
   301    2    9]
 [   0    0    0    0    0    0    0    0    2   22   33    8   20    9
     3  361   38]
 [   0    0    0    0    0    2    0    0    0    8    4   36    6   18
     4   27  410]]
------ TEST ACCURACY:  weights.25-0.53.hdf5  ------
0.842
[[  6   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  5   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 173   0   6   0   3   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  66   0   0   8   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  32   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  32   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  36   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  14   0   2   0   1   0   0   0]
 [  0   0   0   0   0   0   0   1   0   0   6   0   1   1   0   3   3]
 [  0   0   0   0   0   0   0   0   0   0   3   6   0   0   0   1   2]
 [  0   0   0   0   0   0   0   0   0   0  10   0  10   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   3   0   0   0  17   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   1   1   0   0   8   0   0]
 [  0   0   0   0   0   0   0   0   0   3   3   3   0   0   0   6   2]
 [  0   0   0   0   0   0   0   0   0   3   4   0   0   3   0   3   6]]

>>>>>>>>>>>>>> 13 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/13/weights.32-0.56.hdf5
------ TRAIN ACCURACY:  weights.32-0.56.hdf5  ------
0.945322099351
[[ 150    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  210    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1713    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1917    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  859    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    2    6 1271    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  275    4    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  195    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    1  474    3    0    4   19
     0    0    4]
 [   0    0    0    0    0    0    0    0    0   11  433    8   22   10
     2    5    2]
 [   0    0    0    0    0    1    0    7    0   11   21  424   13    5
    11    5   10]
 [   0    0    0    0    2    0    0    1    0    0    1    5  620    4
     0    0    3]
 [   0    0    0    0    0    0    0    0    0   43    3    1    5  408
     4    0   10]
 [   0    0    1    0    5    0    4    3    0    3   11   52    2    0
   330    0    7]
 [   0    0    0    0    0    0    0    0    2   17   44    3   28   11
    12  323   55]
 [   0    0    0    0    0    1    0    0    0    5    7    8   12    8
     8   15  448]]
------ TEST ACCURACY:  weights.32-0.56.hdf5  ------
0.657824933687
[[ 3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  5  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 36  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  3  0  0 11  0  0  0  0  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  3  0  0  4  0  0  8]
 [ 0  0  1  0  0  0  0  0  0  0  3  1  0  0  0 10  3]
 [ 0  0  1  0  0  0  0  0  0  0  1  9  2  0  0  0  5]
 [ 0  0  0  0  0  0  0  0  0  4  0  0 10  0  0 11  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  6  2  0  0  8  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  3  0  7  7]
 [ 0  0  0  0  0  0  0  0  0  0  9  0  1  0  0  3  9]]

>>>>>>>>>>>>>> 14 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/14/weights.50-0.52.hdf5
------ TRAIN ACCURACY:  weights.50-0.52.hdf5  ------
0.948504254759
[[ 152    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  209    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1684    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1930    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  864    0   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    2 1272    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  291    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  195    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    1  483    3    4    0   15
     6    0    2]
 [   0    0    0    2    0    0    0    2    0   13  436    4   19    8
     1    4    4]
 [   0    0    0    1    0    3    1    6    0   11   18  417    8    3
    14   15    6]
 [   0    0    0    0    1    0    0    4    0    1    8    1  606   12
     0    4    4]
 [   0    0    0    0    0    0    0    0    0   48    4    2    0  408
     0    5    7]
 [   0    0    0    0    3    4    4    5    1    2   11   41    6    0
   329    4    4]
 [   0    0    0    0    0    0    0    0    3   15   36    6   19    8
     2  371   35]
 [   0    0    0    0    0    2    0    1    0    9    7   13   12   10
     2   24  443]]
------ TEST ACCURACY:  weights.50-0.52.hdf5  ------
0.741935483871
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  3  0  4  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 35  0  5  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0  0  0 48  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  4  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  0  0  1  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  9  0  0  1  1  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  3 12  0  0  1  7  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  8  7  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0 14  0  0  0  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0  3  1  3]]

>>>>>>>>>>>>>> 15 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/15/weights.50-0.52.hdf5
------ TRAIN ACCURACY:  weights.50-0.52.hdf5  ------
0.949103375527
[[ 144    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  211    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1691    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1897    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  902    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0    2    3 1261    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  283    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  192    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    2  476    4   11    0   20
     0    0    2]
 [   0    0    0    0    0    0    0    0    0   13  441    4   20    3
     2    2    8]
 [   0    0    0    1    0    0    1    7    0    5   20  429   13    7
    13    8    8]
 [   0    0    0    0    2    0    0    2    0    0   15    9  590    8
     0    4   13]
 [   0    0    0    0    0    0    0    0    0   50    5    2    0  405
     1    3    3]
 [   0    0    0    0    8    2    1    6    3    2    6   35    0    0
   341    9    3]
 [   0    0    0    0    0    0    0    1    1   15   41    6   15    3
     6  369   43]
 [   0    0    0    0    1    3    0    2    0    4    9   17    3    8
     9   12  451]]
------ TEST ACCURACY:  weights.50-0.52.hdf5  ------
0.815189873418
[[ 4  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 88  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 16  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 55  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 12  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  6  1  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  2  2  0  0  0]
 [ 0  0  0  0  1  0  0  0  0  0 13  0  0  0  1  3  0]
 [ 0  0  0  0  0  0  0  2  0  3  0  7  0  1  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  4  0  0 11  1  0  1  1]
 [ 0  0  0  0  0  0  0  0  0  6  0  0  2  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  1 11  0  0  2  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  1 10]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  0  0  0  0 11]]

>>>>>>>>>>>>>> 16 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/16/weights.35-0.51.hdf5
------ TRAIN ACCURACY:  weights.35-0.51.hdf5  ------
0.943112448023
[[ 145    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  198    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1675    0    6    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1908    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  860    0   13    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    1    4    4 1253    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  271    4    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    0  192    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    3  443    1   18    2   36
     0    4    1]
 [   0    0    0    0    0    0    0    1    0   16  414   16   18    9
     0   13    5]
 [   0    0    0    0    1    1    0    6    0    6   13  443    4    6
     7   14   11]
 [   0    1    0    0    2    0    0    1    0    1    4   13  603    8
     0    5    2]
 [   0    0    0    0    0    0    0    0    0   35    3    6    1  408
     0   15    2]
 [   0    0    0    0    4    0    1    9    1    4    4   46   10    0
   333    9    2]
 [   0    0    0    1    0    0    0    0    2   15   35   10   11    4
     0  379   34]
 [   0    0    0    1    0    1    0    0    0    3    3   23    6   16
     1   35  419]]
------ TEST ACCURACY:  weights.35-0.51.hdf5  ------
0.730769230769
[[ 8  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 9  1  0  0  0  0  0  6  0  0  0  0  0  0  1  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 77  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 46  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1 28  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  4  0  0  0 55  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 13  0  0  0  8  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 17  0  1  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3 12  0  0  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  5  0  4  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  0  0  4  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  2  0  0  3  2]
 [ 0  0  0  0  0  0  0  0  0 20  0  0  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  4 14  0  0  0  0  4  4]]

>>>>>>>>>>>>>> 17 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/17/weights.36-0.55.hdf5
------ TRAIN ACCURACY:  weights.36-0.55.hdf5  ------
0.947452229299
[[ 149    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  201    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1635    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1904    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  869    0   21    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  727    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0    1    1 1269    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  283    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    2  190    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0    1    1  467    6    6    1   32
     0    0    2]
 [   0    0    0    0    0    0    0    1    0   12  450    7   10    4
     2    3    6]
 [   0    0    0    1    1    1    1    7    0   15   17  431    2    5
     8   11    5]
 [   0    0    0    0    3    0    0    2    0    0    8    2  613    9
     0    0    4]
 [   0    0    0    0    0    0    0    0    0   37    5    1    0  417
     1    1    2]
 [   0    0    2    0    7    0    3    9    0    1   19   38    1    1
   323    0    7]
 [   0    0    0    0    0    0    0    0    1   12   57    4   19    7
     3  362   30]
 [   0    0    0    0    0    0    0    1    0    5   25   26    4   11
     8   17  420]]
------ TEST ACCURACY:  weights.36-0.55.hdf5  ------
0.790149892934
[[  4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0  14   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0]
 [  0   0 103   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  81   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  20   0   8   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  19   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  50   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0  13   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   6   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   0   3   2   0   0   0]
 [  0   0   0   0   0   0   0   0   0   6   5   4   0   0   0   0   1]
 [  0   0   0   0   0   0   0   0   0   0   6   9   0   1   0   0   5]
 [  0   0   0   0   0   0   0   0   0   0   0   0  17   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   4   0   0   8   5   0   3   0]
 [  0   0   0   0   0   0   0   0   0   0   2   0   0   1  18   0   2]
 [  0   0   0   0   0   0   0   0   0   5   7   0   0   0   2   4   0]
 [  0   0   0   0   0   0   0   0   0   0   6   0   0   1   2   2   6]]

>>>>>>>>>>>>>> 18 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/18/weights.50-0.55.hdf5
------ TRAIN ACCURACY:  weights.50-0.55.hdf5  ------
0.951920564411
[[ 139    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  207    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1738    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1929    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0  887    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  730    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    3 1289    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  282    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  189    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    3  490    4    0    0   15
     0    0    1]
 [   0    0    0    3    0    0    0    0    0    9  457    6    9    8
     1    0    0]
 [   0    0    0    1    1    4    1    5    0    8   23  422   12    6
     5    7   14]
 [   0    0    0    0    3    0    0    1    0    0   13    8  604   10
     0    3    1]
 [   0    0    0    0    0    0    0    0    0   43    4    0    0  418
     1    2    3]
 [   0    0    0    0    6    0    5   10    1    2   11   54    5    0
   326    0    3]
 [   0    0    0    0    0    0    0    0    2   12   53    4   13    9
     1  371   38]
 [   0    0    0    0    0    0    0    0    0    7   18   19    3    8
     2   13  451]]
------ TEST ACCURACY:  weights.50-0.55.hdf5  ------
0.710344827586
[[12  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  8  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 56  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 13  0  3  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  3  0 28  0  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  0  0 11  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0 10  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  3  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  3  0  0  3  0  1]
 [ 0  0  0  0  0  0  0  0  2  0  8  0  0  0  4  3]
 [ 0  0  0  0  0  0  0  0  3  0  0 12  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  7  1  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  6  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  2  2  5]
 [ 0  0  0  0  0  0  0  0  0  5  1  0  0  0  5  2]]

>>>>>>>>>>>>>> 19 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/19/weights.21-0.53.hdf5
------ TRAIN ACCURACY:  weights.21-0.53.hdf5  ------
0.932029552369
[[ 146    0    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0  199    0    0    0    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1714    0    8    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1915    0    1    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  884    0   29    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0    7    9 1269    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  288    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    6  184    0    0    0    0    1
     0    0    0]
 [   0    0    0    0    0    0    0    2    1  445    4    6    5   49
     0    6    3]
 [   0    0    1    0    0    0    0    0    0    9  438    8   13   10
     4    8    5]
 [   0    0    1    0    1    4    0    9    0    9   19  405   15    9
    15   17   13]
 [   0    0    2    0    0    0    0    3    0    0   12    5  600   13
     1    6    2]
 [   0    0    0    0    0    0    0    1    0   36    6    0    1  415
     3    6    6]
 [   0    2    1    0    5    0    5   14    0    2    8   46    6    0
   325    2    3]
 [   0    1    0    0    0    0    0    5    0   11   56    4   14   11
     4  372   26]
 [   0    2    0    0    0    0    0    0    0    3   22   21    7   17
    11   38  401]]
------ TEST ACCURACY:  weights.21-0.53.hdf5  ------
0.796992481203
[[ 5  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 11  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 14  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 31  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  6  0  0  1]
 [ 0  0  0  0  3  0  0  0  0  1  2  0  0  1  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  3  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  2  7  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  1  0  0  9  2  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  0  0  6  0]
 [ 0  0  2  0  0  0  0  1  0  0  0  0  0  0  0  8  1]]

>>>>>>>>>>>>>> 20 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/20/weights.43-0.54.hdf5
------ TRAIN ACCURACY:  weights.43-0.54.hdf5  ------
0.948541114058
[[ 143    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  203    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1582    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1914    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  886    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  728    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    1    6 1266    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  285    3    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  192    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  455    2   18    0   33
     0    0    3]
 [   0    0    0    1    0    0    0    0    0   19  436    9   23    7
     0    3    3]
 [   0    0    0    1    0    3    0    1    0    5   10  459    8    6
     5   13    8]
 [   0    0    0    0    3    0    0    0    0    0    3    5  617   10
     0    0    5]
 [   0    0    0    0    0    0    0    0    0   45    2    2    1  407
     3    3    6]
 [   0    0    0    0    5    1    0    1    1    1    9   56    8    0
   336    3    4]
 [   0    0    0    0    0    0    0    0    1   14   35   10   22    8
     0  371   38]
 [   0    0    0    1    0    0    0    0    0    3    6   24    7    9
     1   26  448]]
------ TEST ACCURACY:  weights.43-0.54.hdf5  ------
0.720173535792
[[  6   4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  4   6   0   0   0   0   0   2   0   0   0   0   0   0   1   0   0]
 [  0   0 145   0   0   0  11   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  71   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  11  15   0   3   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  18   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   1  37   0   0  12   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   5   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   8   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   9   0   0   0   7   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   5   1   0   2   0   2]
 [  0   0   0   0   0   0   0   0   0   0   0   3   0   0   1   2   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0  18   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   2   0   0   3  10   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   2   2   0   0   5   0   0]
 [  0   0   0   0   0   0   0   0   0   0   6   2   0   0   0   0   6]
 [  0   0   0   0   0   0   0   0   0   0   4   3   0   0   0   1   1]]

>>>>>>>>>>>>>> 21 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/21/weights.45-0.54.hdf5
------ TRAIN ACCURACY:  weights.45-0.54.hdf5  ------
0.94813332173
[[ 146    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  205    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1731    0    0    0    4    0    1    0    0    0    0    0
     0    0    0]
 [   0    0    0 1924    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  904    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  724    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0    1    0 1273    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  284    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  186    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    3  451    3    5    0   51
     0    0    1]
 [   0    0    0    2    0    1    0    2    3   13  441    3   11   10
     2    6    8]
 [   0    0    0    0    0    3    1    6    1   10   19  413    5    9
    13   11   18]
 [   0    0    0    0    1    0    0    5    0    0    6    1  607   17
     0    1    4]
 [   0    0    0    0    0    0    0    0    0   27    3    0    2  429
     1    8    3]
 [   0    0    0    0    0    0    1   23    3    2    7   32    1    3
   349    0    4]
 [   0    0    0    0    0    0    0    1    3   12   41    2   12   12
     7  377   34]
 [   0    2    0    0    0    0    0    2    0    4    6    6   11   15
     8   22  451]]
------ TEST ACCURACY:  weights.45-0.54.hdf5  ------
0.564285714286
[[ 7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  5  0  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  1 11  0  0 48  0  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  7  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 10 12  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0  2  0 37  0  4  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  4  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 13  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  4  0  0  3  1  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  2  0  0  0 14  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 16  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  8  0  2  1]
 [ 1  0  0  0  0  0  0  0  0  0  0  6  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  1  0  5  4]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  1  2  0  3]]

>>>>>>>>>>>>>> 22 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/22/weights.40-0.53.hdf5
------ TRAIN ACCURACY:  weights.40-0.53.hdf5  ------
0.944272171525
[[ 136    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  205    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1676    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1921    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    9    0  834    0   32    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  720    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    5 1267    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  279    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  182    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  450    3   27    5   18
     0    0    2]
 [   0    0    0    0    0    1    0    0    0   11  443    8   11    6
     2    1    7]
 [   0    0    0    0    1    1    2    4    0   12   16  417    7    2
    15   11   10]
 [   0    1    0    0    3    0    0    0    0    1   16   10  598    7
     0    0    2]
 [   0    0    0    0    0    0    0    0    0   47    3    1    1  399
     1    4    7]
 [   0    0    1    0    4    1    8    6    0    1    9   31    4    1
   344    2    5]
 [   0    0    0    0    0    0    0    0    2   15   54    3   15    5
     4  347   45]
 [   0    0    0    0    0    0    0    0    0    2   15   22    9    8
     9    7  440]]
------ TEST ACCURACY:  weights.40-0.53.hdf5  ------
0.623966942149
[[ 0 11  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 1  7  0  0  0  0  0  2  0  0  1  0  0  0  0  0  0]
 [ 0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 57  0  2  2  0  0  0  0  0  0  0  0  1  0]
 [ 0  0  0  1 17 17  0  0  0  0  0 10  0  0  0  1  0]
 [ 0  0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  7  0  3 40  0  0  0  0  0  0  0  1  0  0]
 [ 0  5  0  0  0  0  0  7  0  0  1  1  0  0  0  1  1]
 [ 0  5  0  0  0  0  0 11  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  8]
 [ 0  0  0  0  0  0  0  0  0  8 10  3  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  6 14  0  0  8  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 23  0  0  0  0]
 [ 0  4  0  0  0  0  0  2  0  9  0  0  2  1  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0  9  4  0]
 [ 0  0  0  0  0  0  0  0  0  0 12  0  0  0  6  0  5]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  4 15]]

>>>>>>>>>>>>>> 23 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/23/weights.40-0.52.hdf5
------ TRAIN ACCURACY:  weights.40-0.52.hdf5  ------
0.944866754041
[[ 147    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  208    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1722    0    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1910    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  871    0   19    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    1    1    0 1275    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  272    9    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  194    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    2  457    2   15    2   24
     0    0    3]
 [   0    0    0    0    0    0    0    0    0   19  426   10   24    9
     4    3    7]
 [   0    0    0    0    0    3    0    1    0   12   14  453   12    6
     5    2    9]
 [   0    0    0    0    0    0    0    3    0    3    5    9  611    9
     0    2    4]
 [   0    0    0    0    0    0    0    0    0   51    2    1    1  406
     1    5    2]
 [   0    0    1    0    2    0    7    8    0    2    5   40    5    0
   345    5    5]
 [   0    0    0    4    0    0    0    0    2   17   35   14   16    8
    10  352   40]
 [   0    0    0    0    0    2    0    3    0   10   10   22    9    4
     3   14  443]]
------ TEST ACCURACY:  weights.40-0.52.hdf5  ------
0.803680981595
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0]
 [ 0  0 15  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 74  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  0 24  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 14  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 10  0  0  0  5  0  7  0]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  0  0  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  7  0  0]
 [ 0  0  0  0  0  0  0  0  0  7  0  1  6  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  0  8  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  1  0  0  8  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  1  6  1  3]]

>>>>>>>>>>>>>> 24 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/24/weights.45-0.54.hdf5
------ TRAIN ACCURACY:  weights.45-0.54.hdf5  ------
0.949014336918
[[ 132    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  197    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1553    0    6    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1914    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  854    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    2    1 1265    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  276    2    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    0  189    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0    3  441    3    7    1   38
     0   11    2]
 [   0    0    0    0    0    0    0    0    0   22  434    6   15   10
     0    6    3]
 [   0    0    0    0    0    1    2    3    0    6   13  449    9    1
    11    6   11]
 [   0    0    0    0    3    0    0    0    0    5    1    9  598   15
     0    5    4]
 [   0    0    0    0    0    0    0    0    0   37    3    2    0  416
     2    4    5]
 [   0    0    0    0    9    0    3    2    1    0    3   47    0    1
   336    4    3]
 [   0    0    0    0    0    0    0    0    1   17   47    4    2   11
     2  375   35]
 [   0    0    0    0    0    2    0    0    0    3    1   18    4   20
     6   20  443]]
------ TEST ACCURACY:  weights.45-0.54.hdf5  ------
0.754500818331
[[  7   8   0   0   0   0   0   1   0   0   0   0   0   5   0   0   0]
 [  0  11   0   0   0   0   0   5   0   0   0   0   0   0   0   3   0]
 [  0   0 172   0   7   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  69   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  57   2   4   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  27   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   9   0   1  46   0   0   0   0   0   0   0   0   0   0]
 [  0   6   0   0   0   0   0  12   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   9   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   0  16   0   0   1   5   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   6   0   9   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   1   2   4   0   0   0]
 [  0   0   0   0   0   0   0   0   0   1   0   0  20   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  12   0   0   0   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0  16   4   0   4   0   1]
 [  0   0   0   0   0   0   0   0   0   0   1   2  11   0   0   1   4]
 [  0   0   0   0   0   0   0   0   0   0   0  11   3   0   0   3   0]]

>>>>>>>>>>>>>> 25 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/25/weights.25-0.53.hdf5
------ TRAIN ACCURACY:  weights.25-0.53.hdf5  ------
0.926887207461
[[ 151    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   4  202    1    0    0    0    0    3    0    0    1    0    0    0
     1    0    0]
 [   0    0 1682    1    2    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1917    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   16    0  853    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    4    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14   28    6    7 1217    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  282    3    0    1    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    7  184    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1    0  441    7   12    9   29
     0    8    5]
 [   0    0    0    2    1    1    0    0    0   14  449   10    1    2
     0    5    7]
 [   0    0    1    0    2    2    0    2    0    9   18  428    8    9
    12   12    9]
 [   0    0    1    0    2    0    1    0    0   13   14   12  578    8
     0    3    1]
 [   0    4    1    0    0    0    0    2    0   56    6    3   13  366
     2    7    3]
 [   0    0    1    0    9    0    1    8    0    1    8   58    4    0
   320    1    8]
 [   0    0    0    6    1    0    0    0    0    0   68   11    9    0
     4  347   39]
 [   0    0    0    0    1    0    0    0    0    1   37   17   11    4
    11   34  397]]
------ TEST ACCURACY:  weights.25-0.53.hdf5  ------
0.76049382716
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  2  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 48  0  5  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 21  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 52  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  1  0  0  0  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  2  5  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  5  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1 12  4  0  0  0  2  0]
 [ 0  0  0  0  0  0  0  3  0  2  5  0  0  0  0  1  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 28  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0 13  0  6  0]
 [ 0  0  1  0  2  1  0  1  0  0  5  5  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 13 11  0  0  4  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0  0  0 17]]

>>>>>>>>>>>>>> 26 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/26/weights.42-0.52.hdf5
------ TRAIN ACCURACY:  weights.42-0.52.hdf5  ------
0.947092260603
[[ 151    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1707    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1925    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  869    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    1    2    1 1271    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  290    3    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  200    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    1  448    4   11    0   28
     0    9    9]
 [   0    0    0    1    0    0    1    0    0   11  434    6    7   12
     1   10    7]
 [   0    0    0    0    0    3    0    4    0    8   15  431    6    8
    14   10    8]
 [   0    0    0    0    0    0    0    0    0    5    9    6  600    8
     3    3    2]
 [   0    1    0    0    0    0    0    0    0   38    7    0    0  422
     1    3    5]
 [   0    0    0    0    5    0    4    0    1    3   11   37    7    0
   341    0   12]
 [   0    0    0    0    0    0    0    0    2   14   46    3   16    6
    11  367   29]
 [   0    0    0    1    0    2    0    0    0    5   16   23    6    9
     3   14  439]]
------ TEST ACCURACY:  weights.42-0.52.hdf5  ------
0.785714285714
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 30  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 48  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 16  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0 19  2  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  1  0  4  8  0  0  2  0  3]
 [ 0  0  0  0  3  0  0  2  0  3  0  7  5  0  4  1]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  4  0  0  0]
 [ 0  0  0  0  3  0  5  3  0  0  2  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  0  0 16]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  2  0 13]]

>>>>>>>>>>>>>> 27 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/27/weights.42-0.52.hdf5
------ TRAIN ACCURACY:  weights.42-0.52.hdf5  ------
0.947174770039
[[ 152    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  214    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1699    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1914    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    0  887    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  715    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1    0 1278    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  289    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    1  198    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    3  463    6    8    0   15
     1   12    1]
 [   0    0    0    1    0    0    0    1    0   17  434    2   15    1
     4   11   11]
 [   0    0    0    1    0    0    0    5    0   11   11  417    9    7
    20   15    8]
 [   0    0    0    0    0    0    0    6    0    9    5    8  592   11
     2    4    3]
 [   0    0    0    0    0    0    0    0    0   63    2    0    0  394
     2    3    2]
 [   0    1    3    0    1    0    2   11    0    3    4   27    6    0
   358    6    1]
 [   0    0    0    0    0    0    0    0    1   16   31    2   16    2
    11  381   37]
 [   0    0    0    0    0    1    0    0    0    8   14   13    6   13
     5   31  427]]
------ TEST ACCURACY:  weights.42-0.52.hdf5  ------
0.820224719101
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 39  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1 70  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 31  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  3  2  0 40  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  5  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  2  9  0  0  1  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  6  0  0  7  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0  9  0  3  0]
 [ 0  2  0  1  0  1  1  0  0  1  0  0  0  0  1  4]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  0  0  7  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  1  2  0 10]]

>>>>>>>>>>>>>> 28 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/28/weights.33-0.49.hdf5
------ TRAIN ACCURACY:  weights.33-0.49.hdf5  ------
0.93278044522
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  214    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   0    0 1698    3    6    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1927    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0  880    0    9    0    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   19    6   24    5 1229    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  284    3    0    0    0    0    1
     0    0    0]
 [   0    0    0    0    0    0    0    0  200    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    3  400    3   13    0   85
     0    5    1]
 [   0    0    0    0    0    0    0    0    1    8  430    1   19   18
     3    5   10]
 [   0    0    0    0    0    0    0    4    0    8   21  402    6   17
    29    8   14]
 [   0    0    0    0    1    0    0    2    0    6    5    5  593   16
     3    3    4]
 [   0    0    0    0    0    0    0    0    0   21    5    1    1  443
     0    2    1]
 [   0    0    0    0    8    0    1    5    0    0   11   31    3    2
   357    0    8]
 [   0    0    0    0    0    0    0    0    1   10   53    4   16   12
    26  353   22]
 [   0    2    0    0    0    2    0    0    0    3   15   20   10   31
    12   23  400]]
------ TEST ACCURACY:  weights.33-0.49.hdf5  ------
0.901898734177
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 30  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 58  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 31  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 41  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  6  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 12  0  0  0  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 16  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  2 14  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 21  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  8  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  1 15]
 [ 0  0  0  1  0  0  0  0  0  1  0  0  2  0  0 12]]

>>>>>>>>>>>>>> 29 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/29/weights.48-0.51.hdf5
------ TRAIN ACCURACY:  weights.48-0.51.hdf5  ------
0.947405828003
[[ 151    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  206    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1632    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1917    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  886    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    4    7 1273    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  283    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    0  192    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    1  437    8   23    0   26
     0    2    1]
 [   0    0    0    0    0    1    0    0    0   15  437    4   17    1
     1    6    1]
 [   0    0    0    0    1    2    0    4    0    9   22  417    9    4
    27    4    5]
 [   0    1    0    0    0    0    0    4    0   12    3    3  600    4
     0    2    1]
 [   0    4    0    0    0    0    0    2    0   44    4    0    3  397
     0    3    1]
 [   0    0    0    0    7    0    2    9    0    0    9   19    7    0
   348    5    8]
 [   0    0    0    0    0    0    0    0    0   15   46    7   20    3
    13  352   37]
 [   0    2    0    0    0    1    0    2    0    5    7   24   13   10
    10    6  422]]
------ TEST ACCURACY:  weights.48-0.51.hdf5  ------
0.695145631068
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  7  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0 93  7  0  0  6  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  8  2 14  0  6  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  2  9  0  0 28  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 13  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 28  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0 19  0  8  0  0  0  1]
 [ 0  0  0  0  0  2  1  0  0  3  3  5  3  0  0  3  2]
 [ 0  0  0  0  0  0  0  0  0  0  3  3 22  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0 12  5  0  2  5  1  1  0]
 [ 0  0  0  0  0  1  0  0  0  3  0 15  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  1  2  9  1  7  0  0  0  0]
 [ 0  0  0  1  0  3  0  0  0  1  0  0  0  3  0  8 16]]

>>>>>>>>>>>>>> 30 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_raw_smv_conv1d_10/30/weights.49-0.51.hdf5
------ TRAIN ACCURACY:  weights.49-0.51.hdf5  ------
0.945612954325
[[ 153    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  212    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0 1686    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1923    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  885    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11    0    0    4 1267    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0  291    0    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    0  196    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    0    2    0  445    3    0    1   42
     0    1    4]
 [   0    0    0    0    0    0    0    0    0    9  431    8   25    2
     2    8    2]
 [   0    0    0    0    1    1    1    1    0   10   14  425   12   10
    13    4    8]
 [   0    0    0    0    2    0    0    3    0   12    2   10  591   11
     0    2    1]
 [   0    4    0    0    0    0    0    2    0   36    2    3    6  409
     1    1    1]
 [   0    0    1    0   14    1    4    2    0    0    8   50   11    0
   316    5    2]
 [   0    0    0    0    0    0    0    0    0   15   42    7   21    6
    10  371   23]
 [   0    0    0    1    0    1    0    1    0    3   16   27   10    6
     9   11  425]]
------ TEST ACCURACY:  weights.49-0.51.hdf5  ------
0.757352941176
[[ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1 26  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0 41  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0 20  0  2  0  0  0]
 [ 0  0  0  0  0  1  0  0  0 11  1  2  5  4  0  0  0]
 [ 0  0  0  0  1  2  0  0  0  0  1 16  1  0  1  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0 25  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  0 19  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  1  0  1  2 10  3]
 [ 0  0  0  0  0  0  0  0  0  3  0  7  0  6  0  1  7]]
[0.625, 0.7564322469982847, 0.8322368421052632, 0.4662379421221865, 0.7718120805369127, 0.8470873786407767, 0.806060606060606, 0.8463476070528967, 0.7222222222222222, 0.7507987220447284, 0.7448979591836735, 0.842, 0.6578249336870027, 0.7419354838709677, 0.8151898734177215, 0.7307692307692307, 0.7901498929336188, 0.7103448275862069, 0.7969924812030075, 0.720173535791757, 0.5642857142857143, 0.6239669421487604, 0.803680981595092, 0.7545008183306056, 0.7604938271604939, 0.7857142857142857, 0.8202247191011236, 0.9018987341772152, 0.6951456310679611, 0.7573529411764706]
0.748059282033
0.0893718048793

Process finished with exit code 0

'''
