import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import numpy as np
import cPickle as pickle
from keras.models import Model, load_model
from keras.initializers import Constant, TruncatedNormal
from keras.layers import Input, Dense, Conv1D, Flatten, Dropout, Activation, BatchNormalization
from keras.layers.merge import concatenate
from keras.optimizers import Adam
from keras.callbacks import ModelCheckpoint
import keras.backend as K
from keras import losses
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix

# Load SVD data

X = pickle.load(open("data/X_unimib_svd.p", "rb"))
y = pickle.load(open("data/y_unimib_svd.p", "rb"))

n_classes = 17


# Below builds 1D CNN.

for i in range(30):
    test = y.loc[y[1] == i+1]
    # print y_sub
    test_index = test.index.values
    # print len(test_index)

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index], y_values[test_index]
    y_train = np.eye(n_classes)[y_train - 1]
    print X_train.shape # (11188, 151)

    # input layer
    input_signal = Input(shape=(151, 1))
    print K.int_shape(input_signal)

    # define initial parameters
    b_init = Constant(value=0.0)
    k_init = TruncatedNormal(mean=0.0, stddev=0.01, seed=2018)

    # first feature extractor
    conv11 = Conv1D(16, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn11 = BatchNormalization()(conv11)
    actv11 = Activation('relu')(bn11)
    conv12 = Conv1D(32, kernel_size=32, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv11)
    bn12 = BatchNormalization()(conv12)
    actv12 = Activation('relu')(bn12)
    flat1 = Flatten()(actv12)

    # second feature extractor
    conv21 = Conv1D(16, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn21 = BatchNormalization()(conv21)
    actv21 = Activation('relu')(bn21)
    conv22 = Conv1D(32, kernel_size=42, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv21)
    bn22 = BatchNormalization()(conv22)
    actv22 = Activation('relu')(bn22)
    flat2 = Flatten()(actv22)

    # third feature extractor
    conv31 = Conv1D(16, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(input_signal)
    bn31 = BatchNormalization()(conv31)
    actv31 = Activation('relu')(bn31)
    conv32 = Conv1D(32, kernel_size=52, strides=1, padding='valid', bias_initializer=b_init,
                    kernel_initializer=k_init)(actv31)
    bn32 = BatchNormalization()(conv32)
    actv32 = Activation('relu')(bn32)
    flat3 = Flatten()(actv32)

    # merge feature extractors
    merge = concatenate([flat1, flat2, flat3])

    # dropout & fully-connected layer
    do = Dropout(0.9, seed=2018)(merge)
    output = Dense(n_classes, activation='softmax', bias_initializer=b_init, kernel_initializer=k_init)(do)

    # result
    model = Model(inputs=input_signal, outputs=output)

    # summarize layers
    print(model.summary())

    new_dir = 'model/unimib_svd_conv1d_10/' + str(i+1) + '/'
    if not os.path.exists(new_dir):
        os.makedirs(new_dir)

    fpath = new_dir + 'weights.{epoch:02d}-{val_acc:.2f}.hdf5'
    cp_cb = ModelCheckpoint(fpath, monitor='val_acc', verbose=1, save_best_only=True, mode='auto', period=1)

    adam = Adam(lr=0.001)
    model.compile(loss=losses.categorical_crossentropy, optimizer=adam, metrics=['accuracy'])
    model.fit(np.expand_dims(X_train, axis=2), y_train, batch_size=64, epochs=50, verbose=2, validation_split=0.10,
              callbacks=[cp_cb], shuffle=True)

    del model
    K.clear_session()


# Below calculates average test data accuracy (LOSO CV).

acc = []

for i in range(30):
    test = y.loc[y[1] == i+1]
    test_index = test.index.values

    train = y[~y.index.isin(test_index)]
    train_index = train.index.values

    y_values = y.ix[:, 0].values

    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y_values[train_index] - 1, y_values[test_index] - 1

    print "\n>>>>>>>>>>>>>>", str(i+1), "-fold <<<<<<<<<<<<<<<<"
    path_str = 'model/unimib_svd_conv1d_10/' + str(i+1) + '/'
    for path, dirs, files in os.walk(path_str):
        dirs.sort()
        files.sort()
        top_acc = []
        top_acc.append(files[-1])
        files = top_acc
        for file in files:
            print "========================================"
            print os.path.join(path, file)
            model = load_model(os.path.join(path, file))
            pred = model.predict(np.expand_dims(X_train, axis=2), batch_size=32)
            print "------ TRAIN ACCURACY: ", file, " ------"
            print accuracy_score(y_train, np.argmax(pred, axis=1))
            print confusion_matrix(y_train, np.argmax(pred, axis=1))
            pred = model.predict(np.expand_dims(X_test, axis=2), batch_size=32)
            print "------ TEST ACCURACY: ", file, " ------"
            print accuracy_score(y_test, np.argmax(pred, axis=1))
            print confusion_matrix(y_test, np.argmax(pred, axis=1))

            del model
            K.clear_session()

    acc.append(accuracy_score(y_test, np.argmax(pred, axis=1)))

print acc
print np.mean(acc)
print np.std(acc)

'''
-----
[0.7317708333333334, 0.7547169811320755, 0.8256578947368421, 0.5273311897106109, 0.7583892617449665, 0.8131067961165048, 0.806060606060606, 0.7984886649874056, 0.6763285024154589, 0.7028753993610224, 0.7091836734693877, 0.82, 0.7957559681697612, 0.7956989247311828, 0.8075949367088607, 0.7350427350427351, 0.8051391862955032, 0.7793103448275862, 0.7556390977443609, 0.6963123644251626, 0.4357142857142857, 0.6446280991735537, 0.7423312883435583, 0.7495908346972177, 0.7358024691358025, 0.7767857142857143, 0.7780898876404494, 0.8227848101265823, 0.683495145631068, 0.7230392156862745]
0.739555503715
0.0842176003637
-----

/usr/bin/python2.7 /mnt/0cdd1a7e-3686-4cf7-9055-145eb5fe70f3/hcilab/OSS/electronicsletters2018/unimib/unimib_svd_conv1d_10.py
/home/hcilab/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.

>>>>>>>>>>>>>> 1 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/1/weights.50-0.52.hdf5
------ TRAIN ACCURACY:  weights.50-0.52.hdf5  ------
0.923333626065
[[ 145    1    0    0    0    0    0    0    1    0    0    0    0    0
     0    0    0]
 [   1  198    1    0    0    0    0    5    0    0    1    0    0    0
     0    0    0]
 [   0    0 1665    0    0    1   15    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1908    0    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    0  840    1   41    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  718    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10    2    0    7 1263    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0  276    7    0    1    0    0    0
     1    1    0]
 [   0    0    0    0    0    0    1    7  190    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  465    3    7    3   32
     3    0    3]
 [   0    0    1    0    1    0    1    3    0   33  406   12    3   23
     1    7    3]
 [   0    0    0    0    0    2    1    1    1   19   25  419    6    6
    18    5    8]
 [   0    1    0    0    0    0    0    2    1    5    8   19  595    8
     0    2    1]
 [   1    0    0    0    1    0    0    0    0   72    3    3    1  386
     0    0    3]
 [   0    0    0    0    0    2    0    9    1    2   14   69   11    2
   295    3   11]
 [   0    0    0    0    0    0    0    0    0   20   56   11   14   17
     4  326   45]
 [   0    0    1    0    0    0    0    0    0    6   14   22    4   23
     4   23  419]]
------ TEST ACCURACY:  weights.50-0.52.hdf5  ------
0.731770833333
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  9  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 55  1  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  3  0  0 27  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 28  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0 41  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  5  0  0  0  0  0  0  2  0  0]
 [ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  9  0  0  0  0  0  1]
 [ 0  1  0  0  1  0  0  1  0  0  6  0  2  0  3  2  1]
 [ 0  0  0  0  0  5  0  0  0  0  0  1  0  0  3  5  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  2  0  1  1  0  8  0]
 [ 0  0  0  0  0  1  0  0  0  0  2  7  0  0  2  3  0]
 [ 0  0  0  0  0  3  0  0  0  0  4  0  0 11  0  1  1]
 [ 0  0  0  0  0  0  0  0  0  2  2  4  0  1  0  1  8]]

>>>>>>>>>>>>>> 2 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/2/weights.46-0.52.hdf5
------ TRAIN ACCURACY:  weights.46-0.52.hdf5  ------
0.926617804791
[[ 145    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  198    1    0    0    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1591    0    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1898    0    0   10    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    0  851    0   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11    4    2    5 1253    0    0    0    0    0    0    0
     0    0    0]
 [   0    6    0    0    0    0    0  275    3    0    1    0    0    0
     0    2    0]
 [   0    0    0    0    0    0    1    5  187    0    0    0    0    0
     0    2    1]
 [   0    2    0    0    0    0    0    0    0  448    4    3    1   35
     6    4    5]
 [   0    0    1    0    0    0    2    3    0   33  386   16    7   14
     1   18    7]
 [   0    0    0    0    0    0    1    1    0   14   15  419    7   14
    16    2   13]
 [   0    3    0    0    0    0    0    2    0    6    3   17  567    7
     1   13    2]
 [   1    0    0    0    1    0    0    0    0   57    0    6    2  379
     0    4    2]
 [   0    1    0    0    0    1    0    3    2    0   15   64    4    3
   300    8    8]
 [   0    0    0    0    1    0    0    1    0   15   42    7    6   22
     1  347   44]
 [   0    0    0    0    0    0    0    1    0    5   11   28    5   19
     3   26  409]]
------ TEST ACCURACY:  weights.46-0.52.hdf5  ------
0.754716981132
[[  6   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0  10   0   0   2   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 139   0   4   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  74   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  37   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  29   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   1  48   0   0   0   0   0   0   0   0   0   0]
 [  1   4   0   0   1   0   0   3   0   0   0   0   0   0   0   0   0]
 [  0   1   0   0   0   0   0   0   3   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  18   0   0   1   0   0   2   0]
 [  0   0   0   0   0   0   0   0   0   0  16   0   6   0   0   1   0]
 [  0   1   0   0   3   0   1   1   0   0   0  15   0   0   0   1   2]
 [  0   0   0   0   0   0   0   0   0   1   4   2  23   0   0  10   0]
 [  0   0   0   0   0   0   0   0   1  13   0   1   0  15   0   2   0]
 [  0   2   0   4   1   0   1   0   0   0   0   4   0   2   2   1   8]
 [  0   0   0   0   0   0   2   0   0   1   5   7   8   0   0   2   2]
 [  0   0   0   0   0   0   0   0   0   0   0  18   0   0   0   9   0]]

>>>>>>>>>>>>>> 3 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/3/weights.28-0.52.hdf5
------ TRAIN ACCURACY:  weights.28-0.52.hdf5  ------
0.904508589867
[[ 144    1    0    0    1    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   4  196    1    0    3    0    0    9    1    0    1    0    0    0
     0    0    0]
 [   0    0 1702    0    2    3    8    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    4 1904    0    2    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    3    0  862    1   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   37   17   10    9 1212    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    0    0    1    0    1  266    9    0    2    0    1    0
     1    0    0]
 [   0    0    1    0    0    0    0   10  184    0    0    0    0    1
     0    0    1]
 [   0    2    0    0    0    0    0    0    0  427    9    4    5   64
     0    1    3]
 [   1    0    1    0    1    0    0    3    1   37  386   21    8   15
     3   18    4]
 [   0    0    0    0    0    1    0    2    3   16   16  390    9   15
    33    5   26]
 [   0    1    0    0    0    0    0    2    0    2    4   17  602   10
     0    8    1]
 [   1    5    0    0    1    0    0    0    0   79    2    4    1  368
     4    4    2]
 [   0    0    0    0    2    0    0    6    3    4   17   64    8    4
   299    7   13]
 [   0    0    0    0    1    0    0    0    2   17   72    4   15   22
     9  315   46]
 [   0    0    0    0    0    0    0    0    0    7   18   24    4   25
    12   38  399]]
------ TEST ACCURACY:  weights.28-0.52.hdf5  ------
0.825657894737
[[ 6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 73  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  8  2 29  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 10  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  1  5  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  9  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  7  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 14  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  1  0  0  0  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  3  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  0  1  1  0  0  0  4  2]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  1  0  0  1  3]]

>>>>>>>>>>>>>> 4 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/4/weights.37-0.52.hdf5
------ TRAIN ACCURACY:  weights.37-0.52.hdf5  ------
0.9184991274
[[ 148    3    0    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   1  200    1    0    2    0    0    7    0    0    1    0    0    0
     0    0    0]
 [   0    0 1702    0   14    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1928    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    9    0  855    0   27    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   14    8    3    7 1265    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    1    0    0  277    4    0    1    0    0    0
     0    1    0]
 [   0    0    1    0    0    0    0   14  175    0    0    0    0    0
     0    0    1]
 [   0    2    0    0    0    0    0    0    0  444    7    5    3   53
     5    0    3]
 [   0    0    1    0    1    0    2    5    0   36  390   10    5   19
     9   13    1]
 [   0    0    0    0    1    3    0    1    1   17   13  378   11   16
    39    5   18]
 [   0    1    0    0    0    0    0    3    0    4    2    8  607    9
     3    4    2]
 [   2    3    0    0    0    0    0    0    0   63    3    1    3  379
     3    6    4]
 [   0    0    0    0    2    0    0    7    1    3    7   50   18    2
   317    4   10]
 [   0    0    0    0    1    0    0    0    0   15   62    8    7   18
     8  346   32]
 [   0    0    0    0    0    0    0    2    0    2   19   25    4   17
     8   36  399]]
------ TEST ACCURACY:  weights.37-0.52.hdf5  ------
0.527331189711
[[ 2  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  6  0  0  0 10  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 34  0  0 20  0  0  0  0  0  0  0  0  0  0]
 [ 1  2  0 23  0  1  0  0  0  0  2  0  0  0  0  0]
 [ 0  0  0  0 17  0  3  0  0  0  0  1  0  0  0  6]
 [ 0  0  0  0  0 27  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  7  2  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  8  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  1  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  1  0  0  1  0 12  0]
 [ 0  0  0  0  0  0  0  0  0  5  8  5  0  0  2  3]
 [ 0  0  0  0  0  0  0  0  1  0  0 16  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0 10  0  0  4]
 [ 0  0  0  0  0  0  0  0  1  4  4  0  0  3  1  0]
 [ 0  0  0  0  0  0  0  0  6  1  1  1  4  0  0  3]
 [ 0  0  0  0  1  0  0  0  0  3  0  2  4  1  7  4]]

>>>>>>>>>>>>>> 5 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/5/weights.47-0.51.hdf5
------ TRAIN ACCURACY:  weights.47-0.51.hdf5  ------
0.921031988146
[[ 145    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  189    1    0    2    0    0    8    1    0    1    0    0    0
     0    0    0]
 [   0    0 1698    0    0    4   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1908    0    0    9    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  869    1   27    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    1    1    8 1276    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    1    0    0    0    0  279    6    0    1    0    1    0
     0    0    0]
 [   2    0    0    0    0    0    0    6  189    0    2    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  464    5    0    3   34
     0    1    4]
 [   0    0    1    0    1    1    0    1    0   52  389    8    1   11
     0   20   17]
 [   0    0    0    0    0    1    0    3    1   13   21  401   12    8
    25    6   14]
 [   0    1    0    0    0    0    0    3    0    5    7   17  599   10
     1    1    2]
 [   1    0    0    0    0    0    0    0    0  103    0    7    2  350
     1    3    7]
 [   0    1    0    0    2    0    0    8    0    3   10   44   15    0
   321    8   13]
 [   0    0    0    0    1    0    0    1    0   23   47    3   11   12
     4  341   55]
 [   0    0    0    0    0    1    0    0    0    8   12   20    5   21
     7   19  423]]
------ TEST ACCURACY:  weights.47-0.51.hdf5  ------
0.758389261745
[[ 7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  8  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 22  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 66  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 17  0  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  4  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  0  0  0 11  0  1  0]
 [ 0  0  0  0  0  0  0  1  0  1  1  0  0  1  1  3  1]
 [ 0  0  0  0  0  0  0  1  0  0  0  3  0  0 10  1  6]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  0  0  0  3  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  2  0 12  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 12  6]]

>>>>>>>>>>>>>> 6 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/6/weights.45-0.50.hdf5
------ TRAIN ACCURACY:  weights.45-0.50.hdf5  ------
0.923584822608
[[ 148    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  196    4    0    0    0    0    9    0    0    1    0    0    0
     0    1    0]
 [   0    0 1681    0    0    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1919    0    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    0  840    0   30    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    4    0    3 1261    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    0    0    0    0    0  274    3    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    7  186    0    0    0    0    0
     0    0    1]
 [   0    2    1    0    0    0    0    0    0  454    5    8    3   31
     1    0    5]
 [   0    0    1    0    0    0    0    2    0   36  405   14    6    8
     4    8   12]
 [   0    0    0    0    0    1    2    2    0   17   14  416   12   13
    14    4   12]
 [   0    1    0    0    0    0    0    3    0    7    9    8  584    9
     1   12    4]
 [   1    2    1    0    0    0    0    0    0   74    0    6    4  364
     2    7    3]
 [   0    1    0    0    0    1    0    7    1    2   13   72    8    0
   293    2   16]
 [   0    0    0    0    0    0    0    1    0   22   51   13   15   12
     4  318   57]
 [   0    0    0    0    0    0    0    0    0    2   10   33    6   13
     3   13  436]]
------ TEST ACCURACY:  weights.45-0.50.hdf5  ------
0.813106796117
[[ 2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  2  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 44  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 29  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 50  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0  0  2 12  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 18  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  6  7  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0 17  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0  0 22  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 16  0  0  0  4  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  4  0  0 10  0  3]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  2  0  0  0 17]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  1  0  0 14]]

>>>>>>>>>>>>>> 7 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/7/weights.50-0.50.hdf5
------ TRAIN ACCURACY:  weights.50-0.50.hdf5  ------
0.927191679049
[[ 151    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  204    0    0    0    0    0    7    0    0    0    0    0    0
     0    0    0]
 [   0    0 1682    0    2    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1928    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    4    0  863    0   17    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    4    1    8 1274    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    1    0    0  285    1    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1    6  185    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  451    6    4    2   43
     6    1    1]
 [   0    0    1    0    0    0    1    2    1   24  425    5    6   18
     4    7    2]
 [   0    0    0    0    0    2    1    4    0   16   15  400   10    9
    31    4   16]
 [   0    1    0    0    0    0    0    3    0    0    5   11  607   10
     1    2    3]
 [   1    0    0    0    0    0    0    0    0   47    8    3    3  380
     7    7    6]
 [   0    1    0    0    0    2    0    4    2    0   17   70    6    3
   306    6    9]
 [   0    0    0    0    0    0    0    4    0   22   69    4    9   14
     4  334   40]
 [   0    0    0    0    0    1    0    1    0    4   18   37    4   10
     8   32  407]]
------ TEST ACCURACY:  weights.50-0.50.hdf5  ------
0.806060606061
[[ 4  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0 44  0  0  0  5  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 52  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 33  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  8  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  0  3  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 14  0  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  1  0  7  7  0  0  1  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  8  0  0  0 10  0  1  3]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  2  0  0  5  5]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  8  3]]

>>>>>>>>>>>>>> 8 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/8/weights.32-0.51.hdf5
------ TRAIN ACCURACY:  weights.32-0.51.hdf5  ------
0.909266748725
[[ 149    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   2  202    2    0    1    0    0    8    0    0    1    0    0    0
     0    0    0]
 [   0    0 1644    0    8    1   18    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2 1926    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    7    0  842    1   43    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    7    1    9 1256    0    0    0    0    0    0    0
     0    0    0]
 [   0    5    0    0    0    0    0  270    4    0    2    0    0    0
     1    1    0]
 [   1    0    0    0    0    0    0    9  177    0    1    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  401    7    6    7   69
     1    2    8]
 [   0    0    0    0    0    1    1    5    1   36  391    5    6   21
     2   18    7]
 [   0    1    0    0    0    3    1    5    3   14   30  371   20   11
    25    3   22]
 [   0    0    0    0    0    0    0    3    0    3    2    9  593    5
     1   12    8]
 [   1    2    0    0    1    0    0    0    0   66    4    1    3  365
     3    9   10]
 [   0    2    0    0    2    0    0    8    2    2   18   57   16    1
   294    6   12]
 [   0    0    0    0    0    0    1    3    0   18   53    2   18   14
     5  336   53]
 [   0    0    0    0    0    1    0    0    0    9   18   16    7   18
     8   32  404]]
------ TEST ACCURACY:  weights.32-0.51.hdf5  ------
0.798488664987
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 52  0  3  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  4  0  0  0 43  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  7  4  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 10  0  2  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11  4  0  0  5  0  0  6]
 [ 0  0  0  0  0  0  0  2  0  0 13  1  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  1  4  0  4  7  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 25  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  5  0  0  2 11  0  1  0]
 [ 0  0  0  0  0  0  0  2  1  0  5  2  0  1  2  0  1]
 [ 0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  7  1]
 [ 0  0  0  0  0  0  0  1  0  0  0  2  0  8  0  0 10]]

>>>>>>>>>>>>>> 9 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/9/weights.37-0.50.hdf5
------ TRAIN ACCURACY:  weights.37-0.50.hdf5  ------
0.913973760676
[[ 145    5    0    0    1    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   2  206    1    0    0    0    0    4    0    0    0    0    0    0
     0    0    0]
 [   0    0 1674    0    1    1   11    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    6 1918    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    2   17    0  862    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   39    8    5    9 1216    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    1    0    1    0    1  279    2    0    1    0    0    0
     1    1    0]
 [   0    1    0    0    0    0    0   13  175    0    0    0    0    0
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  451    2    4    2   38
     2    5    3]
 [   0    0    1    0    1    0    2    3    0   33  375    6    4   19
     3   29    6]
 [   0    1    0    2    1    2    0    5    0   24   27  373   10   11
    26    8   16]
 [   0    2    0    0    0    0    0    2    0    4    1    9  586   11
     2    6    1]
 [   1    1    0    0    1    0    0    0    0   61    1    3    4  391
     2    5    3]
 [   0    1    0    0    0    3    0   11    0    1   15   53   14    0
   307    8    8]
 [   0    0    0    0    0    0    0    1    0   13   49    7    9   31
     5  328   39]
 [   0    0    1    0    0    1    0    3    0    3   21   36    8   26
    11   22  373]]
------ TEST ACCURACY:  weights.37-0.50.hdf5  ------
0.676328502415
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0 50  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 60  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 15  0  5  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 47  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  7  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0 15  0  3  0]
 [ 0  0  0  0  0  0  0  3  0  5 10  0  0  2  0  9  0]
 [ 0  0  0  0  0  0  0  4  1  0  0  0  0  0 15  0  0]
 [ 0  0  2  0  0  0  0  0  0  1  0  0 32  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0  5  0  1  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  2  0  5  0  1  9  1  1 12  0]
 [ 0  0  0  0  0  0  0  3  0 10  0  1  1  1  0 13  0]]

>>>>>>>>>>>>>> 10 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/10/weights.46-0.49.hdf5
------ TRAIN ACCURACY:  weights.46-0.49.hdf5  ------
0.924768720545
[[ 150    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  202    2    0    1    0    0    8    0    0    1    0    0    0
     0    0    1]
 [   0    0 1688    0    5    0   13    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1922    0    0   11    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  882    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  727    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    2    2    0 1288    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  287    3    0    2    0    0    0
     1    0    0]
 [   1    0    0    0    0    0    0    7  175    0    3    0    0    0
     0    0    1]
 [   0    2    0    0    0    0    0    0    0  422   14    5    6   53
     1    0    4]
 [   0    0    0    0    0    1    1    1    0   28  430    8    3    9
     0   11    7]
 [   0    1    0    0    0    2    1    3    0   15   20  401   13   14
    15    1   18]
 [   0    4    0    0    0    0    0    0    0    1   11    6  591   11
     0   11    8]
 [   0    1    0    0    1    0    0    0    0   51    5    1    1  393
     2    6    6]
 [   0    1    0    0    1    2    0    6    0    0   23   60    7    0
   294    2   24]
 [   0    0    0    0    1    0    0    0    0   15   83    2    7   14
     3  340   36]
 [   0    0    0    0    0    0    0    0    0    7   11   18    3   18
     5   51  404]]
------ TEST ACCURACY:  weights.46-0.49.hdf5  ------
0.702875399361
[[ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 32  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 51  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 13  0 21  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 17  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  7 22  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  7  3  0  0  0  0  1  0  2  0]
 [ 0  0  0  0  0  0  0  0 19  0  0  3  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  8  0  0  0  3  0  0]
 [ 0  0  0  0  2  0  0  0  2  7  3  0  0  0  0  8]
 [ 0  0  0  0  0  0  0  0  0  0  0 18  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  1 10  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0 11  0  1]
 [ 0  0  0  0  0  0  0  0  0 12  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  0  0  1  0  1 12]]

>>>>>>>>>>>>>> 11 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/11/weights.39-0.50.hdf5
------ TRAIN ACCURACY:  weights.39-0.50.hdf5  ------
0.889006063802
[[ 138    6    0    0    1    0    0    1    1    0    0    0    0    0
     0    0    0]
 [   2  196    2    0    0    0    0    8    1    0    2    0    0    0
     0    0    0]
 [   0    0 1708    0    3    3    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1892    0    0    6    0    0    0    0    0    0    0
     0    0    0]
 [   0    2   38    0  811    2   25    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  726    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   46   14    5   10 1192    0    0    0    0    0    0    0
     0    0    0]
 [   1    7    2    0    1    0    1  254   15    0    4    1    1    0
     1    0    0]
 [   0    0    1    0    0    0    0   11  182    0    0    0    0    1
     0    0    0]
 [   0    2    1    0    0    0    0    0    0  414   12    7    4   65
     0    4    2]
 [   0    0    2    0    1    0    0    5    1   24  356   25   13   23
     2   25   14]
 [   0    0    0    0    0    1    0    4    0   19   22  387   16   15
    22    3   23]
 [   0    1    0    0    0    0    0    2    1    7    1   10  595   10
     1    6    3]
 [   2    5    0    0    0    0    0    0    0   84    6    9    6  340
     4    5    4]
 [   1    1    0    0    2    0    0    6    3    2   28   87   13    2
   252    3   16]
 [   0    0    0    0    0    0    0    2    2   13   73   17   18   15
     7  310   42]
 [   0    0    0    0    0    0    0    6    1    8   21   48    5   15
     8   43  363]]
------ TEST ACCURACY:  weights.39-0.50.hdf5  ------
0.709183673469
[[ 4  0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  0]
 [ 1  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 23  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 82  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  2  0 39  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 20  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 28  0  1  0 28  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  1  0  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 15  0  0  0  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0 12  2  0  0  4  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  1  2  0  0  4  0  7]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 16  0  0  8  0]
 [ 0  0  2  0  0  0  0  0  0  3  0  0  3  7  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  0  0  0  7  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  3  0  0  5  2]
 [ 0  0  0  0  0  0  0  0  0  0  2  3  2  0  0  6  3]]

>>>>>>>>>>>>>> 12 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/12/weights.48-0.48.hdf5
------ TRAIN ACCURACY:  weights.48-0.48.hdf5  ------
0.915357998403
[[ 145    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  206    0    0    0    0    0    3    1    0    0    0    0    0
     0    0    0]
 [   0    0 1554    0    0    1    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1907    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    5    0  871    0   12    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   89    9   21    7 1162    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    1    0    1  287    4    0    1    0    0    0
     1    0    0]
 [   0    0    1    0    0    0    0    4  192    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  427   16   17    1   43
     4    0    2]
 [   0    0    1    0    0    0    1    3    1   22  409    3   11   18
     7   15    5]
 [   0    0    0    0    1    2    1    2    1   18   22  400    9   15
    31    0   12]
 [   0    2    0    0    0    0    0    2    0    1    4   16  598    9
     3    4    2]
 [   0    2    0    0    0    2    0    1    0   56    7    5    2  381
     3    1    4]
 [   0    1    0    0    2    0    0    7    1    1   16   48    7    1
   326    1   13]
 [   0    0    0    0    0    0    0    1    1   13   65    3    9   22
     9  326   47]
 [   0    0    0    0    0    0    0    0    0    1   18   28    4   15
    12   25  412]]
------ TEST ACCURACY:  weights.48-0.48.hdf5  ------
0.82
[[  5   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  2   3   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 163   0  18   0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   1  73   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  31   0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   2  23   7   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  36   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   2   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  11   0   0   0   2   0   0   4]
 [  0   0   0   0   0   0   0   0   0   0   9   0   0   0   2   2   2]
 [  0   0   0   0   0   0   0   0   0   0   3   7   0   0   0   0   2]
 [  0   0   0   0   0   0   0   0   0   0   4   0  16   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   0   0  13   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   1   0   0   0   9   0   0]
 [  0   0   0   0   0   0   0   0   0   0  14   0   0   0   0   3   0]
 [  0   0   0   0   0   0   0   0   0   0   6   0   0   1   3   3   6]]

>>>>>>>>>>>>>> 13 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/13/weights.50-0.52.hdf5
------ TRAIN ACCURACY:  weights.50-0.52.hdf5  ------
0.921976478849
[[ 145    5    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  201    0    0    1    0    0    6    0    0    1    0    0    0
     0    0    0]
 [   0    0 1712    0    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   18 1892    0    0    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    0  860    0   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    1  713    7    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11    6    4    1 1257    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0    0    1  276    0    0    0    0    0    0
     2    0    0]
 [   0    0    1    0    0    0    0   12  180    0    2    0    0    0
     0    1    0]
 [   0    2    0    0    0    0    0    0    0  433    5    7    3   51
     1    4    1]
 [   0    0    0    0    0    0    0    1    0   28  404   12    6   18
     8   14    2]
 [   0    0    0    0    1    2    0    1    0    9   23  369   14   10
    64    4   11]
 [   0    3    0    0    0    0    0    0    0    0    3    6  607    4
     3    7    3]
 [   1    0    0    0    0    0    0    0    0   61    5    3    3  390
     3    2    6]
 [   0    0    0    0    0    2    0   11    2    1   14   38   11    2
   329    4    4]
 [   0    0    0    0    0    0    0    7    0   13   60    5    5   14
    11  331   49]
 [   0    0    0    0    0    0    0    0    0    0   21   25    7   27
    10   16  406]]
------ TEST ACCURACY:  weights.50-0.52.hdf5  ------
0.79575596817
[[ 2  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  0  0  0  0  0  4  0  0  0  0]
 [ 0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 36  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0 15  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 11 11  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  5  0  0  0  0 12  0]
 [ 0  0  1  0  0  0  0  0  0  0  8  5  2  0  0  1  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  0  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  1  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  0  0 14  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  3  0 15  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  4  0 14  3]]

>>>>>>>>>>>>>> 14 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/14/weights.50-0.50.hdf5
------ TRAIN ACCURACY:  weights.50-0.50.hdf5  ------
0.929116589174
[[ 151    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  204    2    0    0    0    0    1    1    0    1    0    0    0
     0    0    0]
 [   0    0 1674    0    1    1    7    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    0 1929    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    4    0  847    1   27    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    5    0    3 1264    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  279   11    0    0    0    0    0
     1    0    0]
 [   0    0    1    0    0    0    0    3  191    0    0    0    0    0
     0    0    0]
 [   1    1    0    0    0    0    0    0    0  463    5    4    0   36
     1    1    4]
 [   0    0    0    0    0    0    0    1    1   38  401   10    4    8
     9   10   11]
 [   0    0    0    1    0    2    0    2    0   17   12  403    9   15
    25    4   13]
 [   0    1    0    0    0    0    0    2    0    4    4   12  592    8
     0   14    4]
 [   0    0    0    0    0    0    0    0    0   79    1    2    0  376
     2    4   10]
 [   1    1    0    0    2    0    0    4    5    2    8   48    6    2
   322    6    7]
 [   0    0    0    0    0    0    0    0    1   21   52    3    7   15
     5  343   48]
 [   0    0    0    0    0    1    0    0    0    0    7   27    3   15
    12   28  430]]
------ TEST ACCURACY:  weights.50-0.50.hdf5  ------
0.795698924731
[[ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 4  0  0  0  0  0  0  1  0  0  1  0  0  0  0  0  0]
 [ 0  0 38  0  3  0 13  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 55  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 40  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1  0  0  0 49  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  1  9  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  3 12  0  0  0  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  5  0  0 12  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0 18  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  7  0  0  0  0 11  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  0  1  2  5]]

>>>>>>>>>>>>>> 15 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/15/weights.47-0.51.hdf5
------ TRAIN ACCURACY:  weights.47-0.51.hdf5  ------
0.92150140647
[[ 142    1    0    0    0    0    0    0    1    0    0    0    0    0
     0    0    0]
 [   0  202    1    0    1    0    0    5    0    0    1    0    0    0
     1    0    0]
 [   0    0 1680    0    2    0    9    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1876    0    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    7    0  871    0   25    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  713    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    3    1    7 1254    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  276    5    0    1    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    0    8  182    0    0    0    0    0
     0    1    1]
 [   0    2    0    0    0    0    0    0    0  462    9    7    0   29
     3    0    5]
 [   0    0    1    0    0    0    1    1    0   36  417    9    2    9
     5    2   10]
 [   0    1    0    0    0    1    2    3    0   11   31  408   12    3
    26    2   12]
 [   0    2    0    0    0    0    0    1    0    1    7   16  594    7
     4    6    5]
 [   1    3    0    0    0    0    0    0    0   88    4    1    1  363
     2    2    4]
 [   0    1    0    0    0    1    1    6    2    0   24   53    4    0
   306    1   17]
 [   0    1    0    0    0    0    0    1    0   15   85    7    7   18
     3  304   59]
 [   0    0    0    0    0    0    0    1    0    8   11   28    3   12
     5   18  433]]
------ TEST ACCURACY:  weights.47-0.51.hdf5  ------
0.807594936709
[[ 2  0  0  0  0  0  0  2  5  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  2  1  0  0  0  0  0  0  0  0]
 [ 0  0 47  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 88  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 16  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 32  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  9 46  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 12  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  0  2  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0 14  0  0  0  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  4  0  2  6  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  1  5  5  1  0  1  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 15  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  2  0  1  9  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  3  1  1  0  0  0  8]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  0  0  0  0 11]]

>>>>>>>>>>>>>> 16 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/16/weights.48-0.52.hdf5
------ TRAIN ACCURACY:  weights.48-0.52.hdf5  ------
0.921171370433
[[ 141    4    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  183    2    0    3    0    0    9    0    0    0    0    0    0
     0    1    0]
 [   0    0 1678    0    1    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7 1900    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11    0  848    0   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  716    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   72    4    4    5 1180    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    0    0    1    0    0  267    3    0    0    0    0    0
     0    0    0]
 [   0    0    1    0    0    0    0    5  187    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    2  453    9    1    0   36
     5    0    2]
 [   1    0    0    0    1    0    0    2    1   33  425    6    6    4
     2    9    2]
 [   0    0    0    0    1    2    0    2    0   13   15  416    9   11
    24    2   17]
 [   0    1    0    0    0    0    0    2    0    7    3   11  590    9
     1   15    1]
 [   1    3    0    0    0    0    0    0    0   79    5    5    0  368
     2    6    1]
 [   0    1    0    0    2    0    0    5    2    0   15   48   12    0
   320    1   17]
 [   0    0    0    0    0    0    0    6    1   11   68    5   13   16
     2  323   46]
 [   0    0    0    0    0    0    0    3    0    4   21   10    4   24
     8   17  417]]
------ TEST ACCURACY:  weights.48-0.52.hdf5  ------
0.735042735043
[[ 2  5  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 7  2  0  0  0  0  0  7  1  0  0  0  0  0  0  0  0]
 [ 0  0 57  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 77  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 46  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  3 27  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 10  4  0  0 45  0  0  0  0  0  0  0  0  0  0]
 [ 2  1  0  0  2  0  0 11  3  0  0  0  1  0  0  1  0]
 [ 0  0  0  0  1  0  0  1  5  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 12  0  0  2  5  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  3  0  0  0  4  9]
 [ 0  0  0  0  0  0  0  0  0  2  0 10  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 19  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  3  0  0  3  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  3  3  0  2  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  9  0  0  0  0  2 11  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  4  0  0  0  4 14]]

>>>>>>>>>>>>>> 17 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/17/weights.48-0.52.hdf5
------ TRAIN ACCURACY:  weights.48-0.52.hdf5  ------
0.930732484076
[[ 148    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  193    1    0    0    0    0    4    1    0    0    0    0    0
     1    0    0]
 [   0    0 1632    0    1    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1897    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  873    0   15    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  727    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   19    1    8    6 1240    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    1  271    8    0    0    0    0    0
     1    0    0]
 [   0    0    1    0    0    0    0    6  186    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  468    6    2    1   34
     0    0    4]
 [   0    0    2    1    0    0    2    3    0   26  406    6    3    8
     6   15   17]
 [   0    0    0    1    0    2    1    2    0   10   11  414   14   15
    18    2   15]
 [   0    1    0    0    0    0    0    3    0    1    6   16  596    2
     0    9    7]
 [   0    0    0    0    0    0    0    0    0   56    1    5    3  390
     3    2    4]
 [   0    0    0    0    0    0    1    5    3    2   10   44   10    0
   314    5   17]
 [   0    0    0    0    1    0    0    2    0   12   54    9   11    8
     6  337   55]
 [   0    0    0    0    0    0    0    2    0   10   19   21    5    7
    10   14  429]]
------ TEST ACCURACY:  weights.48-0.52.hdf5  ------
0.805139186296
[[  4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  1  11   0   0   0   0   0   3   0   0   0   0   0   0   0   0   0]
 [  0   0 103   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  81   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  12   0  16   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  18   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0  50   0   0   0   0   0   0   0   0   0   0]
 [  1   0   0   0   0   0   0  12   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   6   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   6   0   0   3   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   5   1   0   0   0   6   4]
 [  0   0   0   0   0   0   0   0   0   0   3  14   0   1   3   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  17   3   0   0   0]
 [  0   0   0   0   0   0   0   0   0   7   0   0   0   7   0   0   6]
 [  0   0   0   0   0   0   0   0   0   0   0   5   0   4   9   0   5]
 [  0   0   0   0   0   0   0   0   0   5   3   0   0   0   0   8   2]
 [  0   0   0   0   0   0   0   0   0   0   4   1   0   0   3   0   9]]

>>>>>>>>>>>>>> 18 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/18/weights.48-0.52.hdf5
------ TRAIN ACCURACY:  weights.48-0.52.hdf5  ------
0.929274453445
[[ 136    3    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  203    1    0    0    0    0    3    0    0    0    0    0    0
     0    0    0]
 [   0    0 1733    0    2    1    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1925    0    0    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    5    0  865    0   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  729    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    5    1    7 1272    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    0    0    0  267   10    0    0    1    0    0
     0    1    1]
 [   0    0    1    0    0    0    0    1  187    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  449    7   13    2   37
     2    0    3]
 [   0    0    1    0    0    0    0    2    0   32  409    6    8   15
     4   10    6]
 [   0    0    0    0    0    0    1    5    0   17   25  391    9   13
    23    7   18]
 [   0    1    0    0    0    0    0    3    0    3    5   11  600    7
     2    6    5]
 [   0    1    0    0    0    0    0    0    0   58    0    4    1  394
     2    1   10]
 [   0    1    0    0    0    1    0    5    0    7   18   45    3    0
   325    8   10]
 [   0    0    0    0    0    0    0    0    0   15   46    6   12   18
     8  345   53]
 [   0    0    0    0    0    0    0    0    0    5   14   24    4    9
    10   16  439]]
------ TEST ACCURACY:  weights.48-0.52.hdf5  ------
0.779310344828
[[ 8  3  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  0  0  4  1  0  0  0  0  0  0  0  0]
 [ 0  0 56  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 15  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 31  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 11  2  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  2  8  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  8  0  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 12  1  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  3  0  6  0  6  0  1  1]
 [ 0  0  0  0  0  0  0  0  0  0  0 15  3  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 11  0  1  1]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  7  0  1]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  2  0  4  1]
 [ 0  0  0  0  0  0  0  0  0  8  0  1  0  0  0  4]]

>>>>>>>>>>>>>> 19 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/19/weights.21-0.51.hdf5
------ TRAIN ACCURACY:  weights.21-0.51.hdf5  ------
0.887527162103
[[ 141    4    0    0    0    0    0    0    2    0    0    0    0    0
     0    0    0]
 [   5  174    6    0    1    0    0   13    3    0    2    0    0    0
     0    0    0]
 [   0    0 1697    0    1    4   22    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1899    0    0   19    0    0    0    0    0    0    0
     0    0    0]
 [   0    3   33    0  837    3   41    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   31    3    2    8 1249    0    0    0    0    0    0    0
     0    0    0]
 [   1    5    1    0    2    0    1  260   15    0    1    0    0    0
     1    3    0]
 [   0    0    1    0    0    0    0   10  178    0    0    0    0    1
     0    1    1]
 [   0    2    0    0    0    0    0    0    0  406   19   15    3   67
     1    5    3]
 [   0    0    2    0    0    1    0    6    2   28  391   16    7   12
     4   19    8]
 [   0    1    0    0    0    2    0    6    4   12   25  394   19   13
    15    6   20]
 [   0    2    0    0    0    0    0    2    0    7    9   15  593    8
     0    1    7]
 [   1    5    0    0    1    0    0    0    1   69   10    5    3  364
     2    7    6]
 [   0    1    0    0    1    1    1    9    3    0   23   85   13    1
   264    6   11]
 [   0    0    0    0    0    0    0    3    0   15   94   11   18   27
     2  275   59]
 [   0    0    0    0    0    0    0    3    0    4   29   31    8   27
    10   42  368]]
------ TEST ACCURACY:  weights.21-0.51.hdf5  ------
0.755639097744
[[ 5  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  4  4  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 14  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 67  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0 30  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  6  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  2  0  0  1  0 11  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  9]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  9  1  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  2  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  2  0  4  3]]

>>>>>>>>>>>>>> 20 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/20/weights.50-0.51.hdf5
------ TRAIN ACCURACY:  weights.50-0.51.hdf5  ------
0.920424403183
[[ 140    2    0    0    1    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  194    4    0    0    0    0    5    0    0    0    0    0    0
     0    0    0]
 [   0    0 1565    0    0    0   17    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3 1909    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    0  853    1   25    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  728    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    4    1    8 1248    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    1    0    1  264   18    0    2    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    6  185    0    0    0    0    0
     0    0    0]
 [   2    0    0    0    0    1    0    0    0  434    7    5    2   60
     0    1    1]
 [   0    0    0    0    2    1    0    2    1   23  423   10    7   15
     4    9    4]
 [   0    0    1    0    0    2    1    4    1   22   15  400    3   16
    35    1   18]
 [   0    1    0    0    0    0    0    2    0    1    1    7  606    9
     4   10    2]
 [   0    1    0    0    0    0    0    0    0   57    1    5    1  390
     0   12    2]
 [   0    0    0    0    2    0    0   10    4    3   13   43   10    4
   322    5    9]
 [   0    0    0    0    0    0    0    5    0   12   62    6   12   16
     5  346   35]
 [   0    0    0    0    0    1    0    6    0    3   12   17    4   26
    12   41  403]]
------ TEST ACCURACY:  weights.50-0.51.hdf5  ------
0.696312364425
[[  8   0   0   0   2   0   0   0   0   0   0   0   0   0   0   0   0]
 [  2   6   1   0   1   0   0   2   1   0   0   0   0   0   0   0   0]
 [  0   0 134   0   0   0  22   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  71   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   2  16  10   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  18   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   4  32   0   3  11   0   0   0   0   0   0   0   0   0   0]
 [  8   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   8   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   9   0   0   0   7   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   4   0   0   2   1   3]
 [  0   0   0   0   0   0   0   0   0   0   0   2   0   0   2   0   3]
 [  0   0   0   0   0   0   0   0   0   0   0   0  18   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   5   0   0   0  10   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   7   2   0]
 [  0   0   0   0   0   0   0   0   0   0   4   0   0   0   3   3   4]
 [  0   0   0   0   0   0   0   0   0   0   6   0   0   0   1   2   0]]

>>>>>>>>>>>>>> 21 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/21/weights.39-0.49.hdf5
------ TRAIN ACCURACY:  weights.39-0.49.hdf5  ------
0.916456357149
[[ 137    7    0    0    0    0    0    1    1    0    0    0    0    0
     0    0    0]
 [   0  198    1    0    0    0    0    6    0    0    0    0    0    0
     0    0    0]
 [   0    0 1720    0    4    0   12    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    1 1921    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    3    0  882    0   25    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    2    2    1    0 1273    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    0    0    0  265   14    0    1    0    1    0
     1    0    0]
 [   0    0    1    0    0    0    0    4  180    0    0    0    0    0
     0    0    1]
 [   0    2    0    0    0    0    0    0    0  445    9   12    3   32
     4    0    9]
 [   0    0    0    0    1    0    0    4    2   26  404   20    4   12
     4   11   14]
 [   0    0    0    0    0    2    1    4    1   15   26  401   12   11
    21    2   13]
 [   0    0    0    0    0    0    0    4    0    1    3   15  593    9
     0    8    9]
 [   1    3    0    0    1    0    0    0    0   86    1    6    2  355
     2   10    6]
 [   0    0    0    0    3    0    0    7    3    0   15   64    6    0
   306    8   13]
 [   0    0    0    0    0    0    0    2    0   13   68   11   15   11
     8  320   53]
 [   0    0    0    0    0    0    0    3    0    4   16   47    3   12
     8   24  410]]
------ TEST ACCURACY:  weights.39-0.49.hdf5  ------
0.435714285714
[[ 3  4  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  9  0  0  1  0  0  0  0  0  0]
 [ 0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  4  9  0  0 48  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  2  0  6  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  2 20  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  9  0  7  0 30  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 14  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  0  3  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  5  0  0  0  0  2  2]
 [ 0  0  0  0  0  0  0  0  0  0  5  9  3  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1 18  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  1  0  5  1  0  1]
 [ 0  1  0  0  0  0  0  0  0  0  1  7  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  0  1  0  7  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  5  0]]

>>>>>>>>>>>>>> 22 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/22/weights.34-0.52.hdf5
------ TRAIN ACCURACY:  weights.34-0.52.hdf5  ------
0.907858598388
[[ 130    2    1    0    0    0    0    1    2    0    0    0    0    0
     0    0    0]
 [   0  184    7    0    0    0    0    9    0    0    2    1    0    0
     2    0    0]
 [   0    0 1656    0    6    1   13    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    7 1907    0    0    9    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   15    0  833    0   27    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   42    4    2    6 1219    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    1    0    1    0    0  266    5    0    1    0    1    0
     1    1    0]
 [   0    1    1    0    0    0    0    7  172    0    0    0    0    0
     0    2    0]
 [   2    0    1    0    0    1    0    0    0  438    9   10    5   34
     2    0    5]
 [   0    0    0    0    1    0    0    5    0   38  370   22    8   13
     4   25    4]
 [   0    0    0    0    0    2    1    1    0   20   13  397   12    9
    26    2   15]
 [   0    2    0    0    0    0    0    1    0    5    6    9  595   10
     2    5    3]
 [   0    0    0    0    0    1    0    0    0   65    2    7    5  369
     4    2    8]
 [   0    1    0    0    1    0    0    7    0    4   15   75    8    0
   291    3   12]
 [   0    0    0    0    0    0    0    0    0   19   74    9   16   12
     8  301   51]
 [   0    0    0    0    0    0    0    0    0    3   13   30    7   16
     7   36  400]]
------ TEST ACCURACY:  weights.34-0.52.hdf5  ------
0.644628099174
[[ 2  2  0  0  1  0  0 11  1  0  0  0  0  0  0  0  0]
 [ 0  4  0  0  1  0  0  5  0  0  0  1  0  0  0  0  0]
 [ 0  0 55  0  6  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 57  0  0  5  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 34  7  0  0  0  0  0  5  0  0  0  0  0]
 [ 0  0  0  0  0 23  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  1  0  0 47  0  0  0  0  3  0  0  0  0  0]
 [ 0  1  0  0  0  0  0 11  3  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 10  7  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  3  7  3  0  0  0  0  8]
 [ 0  0  0  0  0  0  0  0  0  4  5  3  0  0  8  0  8]
 [ 0  0  0  0  0  0  0  0  0  2  4  0 17  0  0  0  0]
 [ 3  4  0  0  0  0  0  0  0  8  0  0  0  1  4  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0 16  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  6  0  0  7  6]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  8  0  7  0  3]]

>>>>>>>>>>>>>> 23 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/23/weights.48-0.52.hdf5
------ TRAIN ACCURACY:  weights.48-0.52.hdf5  ------
0.924858016601
[[ 146    1    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0  200    1    0    0    0    0    8    0    0    0    0    0    0
     0    0    0]
 [   0    0 1707    0    1    0   15    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1906    0    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5    0  867    0   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   16    3    3    5 1252    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    1    0    0    0    0  276    2    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    1    4  189    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  457    9    2    0   29
     1    0    7]
 [   0    0    1    1    0    1    0    1    1   33  416   11    8   12
     2    6    9]
 [   0    0    0    0    1    1    0    4    1   15   29  402    5   13
    30    0   16]
 [   0    0    1    0    0    0    0    3    1    0    2   13  608   10
     2    1    5]
 [   1    0    0    0    1    0    0    0    0   62    3    6    1  380
     5    6    4]
 [   0    1    0    0    2    0    0    8    1    1    6   57   10    1
   332    1    5]
 [   0    0    0    0    0    0    0    4    0   16   67    7   10   19
    11  316   48]
 [   0    0    0    0    0    0    0    0    0    8   10   42    9    8
    15   18  410]]
------ TEST ACCURACY:  weights.48-0.52.hdf5  ------
0.742331288344
[[ 5  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 1  6  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  9  6  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 74  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  4  0 16  6  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 24  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 10  0  0  6 29  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0 15  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  6  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  0  0  0 16  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  9  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  6  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  8  0  0  4  2  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  6  0  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 12  3]
 [ 0  0  0  0  0  0  0  0  0  0  6  0  0  0  0  2  6]]

>>>>>>>>>>>>>> 24 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/24/weights.43-0.52.hdf5
------ TRAIN ACCURACY:  weights.43-0.52.hdf5  ------
0.924641577061
[[ 128    4    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  189    1    0    1    0    0    4    0    0    1    0    0    0
     0    0    0]
 [   0    0 1550    0    2    1    5    0    0    0    0    0    0    0
     0    1    0]
 [   0    0    2 1911    0    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    1   10    0  827    0   20    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    4    1    4 1252    0    0    0    0    0    0    0
     0    0    0]
 [   0    4    0    0    1    0    0  267    4    0    1    0    0    0
     1    0    0]
 [   0    1    0    0    0    0    0    3  185    0    0    0    0    0
     1    0    0]
 [   0    0    0    0    0    0    0    0    2  421    5    9    3   60
     1    0    5]
 [   0    1    0    0    2    0    1    0    0   21  400   17   10   24
     2    3   15]
 [   0    0    0    0    0    1    1    1    2   13   20  422    5    6
    20    0   21]
 [   0    1    0    0    0    0    0    2    0   10    6   16  588   10
     0    6    1]
 [   1    2    0    0    0    0    0    0    0   37    1    7    0  416
     2    0    3]
 [   0    1    0    0    2    0    0    4    2    2   14   46    2    0
   315    4   17]
 [   0    0    0    0    1    0    0    0    0   11   62    9   14   31
    14  300   52]
 [   0    0    0    0    0    0    0    1    0    3   11   21    8   21
    12   11  429]]
------ TEST ACCURACY:  weights.43-0.52.hdf5  ------
0.749590834697
[[  8  12   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1]
 [  0   4   0   0   0   0   0   2   0   0   0   1   7   0   1   3   1]
 [  0   0 177   0   2   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  69   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0  62   1   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  27   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   1  17   0   0  38   0   0   0   0   0   0   0   0   0   0]
 [  1   1   0   0   0   0   0   7   0   0   0   0   7   0   0   2   0]
 [  0   0   0   0   0   0   0   3   7   0   0   0   0   0   0   0   0]
 [  0   2   0   0   0   0   0   0   0  11   0   0   0   9   0   0   1]
 [  0   0   0   0   0   0   0   0   0   0  13   0   0   0   0   2   0]
 [  0   0   0   0   0   0   0   0   0   3   0   1   2   8   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  19   2   0   0   0]
 [  0   0   0   0   0   0   0   0   0   9   0   0   0   6   0   0   0]
 [  0   0   0   0   0   0   0   1   0   0   0  13   7   0   0   0   4]
 [  0   0   0   0   0   0   0   0   0   0   4   1   5   0   1   8   0]
 [  0   0   0   0   0   0   0   0   0   0   3  10   1   0   0   2   1]]

>>>>>>>>>>>>>> 25 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/25/weights.35-0.50.hdf5
------ TRAIN ACCURACY:  weights.35-0.50.hdf5  ------
0.914921696287
[[ 149    2    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   1  201    1    0    2    0    0    6    0    0    0    0    1    0
     0    0    0]
 [   0    0 1671    0    9    0    5    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1913    0    0    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    6    0  861    1   24    1    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  722    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    8    7    2    1 1254    0    0    0    0    0    0    0
     0    0    0]
 [   0    6    0    0    1    0    0  271    6    0    1    1    0    0
     2    0    0]
 [   0    3    0    0    0    0    1    4  184    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    0    0    0    0    0  412   11    9    5   67
     1    1    4]
 [   0    0    1    0    1    0    0    4    1   23  405   16    2   13
     3   12   11]
 [   0    0    0    0    0    1    1    1    2   14   16  426   15    8
    14    6    8]
 [   0    3    0    0    0    0    0    4    0    7    4    4  591    6
     4    7    3]
 [   2    6    0    0    0    0    0    0    0   69    7    4    1  362
     1    4    7]
 [   0    1    0    0    0    0    0    9    3    0   15   72    7    1
   286    3   22]
 [   0    1    0    6    1    0    0    1    1    4   67    3   16   11
     7  301   66]
 [   0    0    0    0    0    0    0    0    0    4   24   37    9   17
     9   23  390]]
------ TEST ACCURACY:  weights.35-0.50.hdf5  ------
0.735802469136
[[ 0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  2  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0 31 12  3  2  4  0  0  0  0  0  0  0  0  1  0]
 [ 0  0  0 68  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 26  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 21  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  2  0 50  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  3  2  0  0  0  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  8  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  6  4  0  0  6  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  4  7  0  0  3  0  2  3]
 [ 0  0  0  0  0  0  0  0  0  1  5  4  0  1  0  0  3]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 28  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0 20  0  1  0]
 [ 0  0  0  0  2  0  0  0  0  1  6  4  0  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  7 12  0  0  8  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 21]]

>>>>>>>>>>>>>> 26 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/26/weights.33-0.49.hdf5
------ TRAIN ACCURACY:  weights.33-0.49.hdf5  ------
0.904940970704
[[ 138   10    0    0    0    0    0    0    3    0    1    0    0    0
     0    0    0]
 [   4  191    1    0    1    0    0   14    0    0    1    0    0    0
     0    0    0]
 [   0    0 1633    0   28    3   43    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0 1910    0    2   14    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4    0  862    1   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  723    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    3    6    9   15 1243    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    0    0    1    0    0  283    4    0    1    1    0    0
     1    0    0]
 [   0    2    0    0    0    0    0   12  184    0    0    0    0    0
     0    2    0]
 [   0    1    0    0    0    0    0    1    0  397    6   11    3   85
     2    3    3]
 [   0    0    0    0    1    0    1    4    1   30  377   10    9   20
     4   27    6]
 [   0    0    0    0    3    3    0    0    2   13   15  406   16   12
    16    3   18]
 [   0    0    0    0    0    0    1    0    0    6    2    8  592   13
     2    7    5]
 [   1    5    0    0    1    0    0    0    0   60    1    1    0  391
     2    9    6]
 [   1    0    0    0    3    0    0    4    1    2   16   76    5    0
   294    8   11]
 [   0    0    0    6    2    0    0    1    2   11   53    7   11   21
     2  334   44]
 [   0    0    1    0    0    1    0    0    0    8   14   37    6   21
     8   32  390]]
------ TEST ACCURACY:  weights.33-0.49.hdf5  ------
0.776785714286
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0  0  0  0  1  0  0  0  1  0  0  0  0  0]
 [ 0  0 28  0  0  0  3  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 59  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 30  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 23  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0 48  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 16  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  4 10  4  1  2  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  4  9  0  0  2  0  3]
 [ 0  4  0  0  0  0  0  2  0  0  0  1 15  2  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  6  0  0  0]
 [ 0  0  0  0  0  0  0  4  1  0  0  6  0  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  4 14]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0  2  2  8]]

>>>>>>>>>>>>>> 27 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/27/weights.33-0.48.hdf5
------ TRAIN ACCURACY:  weights.33-0.48.hdf5  ------
0.90608848007
[[ 148    4    0    0    0    0    0    1    0    0    0    0    0    0
     0    0    0]
 [   3  190    5    0    3    0    0    9    1    0    2    1    0    0
     1    0    0]
 [   0    0 1686    0    3    1    9    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    5 1909    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   10    0  858    2   26    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  715    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   11   17    3    8 1240    0    0    0    0    0    0    0
     0    0    0]
 [   1    3    2    0    1    0    0  261   16    0    3    1    1    0
     0    0    0]
 [   0    0    0    0    0    0    1   10  185    0    0    0    0    0
     0    3    0]
 [   0    2    0    0    0    0    0    0    0  423   13    4    3   61
     3    1    1]
 [   0    0    0    0    0    1    2    1    0   32  416    6    8   11
     3    9    8]
 [   0    0    0    0    0    2    0    2    3   18   27  386   11   17
    22    1   15]
 [   0    1    0    0    0    0    0    2    0    7    3    7  598   10
     2   10    0]
 [   2    1    0    0    0    0    0    0    0   71   15    1    3  364
     2    4    3]
 [   0    0    0    0    2    0    0    7    1    0   27   66    7    5
   302    3    3]
 [   0    0    0    0    0    0    0    0    1   13   94    5   15   13
     5  305   46]
 [   0    0    0    0    0    0    0    4    0   12   30   35   12   19
    11   38  357]]
------ TEST ACCURACY:  weights.33-0.48.hdf5  ------
0.77808988764
[[ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 39  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 71  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 30  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 10  1  2  0 32  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  1  4  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 16  0  0  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  7  0  2  2  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  9  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  3  0  0  0 10  0  5  0]
 [ 1  0  0  0  0  0  0  0  1  0  2  1  0  0  0  3  3]
 [ 0  0  0  0  0  0  0  0  0  1 15  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0  0  1 11]]

>>>>>>>>>>>>>> 28 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/28/weights.32-0.47.hdf5
------ TRAIN ACCURACY:  weights.32-0.47.hdf5  ------
0.90309908337
[[ 148    5    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   3  192    2    0    3    0    0   11    0    0    3    0    0    0
     1    0    0]
 [   0    0 1686    0    3    3   16    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1915    0    0    8    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    7    0  846    2   35    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  721    1    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    4    3    8 1255    0    0    0    0    0    0    0
     0    0    0]
 [   0    2    1    0    2    0    1  262    9    0    7    0    0    1
     1    0    2]
 [   0    0    0    0    0    0    1   14  181    0    2    0    0    0
     0    2    0]
 [   2    0    0    0    0    0    0    0    0  419   16    3    4   66
     0    0    2]
 [   0    0    2    0    1    1    1    1    1   29  408    9    5   21
     2   12    2]
 [   0    0    0    0    1    1    2    2    0   16   33  388   11   12
    22    0   21]
 [   1    0    0    0    0    0    0    2    1    8    7   10  590    9
     0    6    4]
 [   1    4    0    0    1    0    0    0    0   62    9    3    1  378
     3    6    6]
 [   0    1    0    0    2    0    0    8    1    2   33   68   13    3
   274    6   15]
 [   0    0    0    6    1    0    0    0    0   12   97    6   17   15
     5  287   51]
 [   0    0    0    0    0    0    0    0    0    7   31   28    5   26
     9   17  395]]
------ TEST ACCURACY:  weights.32-0.47.hdf5  ------
0.822784810127
[[ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0 30  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 41  0  0 17  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 31  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 23  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 41  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  6  0  0  1  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 16  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0 16  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  0 11  0  0  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0 21  0  0  2  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  8  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  3  0  0  4  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  0 15]
 [ 0  0  0  0  0  0  0  0  0  0  3  0  0  1  1 11]]

>>>>>>>>>>>>>> 29 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/29/weights.46-0.55.hdf5
------ TRAIN ACCURACY:  weights.46-0.55.hdf5  ------
0.92697228145
[[ 149    2    0    0    0    0    0    0    1    0    0    0    0    0
     0    0    0]
 [   1  194    4    0    0    0    0    7    0    0    0    0    0    0
     0    0    0]
 [   0    0 1628    0    1    0    3    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1911    0    0    2    0    0    0    0    0    0    0
     0    0    0]
 [   0    1   12    0  853    1   24    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  714    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   32    7    1    6 1239    0    0    0    0    0    0    0
     0    0    0]
 [   0    1    0    0    0    0    0  275    6    0    0    0    0    0
     1    0    0]
 [   0    0    1    0    0    0    0    2  188    0    1    0    0    0
     0    0    0]
 [   0    2    0    0    0    1    0    0    0  432    4    5    1   50
     3    0    2]
 [   0    0    0    0    0    0    0    3    2   35  399    7    3   15
     5   11    3]
 [   0    0    0    0    0    0    1    2    0   10   14  402    4   12
    48    4    7]
 [   0    1    0    0    0    0    0    2    0   11    2    5  589    9
     1    9    1]
 [   4    3    0    0    0    0    0    1    0   53    0    1    0  385
     9    0    2]
 [   0    0    0    0    0    0    0    5    1    4    9   37    6    0
   335    7   10]
 [   0    0    0    0    0    0    0    0    0   12   58    1    7   21
     7  352   35]
 [   0    0    0    0    0    0    0    3    0    7   19   20    2   16
    18   28  389]]
------ TEST ACCURACY:  weights.46-0.55.hdf5  ------
0.683495145631
[[  0   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  3   7   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0 105   0   0   0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0  68   0   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  14   0  16   0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0  32   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0  11   1   0   0  27   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0  11   0   0   2   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   2   6   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0  29   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   3  18   1   2   1   0   3   0]
 [  0   0   0   0   0   2   1   0   0   8   1   0   7   0   0   0   3]
 [  0   0   0   0   0   0   0   0   0   0   0  10  13   0   2   5   1]
 [  0   0   0   0   0   0   0   0   0  16   2   3   0   2   2   0   1]
 [  0   0   0   0   0   0   0   0   0   0   1  13   6   0   0   0   0]
 [  0   0   0   0   1   0   0   0   0   0  17   1   0   0   0   1   0]
 [  0   0   0   0   0   1   0   0   0   0   0   2   3   3   0   6  17]]

>>>>>>>>>>>>>> 30 -fold <<<<<<<<<<<<<<<<
========================================
model/unimib_svd_conv1d_10/30/weights.49-0.50.hdf5
------ TRAIN ACCURACY:  weights.49-0.50.hdf5  ------
0.925283815894
[[ 149    1    1    0    0    0    0    2    0    0    0    0    0    0
     0    0    0]
 [   1  199    5    0    1    0    0    6    0    0    0    0    0    0
     0    0    0]
 [   0    0 1679    0    1    2    4    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    4 1920    0    0    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    6    0  867    0   23    0    0    0    0    0    0    0
     0    0    0]
 [   0    0    0    0    0  719    0    0    0    0    0    0    0    0
     0    0    0]
 [   0    0   13    4    2    7 1256    0    0    0    0    0    0    0
     0    0    0]
 [   0    3    0    0    0    0    0  283    3    0    0    0    0    0
     1    1    0]
 [   0    0    1    0    0    0    0    3  190    0    0    0    0    0
     0    3    0]
 [   0    2    0    0    0    1    0    0    0  434    5    0    5   46
     0    1    4]
 [   0    0    1    0    1    0    0    3    0   22  412   11    5    4
     6   16    6]
 [   0    0    0    0    0    2    2    3    0   18    9  406    6    8
    25    3   18]
 [   0    2    0    0    0    0    0    3    0    9    1   11  584   10
     3    8    3]
 [   3    4    0    0    1    1    0    1    0   75    0    5    0  363
     3    5    4]
 [   0    0    0    0    1    1    0    6    1    0    9   60    8    2
   310    8    8]
 [   0    0    0    6    0    0    0    1    0   18   66    2    7    3
    11  332   49]
 [   0    0    0    0    0    0    0    3    0    5   12   30   13    5
    15   16  411]]
------ TEST ACCURACY:  weights.49-0.50.hdf5  ------
0.723039215686
[[ 1  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0 52  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0 61  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 27  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 42  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 23  0  0  0  0  8  0  0]
 [ 0  0  0  0  1  0  0  0 17  3  2  0  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  2  1  8  5  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  5 21  0  0  0  0]
 [ 0  0  0  0  0  0  0  0 11  0  0  0  8  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  4  0  0 16  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  2  0  8  1  3  4]
 [ 0  0  0  0  0  0  0  0  4  0  8  0  9  2  0  1]]
[0.7317708333333334, 0.7547169811320755, 0.8256578947368421, 0.5273311897106109, 0.7583892617449665, 0.8131067961165048, 0.806060606060606, 0.7984886649874056, 0.6763285024154589, 0.7028753993610224, 0.7091836734693877, 0.82, 0.7957559681697612, 0.7956989247311828, 0.8075949367088607, 0.7350427350427351, 0.8051391862955032, 0.7793103448275862, 0.7556390977443609, 0.6963123644251626, 0.4357142857142857, 0.6446280991735537, 0.7423312883435583, 0.7495908346972177, 0.7358024691358025, 0.7767857142857143, 0.7780898876404494, 0.8227848101265823, 0.683495145631068, 0.7230392156862745]
0.739555503715
0.0842176003637

Process finished with exit code 0

'''
